<!DOCTYPE html> <html class=v2 dir=ltr xmlns=http://www.w3.org/1999/xhtml xmlns:b=http://www.google.com/2005/gml/b xmlns:data=http://www.google.com/2005/gml/data xmlns:expr=http://www.google.com/2005/gml/expr style><!--
 Page saved with SingleFile 
 url: https://blog.marcgravell.com/2018/07/pipe-dreams-part-1.html 
 saved date: Tue Nov 15 2022 14:24:27 GMT+0800 (中国标准时间)
--><meta charset=utf-8>
<style>:root{--sf-img-3: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAARMCAYAAACZG7OEAAABWklEQVR42u3cwQ0CQQwEQS/cl2jIPzCQ0BAEBnHrqgBW7hvxZSW5VaOjqlbng5dq1v6gZMmSJbtQsmTJkiWfK9kokiVLlizZKJIlS5Ys2YWSJUuWLHnXZKNIlixZsmSjSJYsWbJkF0qWLFmyZMnbJBtFsmTJko0iWbJkyZIlu1CyZMmSJe+abBTJkiVLlmwUyZIlS5bsQsmSJUsekmwUyZIlS5Ys2SiSJUuWLNmFkiVLlixZ8nmTjSJZsmTJRpEsWbJkyZJdKFmyZMn/mbyS3LsvzLxRJEuWLFmyZMmSJUs2imTJkiVLlixZsmTJU5ONIlmyZMmSJUuWLFnytGSjSJYsWbJkyZIlSx4+CgAAAAAAAAAAAAAAAAAAAAAAAADwYytJ6/8fHlX16n7wMe/Bp2TJfim+oWTfULJvKNk3/NaFK8m1AAAAAAAAAAAAAAAAAAAAAAAAAADgE2/S1Gnyf8/liwAAAABJRU5ErkJggg==");--sf-img-7: url("data:image/gif;base64,R0lGODlhDQAKALMPAP///6+vr/j4+OHh4fr6+uzs7Nvb2+3t7dzc3Ojo6N3d3e7u7ubm5vf39/b29v///yH5BAEAAA8ALAAAAAANAAoAQAQ68D1AK5AYi5OOyMQxBAFAGshwEARpmQGzEJJQjOhQfBLxUo4GTZBwUU6KxMc2OqV2GaZCx8v0BLRMBAA7");--sf-img-8: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAMAAABhq6zVAAAABGdBTUEAANbY1E9YMgAAAP9QTFRF2XIp3nIw4Xgx6IY16Yc1214q3WMr32ow4Gks4W40428u43I144BT5XMu5XY25noz53Yw6Hkw6Hs36X43634y64Ax64A564M57Ic+7Zpj7oUz7oY67oc67qZ974Y08Is78I1A8J1l8Yo08Yw88Y858ZVN8bGK8o888442848286Rm87aL9JI99JM99JxP9LyY9ZU79ZY+9pQ39ptE9qto95c495k/97J1+Jg4+LmB+MSa+MWa+atd+bFq+cea+ps5+rd2+rh2+r2D+uXY+506+6NG+65e+69f+7p3+7+D/MCD/erZ/e/l/fDm/fHm/ufO/vLm/vPm/vjy//nz////B9JuTQAAAAV0Uk5TMO/v7++mu2gOAAAAj0lEQVQIHQXBUQuCMBAA4N3ddjO11B5C+jVC//+t94iCCCQa6tJ5bn0fKGy0oYx1ugpiwRAJja06ggovanGTscb9qAYvtt4jumGhBtswxMK6r1818VnJPJbHp0fM7G2CcnlyIYK8y2GUw2tug6DmU769mR5N3NBYiX2vzEdpAd25wXsJMSaheM+2NSWlIKQ/2xpDTzPOPTwAAAAASUVORK5CYII=")}body{margin:0}.content-outer,.header-outer,.tabs-outer,.main-outer,.main-inner,.footer-outer,.post,.comments,.widget,.date-header{position:relative;min-height:0}.footer-outer{margin-bottom:-1px}.tabs-inner{padding:0 15px}.main-inner{padding:30px 0}.main-inner .column-left-inner,.main-inner .column-right-inner{padding:0 15px}.footer-inner{padding:30px 15px}.section{margin:0 15px}.widget{margin:30px 0}.section:first-child .widget:first-child{margin-top:0}.section:last-child .widget:last-child{margin-bottom:0}body .navbar{height:30px;padding:0;margin:0}body .navbar .Navbar{position:absolute;z-index:10;left:0;width:100%;margin:0;padding:0;background:none;border:none}.header-inner .section{margin:0}.header-inner .widget{margin-left:30px;margin-right:30px}.header-inner .Header{margin:0}.header-inner .Header #header-inner{overflow:hidden}.header-inner .Header .descriptionwrapper{margin-bottom:25px}.Header h1{margin-bottom:10px}.Header .description{margin:.5em 0 10px;padding:0 2px}a img{position:relative}h1,h2,h3{margin:0;position:relative}h1 a:hover{text-decoration:none}.widget{line-height:1.4}.widget ul{padding:0 0 0 1.25em;margin:0;line-height:1.2}.widget li{padding:.25em 0;margin:0;text-indent:0}.widget .post-body ul{padding:0 2.5em;margin:.5em 0;line-height:1.4}.widget .post-body li{margin-bottom:.25em;padding-top:0;padding-bottom:0}.post-body{width:100%}.post-footer-line>*{margin-right:1em}.post-footer-line>*:last-child{margin-right:0}.post-timestamp{margin-left:-1em}.post-footer-line>*:first-child{margin-left:0}.Profile img{margin:0 .75em .5em 0}.Profile .profile-datablock{margin:0 0 .5em}dt{font-weight:bold}table.section-columns td.first.columns-cell{border-left:none}html{height:100%}body{min-height:100%;position:relative}.content{position:relative;word-wrap:break-word}.content-outer,.region-inner{min-height:0;margin:0 auto}.columns{zoom:1}.columns-inner{min-height:0}.column-center-outer,.column-left-outer,.column-right-outer{position:relative;float:left}.column-center-outer{width:100%}.fauxcolumns{position:relative}.fauxcolumn-outer{position:absolute;top:0;bottom:0;overflow:hidden}.fauxcolumn-outer .fauxborder-left,.fauxcolumn-outer .fauxborder-right,.fauxcolumn-inner{height:100%}.fauxcolumn-left-outer{left:0}.fauxcolumn-right-outer{right:0}.cap-top,.cap-bottom{position:relative;height:0;background-repeat:repeat-x}.cap-top .cap-left,.cap-top .cap-right,.cap-bottom .cap-left,.cap-bottom .cap-right{height:100%;background-repeat:no-repeat}.cap-top,.cap-top .cap-left{background-position:top left}.cap-bottom,.cap-bottom .cap-left{background-position:bottom left}.cap-top .cap-left,.cap-bottom .cap-left{float:left}.cap-top .cap-right{background-position:top right;float:right}.cap-bottom .cap-right{background-position:bottom right;float:right}.fauxborder-left{background-position:top left;background-repeat:repeat-y;position:relative}.fauxborder-right{background-position:top right;background-repeat:repeat-y;position:absolute;right:0;height:100%}table.section-columns{border:none;table-layout:fixed;width:100%;position:relative}table.columns-2 td.columns-cell{width:50%}table.section-columns td.columns-cell{vertical-align:top}.body-fauxcolumns,.content-fauxcolumns{position:absolute;top:0;left:0;z-index:-1;height:100%;width:100%;overflow:hidden}.body-fauxcolumns .fauxcolumn-outer{width:100%}.content-fauxcolumns .fauxcolumn-outer{position:relative;overflow:visible;height:100%;margin:0 auto}aside,header,footer{display:block}div.clear{clear:both}#navbar-iframe{display:block;height:30px}.profile-img{float:left}.profile-data{margin:0}.profile-name-link{background:no-repeat left top;box-sizing:border-box;display:inline-block;max-width:100%;min-height:20px;padding-left:20px}body{overflow-wrap:break-word;word-break:break-word;word-wrap:break-word}.widget.Subscribe{position:static}.widget.Subscribe .widget-content{zoom:1}.subscribe{color:#999}.subscribe-wrapper{margin:.5em;padding:0;position:relative;zoom:1}div.subscribe{cursor:pointer;margin:0;padding:0;text-align:left;width:144px}div.subscribe div.top{font-size:1em;padding:4px 0 1px;width:144px}html>body div.subscribe div.top{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAAGQBAMAAACzH/Q/AAAAMFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkJCTg4ODh4eH7+/v8/Pz///8hEP7MAAAAD3RSTlMABBQiIyYnKCkqK5aZ6O1Hd1dgAAAAv0lEQVR42u3TwRGCMBRF0fArCOxYilZgCfZAYWzpAKuzA+3A1Vs4eG4BZyYvSQ3XNdC917w/Ax1bTY8W6HappUVaasxAY7VQIBAIBAKBQCAQCAQCgUCgBNQzzpCDfu9oJ741XwQE+gq9Ms7b2P89tndkbBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQCgUAgEAgEAoFAIBAIBAKBQCAQCAQ6N/QBxmRSL1QjElcAAAAASUVORK5CYII=)top left no-repeat}span.inner{padding:0}div.subscribe div.top span.inner{margin:0 5px}.feed-icon{vertical-align:baseline;display:inline}div.subscribe div.bottom{font-size:3px;height:3px;line-height:0}.subscribe-wrapper .expanded{position:absolute;top:0;z-index:20}html>body div.subscribe div.bottom{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAAADBAMAAACOmptmAAAALVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAkJCTh4eHj4+Pk5OT7+/v8/Pz9/f3///+jj1vZAAAADHRSTlMABAUUFSImK5mbnuu6xDmCAAAAIklEQVQIHWOweHuGcnD23hQG8dXvqAB2FTEwuaZRAYQoAAA1TZXCCL/A+AAAAABJRU5ErkJggg==)bottom left no-repeat;margin-bottom:0;padding-bottom:0;width:144px}.subscribe-dropdown-arrow{float:right;margin-right:6px;margin-top:4px}#ArchiveList .toggle{cursor:pointer;font-family:Arial,sans-serif}#ArchiveList .toggle-open{line-height:.6em}#ArchiveList{text-align:left}#ArchiveList a.post-count-link,#ArchiveList a.post-count-link:link,#ArchiveList a.post-count-link:visited{text-decoration:none}#ArchiveList a.toggle,#ArchiveList a.toggle:link,#ArchiveList a.toggle:visited,#ArchiveList a.toggle:hover{color:inherit;text-decoration:none}.BlogArchive #ArchiveList ul li{background:none;list-style:none;list-style-image:none;list-style-position:outside;border-width:0;padding-left:15px;text-indent:-15px;margin:.25em 0;background-image:none}.BlogArchive #ArchiveList ul ul li{padding-left:1.2em}.BlogArchive #ArchiveList ul{margin:0;padding:0;list-style:none;list-style-image:none;border-width:0}.BlogArchive #ArchiveList ul.posts li{padding-left:1.3em}.post-footer abbr{border:none}#blog-pager-newer-link{float:left}#blog-pager-older-link{float:right}#blog-pager{margin:1em 0;text-align:center;overflow:hidden}.comments{clear:both;margin-top:10px;margin-bottom:0}</style>
<meta content="width=1100" name=viewport>
<meta content=blogger name=generator>
<link href=https://blog.marcgravell.com/2018/07/pipe-dreams-part-1.html rel=canonical>
<link rel=alternate type=application/atom+xml title="Code, code and more code. - Atom" href=https://blog.marcgravell.com/feeds/posts/default>
<link rel=alternate type=application/rss+xml title="Code, code and more code. - RSS" href="https://blog.marcgravell.com/feeds/posts/default?alt=rss">
<link rel=service.post type=application/atom+xml title="Code, code and more code. - Atom" href=https://www.blogger.com/feeds/8184237816669520763/posts/default>
<link rel=alternate type=application/atom+xml title="Code, code and more code. - Atom" href=https://blog.marcgravell.com/feeds/292482151459961908/comments/default>
<meta content=https://blog.marcgravell.com/2018/07/pipe-dreams-part-1.html property=og:url>
<meta content="Pipe Dreams, part 1" property=og:title>
<meta content="Pipelines - a guided tour of the new IO API in .NET, part 1  (part 2 here)  About two years ago I blogged about an upcoming experimental IO ..." property=og:description>
<title>Code, code and more code.: Pipe Dreams, part 1</title>
<style id=template-skin-1><!--body{font:normal normal 12px Arial,Tahoma,Helvetica,FreeSans,sans-serif;color:#222222;background:#eeaa00 none repeat scroll top left;padding:0 40px 40px 40px}html body .region-inner{min-width:0;max-width:100%;width:auto}h2{font-size:22px}a:link{text-decoration:none;color:#cc6611}a:visited{text-decoration:none;color:#888888}a:hover{text-decoration:underline;color:#ff9900}.body-fauxcolumn-outer .fauxcolumn-inner{background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKAQMAAAC3/F3+AAAAA1BMVEX///+nxBvIAAAAAXRSTlOZyTXzhgAAAApJREFUCB1jwAsAAB4AAfeYTFwAAAAASUVORK5CYII=)repeat scroll top left}.body-fauxcolumn-outer .cap-top{position:absolute;z-index:1;height:400px;width:100%}.body-fauxcolumn-outer .cap-top .cap-left{width:100%;background:transparent var(--sf-img-3) repeat-x scroll top left}.content-outer{-moz-box-shadow:0 0 40px rgba(0,0,0,.15);-webkit-box-shadow:0 0 5px rgba(0,0,0,.15);-goog-ms-box-shadow:0 0 10px #333333;box-shadow:0 0 40px rgba(0,0,0,.15);margin-bottom:1px}.content-inner{padding:10px 10px}.content-inner{background-color:#ffffff}.header-outer{background:#cc6611 var(--sf-img-3) repeat-x scroll 0-400px}.Header h1{font:normal normal 60px Arial,Tahoma,Helvetica,FreeSans,sans-serif;color:#ffffff;text-shadow:1px 2px 3px rgba(0,0,0,.2)}.Header h1 a{color:#ffffff}.Header .description{font-size:140%;color:#ffffff}.header-inner .Header .titlewrapper{padding:22px 30px}.header-inner .Header .descriptionwrapper{padding:0 30px}.tabs-inner .section:first-child{border-top:0 solid #eeeeee}.main-outer{border-top:0 solid #eeeeee}.fauxcolumn-left-outer .fauxcolumn-inner{border-right:1px solid #eeeeee}.fauxcolumn-right-outer .fauxcolumn-inner{border-left:1px solid #eeeeee}div.widget>h2,div.widget h2.title{margin:0 0 1em 0;font:normal bold 11px Arial,Tahoma,Helvetica,FreeSans,sans-serif;color:#000000}.widget .zippy{color:#999999;text-shadow:2px 2px 1px rgba(0,0,0,.1)}h2.date-header{font:normal bold 11px Arial,Tahoma,Helvetica,FreeSans,sans-serif}.date-header span{background-color:transparent;color:#222222;padding:inherit;letter-spacing:inherit;margin:inherit}.main-inner{padding-top:30px;padding-bottom:30px}.main-inner .column-center-inner{padding:0 15px}.main-inner .column-center-inner .section{margin:0 15px}.post{margin:0 0 25px 0}h3.post-title{font:normal normal 22px Arial,Tahoma,Helvetica,FreeSans,sans-serif;margin:.75em 0 0}.post-body{font-size:110%;line-height:1.4;position:relative}.Profile img,.Image img{padding:2px;background:#ffffff;border:1px solid #eeeeee;-moz-box-shadow:1px 1px 5px rgba(0,0,0,.1);-webkit-box-shadow:1px 1px 5px rgba(0,0,0,.1);box-shadow:1px 1px 5px rgba(0,0,0,.1)}.post-header{margin:0 0 1.5em;line-height:1.6;font-size:90%}.post-footer{margin:20px -2px 0;padding:5px 10px;color:#666666;background-color:#f9f9f9;border-bottom:1px solid #eeeeee;line-height:1.6;font-size:90%}.section-columns td.columns-cell{border-left:1px solid #eeeeee}.blog-pager{background:transparent none no-repeat scroll top center}.blog-pager-older-link,.home-link,.blog-pager-newer-link{background-color:#ffffff;padding:5px}.footer-outer{border-top:0 dashed #bbbbbb}--><!--body{min-width:960px}.content-outer,.content-fauxcolumn-outer{min-width:960px;max-width:960px}.main-inner .columns{padding-left:0;padding-right:310px}.main-inner .fauxcolumn-center-outer{left:0;right:310px}.main-inner .fauxcolumn-left-outer{width:0}.main-inner .fauxcolumn-right-outer{width:310px}.main-inner .column-left-outer{width:0;right:100%;margin-left:-0}.main-inner .column-right-outer{width:310px;margin-right:-310px}--></style>
<noscript><link href="https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8184237816669520763&amp;zx=d59b377b-a436-4b46-a15c-73fe7f07228c" rel="stylesheet"></noscript>
<meta name=google-adsense-platform-account content=ca-host-pub-1556223355139109>
<meta name=google-adsense-platform-domain content=blogspot.com>
<meta content=8184237816669520763 itemprop=blogId class=sf-hidden><meta content=292482151459961908 itemprop=postId class=sf-hidden><meta content=https://www.blogger.com/profile/01023334706549710089 itemprop=url class=sf-hidden><meta content=https://blog.marcgravell.com/2018/07/pipe-dreams-part-1.html itemprop=url class=sf-hidden><link href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAQAQAAAAAAAAAAAAAAAAAAAAAAACAP2b/hUhw/2smSv9rQl3/aEhg/2A5S/9SJTP/Tx8s/0kbKP9HFyL/RRQf/0gZM/9IHj7/SRs1/0oaMf9IGC//eDFL/4lPdf9vOVn/dlp4/2hHXv9hM0T/XSo6/1YpN/9RKjT/Uigy/1IqOP9MIDH/Uxsz/1MZMv9UHTv/VRxC/3ksO/+FRmj/e1pu/3dfd/9sPU7/ZDdG/2A3RP9mNET/Zj1T/2Q7Vv9fOVP/VTBC/2czYf9sR2b/YU1e/2KPqP+BNUL/eipB/491i/+DcIP/c0dc/3JJWv9ySFz/aTxM/2ZCUv9kOlH/ZDdQ/2JSX/+b0tf/jbXA/3Fxb/9tm7D/qJ6e/5V+fv+dlZf/kImZ/3dSZf92Umj/cUte/3BLXf9uR1n/bEBa/1gpOf9XIDT/re7u/7b8+/+jr67/baG4/73MyP+0ycP/k4Cg/4Rnhf95V27/dlFn/3dRaP97VGv/dE9n/25IY/9nQ1r/VxQt/7Lp6f/k////oK2q/7v09v/K2dP/p6a2/4hci/+BZoH/fF1z/4NjeP+CYHn/glhv/3NNZ/9uQ17/bUFj/2xDYf9cQ1r/+////6e2tP/T5+j/ztPO/5hqmP+QW4f/hmuC/4VlgP+EboX/hWh7/3pebP9rQ1D/Yz5N/2hCVv9rSGT/mqKq//////+bl5P/anh2/8e6uP+WZpD/l2qL/3tHTf92QUX/dUBF/20zMv9vOjX/fEk+/2ExOv9mQkn/ZURO/4qfl///////nZyZ/4OYk//5+ff/5e3p/5d+gv99TVX/gVxn/4Vmd/98VF7/cklN/3FKTv9hMDX/aj5H/2BLS/+10sr//////5yfmP+Op6H/+Pn5/+Dm4/+QbXH/hVdk/4BaZf+JcYX/g3CD/31oeP9vSVH/Zzk+/2M6R/9iU1f/8P/8//////+LlI7/kLOs/+3y8f/a4N//jWZs/4RaZP+CX2v/fFli/4Nvgf96bID/dWd8/3Vkd/9oSV//rK+x///////+/v//6e7r/9bm5P/w9vT/3uzo/5F4ef+DVWP/e1pl/3lgbf98bIL/fW2D/3dmfP9yWXH/XENX/9vh4P///////v39///////r+Pf/8ff2/+Dq6P++wr//e1FZ/3hNW/95YHD/e2+E/3xtiP93bYX/a1ty/5ajpf///////v39//79/f/+/v7/4/bz/+709P/c5uP/zt/a/7TIwf+IeXr/c0lW/21ATf9rRFT/YkJT/3lrcP/y+Pb///////7+/v/+/v7//v7+/+b08//o8e//1OLf/8jZ1f+70c//rs7K/5y/uv+Qn5v/qKqp/9HV1f/+//////////7+/v/+/v7//v7+//7+/v/3+vr/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" rel=icon type=image/x-icon><style>.sf-hidden{display:none!important}</style><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
<body class=variant-bold>
<div class="navbar section" id=navbar><div class="widget Navbar" data-version=1 id=Navbar1>
<div id=navbar-iframe-container><iframe ng-non-bindable frameborder=0 hspace=0 marginheight=0 marginwidth=0 scrolling=no tabindex=0 vspace=0 width=100% id=navbar-iframe name=navbar-iframe sandbox="allow-popups allow-top-navigation allow-top-navigation-by-user-activation" srcdoc="<!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;> <html dir=ltr><meta charset=utf-8><style>:root{--sf-img-0: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAUCAMAAADFhv/OAAABiVBMVEUAAAD/q3L/q3L/q3L/q3L/q3JmZmZoaGhubm5wcHBycnJ0dHR4eHh6enqCgoKEhISGhoaIiIiKioqOjo6QkJCSkpKYmJiampqenp6lpaWmpqapqamqqqqrq6usrKytra2urq6vr6+zs7O0tLS1tbW2tra3t7e5ubm6urq7u7u+vr6/v7/BwcHDw8PHx8fJycnLy8vQ0NDR0dHT09PU1NTV1dXW1tbY2Njb29vc3Nzd3d3f39/g4ODh4eHi4uLj4+Pl5eXm5ubn5+fp6ent7e3u7u7v7+/x8fHz8/P19fX29vb39/f5+fn6+vr7+/v8/Pz9/f3/q3L/rnf/sHr/sXv/tIH/tYP/toT/toX/uIf/vI//wpn/w5r/xJv/xJ3/xZ3/xZ7/xp//x6D/yaT/0rT/07X/1bn/2L3/2b//2cD/28L/3cb/38r/5NH/5NL/5tX/6Nj/7+T/8OX/8ej/9Oz/9O3/9e7/9vD/9vH/9/L/+PT/+vb/+/j/+/n//Pv//fv//fz//v3///9gKGHcAAAABnRSTlMADHh53+GPUDoCAAABq0lEQVQYGXXBCVcSYRQG4Jftw4Bqsig/GpBq0qZstE0JRW0ZSgbFW9m+b7ZamZCWmt1f3p3J5hwPzvMAs2NWsVQeduHjESOTzfV7ELFEinZIJWKYO1cwrYFj2q4DYDu9x+jdq/JNAHHqEsdY4URtDq6jT3vASHp/leGZ6jADSeqShHW0BtE4pa8ARk8Vgg+pqwDtAkWrBd+ongAyBsPnqApAvoVP3zfWV94/pH9QGkDgsp4Esr0IXFDjAImFXxzYekABlMsuRMvRk0Au50GwqcYBEh+ZN9rtTeYlCmBYOzNAq1o8fgPoVyYDfCmzbx4gscx8n+gF808KwLW1PVpxSoXBOuDlVd45b2bTB5sAiTXmL4uLX5n5zWsSQP2MFkWt7RmgeUSJjFJ5BolVDv0hAcCbnqhNXRvS2roJ8HSlWrvep5TBJH5waJME/msO6ZMNbOM+dYBJdJif3xWPfvM6CYQaF12E+KwHEt+Y3z57+uTxqy1eJYFoJN5xaIkEopG4vcLb1u6RQDTy3fmw3Ol02p9f3iIfotEuEC1JXZKIFqcucUSLJVK0QyoR+wtEprA0cDOepAAAAABJRU5ErkJggg==&quot;);--sf-img-1: url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAAECAYAAABsgwTvAAAAPElEQVR42nXMsQ0AIAwDQe/kWbL/BqwQSIFALznSF3FxqlqdOidmu1ODJRAQQDT7xUSIGCNETA8ilsH/3xfYtbHJD+xUAAAAAElFTkSuQmCC&quot;)}body{padding:0;margin:0}#b-navbar{white-space:nowrap;color:#444;height:29px;border-bottom:1px solid #888;background:transparent;font-size:13px;font-family:Arial,Sans-serif;position:relative}#b-navbar #b-navbar-bg{position:absolute;left:0;top:0;width:100%;height:30px;background-color:#fff;opacity:.4}#b-navbar .navbar-right{text-align:right;padding-right:5px}#b-navbar-controls{margin-left:.2em;height:29px}#b-navbar #b-navbar-logo{display:block;margin-right:8px;margin-left:8px;width:20px;height:20px;background:var(--sf-img-0) no-repeat -26px 0;cursor:pointer}#b-navbar #b-query-box{background-color:#fff;margin:0 .5em 0 0;border:1px solid #aaa;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px;padding:0 .3em}#b-navbar #b-query-icon{display:block;width:13px;height:13px;cursor:pointer;background:var(--sf-img-0) no-repeat 0 0}#b-navbar #b-query-icon:hover{background:var(--sf-img-0) no-repeat -13px 0}#b-navbar #b-query{font-size:13px;color:#000;background-color:transparent;border:none;margin:0}#b-navbar .b-link{display:inline-block;font-size:13px;vertical-align:middle;padding:2px .4em}#b-navbar .b-link{color:#333;text-decoration:none;white-space:nowrap;cursor:pointer}#b-navbar .b-link:hover{color:#55e;text-decoration:underline}#b-navbar #b-more span.arrow{background:var(--sf-img-1) no-repeat -12px;display:inline-block;width:7px;height:10px}#b-navbar #b-more:hover span.arrow{background:var(--sf-img-1) no-repeat 0}.sf-hidden{display:none!important}</style><meta http-equiv=content-security-policy content=&quot;default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:;&quot;><style>img[src=&quot;data:,&quot;],source[src=&quot;data:,&quot;]{display:none!important}</style></head>
<body class=&quot;lang_zh rb&quot; marginwidth=0 marginheight=0>
<div id=b-navbar><div id=b-navbar-bg style=z-index:-1></div>
<div id=b-navbar-fg>
<table id=b-navbar-controls cellpadding=0 cellspacing=0 border=0 width=100%><tbody><tr style=height:20px><td valign=middle width=24px><a href=https://www.blogger.com/ id=b-navbar-logo tabindex=1 title=&quot;转到 Blogger.com&quot;></a>
<div id=b-sms class=&quot;b-mobile sf-hidden&quot;></div></td>
<td valign=middle width=150px><form id=searchthis action=https://blog.marcgravell.com/search style=display:inline><div id=b-query-box><table cellpadding=0 cellspacing=0><tbody><tr><td valign=middle><input type=text id=b-query name=q tabindex=3 style=width:120px title=搜索 value></td>
<td valign=middle style=width:15px><a id=b-query-icon title=搜索此博客></a></table></div>
</form></td>
<td valign=middle nowrap class=gplus><a id=b-more class=b-link tabindex=4>更多
<span class=arrow></span></a></td>
<td class=navbar-right align=right nowrap valign=middle>
<a class=b-link href=https://www.blogger.com/home#create id=b-getorpost tabindex=8>创建博客</a>
<a class=b-link href=https://www.blogger.com/ tabindex=9>登录</a></table></div></div>
"></iframe></div>
</div></div>
<div class=body-fauxcolumns>
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class=cap-top>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class=fauxborder-left>
<div class=fauxborder-right></div>
<div class=fauxcolumn-inner>
</div>
</div>
<div class=cap-bottom>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
</div>
<div class=content>
<div class=content-fauxcolumns>
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class=cap-top>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class=fauxborder-left>
<div class=fauxborder-right></div>
<div class=fauxcolumn-inner>
</div>
</div>
<div class=cap-bottom>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
</div>
<div class=content-outer>
<div class="content-cap-top cap-top">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class=content-inner>
<header>
<div class=header-outer>
<div class="header-cap-top cap-top">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id=header><div class="widget Header" data-version=1 id=Header1>
<div id=header-inner>
<div class=titlewrapper>
<h1 class=title>
<a href=https://blog.marcgravell.com/>
Code, code and more code.
</a>
</h1>
</div>
<div class=descriptionwrapper>
<p class=description><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
</header>
<div class=tabs-outer>
<div class="tabs-cap-top cap-top">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs no-items section" id=crosscol></div>
<div class="tabs no-items section" id=crosscol-overflow></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
<div class=main-outer>
<div class="main-cap-top cap-top">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class=cap-top>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class=fauxborder-left>
<div class=fauxborder-right></div>
<div class=fauxcolumn-inner>
</div>
</div>
<div class=cap-bottom>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class=cap-top>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class=fauxborder-left>
<div class=fauxborder-right></div>
<div class=fauxcolumn-inner>
</div>
</div>
<div class=cap-bottom>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class=cap-top>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class=fauxborder-left>
<div class=fauxborder-right></div>
<div class=fauxcolumn-inner>
</div>
</div>
<div class=cap-bottom>
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
<div class=columns-inner>
<div class=column-center-outer>
<div class=column-center-inner>
<div class="main section" id=main><div class="widget Blog" data-version=1 id=Blog1>
<div class="blog-posts hfeed">
 <div class=date-outer>
 
<h2 class=date-header><span>Monday, 2 July 2018</span></h2>
 <div class=date-posts>
 
<div class=post-outer>
<div class="post hentry" itemprop=blogPost itemscope itemtype=http://schema.org/BlogPosting>
<a name=292482151459961908></a>
<h3 class="post-title entry-title" itemprop=name>
Pipe Dreams, part 1
</h3>
<div class=post-header>
<div class=post-header-line-1></div>
</div>
<div class="post-body entry-content" id=post-body-292482151459961908 itemprop="description articleBody">
<h1><a href=#pipelines---a-guided-tour-of-the-new-io-api-in-net-part-1 aria-hidden=true class=anchor id=user-content-pipelines---a-guided-tour-of-the-new-io-api-in-net-part-1></a>Pipelines - a guided tour of the new IO API in .NET, part 1</h1>
<p><a href=https://blog.marcgravell.com/2018/07/pipe-dreams-part-2.html>(part 2 here)</a></p>
<p>About two years ago <a href=https://blog.marcgravell.com/2016/09/channelling-my-inner-geek.html rel=nofollow>I blogged about an upcoming experimental IO API in the .NET world</a> - at the time provisionally called "Channels"; at the end of May 2018, this finally shipped - under the name <a href=https://www.nuget.org/packages/System.IO.Pipelines/ rel=nofollow><code>System.IO.Pipelines</code></a>. I am hugely interested in the API, and over the last few weeks I'm been <em>consumed</em> with converting <code>StackExchange.Redis</code> to use "pipelines", <a href=https://github.com/StackExchange/StackExchange.Redis/issues/871 rel=nofollow>as part of our 2.0 library update</a>.</p>
<p>My hope in this series, then, is to discuss:</p>
<ul>
<li>what "pipelines" <em>are</em></li>
<li>how to use them in terms of code</li>
<li><em>when</em> you might want to use them</li>
</ul>
<p>To help put this in concrete terms, after introducing "pipelines" I intend to draw heavily on the <code>StackExchange.Redis</code> conversion - and in particular by discussing which problems it solves for us in each scenario. Spoiler: in virtually all cases, the answer can be summarized as:</p>
<blockquote>
<p>It perfectly fits a complex but common stumbling point in IO code; allowing us to replace an ugly kludge, workaround or compromise in <em>our</em> code - with a purpose-designed elegant solution that is in framework code.</p>
</blockquote>
<p>I'm pretty sure that the pain points I'm going to cover below will be familiar to anyone who works at "data protocol" levels, and I'm equally sure that the hacks and messes that we'll be replacing with pipelines will be duplicated in a lot of code-bases.</p>
<h2><a href=#what-do-pipelines-replace--complement aria-hidden=true class=anchor id=user-content-what-do-pipelines-replace--complement></a>What do pipelines replace / complement?</h2>
<p>The starting point here has to be: <em>what is the closest analogue in existing framework code?</em> And that is simple: <code>Stream</code>. The <code>Stream</code> API will be familiar to anyone who has worked with serialization or data protocols. As an aside: <code>Stream</code> is actually a very ambiguous API - it works <em>very</em> differently in different scenarios:</p>
<ul>
<li>some streams are read-only, some are write-only, some are read-write</li>
<li>the same <em>concrete type</em> can sometimes be read-only, and sometimes write-only (<code>DeflateStream</code>, for example)</li>
<li>when a stream is read-write, sometimes it works like a <a href=https://en.wikipedia.org/wiki/Compact_Cassette>cassette tape</a>, where read and write are operating on the same underlying data (<code>FileStream</code>, <code>MemoryStream</code>); and sometimes it works like two separate streams, where read and write are essentially completely separate streams (<code>NetworkStream</code>, <code>SslStream</code>) - a <em>duplex stream</em></li>
<li>in many of the duplex cases, it is hard or impossible to express "no more data will be arriving, but you should continue to read the data to the end" - there's just <code>Close()</code>, which usually kills both halves of the duplex</li>
<li>sometimes streams are seekable and support concepts like <code>Position</code> and <code>Length</code>; often they're not</li>
<li>because of the progression of APIs over time, there are often multiple ways of performing the same operation - for example, we could use <code>Read</code> (synchronous), <code>BeginRead</code>/<code>EndRead</code> (asynchronous using the <code>IAsyncResult</code> pattern), or <code>ReadAsync</code> (asynchronous using the <code>async</code>/<code>await</code> pattern); calling code has no way <em>in the general case</em> of knowing which of these is the "intended" (optimal) API</li>
<li>if you use either of the asynchronous APIs, it is often unclear what the threading model is; will it always actually be synchronous? if not, what thread will be calling me back? does it use sync-context? thread-pool? IO completion-port threads?</li>
<li>and more recently, there are also extensions to allow <code>Span&lt;byte&gt;</code> / <code>Memory&lt;byte&gt;</code> to be used in place of <code>byte[]</code> - again, the caller has no way of knowing which is the "preferred" API</li>
<li>the nature of the API <em>encourages</em> copying data; need a buffer? that's a block-copy into another chunk of memory; need a backlog of data you haven't processed yet? block-copy into another chunk of memory; etc</li>
</ul>
<p>So even before we start talking about real-world <code>Stream</code> examples and the problems that happen <em>when using it</em>, it is clear that there are a <em>lot</em> of problems in the <code>Stream</code> API <em>itself</em>. The first unsurprising news, then, is that pipelines sorts this mess out!</p>
<h2><a href=#what-are-pipelines aria-hidden=true class=anchor id=user-content-what-are-pipelines></a>What are pipelines?</h2>
<p>By "pipelines", I mean a set of 4 key APIs that between them implement decoupled and overlapped reader/writer access to a binary stream (not <code>Stream</code>), including buffer management (pooling, recycling), threading awareness, rich backlog control, and over-fill protection via back-pressure - all based around an API designed around non-contiguous memory. That's a <em>heck</em> of a word salad - but don't worry, I'll be talking about each element to explain what I mean.</p>
<h2><a href=#starting-out-simple-writing-to-and-reading-from-a-single-pipe aria-hidden=true class=anchor id=user-content-starting-out-simple-writing-to-and-reading-from-a-single-pipe></a>Starting out simple: writing to, and reading from, a single pipe</h2>
<p>Let's start with a <code>Stream</code> analogue, and write sometthing simple to a stream, and read it back - sticking to just the <code>Stream</code> API. We'll use ASCII text so we don't need to worry about any complex encoding concerns, and our read/write code shouldn't assume anything about the underlying stream. We'll just write the data, and then read to the end of the stream to consume it.</p>
<p>We'll do this with <code>Stream</code> first - familiar territory. Then we'll re-implement it with pipelines, to see where the similarities and differences lie. After that, we'll investigate what is actually happening under the hood, so we understand <em>why</em> this is interesting to us!</p>
<p>Also, before you say it: yes, I'm aware of <code>TextReader</code>/<code>TextWriter</code>; I'm not using them intentionally - because I'm trying to talk about the <code>Stream</code> API here, so that the example extends to a wide range of data protocols and scenarios.</p>
<div class="highlight highlight-source-cs"><pre><span class=pl-k>using</span> (<span class=pl-en>MemoryStream</span> <span class=pl-en>ms</span> <span class=pl-k>=</span> <span class=pl-en>new</span> <span class=pl-en>MemoryStream</span>())
{
    <span class=pl-c><span class=pl-c>//</span> write something</span>
    <span class=pl-en>WriteSomeData</span>(<span class=pl-en>ms</span>);
    <span class=pl-c><span class=pl-c>//</span> rewind - MemoryStream works like a tape</span>
    <span class=pl-smi>ms</span>.<span class=pl-smi>Position</span> <span class=pl-k>=</span> <span class=pl-c1>0</span>;
    <span class=pl-c><span class=pl-c>//</span> consume it</span>
    <span class=pl-en>ReadSomeData</span>(<span class=pl-smi>ms</span>);
}</pre></div>
<p>Now, to write to a <code>Stream</code> the caller needs to obtain and populate a buffer which they then pass to the <code>Stream</code>. We'll keep it simple for now by using the synchronous API and simply allocating a <code>byte[]</code>:</p>
<div class="highlight highlight-source-cs"><pre><span class=pl-k>void</span> <span class=pl-en>WriteSomeData</span>(<span class=pl-en>Stream</span> <span class=pl-smi>stream</span>)
{
    <span class=pl-k>byte</span>[] <span class=pl-smi>bytes</span> <span class=pl-k>=</span> <span class=pl-smi>Encoding</span>.<span class=pl-smi>ASCII</span>.<span class=pl-en>GetBytes</span>(<span class=pl-s><span class=pl-pds>"</span>hello, world!<span class=pl-pds>"</span></span>);
    <span class=pl-smi>stream</span>.<span class=pl-en>Write</span>(<span class=pl-smi>bytes</span>, <span class=pl-c1>0</span>, <span class=pl-smi>bytes</span>.<span class=pl-smi>Length</span>);
    <span class=pl-smi>stream</span>.<span class=pl-en>Flush</span>();
}
</pre></div>
<p>Note: there are <em>tons</em> of things in the above I could do for efficiency; but that isn't the point yet. So if you're familiar with this type of code and are twitching at the above... don't panic; we'll make it uglier - er, I mean <em>more efficient</em> - later.</p>
<p>The <em>reading</em> code is typically more complex than the writing code, because the reading code can't assume that it will get everything in a single call to <code>Read</code>. A read operation on a <code>Stream</code> can return nothing (which indicates the end of the data), or it could fill our buffer, or it could return a single byte despite being offered a huge buffer. So read code on a <code>Stream</code> is <em>almost always</em> a loop:</p>
<div class="highlight highlight-source-cs"><pre><span class=pl-k>void</span> <span class=pl-en>ReadSomeData</span>(<span class=pl-en>Stream</span> <span class=pl-smi>stream</span>)
{
    <span class=pl-k>int</span> <span class=pl-smi>bytesRead</span>;
    <span class=pl-c><span class=pl-c>//</span> note that the caller usually can't know much about</span>
    <span class=pl-c><span class=pl-c>//</span> the size; .Length is not usually usable</span>
    <span class=pl-k>byte</span>[] <span class=pl-smi>buffer</span> <span class=pl-k>=</span> <span class=pl-k>new</span> <span class=pl-k>byte</span>[<span class=pl-c1>256</span>];
    <span class=pl-k>do</span>
    {
        <span class=pl-smi>bytesRead</span> <span class=pl-k>=</span> <span class=pl-smi>stream</span>.<span class=pl-en>Read</span>(<span class=pl-smi>buffer</span>, <span class=pl-c1>0</span>, <span class=pl-smi>buffer</span>.<span class=pl-smi>Length</span>);
        <span class=pl-k>if</span> (<span class=pl-smi>bytesRead</span> <span class=pl-k>&gt;</span> <span class=pl-c1>0</span>)
        {   <span class=pl-c><span class=pl-c>//</span> note this only works for single-byte encodings</span>
            <span class=pl-k>string</span> <span class=pl-smi>s</span> <span class=pl-k>=</span> <span class=pl-smi>Encoding</span>.<span class=pl-smi>ASCII</span>.<span class=pl-en>GetString</span>(
                <span class=pl-smi>buffer</span>, <span class=pl-c1>0</span>, <span class=pl-smi>bytesRead</span>);
            <span class=pl-smi>Console</span>.<span class=pl-en>Write</span>(<span class=pl-smi>s</span>);
        }
    } <span class=pl-k>while</span> (<span class=pl-smi>bytesRead</span> <span class=pl-k>&gt;</span> <span class=pl-c1>0</span>);
}</pre></div>
<p>Now let's translate that to pipelines. A <code>Pipe</code> is broadly comparable to a <code>MemoryStream</code>, except instead of being able to rewind it many times, the data is more simply a "first in first out" queue. We have a <em>writer</em> API that can push data in at one end, and a <em>reader</em> API that can pull the data out at the other. The <code>Pipe</code> is the buffer that sits between the two. Let's reproduce our previous scenario, but using a single <code>Pipe</code> instead of the <code>MemoryStream</code> (again not something we'd usually do in practice, but it is simple to illustrate):</p>
<div class="highlight highlight-source-cs"><pre><span class=pl-en>Pipe</span> <span class=pl-smi>pipe</span> <span class=pl-k>=</span> <span class=pl-k>new</span> <span class=pl-en>Pipe</span>();
<span class=pl-c><span class=pl-c>//</span> write something</span>
<span class=pl-en>await</span> <span class=pl-en>WriteSomeDataAsync</span>(pipe.Writer);
<span class=pl-c><span class=pl-c>//</span> signal that there won't be anything else written</span>
<span class=pl-smi>pipe</span>.<span class=pl-smi>Writer</span>.<span class=pl-en>Complete</span>();
<span class=pl-c><span class=pl-c>//</span> consume it</span>
<span class=pl-en>await</span> <span class=pl-en>ReadSomeDataAsync</span>(pipe.Reader);</pre></div>
<p>First we create a pipe using the default options, then we write to it. Note that IO operations on pipes are usually asynchronous, so we'll need to <code>await</code> our two helper methods. Note also that we don't pass the <code>Pipe</code> to them - unlike <code>Stream</code>, pipelines have separate API surfaces for read and write operations, so we pass a <code>PipeWriter</code> to the helper method that does our writing, and a <code>PipeReader</code> to the helper method that does our reading. After writing the data, we call <code>Complete()</code> on the <code>PipeWriter</code>. We didn't have to do this with the <code>MemoryStream</code> because it automatically <a href=https://en.wikipedia.org/wiki/End-of-file rel=nofollow>EOFs</a> when it reaches the end of the buffered data - but on some other <code>Stream</code> implementations - especially one-way streams - we might have had to call <code>Close</code> after writing the data.</p>
<p>OK, so what does <code>WriteSomeDataAsync</code> look like? Note, I've deliberately over-annotated here:</p>
<div class="highlight highlight-source-cs"><pre><span class=pl-k>async</span> <span class=pl-en>ValueTask</span> <span class=pl-en>WriteSomeDataAsync</span>(<span class=pl-en>PipeWriter</span> <span class=pl-smi>writer</span>)
{
    <span class=pl-c><span class=pl-c>//</span> use an oversized size guess</span>
    <span class=pl-en>Memory</span>&lt;<span class=pl-k>byte</span>&gt; <span class=pl-smi>workspace</span> <span class=pl-k>=</span> <span class=pl-smi>writer</span>.<span class=pl-en>GetMemory</span>(<span class=pl-c1>20</span>);
    <span class=pl-c><span class=pl-c>//</span> write the data to the workspace</span>
    <span class=pl-k>int</span> <span class=pl-smi>bytes</span> <span class=pl-k>=</span> <span class=pl-smi>Encoding</span>.<span class=pl-smi>ASCII</span>.<span class=pl-en>GetBytes</span>(
        <span class=pl-s><span class=pl-pds>"</span>hello, world!<span class=pl-pds>"</span></span>, <span class=pl-smi>workspace</span>.<span class=pl-smi>Span</span>);
    <span class=pl-c><span class=pl-c>//</span> tell the pipe how much of the workspace</span>
    <span class=pl-c><span class=pl-c>//</span> we actually want to commit</span>
    <span class=pl-smi>writer</span>.<span class=pl-en>Advance</span>(<span class=pl-smi>bytes</span>);
    <span class=pl-c><span class=pl-c>//</span> this is **not** the same as Stream.Flush!</span>
    <span class=pl-k>await</span> <span class=pl-smi>writer</span>.<span class=pl-en>FlushAsync</span>();
}</pre></div>
<p>The first thing to note is that when dealing with pipelines: <em>you don't control the buffers</em>: the <code>Pipe</code> does. Recall how in our <code>Stream</code> code, both the read and write code created a local <code>byte[]</code>, but we don't have that here. Instead, we ask the <code>Pipe</code> for a buffer (<code>workspace</code>), via the <code>GetMemory</code> method (or it's twin - <code>GetSpan</code>). As you might expect from the name, this gives us either a <code>Memory&lt;byte&gt;</code> or a <code>Span&lt;byte&gt;</code> - of size <em>at least</em> twenty bytes.</p>
<p>Having obtained this buffer, we encode our <code>string</code> into it. This means that we're writing directly into the pipe's memory, and keep track of how many bytes we <em>actually used</em>, so we can tell it in <code>Advance</code>. We are under no obligation to use the twenty that we asked for: we could write zero, one, twenty, or even fifty bytes. The last one may seem surprising, but it is actually actively encouraged! The emphasis previously was on "<em>at least</em>" - the writer can actually give us a <em>much bigger</em> buffer than we ask for. When dealing with larger data, it is common to make modest requests but expect greatness: ask for the <em>minumum we can usefully utilize</em>, but then check the size of the memory/span that it gives us before deciding how much to actually write.</p>
<p>The call to <code>Advance</code> is important; this completes a single write operation, making the data available in the pipe to be consumed by a reader. The call to <code>FlushAsync</code> is <em>equally important</em>, but much more nuanced. However, before we can adequately describe what it does, we need to take a look at the reader. So; here's our <code>ReadSomeDataAsync</code> method:</p>
<div class="highlight highlight-source-cs"><pre><span class=pl-k>async</span> <span class=pl-en>ValueTask</span> <span class=pl-en>ReadSomeDataAsync</span>(<span class=pl-en>PipeReader</span> <span class=pl-smi>reader</span>)
{
    <span class=pl-k>while</span> (<span class=pl-c1>true</span>)
    {
        <span class=pl-c><span class=pl-c>//</span> await some data being available</span>
        <span class=pl-en>ReadResult</span> <span class=pl-smi>read</span> <span class=pl-k>=</span> <span class=pl-k>await</span> <span class=pl-smi>reader</span>.<span class=pl-en>ReadAsync</span>();
        <span class=pl-en>ReadOnlySequence</span>&lt;<span class=pl-k>byte</span>&gt; <span class=pl-smi>buffer</span> <span class=pl-k>=</span> <span class=pl-smi>read</span>.<span class=pl-smi>Buffer</span>;
        <span class=pl-c><span class=pl-c>//</span> check whether we've reached the end</span>
        <span class=pl-c><span class=pl-c>//</span> and processed everything</span>
        <span class=pl-k>if</span> (<span class=pl-smi>buffer</span>.<span class=pl-smi>IsEmpty</span> <span class=pl-k>&amp;&amp;</span> <span class=pl-smi>read</span>.<span class=pl-smi>IsCompleted</span>)
            <span class=pl-k>break</span>; <span class=pl-c><span class=pl-c>//</span> exit loop</span>

        <span class=pl-c><span class=pl-c>//</span> process what we received</span>
        <span class=pl-k>foreach</span> (<span class=pl-en>Memory</span>&lt;<span class=pl-k>byte</span>&gt; <span class=pl-smi>segment</span> <span class=pl-k>in</span> <span class=pl-smi>buffer</span>)
        {
            <span class=pl-k>string</span> <span class=pl-smi>s</span> <span class=pl-k>=</span> <span class=pl-smi>Encoding</span>.<span class=pl-smi>ASCII</span>.<span class=pl-en>GetString</span>(
                <span class=pl-smi>segment</span>.<span class=pl-smi>Span</span>);
            <span class=pl-smi>Console</span>.<span class=pl-en>Write</span>(<span class=pl-smi>s</span>);
        }
        <span class=pl-c><span class=pl-c>//</span> tell the pipe that we used everything</span>
        <span class=pl-smi>reader</span>.<span class=pl-en>AdvanceTo</span>(<span class=pl-smi>buffer</span>.<span class=pl-smi>End</span>);
    }
}</pre></div>
<p>Just like with the <code>Stream</code> example, we have a loop that continues until we've reached the end of the data. With <code>Stream</code>, that is defined as being when <code>Read</code> returns a non-positive result, but with pipelines there are two things to check:</p>
<ul>
<li><code>read.IsCompleted</code> tells us whether the write pipe has been signalled as completed and therefore no more data will be written (<code>pipe.Writer.Complete();</code> in our earlier code did this)</li>
<li><code>buffer.IsEmpty</code> tells us whether there is any data left to proces <em>in this iteration</em></li>
</ul>
<p>If there's nothing in the pipe now <em>and</em> the writer has been completed, then there will <strong>never</strong> be anything in the pipe, and we can exit.</p>
<p>If we <em>do</em> have data, then we can look at <code>buffer</code>. So first - let's talk about <code>buffer</code>; in the code it is a <code>ReadOnlySequence&lt;byte&gt;</code>, which is a new type - this concept combines a few roles:</p>
<ul>
<li>describing non-contiguous memory, speficially a sequence of zero, one or many <code>ReadOnlyMemory&lt;byte&gt;</code> chunks</li>
<li>describing a logical position (<code>SequencePosition</code>) in such a data-stream - in particular via <code>buffer.Start</code> and <code>buffer.End</code></li>
</ul>
<p>The <em>non-contiguous</em> is very important here. We'll look at where the data is actually going shortly, but in terms of reading: we need to be prepared to handle data that <em>could</em> be spread accross multiple segments. In this case, we do this by a simple <code>foreach</code> over the <code>buffer</code>, decoding each segment in turn. Note that even though the API is designed to be able to describe multiple non-contiguous buffers, it is frequently the case that the data received is contiguous in a single buffer; and in that case, it is often possible to write an optimized implementation for a single buffer. You can do that by checking <code>buffer.IsSingleSegment</code> and accessing <code>buffer.First</code>.</p>
<p>Finally, we call <code>AdvanceTo</code>, which tells the pipe <em>how much data we actually used</em>.</p>
<h1><a href=#key-point-you-dont-need-to-take-everything-you-are-given aria-hidden=true class=anchor id=user-content-key-point-you-dont-need-to-take-everything-you-are-given></a>Key point: <em>you don't need to take everything you are given!</em></h1>
<p>Contrast to <code>Stream</code>: when you call <code>Read</code> on a <code>Stream</code>, it puts data into the buffer you gave it. In most real-world scenarios, it isn't always possible to consume all the data yet - maybe it only makes sense to consider "commands" as "entire text lines", and you haven't yet seen a <code>cr</code>/<code>lf</code> in the data. With <code>Stream</code>: this is tough - once you've been given the data, it is your problem; if you can't use it yet, you need to store the backlog somewhere. However, with pipelines, <em>you can tell it</em> what you've consumed. In our case, we're telling it that we consumed everything we were given, which we do by passing <code>buffer.End</code> to <code>AdvanceTo</code>. That means we'll never see that data again, just like with <code>Stream</code>. However, we could also have passed <code>buffer.Start</code>, which would mean "we didn't use anything" - and <em>even though we had chance to inspect the data</em>, it would remain in the pipe for subsequent reads. We can also get arbitrary <code>SequencePosition</code> values inside the buffer - if we read 20 bytes, for example - so we have full control over how much data is dropped from the pipe. There are two ways of getting a <code>SequencePosition</code>:</p>
<ul>
<li>you can <code>Slice(...)</code> a <code>ReadOnlySequence&lt;byte&gt;</code> in the same way that you <code>Slice(...)</code> a <code>Span&lt;T&gt;</code> or <code>Memory&lt;T&gt;</code> - and access the <code>.Start</code> or <code>.End</code> of the resulting sub-range</li>
<li>you can use the <code>.GetPosition(...)</code> method of the <code>ReadOnlySequence&lt;byte&gt;</code>, which returns a relative position <em>without</em> actually slicing</li>
</ul>
<p>Even more subtle: we can tell it separetely that we <em>consumed</em> some amount, but that we <em>inspected</em> a different amount. The most common example here is to express "you can drop <em>this much</em> - I'm done with that; but I looked at everything, I can't make any more progress at the moment - I need more data" - specifically:</p>
<div class="highlight highlight-source-cs"><pre><span class=pl-smi>reader</span>.<span class=pl-en>AdvanceTo</span>(<span class=pl-smi>consumedToPosition</span>, <span class=pl-smi>buffer</span>.<span class=pl-smi>End</span>);</pre></div>
<p>This is where the subtle interplay of <code>PipeWriter.FlushAsync()</code> and <code>PipeReader.ReadAsync()</code> starts to come into play. I skipped over <code>FlushAsync</code> earlier, but it actually serves two different functions in one call:</p>
<ul>
<li>if there is a <code>ReadAsync</code> call that is outstanding because it needs data, then it <em>awakens</em> the reader, allowing the read loop to continue</li>
<li>if the writer is out-pacing the reader, such that the pipe is filling up with data that isn't being cleared by the reader, it can <em>suspend</em> the writer (by not completing synchronously) - to be reactivated when there is more space in the pipe (the thresholds for writer suspend/resume can be optionally specified when creating the <code>Pipe</code> instance)</li>
</ul>
<p>Obviously these concepts don't come into play in our example, but they are central ideas to how pipelines works. The ability to push data back into the pipe <em>hugely</em> simplifies a vast range of IO scenarios. Virtually every piece of protocol handling code I've seen before pipelines has <em>masses</em> of code related to handling the backlog of incomplete data - it is such a repeated piece of logic that I am <em>incredibly</em> happy to see it handled well in a framework library instead.</p>
<h2><a href=#what-does-awaken-or-reactivate-mean-here aria-hidden=true class=anchor id=user-content-what-does-awaken-or-reactivate-mean-here></a>What does "awaken" or "reactivate" mean here?</h2>
<p>You might have observed that I didn't really define what I meant here. At the <em>obvious</em> level, I mean that: an <code>await</code> operation of <code>ReadAsync</code> or <code>FlushAsync</code> had previously returned as incomplete, so now the asynchronous continuation gets invoked, allowing our <code>async</code> method to resume execution. Yeah, OK, but that's just re-stating what <code>async</code>/<code>await</code> <em>mean</em>. It is bug-bear of mine that I care <em>deeply</em> (really, it is alarming how deep) about which threads code runs on - for reasons that I'll talk about later in this series. So saying "the asynchronous continuation gets invoked" <em>isn't enough for me</em>. I want to understand <em>who is invoking it</em>, in terms of threads. The most common answers to this are:</p>
<ul>
<li>it delegates via the <code>SynchronizationContext</code> (note: many systems <em>do not have</em> a <code>SynchronizationContext</code>)</li>
<li>the thread that <em>triggered the state change</em> gets used, at the point of the state change, to invoke the continuation</li>
<li>the global thread-pool is used to invoke the continuation</li>
</ul>
<p>All of these can be fine in some cases, and all of these can be terrible in some cases! Sync-context is a well-established mechanism for getting from worker threads back to primary application threads (epecially: the UI thread in desktop applications). However, it isn't necessarily the case that just because we've finished one IO operation, we're ready to jump back to an application thread; and doing so can effectively push a lot of IO code and data processing code <em>onto</em> an application thread - usually the one thing we explicitly want to avoid. Additionally, it can be prone to deadlocks if the application code has used <code>Wait()</code> or <code>.Result</code> on an asynchronous call (which, to be fair, you're not meant to do). The second option (performing the callback "inline" on the thread that triggered it) can be problematic because it can steal a thread that you expected to be doing something else (and can lead to deadlocks as a consequence); and in some extreme cases it can lead to a stack-dive (and eventually a stack-overflow) when two asynchronous methods are essentially functioning as co-routines. The final option (global thread-pool) is immune to the problems of the other two - but can run into severe problems under some load conditions - something again that I'll discuss in a later part in this series.</p>
<p>However, the good news is that <em>pipelines gives you control here</em>. When creating the <code>Pipe</code> instance, we can supply <code>PipeScheduler</code> instances to use for the reader and writer (separately). The <code>PipeScheduler</code> is used to perform these activations. If not specified, then it defaults <em>first</em> to checking for <code>SynchronizationContext</code>, then using the global thread-pool, with "inline" continuations (i.e. intionally using the thread that caused the state change) as another option readily available. But: <em>you can provide your own implementation</em> of a <code>PipeScheduler</code>, giving you full control of the threading model.</p>
<h2><a href=#summary aria-hidden=true class=anchor id=user-content-summary></a>Summary</h2>
<p>So: we've looked at what a <code>Pipe</code> is when considered individually, and how we can write to a pipe with a <code>PipeWriter</code>, and read from a pipe with a <code>PipeReader</code> - and how to "advance" both reader and writer. We've looked at the similarity and differences with <code>Stream</code>, and we've discussed how <code>ReadAsync()</code> and <code>FlushAsync()</code> can interact to control how the writer and reader pieces execute. We looked at how responsibility for buffers is reversed, with the pipe providing all buffers - and how the pipe can simplify backlog management. Finally, we discussed the threading model that is active for continuations in the <code>await</code> operations.</p>
<p>That's probably enough for step 1; next, we'll look at how the <em>memory model</em> for pipelines works - i.e. where does the data live. We'll also look at <em>how we can use pipelines in real scenarios</em> to start doing interesting things.</p>
<div style=clear:both></div>
</div>
<div class=post-footer>
<div class="post-footer-line post-footer-line-1"><span class="post-author vcard">
Posted by
<span class=fn itemprop=author itemscope itemtype=http://schema.org/Person>
<a class=g-profile href=https://www.blogger.com/profile/01023334706549710089 rel=author title="author profile">
<span itemprop=name>Marc Gravell</span>
</a>
</span>
</span>
<span class=post-timestamp>
at
<a class=timestamp-link href=https://blog.marcgravell.com/2018/07/pipe-dreams-part-1.html rel=bookmark title="permanent link"><abbr class=published itemprop=datePublished title=2018-07-02T08:27:00-07:00>08:27</abbr></a>
</span>
<span class=post-comment-link>
</span>
<span class=post-icons>
<span class="item-control blog-admin pid-1042145909 sf-hidden">
</span>
</span>
<span class="post-backlinks post-comment-link">
</span>
</div>
<div class="post-footer-line post-footer-line-2"><span class=post-labels>
Labels:
<a href=https://blog.marcgravell.com/search/label/pipelines rel=tag>pipelines</a>
</span>
</div>
<div class="post-footer-line post-footer-line-3"></div>
</div>
</div>
<div class=comments id=comments>
<a name=comments></a>
</div>
</div>
<div class="inline-ad sf-hidden">
</div>
 </div></div>
 
</div>
<div class=blog-pager id=blog-pager>
<span id=blog-pager-newer-link>
<a class=blog-pager-newer-link href=https://blog.marcgravell.com/2018/07/pipe-dreams-part-2.html id=Blog1_blog-pager-newer-link title="Newer Post">Newer Post</a>
</span>
<span id=blog-pager-older-link>
<a class=blog-pager-older-link href=https://blog.marcgravell.com/2018/04/having-serious-conversation-about-open.html id=Blog1_blog-pager-older-link title="Older Post">Older Post</a>
</span>
<a class=home-link href=https://blog.marcgravell.com/>Home</a>
</div>
<div class=clear></div>
<div class=post-feeds>
</div>
</div></div>
</div>
</div>
<div class=column-left-outer>
<div class=column-left-inner>
<aside>
</aside>
</div>
</div>
<div class=column-right-outer>
<div class=column-right-inner>
<aside>
<div class="sidebar section" id=sidebar-right-1><div class="widget AdSense sf-hidden" data-version=1 id=AdSense1>
<div class="widget-content sf-hidden">
</div>
</div><div class="widget Image" data-version=1 id=Image2>
<h2>Stack Overflow</h2>
<div class=widget-content>
<a href=https://stackoverflow.com/users/23354/marc-gravell>
<img alt="Stack Overflow" height=58 id=Image2_img src="data:image/png;base64,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" width=208>
</a>
<br>
</div>
<div class=clear></div>
</div><div class="widget Text" data-version=1 id=Text1>
<div class=widget-content>
@marcgravell
</div>
<div class=clear></div>
</div><div class="widget Subscribe" data-version=1 id=Subscribe1>
<div style=white-space:nowrap>
<h2 class=title>Subscribe</h2>
<div class=widget-content>
<div class="subscribe-wrapper subscribe-type-POST">
<div class="subscribe expanded subscribe-type-POST" id=SW_READER_LIST_Subscribe1POST style=display:none>
</div>
<div class=subscribe id=SW_READER_LIST_CLOSED_Subscribe1POST>
<div class=top>
<span class=inner>
<img class=subscribe-dropdown-arrow src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="13" height="10"><rect fill-opacity="0"/></svg>' style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-7)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important">
<span>
<img align=absmiddle alt border=0 class=feed-icon src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12"><rect fill-opacity="0"/></svg>' style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-8)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important">
Posts
</span>
</span>
</div>
<div class=bottom></div>
</div>
</div>
<div class="subscribe-wrapper subscribe-type-PER_POST">
<div class="subscribe expanded subscribe-type-PER_POST" id=SW_READER_LIST_Subscribe1PER_POST style=display:none>
</div>
<div class=subscribe id=SW_READER_LIST_CLOSED_Subscribe1PER_POST>
<div class=top>
<span class=inner>
<img class=subscribe-dropdown-arrow src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="13" height="10"><rect fill-opacity="0"/></svg>' style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-7)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important">
<span>
<img align=absmiddle alt border=0 class=feed-icon src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12"><rect fill-opacity="0"/></svg>' style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-8)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important">
Comments
</span>
</span>
</div>
<div class=bottom></div>
</div>
</div>
<div style=clear:both></div>
</div>
</div>
<div class=clear></div>
</div><div class="widget BlogArchive" data-version=1 id=BlogArchive1>
<h2>Blog Archive</h2>
<div class=widget-content>
<div id=ArchiveList>
<div id=BlogArchive1_ArchiveList>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2022/>
2022
</a>
<span class=post-count dir=ltr>(2)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2021/>
2021
</a>
<span class=post-count dir=ltr>(1)</span>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2020/>
2020
</a>
<span class=post-count dir=ltr>(4)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2019/>
2019
</a>
<span class=post-count dir=ltr>(2)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate expanded">
<a class=toggle>
<span class="zippy toggle-open">
 ▼&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2018/>
2018
</a>
<span class=post-count dir=ltr>(11)</span>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2018/12/>
December
</a>
<span class=post-count dir=ltr>(1)</span>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2018/09/>
September
</a>
<span class=post-count dir=ltr>(1)</span>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2018/08/>
August
</a>
<span class=post-count dir=ltr>(1)</span>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate expanded">
<a class=toggle>
<span class="zippy toggle-open">
 ▼&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2018/07/>
July
</a>
<span class=post-count dir=ltr>(4)</span>
<ul class=posts>
<li><a href=https://blog.marcgravell.com/2018/07/pipe-dreams-part-31.html>Pipe Dreams, part 3.1</a></li>
<li><a href=https://blog.marcgravell.com/2018/07/pipe-dreams-part-3.html>Pipe Dreams, part 3</a></li>
<li><a href=https://blog.marcgravell.com/2018/07/pipe-dreams-part-2.html>Pipe Dreams, part 2</a></li>
<li><a href=https://blog.marcgravell.com/2018/07/pipe-dreams-part-1.html>Pipe Dreams, part 1</a></li>
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2018/04/>
April
</a>
<span class=post-count dir=ltr>(1)</span>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2018/01/>
January
</a>
<span class=post-count dir=ltr>(3)</span>
</li>
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2017/>
2017
</a>
<span class=post-count dir=ltr>(7)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2016/>
2016
</a>
<span class=post-count dir=ltr>(5)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2015/>
2015
</a>
<span class=post-count dir=ltr>(4)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2014/>
2014
</a>
<span class=post-count dir=ltr>(16)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2013/>
2013
</a>
<span class=post-count dir=ltr>(4)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2012/>
2012
</a>
<span class=post-count dir=ltr>(9)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2011/>
2011
</a>
<span class=post-count dir=ltr>(14)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2010/>
2010
</a>
<span class=post-count dir=ltr>(24)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2009/>
2009
</a>
<span class=post-count dir=ltr>(57)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
<ul class=hierarchy>
<li class="archivedate collapsed">
<a class=toggle>
<span class=zippy>
 ►&nbsp;
 
</span>
</a>
<a class=post-count-link href=https://blog.marcgravell.com/2008/>
2008
</a>
<span class=post-count dir=ltr>(16)</span>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
<ul class="hierarchy sf-hidden">
</ul>
</li>
</ul>
</div>
</div>
<div class=clear></div>
</div>
</div></div>
<table border=0 cellpadding=0 cellspacing=0 class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="sidebar section" id=sidebar-right-2-1><div class="widget Profile" data-version=1 id=Profile1>
<h2>About Me</h2>
<div class=widget-content>
<a href=https://www.blogger.com/profile/01023334706549710089><img alt="My photo" class=profile-img height=80 src="data:image/jpeg;base64,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" width=80></a>
<dl class=profile-datablock>
<dt class=profile-data>
<a class="profile-name-link g-profile" href=https://www.blogger.com/profile/01023334706549710089 rel=author style=background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA3klEQVQ4y2P4l8YUCsT/ycT6DBRoBmNMA5IZ/v+LB+IYKI5lgIgRZUACUOH2jv//3j/5/+//fwj+8/P/vyNz/v8rliRgQDJUM0jTv39oGCh2ceP/f0kMeAwAORtkM0gDyJBzqyEYZiCILpXCYwDIvzDF1/YAFUtCMIgNM2BVyf9/hWJEGPD3LyIMQGx0sRgGEgxAN4goA2BeqJCDYHSvYDUAWyCCQh6EkQPz08v//+IYSI3GfwiD58cTSEggBSBb0MMAJAaSS2AgkJRBOA4pKcNwHAOReYGMzKRPgQEGAIvy2M2lOZIeAAAAAElFTkSuQmCC)>
Marc Gravell
</a>
</dt>
</dl>
<a class=profile-link href=https://www.blogger.com/profile/01023334706549710089 rel=author>View my complete profile</a>
<div class=clear></div>
</div>
</div></div>
</td>
<td class=columns-cell>
<div class="sidebar no-items section" id=sidebar-right-2-2></div>
</td>
</tr>
</tbody>
</table>
<div class="sidebar section" id=sidebar-right-3><div class="widget Label" data-version=1 id=Label1>
<h2>Labels</h2>
<div class="widget-content list-label-widget-content">
<ul>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/c%23>c#</a>
<span dir=ltr>(48)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/protobuf-net>protobuf-net</a>
<span dir=ltr>(30)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/.net>.net</a>
<span dir=ltr>(17)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/4.0>4.0</a>
<span dir=ltr>(17)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/serialization>serialization</a>
<span dir=ltr>(15)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/linq>linq</a>
<span dir=ltr>(12)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/expression>expression</a>
<span dir=ltr>(10)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/me>me</a>
<span dir=ltr>(10)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/community>community</a>
<span dir=ltr>(8)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/redis>redis</a>
<span dir=ltr>(7)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/reflection>reflection</a>
<span dir=ltr>(6)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/cf>cf</a>
<span dir=ltr>(5)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/ide>ide</a>
<span dir=ltr>(5)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/metaprogramming>metaprogramming</a>
<span dir=ltr>(5)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/pipelines>pipelines</a>
<span dir=ltr>(5)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/dynamic>dynamic</a>
<span dir=ltr>(3)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/generics>generics</a>
<span dir=ltr>(3)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/mvc>mvc</a>
<span dir=ltr>(3)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/5.0>5.0</a>
<span dir=ltr>(2)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/asp.net>asp.net</a>
<span dir=ltr>(2)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/async>async</a>
<span dir=ltr>(2)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/disposable>disposable</a>
<span dir=ltr>(2)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/phone-7>phone-7</a>
<span dir=ltr>(2)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/stackexchange>stackexchange</a>
<span dir=ltr>(2)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/stackoverflow>stackoverflow</a>
<span dir=ltr>(2)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/surface>surface</a>
<span dir=ltr>(2)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/autism>autism</a>
<span dir=ltr>(1)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/c%23%20.net%205.0%20async%20redis>c# .net 5.0 async redis</a>
<span dir=ltr>(1)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/c%23%20linq>c# linq</a>
<span dir=ltr>(1)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/c%23%20profiling>c# profiling</a>
<span dir=ltr>(1)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/ikvm>ikvm</a>
<span dir=ltr>(1)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/immutability>immutability</a>
<span dir=ltr>(1)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/linq%20expression%20c%23>linq expression c#</a>
<span dir=ltr>(1)</span>
</li>
<li>
<a dir=ltr href=https://blog.marcgravell.com/search/label/tpl>tpl</a>
<span dir=ltr>(1)</span>
</li>
</ul>
<div class=clear></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style=clear:both></div>
</div>
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
<footer>
<div class=footer-outer>
<div class="footer-cap-top cap-top">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot no-items section" id=footer-1></div>
<table border=0 cellpadding=0 cellspacing=0 class="section-columns columns-2">
<tbody>
<tr>
<td class="first columns-cell">
<div class="foot no-items section" id=footer-2-1></div>
</td>
<td class=columns-cell>
<div class="foot no-items section" id=footer-2-2></div>
</td>
</tr>
</tbody>
</table>
<div class="foot section" id=footer-3><div class="widget Attribution" data-version=1 id=Attribution1>
<div class=widget-content style=text-align:center>
Simple theme. Powered by <a href=https://www.blogger.com/ target=_blank>Blogger</a>.
</div>
<div class=clear></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
</footer>
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class=cap-left></div>
<div class=cap-right></div>
</div>
</div>
</div>
