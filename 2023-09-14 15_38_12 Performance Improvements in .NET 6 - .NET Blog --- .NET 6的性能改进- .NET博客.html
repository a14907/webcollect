<!DOCTYPE html> <html lang=en-US theme=light class=js style><!--
 Page saved with SingleFile 
 url: https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/ 
 saved date: Thu Sep 14 2023 15:38:12 GMT+0800 (中国标准时间)
--><meta charset=utf-8>
<meta name=awa-ver content=light>
<meta http-equiv=X-UA-Compatible content="IE=edge">
<meta name=awa-pageType content=post>
<meta name=awa-product content=".NET Blog">
<meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name=mobile-web-app-capable content=yes>
<meta name=color-scheme content="dark light">
<meta name=apple-mobile-web-app-capable content=yes>
<meta name=apple-mobile-web-app-title content=".NET Blog - Free. Cross-platform. Open source. A developer platform for building all your apps.">
<link rel=profile href=http://gmpg.org/xfn/11>
<link rel=pingback href=https://devblogs.microsoft.com/dotnet/xmlrpc.php>
<meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<title>Performance Improvements in .NET 6 - .NET Blog --- .NET 6的性能改进- .NET博客</title>
<meta name=description content="Take a rip-roarin' tour through hundreds of PRs worth of performance improvements for .NET 6.">
<link rel=canonical href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/>
<meta property=og:locale content=en_US>
<meta property=og:type content=article>
<meta property=og:title content="Performance Improvements in .NET 6 - .NET Blog">
<meta property=og:description content="Take a rip-roarin' tour through hundreds of PRs worth of performance improvements for .NET 6.">
<meta property=og:url content=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/>
<meta property=og:site_name content=".NET Blog">
<meta property=article:published_time content=2021-08-17T15:15:42+00:00>
<meta property=article:modified_time content=2021-09-17T01:09:18+00:00>
<meta property=og:image content=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2019/02/swimlane-cross-platform.png>
<meta property=og:image:width content=636>
<meta property=og:image:height content=300>
<meta property=og:image:type content=image/png>
<meta name=author content="Stephen Toub - MSFT">
<meta name=twitter:card content=summary_large_image>
<script type=application/ld+json class=yoast-schema-graph>{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/","url":"https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/","name":"Performance Improvements in .NET 6 - .NET Blog","isPartOf":{"@id":"https://devblogs.microsoft.com/dotnet/#website"},"primaryImageOfPage":{"@id":"https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#primaryimage"},"image":{"@id":"https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#primaryimage"},"thumbnailUrl":"https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2023/07/230663244-b12e77a9-ffbc-40e9-b360-58a3fb3b4c9d-Copy-2-Copy.png","datePublished":"2021-08-17T15:15:42+00:00","dateModified":"2021-09-17T01:09:18+00:00","author":{"@id":"https://devblogs.microsoft.com/dotnet/#/schema/person/07639e75647242d5dd1f9b9cf6b6abb1"},"description":"Take a rip-roarin' tour through hundreds of PRs worth of performance improvements for .NET 6.","breadcrumb":{"@id":"https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#primaryimage","url":"https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2023/07/230663244-b12e77a9-ffbc-40e9-b360-58a3fb3b4c9d-Copy-2-Copy.png","contentUrl":"https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2023/07/230663244-b12e77a9-ffbc-40e9-b360-58a3fb3b4c9d-Copy-2-Copy.png","width":1205,"height":522,"caption":"Image 230663244 b12e77a9 ffbc 40e9 b360 58a3fb3b4c9d 8211 Copy 2 8211 Copy"},{"@type":"BreadcrumbList","@id":"https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://devblogs.microsoft.com/dotnet/"},{"@type":"ListItem","position":2,"name":"Performance Improvements in .NET 6"}]},{"@type":"WebSite","@id":"https://devblogs.microsoft.com/dotnet/#website","url":"https://devblogs.microsoft.com/dotnet/","name":".NET Blog","description":"Free. Cross-platform. Open source. A developer platform for building all your apps.","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://devblogs.microsoft.com/dotnet/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"Person","@id":"https://devblogs.microsoft.com/dotnet/#/schema/person/07639e75647242d5dd1f9b9cf6b6abb1","name":"Stephen Toub - MSFT","image":{"@type":"ImageObject","inLanguage":"en-US","@id":"https://devblogs.microsoft.com/dotnet/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=96&d=mm&r=g","caption":"Stephen Toub - MSFT"},"description":"Stephen Toub is a developer on the .NET team at Microsoft.","url":"https://devblogs.microsoft.com/dotnet/author/toub/"}]}</script>
<link rel=alternate type=application/rss+xml title=".NET Blog » Feed" href=https://devblogs.microsoft.com/dotnet/feed/>
<link rel=alternate type=application/rss+xml title=".NET Blog » Comments Feed" href=https://devblogs.microsoft.com/dotnet/comments/feed/>
<link rel=alternate type=application/rss+xml title=".NET Blog » Performance Improvements in .NET 6 Comments Feed" href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/feed/>
<style>:root{--sf-img-40: url("data:image/jpeg;base64,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");--sf-img-41: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA1CAYAAAAK0RhzAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOdJREFUeNrs2M0JAjEQhuHxp4AFG9iLngUbWAXBqx2kEv8q2Q68CoKmAWHPekkDQhoQTHBX0sAghncgJOxhP54w5DAimVavO/j1uApbpZhli+PDbs6LMpyNYo47LC/1MPkQUVvli7Rhlco5MaPu59qKwIABAwYMGDBgwIABAwYMGDBgwP6o0vGbVc7q/u/C2ivmOMm5vpPgWX0v5TPMVLvJm5m412lUhPNUMccPVs8mbUUjuhPa2H67FnVVbvk5ryIwYMCAAQMGDBgwYMCAAQMGDBiw31c6fnOiOw127e6VcxrJud4CDAB/iiR6b7OBZgAAAABJRU5ErkJggg==");--sf-img-49: url("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4QAqRXhpZgAASUkqAAgAAAABADEBAgAHAAAAGgAAAAAAAABHb29nbGUAAP/bAEMABgQEBQQEBgUFBQYGBgcJDgkJCAgJEg0NCg4VEhYWFRIUFBcaIRwXGB8ZFBQdJx0fIiMlJSUWHCksKCQrISQlJP/bAEMBBgYGCQgJEQkJESQYFBgkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJP/AABEIADAAMAMBEQACEQEDEQH/xAAbAAACAwEBAQAAAAAAAAAAAAAEBwUGCAECA//EAC4QAAEDAwIFAwMEAwAAAAAAAAECAwQABRESIQYHEzFBIlFhFDJxIyZDsYGRof/EABoBAAMBAQEBAAAAAAAAAAAAAAIDBAAFAQb/xAAjEQADAAIBBAMAAwAAAAAAAAAAAQIDESEEEhNBMTJRFCJh/9oADAMBAAIRAxEAPwDLrEcOjJq3Dhmp2wW+Q9uAhRSlLYUT4zvTvDH4bkMYgwhJaStlGguaFA+DXlYpS+A51tbGmjlfZ7lAckwoTPRt+DKUc61DGdh7Vy3kUvT9l3in8AlcBWZTBcNtbTnfGCCkfis60xsYYfoo/EdjgR48p2NHDXRAxgnuSB2qhyuzfsX1OGInaRB2xkOJSVLShI3JVVeD6o52iVUtluQ2uPpWlI3UD5o3Ww0kvg9xizMcWh30KUrOfmi3wDxs09wDB/ZaXwELWpkpcUP5E42z/VfM9TbWbR0FXCFc9zKhPvN25EJ95TCumXU4G2fPxXYnom57mxP8lKuCt8wIi4MG4PrYbSmU22lBCwogatXcfitK3D/wLqL3PIt0pV9I2VfZnxVGH6oiZyM6Wla0nBH/AGnaTBTaJlKm3pCHEHZQGr4rSmetmk+XvEMFvgCXDElKnUxlJyO6SU+R8GuD1OJ+dU17KYba4M/2KJcrTfGpZgGY0hwnQoHpu/BPtX0FuKnVPRKpve0W/jp6HJ5exYCAlydAaT13k9lb/bnzjb/VQNvuuvTKaT7EmKWOpXSAB7+D2p2L6oSfXThJSUDfzTUCzja+isJJwDRrkF8DF4Cv308xtnWkJKSjvjII7VJ1eHunaH4siT0ywTrO400lta1tx3la20kY7n+qDHmWt+0NqNPWyI42jmx8LSGF+r6hOgbDY5FLdvJt/hrSmBVxlekVVh+qJQvohWDlRPxTTaDhakS2ArUUuY2zRTvZ5RK8vbSiZxXEhz1hphDqVOEKxqAPb/NbM3MNoFcmqrhaYUt1iS1Hi9NlGAVN6iAO2M7CvmHlc7RZHPyITnpdYhDduZdJeTlTiQrtk7bV0ell+OqfsHM/iRNNu6B3qvFllTpiGgxiahB9R2pvlj9NySDN1abI/URj5o1mj9PNMt3A9w4eauyJdzuUeOEnPqJpPUZ/66kJShwXrnFwlEtQYt16iPqSn7QVeo+3auLGB3e7+B80kjMl+u7t4uUiY66twurJ9SskDOwz7V2ctwo7JZPy3tn/2Q==");--sf-img-50: url("data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+t6KPxr0D4VeF7fVJrjUbtFmjgYJFGwyu/GSSPYY/OgDhvsFz5PnfZ5vJ6+ZsO386gr6awMY7V5N8VvC9vpklvqVoiwpO5jlRRhd+MggdsgHP0oA8+oo/GigA/CvR/hJ4hgtHudLndYmmcSQljgM2MFfrwMfjXnKIZHVEBZmOAo5JNez+DPh7aaHbR3N7EtxqLDcd4ysXsB6+/5UAdnz6V5Z8XPEMF19n0qB1laF/NmKnIVsEBfryc/hXqXHvXG+NPh7aa5bSXNlEtvqKgsNgwsvsR6+/wCdAHi/4UUroY3ZHBVlOCp4IPpRQB1Xwy05dR8WW5cBlt1afHuOB+RIP4V7hz60UUAHPrRz60UUAeH/ABN05dO8WXBQBUuEWfHucg/qCfxooooA/9k=");--sf-img-59: url("data:image/png;base64,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")}img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 0.07em!important;vertical-align:-0.1em!important;background:none!important;padding:0!important}:where(.wp-block-button__link){border-radius:9999px;box-shadow:none;padding:calc(.667em + 2px) calc(1.333em + 2px);text-decoration:none}:where(.wp-block-calendar table:not(.has-background) th){background:#ddd}:where(.wp-block-columns){margin-bottom:1.75em}:where(.wp-block-columns.has-background){padding:1.25em 2.375em}:where(.wp-block-post-comments input[type=submit]){border:none}@supports (position:sticky){.wp-block-cover-image:after,.wp-block-cover:after{content:none}}@supports (-webkit-touch-callout:inherit){.wp-block-cover-image.has-parallax,.wp-block-cover.has-parallax,.wp-block-cover__image-background.has-parallax,video.wp-block-cover__video-background.has-parallax{background-attachment:scroll}}:where(.wp-block-cover-image:not(.has-text-color)),:where(.wp-block-cover:not(.has-text-color)){color:#fff}:where(.wp-block-cover-image.is-light:not(.has-text-color)),:where(.wp-block-cover.is-light:not(.has-text-color)){color:#000}:where(.wp-block-file){margin-bottom:1.5em}:where(.wp-block-file__button){border-radius:2em;display:inline-block;padding:.5em 1em}:where(.wp-block-file__button):is(a):active,:where(.wp-block-file__button):is(a):focus,:where(.wp-block-file__button):is(a):hover,:where(.wp-block-file__button):is(a):visited{box-shadow:none;color:#fff;opacity:.85;text-decoration:none}@supports ((-webkit-mask-image:none) or (mask-image:none)) or (-webkit-mask-image:none){.wp-block-image.is-style-circle-mask img{border-radius:0;-webkit-mask-image:url(data:image/svg+xml;utf8,<svg\ viewBox=\"0\ 0\ 100\ 100\"\ xmlns=\"http://www.w3.org/2000/svg\"><circle\ cx=\"50\"\ cy=\"50\"\ r=\"50\"\/><\/svg>);mask-image:url(data:image/svg+xml;utf8,<svg\ viewBox=\"0\ 0\ 100\ 100\"\ xmlns=\"http://www.w3.org/2000/svg\"><circle\ cx=\"50\"\ cy=\"50\"\ r=\"50\"\/><\/svg>);mask-mode:alpha;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain}}@keyframes turn-on-visibility{0%{opacity:0}to{opacity:1}}@keyframes turn-off-visibility{0%{opacity:1;visibility:visible}99%{opacity:0;visibility:visible}to{opacity:0;visibility:hidden}}@keyframes lightbox-zoom-in{0%{left:var(--lightbox-initial-left-position);top:var(--lightbox-initial-top-position);transform:scale(var(--lightbox-scale-width),var(--lightbox-scale-height))}to{left:var(--lightbox-target-left-position);top:var(--lightbox-target-top-position);transform:scale(1)}}@keyframes lightbox-zoom-out{0%{left:var(--lightbox-target-left-position);top:var(--lightbox-target-top-position);transform:scale(1);visibility:visible}99%{visibility:visible}to{left:var(--lightbox-initial-left-position);top:var(--lightbox-initial-top-position);transform:scale(var(--lightbox-scale-width),var(--lightbox-scale-height))}}:where(.wp-block-latest-comments:not([style*=line-height] .wp-block-latest-comments__comment)){line-height:1.1}:where(.wp-block-latest-comments:not([style*=line-height] .wp-block-latest-comments__comment-excerpt p)){line-height:1.8}ol,ul{box-sizing:border-box}:where(.wp-block-navigation.has-background .wp-block-navigation-item a:not(.wp-element-button)),:where(.wp-block-navigation.has-background .wp-block-navigation-submenu a:not(.wp-element-button)){padding:.5em 1em}:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-item a:not(.wp-element-button)),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-submenu a:not(.wp-element-button)),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-navigation-submenu button.wp-block-navigation-item__content),:where(.wp-block-navigation .wp-block-navigation__submenu-container .wp-block-pages-list__item button.wp-block-navigation-item__content){padding:.5em 1em}@keyframes overlay-menu__fade-in-animation{0%{opacity:0;transform:translateY(.5em)}to{opacity:1;transform:translateY(0)}}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}:where(.wp-block-post-excerpt){margin-bottom:var(--wp--style--block-gap);margin-top:var(--wp--style--block-gap)}:where(.wp-block-pullquote){margin:0 0 1em}:where(.wp-block-search__button){border:1px solid #ccc;padding:6px 10px}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper){border:1px solid #949494;box-sizing:border-box;padding:4px}:where(.wp-block-search__button-inside .wp-block-search__inside-wrapper) :where(.wp-block-search__button){padding:4px 8px}:where(.wp-block-term-description){margin-bottom:var(--wp--style--block-gap);margin-top:var(--wp--style--block-gap)}:where(pre.wp-block-verse){font-family:inherit}@supports (position:sticky){.wp-block-video [poster]{object-fit:cover}}.entry-content{counter-reset:footnotes}:root{--wp--preset--font-size--normal:16px;--wp--preset--font-size--huge:42px}html :where(.has-border-color){border-style:solid}html :where([style*=border-top-color]){border-top-style:solid}html :where([style*=border-right-color]){border-right-style:solid}html :where([style*=border-bottom-color]){border-bottom-style:solid}html :where([style*=border-left-color]){border-left-style:solid}html :where([style*=border-width]){border-style:solid}html :where([style*=border-top-width]){border-top-style:solid}html :where([style*=border-right-width]){border-right-style:solid}html :where([style*=border-bottom-width]){border-bottom-style:solid}html :where([style*=border-left-width]){border-left-style:solid}html :where(img[class*=wp-image-]){height:auto;max-width:100%}:where(figure){margin:0 0 1em}html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:var(--wp-admin--admin-bar--height,0px)}@media screen and (max-width:600px){html :where(.is-position-sticky){--wp-admin--admin-bar--position-offset:0px}}body{--wp--preset--color--black:#000000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#ffffff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--color--blue:#007bff;--wp--preset--color--indigo:#6610f2;--wp--preset--color--purple:#5533ff;--wp--preset--color--pink:#e83e8c;--wp--preset--color--red:#dc3545;--wp--preset--color--orange:#fd7e14;--wp--preset--color--yellow:#ffc107;--wp--preset--color--green:#28a745;--wp--preset--color--teal:#20c997;--wp--preset--color--cyan:#17a2b8;--wp--preset--color--gray:#6c757d;--wp--preset--color--gray-dark:#343a40;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small:13px;--wp--preset--font-size--medium:20px;--wp--preset--font-size--large:36px;--wp--preset--font-size--x-large:42px;--wp--preset--spacing--20:0.44rem;--wp--preset--spacing--30:0.67rem;--wp--preset--spacing--40:1rem;--wp--preset--spacing--50:1.5rem;--wp--preset--spacing--60:2.25rem;--wp--preset--spacing--70:3.38rem;--wp--preset--spacing--80:5.06rem;--wp--preset--shadow--natural:6px 6px 9px rgba(0,0,0,0.2);--wp--preset--shadow--deep:12px 12px 50px rgba(0,0,0,0.4);--wp--preset--shadow--sharp:6px 6px 0px rgba(0,0,0,0.2);--wp--preset--shadow--outlined:6px 6px 0px -3px rgba(255,255,255,1),6px 6px rgba(0,0,0,1);--wp--preset--shadow--crisp:6px 6px 0px rgba(0,0,0,1)}body{--wp--style--global--content-size:840px;--wp--style--global--wide-size:840px}:where(.is-layout-flex){gap:0.5em}:where(.is-layout-grid){gap:0.5em}body{padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px}a:where(:not(.wp-element-button)){text-decoration:underline}:where(.wp-block-post-template.is-layout-flex){gap:1.25em}:where(.wp-block-post-template.is-layout-grid){gap:1.25em}:where(.wp-block-columns.is-layout-flex){gap:2em}:where(.wp-block-columns.is-layout-grid){gap:2em}article,footer,header,main,nav,section{display:block}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}strong{font-weight:bolder}button{margin:0}button,input{overflow:visible}button{text-transform:none}[type=submit],button,html [type=button]{-webkit-appearance:button}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}h1,h2,h3,h5{font-family:"Segoe UI";line-height:1.2;color:inherit}h2{font-size:1.75rem}h3{font-size:1.5rem}code{word-break:break-word;color:#c00}a>code{color:inherit}pre code{font-size:inherit;color:inherit;word-break:normal}.container{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto}@media (min-width:576px){.container{padding-left:10px;padding-right:10px}}@media (min-width:768px){.container{max-width:720px}.col-md{-ms-flex-preferred-size:0;flex-basis:0;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;max-width:100%}.col-md-4{-webkit-box-flex:0;-ms-flex:0 0 33.33333%;flex:0 0 33.33333%;max-width:33.33333%}.col-md-6{-webkit-box-flex:0;-ms-flex:0 0 50%;flex:0 0 50%;max-width:50%}}@media (min-width:992px){.container{max-width:960px}.col-lg-4{-webkit-box-flex:0;-ms-flex:0 0 33.33333%;flex:0 0 33.33333%;max-width:33.33333%}}@media (min-width:1200px){.container{max-width:1140px}}.row{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-right:-15px;margin-left:-15px}.col-10,.col-12,.col-4,.col-8,.col-lg-4,.col-md,.col-md-4,.col-md-6{position:relative;width:100%;min-height:1px;padding-right:15px;padding-left:15px}.col-4{-webkit-box-flex:0;-ms-flex:0 0 33.33333%;flex:0 0 33.33333%;max-width:33.33333%}.col-8{-webkit-box-flex:0;-ms-flex:0 0 66.66667%;flex:0 0 66.66667%;max-width:66.66667%}.col-10{-webkit-box-flex:0;-ms-flex:0 0 83.33333%;flex:0 0 83.33333%;max-width:83.33333%}.col-12{-webkit-box-flex:0;-ms-flex:0 0 100%;flex:0 0 100%;max-width:100%}.table-responsive{display:block;width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;-ms-overflow-style:-ms-autohiding-scrollbar}.btn{display:inline-block;font-weight:400;text-align:center;white-space:nowrap;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;line-height:1.5;border-radius:.25rem;-webkit-transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,-webkit-box-shadow .15s ease-in-out;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out,-webkit-box-shadow .15s ease-in-out}.btn:focus,.btn:hover{text-decoration:none}.btn.focus,.btn:focus{outline:0;-webkit-box-shadow:0 0 0 .2rem rgba(124,0,140,.47);box-shadow:0 0 0 .2rem rgba(124,0,140,.47)}.btn.disabled,.btn:disabled{opacity:.65}.btn:not(:disabled):not(.disabled){cursor:pointer}.btn:not(:disabled):not(.disabled).active,.btn:not(:disabled):not(.disabled):active{background-image:none}.card{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;min-width:0;word-wrap:break-word;background-clip:border-box;border-radius:4px;box-shadow:2px 2px 8px rgba(0,0,0,.1)}.card-body{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;padding:2.25rem}.card-title{margin-bottom:.75rem}.card-text:last-child{margin-bottom:0}.pagination{display:-webkit-box;display:-ms-flexbox;display:flex;padding-left:0;list-style:none;border-radius:.25rem}li.page-item{margin:0 .5rem}.page-link{position:relative;display:block;color:#666}.page-link:hover{z-index:2;color:#0067b8;text-decoration:underline;background-color:#f4f4f4}.page-link:focus{z-index:2;outline:0}.page-item.active .page-link{z-index:1;margin-left:0;text-align:center;border:1px solid #0067b8;background:#0067b8;border-radius:.2rem;color:#fff;text-decoration:none;height:1.8rem;width:2rem;padding:0}.page-link:not(:disabled):not(.disabled){cursor:pointer}.page-item .page-link.next{margin-left:0;text-align:center;color:#0067b8;height:2rem;width:2rem;padding:0}a.next.page-link{content:"";font:14px FabricIcons;padding-top:5px!important;padding-left:1px!important}a.next.page-link:hover,a.prev.page-link:hover{color:#0067b8;font-weight:900}@-webkit-keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@keyframes progress-bar-stripes{from{background-position:1rem 0}to{background-position:0 0}}@supports ((-webkit-transform-style:preserve-3d) or (transform-style:preserve-3d)){.carousel-item-next.carousel-item-left,.carousel-item-prev.carousel-item-right{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.active.carousel-item-right,.carousel-item-next{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0)}.active.carousel-item-left,.carousel-item-prev{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}.carousel-fade .active.carousel-item-left,.carousel-fade .active.carousel-item-prev,.carousel-fade .carousel-item-next,.carousel-fade .carousel-item-prev,.carousel-fade .carousel-item.active{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}}.justify-content-center{-webkit-box-pack:center!important;-ms-flex-pack:center!important;justify-content:center!important}@supports ((position:-webkit-sticky) or (position:sticky)){.sticky-top{position:-webkit-sticky;position:sticky;top:0;z-index:1020}}.sr-only{white-space:nowrap;position:absolute;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.mr-1{margin-right:.25rem!important}@font-face{font-family:"Segoe UI";font-style:normal;font-weight:400;src:local("Segoe UI"),url(data:font/woff2;base64,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)format("woff2")}@font-face{font-family:"Segoe UI Bold";font-style:normal;font-weight:400;src:local("Segoe UI Bold"),url(data:font/woff2;base64,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)format("woff2")}*,::after,::before{-webkit-box-sizing:border-box;box-sizing:border-box}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent}@-ms-viewport{width:device-width}body{font:1.0625rem/1.5 Segoe UI,"Segoe UI Web Regular","Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,Roboto,"Helvetica Neue",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";color:#333;text-align:left}.entry-content button:focus,[tabindex="-1"]:focus,a:not([href]):not([tabindex]):focus{outline:0}h1,h2,h3,h5{margin-top:0;margin-bottom:.5rem}ol,p,ul{margin-top:0;margin-bottom:1rem}ul ul{margin-bottom:0}blockquote{background-color:#f1f1f1;text-align:left;font-size:medium;padding:10px 20px;border-left:3px solid #39e}a{color:#005da6;text-decoration:underline}a:hover{text-decoration:underline}a:not([href]):not([tabindex]),a:not([href]):not([tabindex]):focus,a:not([href]):not([tabindex]):hover{color:inherit;text-decoration:none}code,pre{font:1em monospace,monospace}pre{margin-top:0;margin-bottom:1rem;overflow:auto;-ms-overflow-style:scrollbar;display:block;font-size:87.5%;color:#212529}img{vertical-align:middle;border-style:none}svg:not(:root){overflow:hidden}th{text-align:inherit}button{border-radius:0}button:focus{outline:5px}button,input{font-family:inherit;font-size:inherit;line-height:inherit}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}@media (min-width:768px){.related-articles article:first-of-type{padding-left:0}.related-articles article:last-of-type{padding-right:0}.comments-area{margin-left:-15px;margin-right:-15px}}.table-responsive{margin-bottom:12px}@media screen and (prefers-reduced-motion:reduce){.btn{-webkit-transition:none;transition:none}}.wrapper{padding:30px 0}.bypostauthor{font-size:inherit}#wrapper-footer-1 .justify-content-center .col-10{text-align:center}#wrapper-footer-1 .featuresectiontwo .col-12{margin-top:20px}article img,img{max-width:100%;height:auto}img.avatar{border-radius:100px}@font-face{font-family:FontAwesome;src:url(data:font/woff2;base64,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)format("woff2");font-weight:400;font-style:normal}.fa{display:inline-block;font:14px/1 FontAwesome;font-size:inherit;text-rendering:auto;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.pull-left{float:left}.fa-twitter:before{content:""}.fa-facebook:before{content:""}.fa-github:before{content:""}.fa-rss:before{content:""}.fa-linkedin:before{content:""}.fa-youtube-play:before{content:""}.fa-stack-overflow:before{content:""}.fa-twitch:before{content:""}.no-underline:hover,a.next.page-link,a.no-underline,a.no-underline:hover,a.page-link{text-decoration:none}@media screen and (max-width:567px){a.stayinformedsite{padding-left:8px;padding-right:8px}.stayinformedsite .fa{font-size:24px}.entry-content{margin-top:14px}}.featuresectiontwo{padding:20px 0}.c-search button{background-color:transparent!important}h1.entry-title{text-align:center;font-size:1.8rem}.cattagsarea{margin-bottom:20px;margin-left:-15px;margin-right:-15px;background-color:#fff;padding:1rem;border-radius:0 0 4px 4px}.cattagsarea .cat-links{width:100%;display:flex;flex-direction:row;flex-wrap:wrap;align-items:center}.cattagsarea .cat-links{margin-bottom:10px}.cat-links a{background-color:#efefef;color:#222;padding:.5rem;margin:5px;border-radius:3px;text-decoration:none}.cat-links a:hover,.tags-links a:hover{text-decoration:underline}.bottomleft{background-color:#fff;color:#333;border:1px solid rgba(0,0,0,.1)}.bottomleft a{text-decoration:none}.bottomleft a:hover{text-decoration:underline}.bottomleft a:link,.bottomleft a:visited{color:#005da6}.bottomcenter{background-color:#fff;color:#333;border:1px solid rgba(0,0,0,.1)}.bottomcenter a{text-decoration:none}.bottomcenter a:hover{text-decoration:underline}.bottomcenter a:link,.bottomcenter a:visited{color:#005da6}.bottomright{background-color:#fff;border:1px solid rgba(0,0,0,.1)}.bottomright a{text-decoration:none}.bottomright a:hover{text-decoration:underline}.bottomright a:link,.bottomright a:visited{color:#005da6}.bottomcenter h5,.bottomleft h5,.bottomright h5{color:#222;font-weight:600;font-size:18px;line-height:21px}.listdisplay{-ms-overflow-style:-ms-autohiding-scrollbar}a.stayinformed{color:#666;padding-left:9px;padding-right:9px;vertical-align:middle}a.stayinformedsite{color:#666;padding-left:12px;padding-right:12px}a.stayinformedsite:hover{color:#000}.stayinformedsite .fa{font-size:32px}@-webkit-keyframes hvr-pop{50%{-webkit-transform:scale(1.2);transform:scale(1.2)}}@keyframes hvr-pop{50%{-webkit-transform:scale(1.2);transform:scale(1.2)}}.hvr-pop{display:inline-block;vertical-align:middle;-webkit-transform:perspective(1px) translateZ(0);transform:perspective(1px) translateZ(0);box-shadow:0 0 1px transparent}.hvr-pop:active,.hvr-pop:focus,.hvr-pop:hover{-webkit-animation-name:hvr-pop;animation-name:hvr-pop;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-animation-iteration-count:1;animation-iteration-count:1}#single-wrapper article.addtoanyshare{position:relative}#single-wrapper article.addtoanyshare:before{position:absolute;content:"";float:left;height:100%;left:-15px;width:calc(100% + 30px);z-index:-1;box-shadow:2px 2px 8px rgba(0,0,0,.1);border-radius:4px}.postcontent{margin-bottom:2px;padding-top:60px;padding-left:16%;padding-right:16%;background-color:#fff;border-radius:4px 4px 0 0}@media screen and (max-width:800px){.comments-area,.postcontent,.related-articles{padding:0 30px}#wrapper-footer-1{padding:30px}}@media screen and (max-width:768px){.entry-content{margin-top:14px;word-break:break-word}}.listdisplay li{line-height:30px}.stayinformedform.tnp-subscription{margin:32px auto 40px}h3.stayinformedtitle{font-size:24px;line-height:31px;color:#000}.screen-reader-text-pagination{border:0;clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute!important;width:1px;word-wrap:normal!important}::-webkit-input-placeholder{color:#005da6}.listdisplay .ftr-archives li{display:block}::-webkit-scrollbar{width:10px}::-webkit-scrollbar-track{background:#f1f1f1;border-radius:12px}::-webkit-scrollbar-thumb{background:#888;border-radius:10px}::-webkit-scrollbar-thumb:hover{background:#555}@media only screen and (max-width:991px){.post-card{margin-bottom:0}}.login-section .login-but{background-color:#0078d4;border-radius:20px;font-size:13px;color:#fff!important;display:inline-block;margin-top:15px;line-height:1;text-align:center;padding:5px 14px 7px;text-decoration:none;margin-right:8px}.login-section .login-but:hover{text-decoration:underline}.related-articles{margin-top:25px;margin-bottom:70px}.related-articles article .post-card{background-color:#fff;box-shadow:2px 2px 8px rgba(0,0,0,.1);border-radius:4px;padding:20px 40px 0;word-break:break-word}.related-articles article .post-card .post-desc{font-size:16px;font-style:normal;line-height:24px;color:#666}.related-articles article .article-title{display:block;color:#005da6;font-size:20px;margin-top:5px;line-height:24px;text-decoration:none;font-weight:700;margin-bottom:5px}.related-articles article .article-title:hover{text-decoration:underline}.author-details{padding:12px 0}.author-details .avatar-img{margin-right:9px;vertical-align:bottom}.author-details .author-name{font-size:18px;color:#005da6;font-weight:400;margin-right:8px}.author-details .author-name:hover{text-decoration:underline}.author-details a{text-decoration:none}.author-details .post-date{font-size:16px;color:#666}.author-header{max-width:580px;margin:auto}.post-detail-avatar-section{margin:20px 0;text-align:center}.author-header .post-detail-avatar{width:52px;margin:5px auto 10px}.authorinfoarea{padding:12px 0}.authorinfoarea p{margin-bottom:0}.post-authoravatar{float:left;margin-right:20px}a.stayinformed{font-size:18px}.postdetail-author-info{border-top:1px solid #a6a6a6;padding:25px 0 20px;margin-top:15px}.related-articles .post-comments{padding:0 0 12px;font-size:16px;color:#005da6;font-weight:700}.related-articles .post-comments a{color:#005da6}.related-articles .post-comments .comment-icon{padding-right:10px;margin-right:10px;text-decoration:none}.related-articles .post-comments .comment-icon svg{vertical-align:middle;margin-right:9px!important;width:24px}.linkicon{font-size:16px;margin-left:10px;opacity:0;text-decoration:none}.linkicon:focus,.linkicon:hover,:focus>.linkicon,:hover>.linkicon{opacity:1}.postcontent .entry-content a,.postcontent .entry-content p{word-break:break-word}.entry-content h1:hover .linkicon,.entry-content h2:hover .linkicon,.entry-content h3:hover .linkicon,.entry-content h4:hover .linkicon,.entry-content h5:hover .linkicon{display:inline-block;text-decoration:none}.login-section:focus,body .login-section a.login-but:active,body .login-section a.login-but:focus{outline:#000 dotted 2px}table,td,th{border:1px solid #d3d3d3;border-collapse:collapse}td,th{padding:5px;min-width:150px}thead tr,thead+tbody tr:nth-child(2n),tr:nth-child(odd){background-color:#f9f9f9}table.default tr:nth-child(2n),thead+tbody tr:nth-child(odd){background-color:#fff}.table-responsive::-webkit-scrollbar{height:15px}.table-responsive::-webkit-scrollbar-track{background-color:#dadada}.table-responsive::-webkit-scrollbar-thumb{background-color:#969696}body pre.prettyprinted{background-color:#f0f0f0!important;padding:10px!important;border-radius:10px;border:0!important}@media (max-width:859px){.login-section{right:0;background:#fff;border-bottom:1px solid #e6e6e6;display:block!important;height:34px;position:absolute;width:50%;top:54px;text-align:right}.login-section .login-but{margin-top:4px;margin-right:15px}}@media (max-width:520px){.post-authoravatar{float:none!important;display:inline-block}.post-authorname{display:inline-block}.post-authoravatar img{max-width:60px}.social-links strong{display:block;padding-left:0;margin-bottom:8px}.postcontent .entry-content ol,.postcontent .entry-content ul,.postcontent .entry-content ul ul{padding-left:15px}.related-articles article .post-card{padding:12px 20px 10px}}.social-icon-bar{position:fixed;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%)}.social-icon-bar a{display:block;text-align:center;padding:5px 15px;transition:.3s;color:#3c3c3c;font-size:20px}.social-icon-bar a:hover{background-color:#fff;color:#999}.facebook,.linkedin,.twitter{background:#fff}@media screen and (max-width:1024px){.social-icon-bar{display:flex;right:0;left:unset;top:50%;flex-direction:column}.social-icon-bar a{padding:.675rem}.entry-meta-layout{margin-bottom:-20px}}.entry-meta-layout{margin-top:-24px;margin-bottom:28px}.pagination a.page-link:focus{border:1px solid #0067b8}.author-details .avatar-img img,.post-authoravatar img{max-width:100%;width:100%;border-radius:0!important;display:block}.post-authoravatar{width:96px;height:96px;border-radius:100%;-webkit-border-radius:100%;-moz-border-radius:100%;overflow:hidden}.author-details .avatar-img{width:25px;height:25px;border-radius:100%;-webkit-border-radius:100%;-moz-border-radius:100%;overflow:hidden;display:inline-block}.entry-meta-comment a{text-decoration:none;font-size:.75rem;line-height:1rem;display:inline-block;position:relative;z-index:10;padding:.5em 0 0;margin:-.5em 0 0;border-bottom:1px solid transparent}.entry-meta-comment a:hover{border-bottom:1px solid #005da6}.entry-meta-comment .fabric-icon{font-size:.6875rem;margin-right:.375rem}.entry-meta-comment:before{border-left:1px solid #c4c4c4;content:" ";padding-left:.3rem;margin-left:.5rem}.back-comment-buttons{position:fixed;top:35%;right:0;z-index:2;height:120px;display:flex;flex-direction:column;justify-content:flex-end;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%)}.jump-to-comments{width:2.5rem;height:2.5rem;background:#0060ac;box-shadow:0 4px 4px rgba(0,0,0,.25);display:flex;justify-content:center;align-items:center;text-decoration:none;color:#fff}.jump-to-comments .fabric-icon{font-size:1.5rem}.back-to-top.active:hover,.jump-to-comments:hover{background:#fff;color:#0060ac;text-decoration:none}.back-to-top.active:focus,.jump-to-comments:focus{outline-offset:-3px;outline:#fff solid 1px;background:#0060ac;color:#fff}@media screen and (max-width:1024px){.back-comment-buttons{top:20%}}.theme-picker{position:relative;float:left;line-height:1.5rem;margin-right:8px}#theme-picker-button{display:flex;align-items:center;background:0 0;padding:1rem;width:118px;margin-top:1px;z-index:701;position:relative;outline-offset:-2px;border:1px solid transparent;line-height:19.5px}#theme-picker-button .fabric-icon{font-size:1rem;color:#262626;margin-right:.75rem;line-height:1rem;width:1rem;height:1rem}#theme-picker-button .theme-text{color:#262626}#theme-picker-button:focus{outline:dashed 1px;outline-offset:-1px;background:#f2f2f2}#theme-picker-button:hover::before{background:currentColor;content:"";height:2px;position:absolute;bottom:12px;display:block;width:39px;right:2rem}@media only screen and (max-width:859px){.theme-picker{right:150px;position:absolute;top:54px;margin:0 1px}#theme-picker-button:hover::before{display:none}#theme-picker-button{padding:0;height:33px;line-height:22.5px;width:auto;z-index:1}.c-uhfh .login-section{width:auto}}@media all and (max-width:420px){.c-uhfh.c-sgl-stck.c-category-header{padding-bottom:68px;margin-bottom:0!important}.theme-picker{left:10px;top:88px;right:auto}.login-section{top:88px;border-bottom:0}}.entry-meta-comment .post-like .icon-like-dislike svg{width:.875rem;vertical-align:-2px;fill:#005da6;margin-right:.2rem;margin-left:.3rem}.post-like,.post-like .icon-like-dislike a,.post-like .icon-like-dislike a:focus,.post-like .icon-like-dislike a:hover,.post-like .icon-like-dislike a:target{color:#005da6;cursor:pointer}@media screen{pre .str{color:#080}pre .kwd{color:#008}pre .com{color:#800}pre .typ{color:#606}pre .lit{color:#066}pre .pun{color:#660}pre code.language-assembly span,pre code.language-console span{color:#000!important}pre .tag{color:#008}pre .atn{color:#606}pre .atv{color:#007a00}}.vscom-usabilla-button{right:0;bottom:188px;transform-origin:bottom right;transform:rotate(-90deg);display:block;padding:0;position:fixed!important;z-index:99999}.vscom-usabilla-button .vscom-usabilla-link{color:#fff!important;text-decoration:none}.vscom-usabilla-button .vscom-usabilla-text{outline:#FFF solid 1px;background-color:#106ebe;line-height:1;font-family:"Segoe UI",SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif}.vscom-usabilla-text{margin:0;padding:12px}.vscom-usabilla-icon{width:1rem;height:1rem}@media all and (max-width:700px){.vscom-usabilla-button{bottom:130px}}@media all and (max-width:1084px){body .vscom-usabilla-button{-webkit-transform:none;-moz-transform:none;transform:none;bottom:0}.vscom-usabilla-text{padding:10px}}@page{size:A4;margin:2cm}.postcontent h3.post-authorname{font-size:1.25rem;margin-bottom:0}.related-postssection h3{font-size:1.25rem}@media (min-width:768px){.related-postssection h3{margin-left:-15px}}@media screen and (max-height:450px){.social-icon-general{display:none}.vscom-usabilla-button .vscom-usabilla-text{font-size:0;width:2.5rem}}@media screen and (max-height:300px){.social-icon-bar{top:55%!important}}span.banner-button-text i{font-size:10px}.tnp-field input[type=submit]{cursor:pointer}.alert-banner{padding:15px 0;position:relative}.alert-banner .banner-inner-wrapper{max-width:1148px;margin:0 auto;display:flex;flex-direction:row}.banner-button-wrapper,.banner-close-wrapper,.banner-content-wrapper{display:flex;flex-direction:column}.banner-content-wrapper{flex:0 1 75%}.banner-button-wrapper,.banner-close-wrapper{flex:1 1 auto}.banner-close-wrapper{position:absolute;top:0;bottom:0;right:0;left:auto;padding-top:15px;padding-right:15px}.banner-button{margin-top:auto;margin-bottom:0;align-self:flex-end;width:auto}.banner-close{margin-top:0;margin-bottom:auto}.alert-banner{background-color:#000}.banner-body,.banner-button,.banner-button-text,.banner-close-text,.banner-title{color:#fff}.banner-title{font-size:24px;line-height:32px;margin-bottom:.5rem;font-family:"Segoe UI Bold","Segoe UI",Tahoma,Geneva,Verdana,sans-serif}.banner-body{font-size:18px;font-family:"Segoe UI Thin","Segoe UI",Tahoma,Geneva,Verdana,sans-serif;line-height:1.556}.banner-button{border:1px solid #fff;padding:5px 8px;text-decoration:none}.banner-button-text{font-size:18px;line-height:24px;text-decoration:none}.banner-close{background:0 0;border:0}.banner-close-text{font-size:12px;line-height:14.06px}.banner-button:hover,.banner-close:hover{cursor:pointer}.banner-button:focus{text-decoration:underline}.banner-button:hover .banner-button-text,.banner-close:hover .banner-close-text{text-decoration:underline}.social-icon-bar.banner-active{top:20rem}@media screen and (max-width:1200px){.alert-banner .banner-inner-wrapper{flex-direction:column;padding:0 1.5rem;align-items:center}.banner-button-wrapper,.banner-content-wrapper{display:flex;flex-direction:column;align-items:center}.banner-button{margin-top:1rem;align-self:center}}div.tnp-subscription{display:block;max-width:500px;width:100%}.tnp-subscription div.tnp-field{margin-bottom:.7em;border:0;padding:0}.tnp-subscription label{display:block;color:inherit;line-height:normal;padding:0;margin:0;margin-bottom:.25em}.tnp-subscription input[type=email],.tnp-subscription input[type=submit]{width:100%;padding:.7em;display:block;border:1px;color:#444;border-color:#ddd;background-image:none;text-shadow:none;margin:0;line-height:normal;box-sizing:border-box}.tnp-subscription input.tnp-submit{color:#fff;width:auto;margin:0}@media all and (max-width:480px){.tnp-subscription input[type=submit]{width:100%}}.tnp-field input[type="submit"]{position:inherit}@font-face{font-family:"FabricIcons";src:url(data:font/woff;base64,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)format("woff");font-style:normal;font-weight:normal}.fabric-icon:before{font-family:"FabricIcons";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-style:normal;font-variant:normal;font-weight:normal;text-decoration:none;text-transform:none}.fabric-icon--ChevronDown:before{content:""}.fabric-icon--Link:before{content:""}.fabric-icon--ChevronRight:before{content:""}.fabric-icon--Message:before{content:""}.fabric-icon--Sunny:before{content:""}#comments.comments-area{font-size:16px;overflow:hidden}h2.comments-title{font-size:1.5em;font-family:Segoe UI;line-height:2em}ul li.comment{list-style-type:none;font-family:Segoe UI;color:#323130}ul.commentlist{padding-left:0;font-size:1em}ul.commentlist li.comment.depth-1{position:relative}ul.commentlist li.comment.depth-1:before{position:absolute;display:block;content:"";float:left;left:70px;height:calc(100% - 1px);width:calc(100% - 70px);box-shadow:2px 2px 8px rgba(0,0,0,.1);border-radius:4px;z-index:-1}ul.commentlist li.comment.depth-1>article header{border-radius:4px 4px 0 0}ul.commentlist li.comment.depth-1>article.comment footer{border-radius:0 0 4px 4px}ul.commentlist li ul:last-of-type{border-radius:0 0 4px 4px}.commentlist li{margin:1em;padding-bottom:1px}.commentlist li ul.children{margin-left:70px;padding:.5em 1em;background-color:#fff}.commentlist li ul.children li{margin:0;box-shadow:none}.commentlist li header{font-size:1em}.commentlist li footer{background:#fff;padding:0 1em .5em;margin-left:70px}.comments-area .pagination{justify-content:center}.commentmetadata{float:right}.comment-meta.commentmetadata span{width:22px;display:inline-grid;text-align:center}.comment-author .avatar{border-radius:50%}.author-name{font-size:1.125em;color:#005da6;margin-right:.5em}.author-name{font-weight:700}.comment-date{font-size:1em;color:#737170;font-weight:400;padding-left:.5em}.comment-author.vcard{float:left;margin:15px}article.comment header{line-height:21px;padding:1em;margin-left:70px;background-color:#fff}article.comment .comment-content{font-size:1em;padding:.5em 1em;margin-left:70px;background-color:#fff}.comment-meta .copy-link-live{line-height:20px;font-style:normal}@media screen and (max-width:767px){.comment-author.vcard{margin:5px;margin-top:15px}.commentlist li{margin:0}.comment-date{display:block;padding-left:0}.commentlist li footer,article.comment .comment-content,article.comment header{margin-left:50px}.commentmetadata{margin-bottom:5px}.commentlist li ul.children{margin-left:50px;padding-right:0}.commentlist li.depth-2 ul.children{margin-left:0}.commentlist article.comment .comment-content{display:block}.commentlist article.comment .comment-content p{display:inline-block;word-break:break-word}}@media screen and (max-width:480px){article.comment header{padding-left:.5em}.commentlist li footer,article.comment .comment-content,article.comment header{margin-left:30px}.children article.comment .comment-content{margin-left:22px}.commentlist li.depth-2 ul.children{margin-left:0}.commentlist li ul.children{padding-bottom:0}.commentlist>li>ul.children{margin-left:30px}.commentlist li ul.children{padding-left:0}.commentlist li ul.children article.comment header{margin-top:0!important}.comment-author.vcard{margin-left:0}.children .comment-author.vcard{margin-left:5px}.comment-author .avatar{width:25px;height:25px}.comments-area nav{flex-direction:column;text-align:center}}#comments.comments-area{position:relative}.commentlist li ul.children article{border-top:1px solid #c8c6c4;padding-top:2px}.commentlist li ul.children article.comment header{margin-top:2px}.commentlist li ul.children,.commentlist li ul.children li{padding-top:0}.copy-link .copy-link-live{color:#000;font-size:13px;margin-top:-34px;position:absolute;padding:0;margin-left:-11px}.author-name img{margin-left:5px;margin-bottom:2px}article.comment .comment-content a{word-break:break-word}.comments-area nav{display:flex;justify-content:center;margin-top:20px;align-items:center}.comments-area nav .pagination{margin-bottom:0}.commentlist .commentmetadata .btn{background-color:#fff;border:none;color:#005da6;padding:2px 2px;font-size:16px;cursor:pointer}.commentlist .commentmetadata .btn:hover{border:none}.commentlist .commentmetadata .btn:active,.commentlist .commentmetadata .btn:focus,.commentlist .commentmetadata .btn:focus-visible,.commentlist .commentmetadata .btn:hover{background-color:#fff;box-shadow:revert;-webkit-box-shadow:revert}.commentlist .commentmetadata .btn:active,.commentlist .commentmetadata .btn:focus,.commentlist .commentmetadata .btn:focus-visible{border:1px solid}.icon-like-dislike svg{width:20px;vertical-align:middle;margin-left:10px;fill:#005da6}[data-featherlight] img{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in}@-webkit-keyframes featherlightLoader{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes featherlightLoader{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}@keyframes fadein{from{opacity:0}to{opacity:1}}</style>
<link rel=https://api.w.org/ href=https://devblogs.microsoft.com/dotnet/wp-json/><link rel=alternate type=application/json href=https://devblogs.microsoft.com/dotnet/wp-json/wp/v2/posts/33921><link rel=EditURI type=application/rsd+xml title=RSD href=https://devblogs.microsoft.com/dotnet/xmlrpc.php?rsd>
<link rel=shortlink href="https://devblogs.microsoft.com/dotnet/?p=33921">
<link rel=alternate type=application/json+oembed href="https://devblogs.microsoft.com/dotnet/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F">
<link rel=alternate type=text/xml+oembed href="https://devblogs.microsoft.com/dotnet/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F&amp;format=xml">
<style id=custom-background-css>body.custom-background{background-color:#f4f4f4}</style>
<link rel=icon href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASBAMAAACk4JNkAAAAMFBMVEUApO9fxvVvzPZ/ugCl3/m32G+/3H/b7LfyUCL3kXT4nIL6wbH/uQD/12//3H//67cLnuJJAAAAKElEQVQI12PoAIJpxkDAQB3WKiDYHgoEDEpA4H8XCBhAQO4MEFCHBQB+Zj9/rBzZFQAAAABJRU5ErkJggg==" sizes=192x192>
<meta name=msapplication-TileImage content=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2018/10/Microsoft-Favicon.png>
<style>@keyframes nsl-loader-spin{0%{transform:rotate(0deg)}to{transform:rotate(360deg)}}body pre .com{color:#007a00}body pre .str{color:#980606}body pre .kwd{color:#1e1eff}body pre .pun{color:#000}pre .pln{color:#000}@media screen{pre .str{color:#080}pre .kwd{color:#008}pre .com{color:#800}pre .typ{color:#606}pre .lit{color:#066}pre .pun{color:#660}pre .tag{color:#008}pre .atn{color:#606}pre .atv{color:#080}}@keyframes immersiveTranslateShadowRolling{0%{box-shadow:0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0)}12%{box-shadow:100px 0 var(--loading-color),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0)}25%{box-shadow:110px 0 var(--loading-color),100px 0 var(--loading-color),0px 0 rgba(255,255,255,0),0px 0 rgba(255,255,255,0)}36%{box-shadow:120px 0 var(--loading-color),110px 0 var(--loading-color),100px 0 var(--loading-color),0px 0 rgba(255,255,255,0)}50%{box-shadow:130px 0 var(--loading-color),120px 0 var(--loading-color),110px 0 var(--loading-color),100px 0 var(--loading-color)}62%{box-shadow:200px 0 rgba(255,255,255,0),130px 0 var(--loading-color),120px 0 var(--loading-color),110px 0 var(--loading-color)}75%{box-shadow:200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),130px 0 var(--loading-color),120px 0 var(--loading-color)}87%{box-shadow:200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),130px 0 var(--loading-color)}100%{box-shadow:200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0),200px 0 rgba(255,255,255,0)}}:root{--immersive-translate-theme-underline-borderColor:#72ece9;--immersive-translate-theme-nativeUnderline-borderColor:#72ece9;--immersive-translate-theme-nativeDashed-borderColor:#72ece9;--immersive-translate-theme-nativeDotted-borderColor:#72ece9;--immersive-translate-theme-highlight-backgroundColor:#ffff00;--immersive-translate-theme-dashed-borderColor:#59c1bd;--immersive-translate-theme-blockquote-borderColor:#cc3355;--immersive-translate-theme-thinDashed-borderColor:#ff374f;--immersive-translate-theme-dashedBorder-borderColor:#94a3b8;--immersive-translate-theme-dashedBorder-borderRadius:0;--immersive-translate-theme-solidBorder-borderColor:#94a3b8;--immersive-translate-theme-solidBorder-borderRadius:0;--immersive-translate-theme-dotted-borderColor:#94a3b8;--immersive-translate-theme-wavy-borderColor:#72ece9;--immersive-translate-theme-dividingLine-borderColor:#94a3b8;--immersive-translate-theme-grey-textColor:#2f4f4f;--immersive-translate-theme-marker-backgroundColor:#fbda41;--immersive-translate-theme-marker-backgroundColor-rgb:251,218,65;--immersive-translate-theme-marker2-backgroundColor:#ffff00;--immersive-translate-theme-opacity-opacity:10}.immersive-translate-target-translation-block-wrapper{margin:8px 0!important}.immersive-translate-target-translation-block-wrapper-theme-paper{margin:8px 0;box-shadow:rgba(0,0,0,0.24) 0px 3px 8px;padding:16px 32px;display:block}.immersive-translate-clickable-button{cursor:pointer}.immersive-translate-help-button{cursor:help}.immersive-translate-error-wrapper{position:relative;display:inline-flex;padding:6px;margin:0 12px}@-webkit-keyframes immersive-translate-loading-animation{from{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(359deg)}}@keyframes immersive-translate-loading-animation{from{transform:rotate(0deg)}to{transform:rotate(359deg)}}.sf-hidden{display:none!important}</style><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
<body class="post-template-default single single-post postid-33921 single-format-standard custom-background wp-featherlight-captions group-blog" style=visibility:visible;opacity:1 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>
 
 <div id=cookie-banner data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></div>
 
<div id=headerArea class=uhf data-m='{"cN":"headerArea","cT":"Area_coreuiArea","id":"a1Body","sN":1,"aN":"Body"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div id=headerRegion data-region-key=headerregion data-m='{"cN":"headerRegion","cT":"Region_coreui-region","id":"r1a1","sN":1,"aN":"a1"}' style=overflow-x:visible data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div id=headerUniversalHeader data-m='{"cN":"headerUniversalHeader","cT":"Module_coreui-universalheader","id":"m1r1a1","sN":1,"aN":"r1a1"}' data-module-id=Category|headerRegion|coreui-region|headerUniversalHeader|coreui-universalheader style=overflow-x:visible data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <div data-m='{"cN":"cookiebanner_cont","cT":"Container","id":"c1m1r1a1","sN":1,"aN":"m1r1a1"}' style=overflow-x:visible data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<div id=uhfCookieAlert data-locale=en-us style=overflow-x:visible data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div id=msccBannerV2 style=overflow-x:visible data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></div>
</div>
 
 </div>
 <a id=uhfSkipToMain class=m-skip-to-main href=javascript:void(0) data-href=#mainContent tabindex=0 data-m='{"cN":"Skip to content_nonnav","id":"nn2m1r1a1","sN":2,"aN":"m1r1a1"}' style=overflow-x:visible data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Skip to main content</a>
<header class="c-uhfh context-uhf c-sgl-stck c-category-header" itemscope data-header-footprint="/DEV_Blogs/DEV_header_dotnet, fromService: True" data-magict=true itemtype=http://schema.org/Organization style=overflow-x:visible translate=no>
 <div class="theme-light js-global-head f-closed global-head-cont" data-m='{"cN":"Universal Header_cont","cT":"Container","id":"c3m1r1a1","sN":3,"aN":"m1r1a1"}' style=overflow-x:visible>
 <div class=c-uhfh-gcontainer-st style=overflow-x:visible>
 <button type=button class="c-action-trigger c-glyph glyph-global-nav-button sf-hidden" aria-label="All Microsoft expand to see list of Microsoft products and services" initialstate-label="All Microsoft expand to see list of Microsoft products and services" togglestate-label="Close All Microsoft list" aria-expanded=false data-m='{"cN":"Mobile menu button_nonnav","id":"nn1c3m1r1a1","sN":1,"aN":"c3m1r1a1"}' style=overflow-x:visible></button>
 <button type=button class="c-action-trigger c-glyph glyph-arrow-htmllegacy c-close-search sf-hidden" aria-label="Close search" aria-expanded=false data-m='{"cN":"Close Search_nonnav","id":"nn2c3m1r1a1","sN":2,"aN":"c3m1r1a1"}' style=overflow-x:visible></button>
 <a id=uhfLogo class="c-logo c-sgl-stk-uhfLogo" itemprop=url href=https://www.microsoft.com/ aria-label=Microsoft data-m='{"cN":"GlobalNav_Logo_cont","cT":"Container","id":"c3c3m1r1a1","sN":3,"aN":"c3m1r1a1"}' target=_blank style=overflow-x:visible>
 <img alt itemprop=logo class=c-image src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANgAAAAuCAYAAABK69fpAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTMyIDc5LjE1OTI4NCwgMjAxNi8wNC8xOS0xMzoxMzo0MCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTAwQkM2Mzk4NDBBMTFFNjhDQkVCOTdDMjE1NkM3RkQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTAwQkM2Mzg4NDBBMTFFNjhDQkVCOTdDMjE1NkM3RkQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUuNSAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBMkM5MzFBNDcwQTExMUU2QUVERkExNDU3ODU1M0I3QiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBMkM5MzFBNTcwQTExMUU2QUVERkExNDU3ODU1M0I3QiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgQJy/MAAAxESURBVHja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" role=presentation aria-hidden=true style=overflow-x:visible>
 <span itemprop=name role=presentation aria-hidden=true style=overflow-x:visible class=sf-hidden>Microsoft</span>
 </a>
 <div class="f-mobile-title sf-hidden" style=overflow-x:visible>
 
 
 
 </div>
 <div class="c-show-pipe x-hidden-vp-mobile-st" style=overflow-x:visible>
 <a id=uhfCatLogo class="c-logo c-cat-logo" href=https://devblogs.microsoft.com/dotnet/ aria-label=".NET Blog" itemprop=url data-m='{"cN":"CatNav_.NET Blog_nav","id":"n6c3m1r1a1","sN":6,"aN":"c3m1r1a1"}' style=overflow-x:visible>
 <span style=overflow-x:visible>.NET Blog</span>
 </a>
 </div>
 <div class="cat-logo-button-cont x-hidden sf-hidden" style=overflow-x:visible>
 
 </div>
 <nav id=uhf-g-nav aria-label="Contextual menu" class=c-uhfh-gnav data-m='{"cN":"Category nav_cont","cT":"Container","id":"c8c3m1r1a1","sN":8,"aN":"c3m1r1a1"}' style=overflow-x:visible translate=no>
 <ul class=js-paddle-items style=overflow-x:visible>
 <li class="single-link js-nav-menu x-hidden-none-mobile-vp uhf-menu-item sf-hidden" style=overflow-x:visible>
 
 </li>
 <li class="single-link js-nav-menu uhf-menu-item" style=overflow-x:visible>
 <a id=DevBlogs class=c-uhf-nav-link href=https://devblogs.microsoft.com/ data-m='{"cN":"CatNav_DevBlogs_nav","id":"n2c8c3m1r1a1","sN":2,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>DevBlogs</a>
 </li>
 <li class="nested-menu uhf-menu-item" style=overflow-x:visible>
 <div class="c-uhf-menu js-nav-menu" style=overflow-x:visible>
 <button type=button id=Developer aria-expanded=false data-m='{"cN":"CatNav_Developer_nonnav","id":"nn3c8c3m1r1a1","sN":3,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>Developer</button>
 <ul class=sf-hidden data-class-idn aria-hidden=true data-m='{"cN":"Developer_cont","cT":"Container","id":"c4c8c3m1r1a1","sN":4,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </ul>
 </div>
 </li> <li class="nested-menu uhf-menu-item" style=overflow-x:visible>
 <div class="c-uhf-menu js-nav-menu" style=overflow-x:visible>
 <button type=button id=Technology-main aria-expanded=false data-m='{"cN":"CatNav_Technology_nonnav","id":"nn5c8c3m1r1a1","sN":5,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>Technology</button>
 <ul class=sf-hidden data-class-idn aria-hidden=true data-m='{"cN":"Technology_cont","cT":"Container","id":"c6c8c3m1r1a1","sN":6,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>
 
 
 
 
 
 
 
 
 </ul>
 </div>
 </li> <li class="nested-menu uhf-menu-item" style=overflow-x:visible>
 <div class="c-uhf-menu js-nav-menu" style=overflow-x:visible>
 <button type=button id=Languages aria-expanded=false data-m='{"cN":"CatNav_Languages_nonnav","id":"nn7c8c3m1r1a1","sN":7,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>Languages</button>
 <ul class=sf-hidden data-class-idn aria-hidden=true data-m='{"cN":"Languages_cont","cT":"Container","id":"c8c8c3m1r1a1","sN":8,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>
 
 
 
 
 
 
 
 
 
 
 
 
 
 </ul>
 </div>
 </li> <li class="nested-menu uhf-menu-item" style=overflow-x:visible>
 <div class="c-uhf-menu js-nav-menu" style=overflow-x:visible>
 <button type=button id=c-shellmenu_40 aria-expanded=false data-m='{"cN":"CatNav_.Net_nonnav","id":"nn9c8c3m1r1a1","sN":9,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>.NET</button>
 <ul class=sf-hidden data-class-idn aria-hidden=true data-m='{"cN":".Net_cont","cT":"Container","id":"c10c8c3m1r1a1","sN":10,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>
 
 
 
 
 
 
 
 
 
 
 
 </ul>
 </div>
 </li> <li class="nested-menu uhf-menu-item" style=overflow-x:visible>
 <div class="c-uhf-menu js-nav-menu" style=overflow-x:visible>
 <button type=button id="Platform Development" aria-expanded=false data-m='{"cN":"CatNav_Platform Development_nonnav","id":"nn11c8c3m1r1a1","sN":11,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>Platform Development</button>
 <ul class=sf-hidden data-class-idn aria-hidden=true data-m='{"cN":"Platform Development_cont","cT":"Container","id":"c12c8c3m1r1a1","sN":12,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 </ul>
 </div>
 </li> <li class="nested-menu uhf-menu-item" style=overflow-x:visible>
 <div class="c-uhf-menu js-nav-menu" style=overflow-x:visible>
 <button type=button id="Data Development" aria-expanded=false data-m='{"cN":"CatNav_Date Development_nonnav","id":"nn13c8c3m1r1a1","sN":13,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>Data Development</button>
 <ul class=sf-hidden data-class-idn aria-hidden=true data-m='{"cN":"Date Development_cont","cT":"Container","id":"c14c8c3m1r1a1","sN":14,"aN":"c8c3m1r1a1"}' style=overflow-x:visible>
 
 
 
 
 
 
 
 </ul>
 </div>
 </li>
 <li id=overflow-menu class="overflow-menu x-hidden uhf-menu-item sf-hidden" style=overflow-x:visible>
 
 </li>
 </ul>
 
 </nav><div data-bi-id=headerarea data-bi-name=Theme class=theme-picker style=overflow-x:visible>
 <button id=theme-picker-button aria-expanded=false aria-label="Select light or dark theme" style=overflow-x:visible><i class="fabric-icon fabric-icon--Sunny" style=overflow-x:visible></i><span class=theme-text style=overflow-x:visible>Theme</span></button>
 <ul class="theme-panel sf-hidden" role=menu style=overflow-x:visible>
 
 
 </ul>
</div><div class="login-section c-me" style=overflow-x:visible><a class=login-but href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F" style=overflow-x:visible>Login</a></div>
 <div class=c-uhfh-actions data-m='{"cN":"Header actions_cont","cT":"Container","id":"c9c3m1r1a1","sN":9,"aN":"c3m1r1a1"}' style=overflow-x:visible>
 <div class=wf-menu style=overflow-x:visible></div>
 <form class=c-search autocomplete=off id=searchForm name=searchForm role=search action=/search method=GET data-seautosuggest='{"queryParams":{"market":"en-us","clientId":"7F27B536-CF6B-4C65-8638-A0F8CBDFCA65","sources":"Microsoft-Terms,Iris-Products,DCatAll-Products","filter":"+ClientType:StoreWeb","counts":"5,1,5"},"familyNames":{"Apps":"App","Books":"Book","Bundles":"Bundle","Devices":"Device","Fees":"Fee","Games":"Game","MusicAlbums":"Album","MusicTracks":"Song","MusicVideos":"Video","MusicArtists":"Artist","OperatingSystem":"Operating System","Software":"Software","Movies":"Movie","TV":"TV","CSV":"Gift Card","VideoActor":"Actor"}}' data-seautosuggestapi=https://www.microsoft.com/msstoreapiprod/api/autosuggest data-m='{"cN":"GlobalNav_Search_cont","cT":"Container","id":"c1c9c3m1r1a1","sN":1,"aN":"c9c3m1r1a1"}' aria-expanded=false style=overflow-x:visible><div class=x-screen-reader aria-live=assertive></div>
 <input id=cli_shellHeaderSearchInput aria-label="Search Expanded" aria-autocomplete=list aria-expanded=false aria-controls=universal-header-search-auto-suggest-transparent aria-owns=universal-header-search-auto-suggest-ul type=search name=query role=combobox placeholder=Search data-m='{"cN":"SearchBox_nav","id":"n1c1c9c3m1r1a1","sN":1,"aN":"c1c9c3m1r1a1"}' data-toggle=tooltip data-placement=right title data-original-title=Search style=overflow-x:visible value class=sf-hidden>
 
 <button id=search aria-label=Search class=c-glyph data-m='{"cN":"Search_nav","id":"n3c1c9c3m1r1a1","sN":3,"aN":"c1c9c3m1r1a1"}' data-bi-mto=true aria-expanded=false style=overflow-x:visible>
 <span role=presentation style=overflow-x:visible class=sf-hidden>Search</span>
 <span role=tooltip class="c-uhf-tooltip c-uhf-search-tooltip sf-hidden" style=overflow-x:visible>Search</span>
 </button>
 <div class=m-auto-suggest id=universal-header-search-auto-suggest-transparent role=group style=overflow-x:visible>
 <ul class="c-menu sf-hidden" id=universal-header-search-auto-suggest-ul aria-label="Search Suggestions" aria-hidden=true data-bi-dnt=true data-bi-mto=true data-js-auto-suggest-position=default role=listbox data-tel=jsll data-m='{"cN":"search suggestions_cont","cT":"Container","id":"c4c1c9c3m1r1a1","sN":4,"aN":"c1c9c3m1r1a1"}' style=overflow-x:visible></ul>
 <ul class="c-menu f-auto-suggest-no-results sf-hidden" aria-hidden=true data-js-auto-suggest-postion=default data-js-auto-suggest-position=default role=listbox style=overflow-x:visible>
 
 </ul>
 </div>
 
 </form>
 <button data-m='{"cN":"cancel-search","pid":"Cancel Search","id":"nn2c9c3m1r1a1","sN":2,"aN":"c9c3m1r1a1"}' id=cancel-search class="cancel-search sf-hidden" aria-label="Cancel Search" style=overflow-x:visible>
 
 </button>
 
 </div>
 </div>
 
 
 </div>
 
</header>
 </div>
 </div>
 </div><style>/*!  | Copyright 2017 Microsoft Corporation | This software is based on or incorporates material from the files listed below (collectively, "Third Party Code"). Microsoft is not the original author of the Third Party Code. The original copyright notice and the license under which Microsoft received Third Party Code are set forth below together with the full text of such license. Such notices and license are provided solely for your information. Microsoft, not the third party, licenses this Third Party Code to you under the terms in which you received the Microsoft software or the services, unless Microsoft clearly states that such Microsoft terms do NOT apply for a particular Third Party Code. Unless applicable law gives you more rights, Microsoft reserves all other rights not expressly granted under such agreement(s), whether by implication, estoppel or otherwise.*//*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */body{margin:0}.context-uhf{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}.context-uhf nav{display:block}.context-uhf a{background-color:transparent}.context-uhf a:active,.context-uhf a:hover{outline:0}.context-uhf ul,.context-uhf li{padding:0;margin:0}.context-uhf img{border:0}.context-uhf button{color:inherit;font:inherit;margin:0}.context-uhf button{overflow:visible}.context-uhf button{text-transform:none}.context-uhf button{-webkit-appearance:button;cursor:pointer}@font-face{font-family:"MWF-MDL2";src:url(data:application/font-woff;base64,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)format("woff")}@font-face{font-family:"SegoeUI";src:local("Segoe UI"),url(data:font/woff2;base64,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)format("woff2");font-weight:400}@font-face{font-family:"SegoeUI";src:local("Segoe UI"),url(data:font/woff2;base64,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)format("woff2");font-weight:600}.context-uhf .c-heading-4{padding:36px 0 4px;font-weight:600}@media (max-width:767px){.context-uhf .c-heading-4{font-size:20px;line-height:24px}}.context-uhf{box-sizing:border-box}.context-uhf{font-size:15px;font-family:"Segoe UI",SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;color:#000;background-color:#fff}.context-uhf *,.context-uhf *:before,.context-uhf *:after{box-sizing:inherit}.context-uhf .theme-light{color:#000;background-color:#e6e6e6}.context-uhf ul{margin-top:0;margin-bottom:0}.context-uhf ul{padding:0;list-style:none}.context-uhf img{vertical-align:middle}.context-uhf a:link,.context-uhf a:focus,.context-uhf a:hover,.context-uhf a:active,.context-uhf a:visited{text-decoration:none;color:inherit}@keyframes fadeIn{0%{opacity:0}1%{opacity:0}100%{opacity:1}}@keyframes fadeOut{0%{opacity:1}1%{opacity:1}100%{opacity:0}}.x-screen-reader{position:absolute!important;overflow:hidden!important;clip:rect(1px,1px,1px,1px)!important;width:1px!important;height:1px!important;border:0!important;padding:0!important;margin:0!important}.c-glyph{font-style:normal}.c-glyph:before,.c-glyph:after{font-family:"MWF-MDL2";display:inline-block;text-decoration:underline}.c-glyph:before,.c-glyph:after,.c-glyph:hover:before,.c-glyph:hover:after{text-decoration:none}img.c-image{display:block;margin:0;max-width:100%;height:auto}.c-list{padding-right:0;list-style-position:outside}.c-list li{padding:8px 0}.c-list.f-bare{padding-left:0;list-style-type:none}.c-search{position:relative;min-width:92px;max-width:296px;height:38px;margin-top:20px}.c-search button{float:left;outline:0;background-color:#fff}.c-search button{position:absolute;top:0;right:0;width:34px;height:34px;margin:2px 2px 1px 1px;padding:9px;transition:color .1s,background-color .1s}.c-search button:hover{color:#0067b8}.c-search button:active,.c-search button:focus{color:#fff;background:#0067b8;-ms-high-contrast-adjust:auto}@media screen and (-ms-high-contrast){.c-search button:active,.c-search button:focus{color:window;background:windowText}}.c-search button:before{content:"";text-indent:0;font-size:16px;-ms-high-contrast-adjust:none}@media screen and (-ms-high-contrast){.c-search button:before{font-size:22px;font-weight:900;line-height:18px;text-indent:-3PX}}@media screen and (-ms-high-contrast){.c-search button{color:windowText;background:window}}.theme-light .c-search{color:#000}.theme-light .c-search button{background:transparent}.theme-light .c-search button:active,.theme-light .c-search button:focus,.theme-dark .theme-light .c-search button:active,.theme-dark .theme-light .c-search button:focus{color:#fff;background:#0067b8;-ms-high-contrast-adjust:auto}@media screen and (-ms-high-contrast){.theme-light .c-search button:active,.theme-light .c-search button:focus,.theme-dark .theme-light .c-search button:active,.theme-dark .theme-light .c-search button:focus{color:window;background:windowText}}.m-auto-suggest{padding-left:0;padding-right:0;padding-top:0;display:block}a.m-skip-to-main{left:-999px;position:absolute;top:auto;width:1px;height:1px;overflow:hidden;z-index:-2}a.m-skip-to-main:hover{left:-999px;position:absolute;top:auto;width:1px;height:1px;overflow:hidden;z-index:-2}a.m-skip-to-main:focus,a.m-skip-to-main:active{background:#e6e6e6;color:#0067b8;position:fixed;top:0;left:0;padding:24px;width:auto;height:auto;overflow:auto;right:0;text-decoration:underline;text-align:center;z-index:800;outline:none}a.m-skip-to-main:focus{border:1px dashed #000}.context-uhf{min-width:280px}@media screen and (-ms-high-contrast:active){.c-uhfh button{border:none!important}.c-logo{margin-right:1px;border:none!important;outline:none!important}.c-logo.c-cat-logo:focus>span:before,.c-logo.c-cat-logo:hover>span:before{background:WindowText}.c-uhf-nav-link{border:none!important}.c-uhf-nav-link:hover{text-decoration:underline!important}#search{background:Window;color:WindowText!important}#search:hover,#search:focus{color:windowText!important;background:Window!important}.c-uhfh.c-sgl-stck .c-uhf-menu button:focus,.c-uhfh.c-sgl-stck .c-uhf-menu span:focus,.c-uhfh.c-sgl-stck .c-uhf-menu a:focus,.c-uhfh.c-sgl-stck .c-uhf-nav-link:focus,.c-uhfh.c-sgl-stck .c-logo.c-sgl-stk-uhfLogo:focus,.c-uhfh.c-sgl-stck .c-logo.c-cat-logo:focus,.c-uhfh.c-sgl-stck .c-search #search:focus,.c-uhfh.c-sgl-stck .glyph-shopping-cart:focus,.c-uhfh.c-sgl-stck .glyph-global-nav-button:focus,.c-uhfh.c-sgl-stck .glyph-shopping-bag:focus{outline:2px solid WindowText!important}}.c-uhf-menu{display:inline-block}.c-uhf-menu button{padding:16px 30px 16px 12px;border:0;background:transparent;text-align:left;position:relative}.c-uhf-menu button:after{font-family:"MWF-MDL2";content:"";position:absolute;font-size:8px;display:inline-block;color:currentColor;font-weight:700;padding-top:7px}.c-uhf-menu button:hover{color:#000}.c-uhf-menu button:focus{border-color:transparent}.c-uhf-menu button:focus:not(.x-hidden-focus){outline-color:#000}.c-uhf-menu button:focus:hover{outline:none}.c-uhf-nav-link{position:relative}.c-uhf-nav-link:focus{background:transparent}.m-skip-to-main{cursor:pointer}.c-uhfh{margin-top:0}.c-uhfh a:not(.x-hidden-focus):focus,.c-uhfh button:not(.x-hidden-focus):focus,.c-uhfh span:not(.x-hidden-focus):focus,.c-uhfh :not(.x-hidden-focus) a:focus,.c-uhfh :not(.x-hidden-focus) button:focus,.c-uhfh :not(.x-hidden-focus) span:focus,.c-uhfh .c-me .msame_Header:focus{outline:1px dashed currentColor!important;outline-offset:-1px}.c-uhfh>div>div{max-width:1600px;height:100%;margin:0 auto}.c-uhfh>div:first-child{height:50px;background:#fff}.c-uhfh>div:first-child>div>div{float:right}.c-uhfh>div:first-child .c-search{float:left}.c-uhfh>div:first-child .c-search button{height:32px;background:transparent;margin-right:6px}.c-uhfh>div:first-child .c-search button:hover{color:rgba(0,0,0,.8)}.c-uhfh>div:first-child .c-search button:active{color:#000}.c-uhfh>div:first-child .c-search button:focus:not(.x-hidden-focus){outline:1px dashed currentColor}.c-uhfh>div:first-child .c-logo .c-image{margin-top:-3px;max-width:none;width:108px}.c-uhfh>div:first-child .c-uhf-menu{position:relative}.c-uhfh.c-sgl-stck .c-uhfh-actions #search,.c-uhfh.c-sgl-stck .c-uhfh-actions #search:focus{border:none}@media only screen and (min-width:860px){.c-uhfh.c-sgl-stck .c-uhfh-gnav button{margin-right:-10px}.c-uhfh.c-sgl-stck .js-paddle-items>li:last-child>div>button{margin-right:5px}.c-uhfh.c-sgl-stck .c-search{margin-top:3px;max-width:100%!important;min-width:90px;width:auto}.c-uhfh.c-sgl-stck .c-search button{margin-top:0;padding-top:15px;padding-bottom:30px;width:auto}.c-uhfh.c-sgl-stck .c-search button:focus{color:#262626}}.c-uhfh .c-logo.c-cat-logo{margin-left:18px;position:relative}.c-uhfh .c-logo.c-cat-logo>span:before{bottom:15px;width:calc(100% - 16px)}.c-uhfh .c-logo.c-cat-logo>span:before{background:currentColor;content:"";display:none;height:2px;position:absolute}.c-uhfh .c-logo.c-cat-logo:focus>span:before,.c-uhfh .c-logo.c-cat-logo:hover>span:before{display:block}.c-uhfh .c-show-pipe{position:relative}.c-uhfh .c-show-pipe::before{border-left:2px solid #000;height:24px;content:" ";margin-left:7px;position:absolute;top:15px;left:0}.c-uhfh .c-uhfh-gcontainer-st{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.c-uhfh.c-sgl-stck .c-cat-logo{width:auto!important;white-space:nowrap}.c-uhfh.c-sgl-stck .c-cat-logo span{display:block;font-size:18px;font-weight:600;margin-top:-3px}.c-uhfh.c-sgl-stck .c-search button{white-space:nowrap}.c-uhfh.c-sgl-stck .c-search button::after{font-family:"MWF-MDL2";content:"";-ms-high-contrast-adjust:none;border:none;display:inline-block;font-size:16px;margin-left:2px;position:relative;text-indent:0;vertical-align:sub}.c-uhfh.c-sgl-stck .c-search button::before{background:currentColor;bottom:9px;content:""!important;display:none;height:2px;position:absolute;width:calc(100% - 40px)}.c-uhfh.c-sgl-stck .c-search button:hover:before,.c-uhfh.c-sgl-stck .c-search button:focus:before{display:block}@media only screen and (max-width:859px){.c-uhfh>div:first-child>div>div>.c-uhf-menu,.c-uhfh #meControl,.c-uhfh>div:first-child.f-opened .c-search,.c-uhfh>div:first-child.f-opened .glyph-shopping-cart,.c-uhfh>div:first-child.f-opened .glyph-shopping-bag,.c-uhfh>div:first-child.f-closed .c-me>.c-image,.c-uhfh>div:first-child.f-closed .f-mobile-title,.c-uhfh>div:first-child.f-closed nav,.c-uhfh>div:first-child.f-search-opened>div .c-logo,.c-uhfh>div:first-child.f-search-opened>div .c-me,.c-uhfh>div:first-child.f-search-opened>div .glyph-global-nav-button,.c-uhfh>div:first-child.f-search-opened>div .glyph-shopping-cart,.c-uhfh>div:first-child.f-search-opened>div .glyph-shopping-bag,.c-uhfh>div:first-child.f-search-opened>div nav,.c-uhfh>div:first-child>div .c-me>.c-image,.c-uhfh>div+div nav,.c-uhfh>div+div>div>.c-uhf-nav-link,.c-uhfh>div+div .c-logo,.c-uhfh>div+div .c-call-to-action,.c-uhfh>div+div .c-action-trigger,.c-uhfh>div+div .c-action-trigger[class*="glyph-chevron-"],.c-uhfh>div+div .c-action-trigger.glyph-chevron-left+.c-action-trigger{display:none}.c-uhfh .c-uhf-menu button:after,.c-uhfh li.f-sub-menu button:after{font-family:"MWF-MDL2";content:"";right:12px}.c-uhfh .c-uhf-menu{display:block}.c-uhfh .c-uhf-menu button{color:#262626}.c-uhfh .c-uhf-menu a:hover,.c-uhfh .c-uhf-menu a:focus,.c-uhfh .c-uhf-menu a[aria-expanded="true"],.c-uhfh .c-uhf-menu button:hover,.c-uhfh .c-uhf-menu button:focus,.c-uhfh .c-uhf-menu button[aria-expanded="true"]{background:transparent;color:#262626}.c-uhfh .c-uhf-menu a:focus:not(.x-hidden-focus),.c-uhfh .c-uhf-menu button:focus:not(.x-hidden-focus){outline-color:#000}.c-uhfh .c-uhf-nav-link{background:transparent}.c-uhfh a.c-uhf-nav-link{color:#000}.c-uhfh>div:first-child{padding:0;top:0;left:0;right:0;z-index:501}.c-uhfh>div:first-child.f-closed .glyph-shopping-cart,.c-uhfh>div:first-child.f-closed .glyph-shopping-bag,.c-uhfh>div:first-child.f-closed .c-search{display:block}.c-uhfh>div:first-child>div{margin:0}.c-uhfh>div:first-child .c-logo{float:none;display:block;position:absolute;left:calc(50% - 60px);height:auto;margin-top:1px;padding-top:11px}.c-uhfh>div:first-child .c-uhf-nav-link{display:inline-block;padding-top:16px;padding-right:8px;padding-bottom:16px;height:48px}.c-uhfh>div:first-child .c-uhf-menu{float:none;position:static}.c-uhfh>div:first-child nav{display:none;background:#fff;left:0;transition:all .3s ease-in;z-index:501}.c-uhfh>div:first-child nav>ul>li{display:block;text-align:left;height:50px;float:none;border-top:1px solid transparent;border-bottom:1px solid rgba(0,0,0,.1)}.c-uhfh .c-uhfh-actions{margin-right:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:1 0 auto;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end}.c-uhfh.c-sgl-stck.c-category-header{margin-bottom:34px}.c-uhfh.c-sgl-stck.c-category-header nav.c-uhfh-gnav{top:88px}.c-uhfh.c-sgl-stck .global-head-cont,.c-uhfh.c-sgl-stck>div:first-child{border-bottom:1px solid #e6e6e6;height:54px}.c-uhfh.c-sgl-stck .c-uhfh-gcontainer-st{position:relative;padding:2px 0}.c-uhfh.c-sgl-stck .c-logo.c-sgl-stk-uhfLogo{margin:1px;padding:12px 4px}.c-uhfh.c-sgl-stck .c-uhfh-actions{margin:0;justify-content:flex-start;-webkit-justify-content:flex-start;-ms-flex-pack:start}.c-uhfh.c-sgl-stck .c-uhfh-actions .wf-menu{padding:0}.c-uhfh.c-sgl-stck .c-uhfh-actions .c-search{margin:6px 0}.c-uhfh.c-sgl-stck .c-uhfh-actions .c-search button#search{left:1px;padding:8px 8px 8px 0;margin-left:2px}.c-uhfh.c-sgl-stck .c-uhfh-actions .c-search button#search:before{margin:0}.c-uhfh.c-sgl-stck .c-uhfh-actions .c-search button#search:after{vertical-align:baseline!important}.c-uhfh.c-sgl-stck .c-uhfh-actions .c-search button#search:focus{color:#000}.c-uhfh.c-sgl-stck nav{min-width:320px}.c-uhfh.c-sgl-stck nav.c-uhfh-gnav{padding-left:0}.c-uhfh.c-sgl-stck nav.c-uhfh-gnav::before{display:none}.c-uhfh.c-sgl-stck nav.c-uhfh-gnav{background:#f2f2f2;border-bottom:1px solid #000;position:absolute;width:100%}.c-uhfh.c-sgl-stck nav div.c-uhf-menu,.c-uhfh.c-sgl-stck nav ul,.c-uhfh.c-sgl-stck nav li,.c-uhfh.c-sgl-stck nav a,.c-uhfh.c-sgl-stck nav button{height:100%!important;max-width:100%;position:relative;width:100%;outline-offset:-3px}.c-uhfh.c-sgl-stck nav a,.c-uhfh.c-sgl-stck nav button{padding-left:15px;padding-top:10px}.c-uhfh.c-sgl-stck nav li{border-bottom:1px solid #e6e6e6!important}.c-uhfh.c-sgl-stck nav li:last-child{border-bottom:none!important}.c-uhfh.c-sgl-stck nav a.c-uhf-nav-link{padding-top:12px;padding-bottom:13px}.c-uhfh.c-sgl-stck nav button:after{right:20px;font-size:10px;font-weight:700;padding-left:7px;padding-top:7px}.c-uhfh.c-sgl-stck nav button[aria-expanded="false"]:after{font-family:"MWF-MDL2";content:""}}@media only screen and (max-width:1399px){.c-uhfh>div:first-child.f-search-opened>div nav,.c-uhfh>div:first-child .m-auto-suggest{display:none}.c-uhfh .c-search{min-width:0;width:0}.c-uhfh .c-search button{position:absolute;margin-left:6px}}@media only screen and (min-width:860px) and (max-width:1083px){.c-uhfh>div:first-child{padding-left:24px;padding-right:24px}}@media only screen and (min-width:860px) and (max-width:1399px){.c-uhfh .c-search{min-width:45px!important}}@media only screen and (max-width:1399px){.c-uhfh .c-search{min-width:0;width:0}}@media only screen and (max-width:859px){.x-hidden-vp-mobile-st{display:none!important}}@keyframes slideup{from{height:50px}to{height:0}}@keyframes slidedown{from{height:0}to{height:54px}}@media screen and (min-width:860px){.context-uhf li{word-break:break-word}.c-uhf-menu>button{border:1px solid transparent;display:inline-block;margin-top:1px;z-index:701;outline-offset:-2px}.c-uhf-menu>button:after{right:15px}.theme-light .c-uhf-menu>button{color:rgba(0,0,0,.8)}.theme-light .c-uhf-menu>button:hover,.theme-dark .theme-light .c-uhf-menu>button:hover{color:#000}.theme-light .c-uhf-menu>button:focus:not(.x-hidden-focus),.theme-dark .theme-light .c-uhf-menu>button:focus:not(.x-hidden-focus){outline-color:#000}.theme-light .c-uhf-nav-link:focus:not(.x-hidden-focus){outline-color:#000}.c-uhfh .c-uhf-nav-link:before,.c-uhfh .c-uhf-menu>button[aria-expanded="false"]:before,.c-uhfh>div+div .c-logo:not(.f-image):before{background:currentColor;content:"";display:none;height:2px;position:absolute}.c-uhfh .c-uhf-nav-link:hover:before,.c-uhfh .c-uhf-nav-link:focus:before,.c-uhfh .c-uhf-menu>button[aria-expanded="false"]:hover:before,.c-uhfh .c-uhf-menu>button[aria-expanded="false"]:focus:before,.c-uhfh>div+div .c-logo:not(.f-image):hover:before,.c-uhfh>div+div .c-logo:not(.f-image):focus:before{display:block}.c-uhfh a,.c-uhfh button{white-space:normal}.c-uhfh>div{padding:0 5%}.c-uhfh>div nav{overflow:hidden;height:100%;white-space:nowrap;padding-left:2px;padding-right:1px}.c-uhfh>div:first-child{font-size:13px!important;height:54px;margin-bottom:2px;z-index:502}.c-uhfh>div:first-child>div{position:relative}.c-uhfh>div:first-child nav>ul>li{display:inline-block}.c-uhfh>div:first-child nav>ul>li>div{position:static!important}.c-uhfh>div:first-child .c-logo{padding:16px 6px 16px 10px;float:left;height:100%;margin-top:1px;width:137px;outline-offset:-2px}.c-uhfh>div:first-child .c-uhf-nav-link{border:1px solid transparent;color:#262626;display:inline-block;margin-top:1px;padding:16px 8px 10px;height:48px;outline-offset:-2px}.c-uhfh>div:first-child .c-uhf-nav-link:before{bottom:9px;width:calc(100% - 16px)}.c-uhfh>div:first-child .c-uhf-menu a,.c-uhfh>div:first-child .c-uhf-menu button{color:#262626}.c-uhfh>div:first-child .c-uhf-menu>button{white-space:nowrap}.c-uhfh>div:first-child .c-uhf-menu>button:before{bottom:12px;width:calc(100% - 42px)}.c-uhfh>div:first-child .c-uhf-menu>button:hover,.c-uhfh>div:first-child .c-uhf-menu>button:focus{background:#fff}}@media screen and (min-width:860px){.c-uhfh>[class*="theme-"]{background:#fff}.c-uhfh>[class*="theme-"] .c-logo,.c-uhfh>[class*="theme-"] .c-uhf-nav-link,.c-uhfh>[class*="theme-"] .c-uhf-menu button{color:#262626}.c-uhfh>[class*="theme-"] .c-logo:hover,.c-uhfh>[class*="theme-"] .c-logo:focus,.c-uhfh>[class*="theme-"] .c-uhf-nav-link:hover,.c-uhfh>[class*="theme-"] .c-uhf-nav-link:focus,.c-uhfh>[class*="theme-"] .c-uhf-menu>button:hover,.c-uhfh>[class*="theme-"] .c-uhf-menu>button:focus{background:transparent}.c-uhfh .c-uhf-menu [aria-expanded]{position:relative;z-index:701}.c-uhfh .c-uhf-menu [aria-expanded]:focus:not(.x-hidden-focus),.c-uhfh .c-uhf-menu a:focus:not(.x-hidden-focus),.c-uhfh li.f-sub-menu [aria-expanded]:focus:not(.x-hidden-focus),.c-uhfh li.f-sub-menu a:focus:not(.x-hidden-focus){z-index:702}}@media screen and (min-width:860px){.c-me{float:left;padding-top:3px}.c-uhfh-gnav{float:left;-webkit-box-flex:1;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto}.c-uhfh-actions{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1 0 auto;-ms-flex:1 0 auto;flex:none;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}}@media only screen and (min-width:1400px){.c-uhfh.c-sgl-stck .js-paddle-items>li:last-child>div>button{margin-right:0}.c-uhfh.c-sgl-stck .c-search button[aria-expanded="false"]{position:relative}}@media only screen and (min-width:1779px){.c-uhfh>div:first-child .c-search button{margin-right:1px!important}.c-uhfh .c-uhf-nav-link{margin-left:4px!important;margin-right:4px!important}.c-uhfh .c-uhfh-gnav button{margin-right:-6px!important}.c-uhfh .c-uhf-menu>button{padding:16px 30px 16px 16px}.c-uhfh .c-uhf-menu>button:before{width:calc(100% - 45px)!important}.c-uhfh .c-logo.c-cat-logo{padding-right:10px!important;margin-left:32px}.c-uhfh .c-show-pipe::before{padding-left:24px}}.c-uhff{background:#f2f2f2;margin-top:48px}.c-uhff-nav{margin:0 auto;max-width:calc(1600px + 10%);padding:0 5%}.c-uhff-nav:before,.c-uhff-nav:after{content:" ";display:table}.c-uhff-nav:after{clear:both}.c-uhff-nav .c-heading-4{font-size:15px;line-height:20px}.c-uhff-nav .c-heading-4,.c-uhff-nav a.c-uhff-link{color:#616161;word-break:break-word}.c-uhff-nav-group{display:block;float:left;min-height:1px;vertical-align:text-top;padding:0 12px;width:16.6666666667%;zoom:1}.c-uhff-nav-group ul.c-list{font-size:11px;line-height:16px;margin-top:0}.c-uhff-nav-group:first-child{padding-left:0}.c-uhff-base{background:#f2f2f2;margin:0 auto;max-width:calc(1600px + 10%);padding:30px 5% 16px}.c-uhff-base:before,.c-uhff-base:after{content:" ";display:table}.c-uhff-base:after{clear:both}.c-uhff-base .c-uhff-ccpa{display:flex;font-size:11px;line-height:16px;padding-right:24px;padding-top:4px;color:#616161;float:left}.c-uhff-base .c-uhff-ccpa svg{padding-right:8px;height:16px}.c-uhff-base ul.c-list{font-size:11px;line-height:16px;float:right;margin:3px 0;color:#616161}.c-uhff-base ul.c-list li{padding:0 24px 4px 0;display:inline-block}@media only screen and (max-width:1083px){.c-uhff-nav{padding:0 12px}.c-uhff-nav-row:before,.c-uhff-nav-row:after{content:" ";display:table}.c-uhff-nav-row:after{clear:both}.c-uhff-nav-group{width:33.33333%}.c-uhff-nav-group:first-child{padding-left:12px}.c-uhff-base{display:flex;flex-wrap:wrap;flex-direction:column;padding:30px 24px 16px}.c-uhff-base>a.c-uhff-link{margin-right:auto}.c-uhff-base .c-uhff-ccpa{margin:8px 0 16px 0}}@media only screen and (max-width:767px){.c-uhff-base>a.c-uhff-link{width:100%}.c-uhff-base>a.c-uhff-link{float:none}.c-uhff-base ul.c-list{width:100%;float:none;text-align:left;margin-top:12px}.c-uhff-base ul.c-list li{padding:6px 4px 0 6px}}@media only screen and (max-width:539px){.c-uhff-nav-row{width:100%;float:none}.c-uhff-base ul.c-list{float:left}.c-uhff-base ul.c-list li{padding:6px 10px 0 0}.c-uhff-nav-group{width:100%}}@supports (-ms-ime-align:auto){a.c-uhff-link{display:inline-block}}a.c-uhff-link:focus{outline:1px dashed;outline-offset:3px}a.c-uhff-link:focus,a.c-uhff-link:hover{color:rgba(0,0,0,.9);text-decoration:underline}a.c-uhff-link:active{background:none;color:rgba(0,0,0,.8)}</style>
<div class="hfeed site" id=page data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<main class=site-main id=main role=main data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<div class="alert-banner open" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=banner-inner-wrapper data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=banner-content-wrapper data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=banner-title data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Conf 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET会议2023 </font></font></font></span>
 <span class=banner-body data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The biggest .NET virtual event is back, November 14-16!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>最大的.NET虚拟活动回来了，11月14日至16日！ </font></font></font></span>
 </div>
 <div class=banner-button-wrapper data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=banner-button href=https://www.dotnetconf.net/ target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=banner-button-text data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Save The Date <font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>保存The Date </font></font></font><i class="fabric-icon fabric-icon--ChevronRight x-hidden-focus" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></span>
 </a>
 </div>
 </div>
 <div class=banner-close-wrapper data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class=banner-close href=https://www.dotnetconf.net/>
 <span class=banner-close-text>Close <i class="fabric-icon fabric-icon--Stop x-hidden-focus"></i></span>
 </button>
 </div>
</div><div class=wrapper id=single-wrapper data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=container id=content tabindex=-1 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=row id=mainContent data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 
<div class="col-md content-area" id=primary data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <article class=addtoanyshare id=post-33921 data-bi-id=body data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<div class="row justify-content-center postcontent" id=featured data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="entry-content col-12 sharepostcontent" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <h1 class=entry-title style=margin-bottom:15px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Performance Improvements in .NET 6<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET 6中的性能改进 </font></font></font></h1> <div class="row justify-content-center author-header" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><div class=col-md-4 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><div class=post-detail-avatar-section data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><div class=post-detail-avatar data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467> <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=58&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAOgA6AwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A9fm8SaX4Lhg0HSY1tLVY4/tVwlr5uwFiN2cj5iRyfTNcF8bI9ZufDlosdzLPpm77SZYINhiYSfK0efulsnoa+rvB3wYh0yC4fVLl9XmulQs91Gu5ePmUYGAOeB2ryz9u/WLX4Tfs8XF3p1raxXVzew2EM80YZoQysxZM9DtQgHtnjnFcvK2rFpdD4K1r4hWVlrFw1/bjxDcBw0c1+ziTOOd+GG4jpg+n4CnN8cnF8k1to9hBOuQm1CQMjH3c7e/pXlnhPT7nxbfzXYZ5A0mxW6jpnFe1+DPhpbxwozxpLKTyzcn8+1ZOp7PQ9Whg/bJWItF+KlldaK/h3WNGSC2Zt8N7aZE8T5yH5OGwex/Ov0L/AGWvEU3iH4WJrc2rm8hto2hvIFYERMg+8B15GG5r4Q8VfDdvssc0EA3KOWA7981H8GfjDrXwh8T6joUZlaz1q2NtJbZIIY5CkY/iDHg+jGs1WTeiHWwLpLU++vFusQX0trc6dG9/rN7A0OnWO0mZoQxJc8HYWYjk4GBWLB4R+K7wRtdXki3RUGULegAPj5sAJwM5r2T4J+HLPwp4UfV7z/kJ3MK3F3PcHMiDbnaT2C9APasKX9rb4V+Y/wDxUMEnJ+dIXZW9wQOR71bk3seco9jyG/8A+CjvgqK3d9P8N65eSD7gkEMan6kOxH5V8vftY/tL6r+074CGkJo0OjaPZT/aTapN58082MRkNtGMAycDrk5PSvnqO6vp1ZEdGyeFU4wK3/A3iqLS9autJnsJZnvYgbeaJQwWRMnnPTgnn613VIKMbx3DDNSqqM9nf8jd8LfD19M+G1jbWaj7Q0QmmAJyzEZIyOaxvCml65beILd7SN7BmmEb+QXVWXPG4EYP/wBavTYdd/4R7SrZbdfOZYQpY9AAOuKw7X4npY3sd/fwefau42NCAFTGck+vbpXluUrtH1FOlStFt2sP8VfEPxN4a8YSaJFMEtlIDyNaednKg5PP9K4v4hajfQ/Ebw1dWkSwXD6WLh3jXYPMWWQb+en3Rj8K9rXxZ4a8V+MNMkutKWRJIExcsgDpKDj8RgL+teS/tDXzW/j1ZrK3WR1tUjKs2CEBOAB2+beevPFKjadRRaMcenTpOfNub03xu+I939pa48V6mhuU2XCi9ZFkXGMFV4Iwe4rkYfEmrW0McUd5cJHGoVVWU4AHAA5rgT45WJDHdI0Ug7uCp/8Ar1AfiLag4yD77P8A69e1aK6HyV5E9/rjJclUneLZjAZiT9ckn9Kl+ETGH4lzSzkyyvC+13O4gED1+prB1RPtMQCkM2N0bDofxpfh/q40/wAXafdM52uWt23dQSMj9Rj8a+hx6vQmkuh4+Wu2IhJvqj2afxOum6zLYyMBGz/uy3TB6j+dac/hiJ5UNlpreXKckWzlRk9xiuN8T6AdTuJJEkKlvmBB6VJ4Ni8YC8his9TCWyHB8xckV8PJRa5kz9Bp1pUpOMldHoV5Dp/hHUYb957u6uVgG2O4fcVxyAP8T6185/EbxX4qTXZ77X9s73GFjnWPahRRwq4Hb0Izz71o6p4um1n4jajqQvZLuyW2Mcbs/DKH2lh6bipb6EelWdG8UMNP+zXKR3dnKxAhnXepTJ6g8d+K+hwWWQ9lzyfvvqfKZjmtSdZxivcXTz7nlkuuSvExEjKH52thgP8A69aSeL7VUUGyQkDGcV3PjDwZpt9ZQ3enWIjgZivlIMEMFBIBHJAyOv8ASvPm8HsrEbp+DjhRj+dYVKcqU3CXQKc41YqcTpLEvGXtZRtGcAH+Bvb2P6Hj0rL1SzkWdZYCY2f5sr1V15B/MV096obRjIQDJ5Wd569M9az7ocH/AK7f+y19ROCa5WfNU5tPmR2XhT4h22t2MdtduLbUowAyn7snuv8AhWj4m8dw+H/CeoWNjcCTVL5TGuw5MKNwzZ7HGcfn2rwvVBsMhX5SJDgjtV3QZpLi1laV2kbcBlzk9DXzf9n05Vlrp2Pqf7Rqqg++1xLHzbHTonTLbGdSAeq9GH4cGtazugbS0CE48sdfqax7gkaUcH/lvJ/IVYsjtt4ccfu+1e3T912XY8Ca5k2z1nwrdSaro72drGst8n+kW+5QcsM5A+qbv0qF/D2ps7F5NNVyfmUlMg9+1UvhQ7J4itdrFcIMYPTg17MwwxrhxyTlGXkdeBfuyj2Z/9k=" data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=116&amp;d=mm&amp;r=g 2x" class="avatar avatar-58 photo lazyloaded" height=58 width=58 decoding=async srcset data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 sizes></div><p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT</p></div></div></div><div style=clear:both;padding-bottom:10px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></div> <div class="entry-meta entry-meta-layout" style=text-align:center data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p style="text-align:center;font-size:14px;color:#616161;margin-top:20px;padding-top:6px;border-top:2px solid #979593;display:inline-block" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17th, 2021<span class=entry-meta-comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a data-bi-id=body data-bi-name=jump-to-comments href=#comments aria-label="click to comments" title="Jump to comments" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Message" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i>93</a></span><span class=entry-meta-comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=post-like id=postLike-33921 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=x-hidden-focus aria-label="Login to like, vote count 6" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F" data-bi-id=body data-bi-name="Login to like" data-original-title="Login to like" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1504 128q113 0 212 43t173 116 116 173 43 212q0 109-41 209t-118 176l-865 864-865-864Q83 981 42 881T0 672q0-112 42-211t117-173 173-117 212-43q83 0 148 19t120 52 106 81 106 103q55-56 105-103t106-80 121-53 148-19zm294 838q59-59 90-135t31-159q0-87-32-162t-88-131-132-87-163-32q-84 0-149 26t-120 70-105 97-106 111q-54-54-105-109t-106-99-121-72-148-28q-86 0-162 32t-132 89-89 133-33 162q0 83 31 159t91 135l774 774 774-774z"></path></svg><span data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467> 6</span></a></span></span></span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 2021年8月17日93 6</font></font></font></p>
 </div>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Four years ago, around the time .NET Core 2.0 was being released, I wrote <a href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-core/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Performance Improvements in .NET Core</a> to highlight the quantity and quality of performance improvements finding their way into .NET. With its very positive reception, I did so again a year later with <a href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-core-2-1/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Performance Improvements in .NET Core 2.1</a>, and an annual tradition was born. Then came <a href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-core-3-0/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Performance Improvements in .NET Core 3.0</a>, followed by <a href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-5/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Performance Improvements in .NET 5</a>. Which brings us to today.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>四年前，大约在.NET Core 2.0发布的时候，我写了.NET Core中的性能改进，以突出性能改进的数量和质量。凭借其非常积极的反响，我在一年后再次在.NET Core 2.1中进行了性能改进，并且每年一度的传统诞生了。然后是.NET Core 3.0的性能改进，然后是.NET 5的性能改进。这就引出了今天。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <a href=https://github.com/dotnet/runtime target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime</a> repository is the home of .NET’s runtimes, runtime hosts, and core libraries. Since its main branch forked a year or so ago to be for .NET 6, there have been over 6500 merged PRs (pull requests) into the branch for the release, and that’s excluding automated PRs from bots that do things like flow dependency version updates between repos (not to discount the bots’ contributions; after all, they’ve actually received interview offers by email from recruiters who just possibly weren’t being particularly discerning with their candidate pool). I at least peruse if not review in depth the vast majority of all those PRs, and every time I see a PR that is likely to impact performance, I make a note of it in a running log, giving me a long list of improvements I can revisit when it’s blog time. That made this August a little daunting, as I sat down to write this post and was faced with the list I’d curated of almost 550 PRs. Don’t worry, I don’t cover all of them here, but grab a large mug of your favorite hot beverage, and settle in: this post takes a rip-roarin’ tour through ~400 PRs that, all together, significantly improve .NET performance for .NET 6.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>dotnet/runtime存储库是.NET的运行时、运行时主机和核心库的所在地。自从一年前它的主分支为.NET 6以来，已经有超过6500个合并PR（pull request）进入了该版本的分支，这还不包括来自机器人的自动PR，这些机器人会在repos之间执行流依赖版本更新（不是为了贬低机器人的贡献;毕竟，他们实际上已经收到了招聘人员的电子邮件，而这些招聘人员可能对他们的候选人并不特别挑剔）。我至少仔细阅读，如果没有深入审查所有这些PR的绝大多数，每次我看到可能影响性能的PR，我都会在运行日志中记录下来，给我一长串改进，我可以在博客时间重新审视。这让今年八月有点令人生畏，当我坐下来写这篇文章时，面对着我策划的近550个公关列表。 别担心，我不会在这里一一介绍，但你可以拿一大杯你最喜欢的热饮，然后安顿下来：这篇文章对大约400个PR进行了一次Rip-roarin'之旅，所有这些PR一起显著提高了.NET 6的.NET性能。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Please enjoy!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>请尽情享用！ </font></font></font></p>
<h3 id=table-of-contents data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Table Of Contents<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>目录 </font></font></font><a aria-labelledby=table-of-contents class=linkicon href=#table-of-contents data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#benchmarking-setup data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Benchmarking Setup<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 基准测试设置</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#jit data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JIT</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#gc data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GC</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#threading data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Threading<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 螺纹</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#system-types data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>System Types<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 系统类型</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#arrays-strings-spans data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Arrays, Strings, Spans<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 数组、字符串、跨度</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#buffering data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Buffering<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 缓冲</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#io data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IO</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#networking data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Networking<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 联网</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#reflection data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Reflection<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 反射</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#collections-and-linq data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Collections and LINQ<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 收藏和LINQ</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#cryptography data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Cryptography<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 密码学</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#peanut-butter data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“Peanut Butter”<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 花生酱</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#json data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JSON</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#interop data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Interop</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#startup data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Startup<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 启动</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#tracing data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Tracing<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 追踪</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#size data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Size<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 大小</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#blazor-and-mono data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Blazor and mono<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Blazor和mono</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=#is-that-all data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Is that all?<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 就这些吗</font></font></font></a></li>
</ul>
<h3 id=benchmarking-setup data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Benchmarking Setup<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>基准测试设置 </font></font></font><a aria-labelledby=benchmarking-setup class=linkicon href=#benchmarking-setup data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As in previous posts, I’m using <a href=https://github.com/dotnet/benchmarkdotnet target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>BenchmarkDotNet</a> for the majority of the examples throughout. To get started, I created a new console application:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>和之前的文章一样，我在整个过程中使用BenchmarkDotNet的大部分示例。为了开始，我创建了一个新的控制台应用程序：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> console </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>o net6perf
cd net6perf</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and added a reference to the <a href=https://www.nuget.org/packages/BenchmarkDotNet/ target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>BenchmarkDotNet nuget package</a>:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>并添加了对BenchmarkDotNet nuget包的引用：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>package</span></span><span class=pln><span class=pln> benchmarkdotnet</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>That yielded a net6perf.csproj, which I then overwrote with the following contents; most importantly, this includes multiple target frameworks so that I can use BenchmarkDotNet to easily compare performance on them:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这就产生了net6perf.csproj，然后我用下面的内容覆盖了它;最重要的是，这包括多个目标框架，这样我就可以使用BenchmarkDotNet轻松比较它们的性能： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-xml prettyprinted"><span class=tag><span class=tag>&lt;Project</span></span><span class=pln><span class=pln> </span></span><span class=atn><span class=atn>Sdk</span></span><span class=pun><span class=pun>=</span></span><span class=atv><span class=atv>"Microsoft.NET.Sdk"</span></span><span class=tag><span class=tag>&gt;</span></span><span class=pln><span class=pln>

  </span></span><span class=tag><span class=tag>&lt;PropertyGroup&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;OutputType&gt;</span></span><span class=pln><span class=pln>Exe</span></span><span class=tag><span class=tag>&lt;/OutputType&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;TargetFrameworks&gt;</span></span><span class=pln><span class=pln>net48;netcoreapp2.1;netcoreapp3.1;net5.0;net6.0</span></span><span class=tag><span class=tag>&lt;/TargetFrameworks&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;Nullable&gt;</span></span><span class=pln><span class=pln>annotations</span></span><span class=tag><span class=tag>&lt;/Nullable&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;AllowUnsafeBlocks&gt;</span></span><span class=pln><span class=pln>true</span></span><span class=tag><span class=tag>&lt;/AllowUnsafeBlocks&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;LangVersion&gt;</span></span><span class=pln><span class=pln>10</span></span><span class=tag><span class=tag>&lt;/LangVersion&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;ServerGarbageCollection&gt;</span></span><span class=pln><span class=pln>true</span></span><span class=tag><span class=tag>&lt;/ServerGarbageCollection&gt;</span></span><span class=pln><span class=pln>
  </span></span><span class=tag><span class=tag>&lt;/PropertyGroup&gt;</span></span><span class=pln><span class=pln>

  </span></span><span class=tag><span class=tag>&lt;ItemGroup&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;PackageReference</span></span><span class=pln><span class=pln> </span></span><span class=atn><span class=atn>Include</span></span><span class=pun><span class=pun>=</span></span><span class=atv><span class=atv>"benchmarkdotnet"</span></span><span class=pln><span class=pln> </span></span><span class=atn><span class=atn>Version</span></span><span class=pun><span class=pun>=</span></span><span class=atv><span class=atv>"0.13.1"</span></span><span class=pln><span class=pln> </span></span><span class=tag><span class=tag>/&gt;</span></span><span class=pln><span class=pln>
  </span></span><span class=tag><span class=tag>&lt;/ItemGroup&gt;</span></span><span class=pln><span class=pln>

  </span></span><span class=tag><span class=tag>&lt;ItemGroup</span></span><span class=pln><span class=pln> </span></span><span class=atn><span class=atn>Condition</span></span><span class=pun><span class=pun>=</span></span><span class=atv><span class=atv>" '$(TargetFramework)' == 'net48' "</span></span><span class=tag><span class=tag>&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;Reference</span></span><span class=pln><span class=pln> </span></span><span class=atn><span class=atn>Include</span></span><span class=pun><span class=pun>=</span></span><span class=atv><span class=atv>"System.Net.Http"</span></span><span class=pln><span class=pln> </span></span><span class=tag><span class=tag>/&gt;</span></span><span class=pln><span class=pln>
  </span></span><span class=tag><span class=tag>&lt;/ItemGroup&gt;</span></span><span class=pln><span class=pln>

</span></span><span class=tag><span class=tag>&lt;/Project&gt;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I then updated the generated Program.cs to contain the following boilerplate code:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然后，我更新了生成的Program.cs，以包含以下样板代码： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkDotNet</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Attributes</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkDotNet</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Running</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkDotNet</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Columns</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkDotNet</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Configs</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkDotNet</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Reports</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkDotNet</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Order</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Perfolizer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Horology</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Buffers</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Buffers</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Binary</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Buffers</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Collections</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Collections</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Concurrent</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Collections</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Generic</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Collections</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Immutable</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Collections</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ObjectModel</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Diagnostics</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CodeAnalysis</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Diagnostics</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Diagnostics</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tracing</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Globalization</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>IO</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Linq</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Net</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Net</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Http</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Net</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sockets</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Net</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WebSockets</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Numerics</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Reflection</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Runtime</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompilerServices</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Runtime</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InteropServices</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Security</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Cryptography</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Security</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Cryptography</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>X509Certificates</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Threading</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Threading</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tasks</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>IO</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Compression</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=com><span class=com>#if NETCOREAPP3_0_OR_GREATER</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Encodings</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Web</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Json</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Json</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Serialization</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=com><span class=com>#endif</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>DisassemblyDiagnoser</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>maxDepth</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln> </span></span><span class=com><span class=com>// change to 0 for just the [Benchmark] method</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MemoryDiagnoser</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>displayGenColumns</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Main</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> args</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>BenchmarkSwitcher</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FromAssembly</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Assembly</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>args</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DefaultConfig</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Instance</span></span><span class=pln><span class=pln>
            </span></span><span class=com><span class=com>//.WithSummaryStyle(new SummaryStyle(CultureInfo.InvariantCulture, printUnitsInHeader: false, SizeUnit.B, TimeUnit.Microsecond))</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=com><span class=com>// BENCHMARKS GO HERE</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>With minimal friction, you should be able to copy and paste a benchmark from this post to where it says <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=com>// BENCHMARKS GO HERE</span></code>, and run the app to execute the benchmarks. You can do so with a command like this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在最小的摩擦下，你应该能够从这篇文章中复制并粘贴一个基准测试到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=com>// BENCHMARKS GO HERE</span></code> 的位置，然后运行应用程序来执行基准测试。你可以使用这样的命令来执行：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet run </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>f net48 </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>filter </span></span><span class=str><span class=str>"**"</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>--</span></span><span class=pln><span class=pln>runtimes net48 net5</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln> net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This tells BenchmarkDotNet:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这告诉BenchmarkDotNet： </font></font></font></p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Build everything in a release configuration,<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在发布配置中构建所有内容， </font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>build it targeting the .NET Framework 4.8 surface area,<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>针对.NET Framework 4.8外围区域构建它， </font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>don’t exclude any benchmarks,<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>不要排除任何基准， </font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and run each benchmark on each of .NET Framework 4.8, .NET 5, and .NET 6.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>并在.NET Framework 4.8、.NET 5和.NET 6上运行每个基准测试。 </font></font></font></li>
</ul>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In some cases, I’ve added additional frameworks to the list (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>netcoreapp3</span><span class=pun>.</span><span class=lit>1</span></code>) to highlight cases where there’s a continuous improvement release-over-release. In other cases, I’ve only targeted .NET 6.0, such as when highlighting the difference between an existing API and a new one in this release. Most of the results in the post were generated by running on Windows, primarily so that .NET Framework 4.8 could be included in the result set. However, unless otherwise called out, all of these benchmarks show comparable improvements when run on Linux or on macOS. Simply ensure that you have installed each runtime you want to measure. I’m using a <a href=https://github.com/dotnet/installer/blob/main/README.md#installers-and-binaries target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>nightly build of .NET 6 RC1</a>, along with the latest <a href=https://dotnet.microsoft.com/download target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>released downloads</a> of .NET 5 and .NET Core 3.1.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在某些情况下，我已经在列表中添加了额外的框架（例如： <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>netcoreapp3</span><span class=pun>.</span><span class=lit>1</span></code> ）强调了在发布中不断改进的情况。在其他情况下，我只针对.NET 6.0，例如在此版本中突出现有API和新API之间的区别时。文章中的大多数结果都是在Windows上运行生成的，主要是为了使.NET Framework 4.8可以包含在结果集中。然而，除非另有说明，所有这些基准测试在Linux或macOS上运行时都显示出相当的改进。只需确保安装了要测量的每个运行时即可。我正在使用.NET 6 RC1的夜间构建，沿着最新发布的.NET 5和.NET Core 3.1下载。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Final note and standard disclaimer: microbenchmarking can be very subject to the machine on which a test is run, what else is going on with that machine at the same time, and sometimes seemingly the way the wind is blowing. Your results may vary.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>最后说明和标准免责声明：微基准测试很可能取决于运行测试的机器，同时该机器还发生了什么，有时候看起来似乎是风向。您的结果可能会有所不同。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s get started…<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我们开始吧。。 </font></font></font></p>
<h3 id=jit data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JIT<a aria-labelledby=jit class=linkicon href=#jit data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code generation is the foundation on top of which everything else is built. As such, improvements to code generation have a multiplicative effect, with the power to improve the performance of all code that runs on the platform. .NET 6 sees an unbelievable number of performance improvements finding their way into the JIT (just-in-time compiler), which is used to translate IL (intermediate language) into assembly code at run-time, and which is also used for AOT (ahead-of-time compilation) as part of <a href=https://devblogs.microsoft.com/dotnet/conversation-about-crossgen2/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Crossgen2</a> and the <a href=https://github.com/dotnet/runtime/blob/main/docs/design/coreclr/botr/readytorun-overview.md target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>R2R format (ReadyToRun)</a>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>代码生成是构建其他一切的基础。因此，对代码生成的改进具有倍增效应，具有提高在平台上运行的所有代码的性能的能力。.NET 6看到了令人难以置信的数量的性能改进发现了JIT（即时编译器），它用于在运行时将IL（中间语言）翻译成汇编代码，并且它也用于AOT（提前编译），作为Crossgen2和R2R格式（ReadyToRun）的一部分。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Since it’s so foundational to good performance in .NET code, let’s start by talking about inlining and devirtualization. “Inlining” is the process by which the compiler takes the code from a method callee and emits it directly into the caller. This avoids the overhead of the method call, but that’s typically only a minor benefit. The major benefit is it exposes the contents of the callee to the context of the caller, enabling subsequent (“knock-on”) optimizations that wouldn’t have been possible without the inlining. Consider a simple case:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>由于它是.NET代码中良好性能的基础，让我们从内联和去虚拟化开始。“内联”是编译器从方法被调用者获取代码并将其直接发送到调用者的过程。这避免了方法调用的开销，但这通常只是一个小好处。最大的好处是，它将被调用者的内容公开给调用者的上下文，从而实现后续的（“敲入”）优化，而没有内联是不可能实现的。考虑一个简单的例子： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Compute</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ComputeValue</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>123</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>11</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ComputeValue</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> length</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> length </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Here we have a method, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code>, which just takes an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> and multiplies it by 7, returning the result. This method is simple enough to always be inlined, so for demonstration purposes I’ve used <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodImplOptions</span><span class=pun>.</span><span class=typ>NoInlining</span></code> to tell the JIT to not inline it. If I then look at what assembly code the JIT produces for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Compute</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code>, we get something like this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这里我们有一个方法， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code> ，它只接受一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> ，然后乘以7，返回结果。这个方法非常简单，可以始终内联，所以为了演示的目的，我使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodImplOptions</span><span class=pun>.</span><span class=typ>NoInlining</span></code> 告诉JIT不要内联它。如果我再看看JIT为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Compute</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code> 生成的汇编代码，我们会得到这样的结果：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Compute</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>7B</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ComputeValue</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       imul      eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0B</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ComputeValue</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       imul      eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>7</span></span><span class=pln><span class=pln>
       ret</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Compute</span></code> loads the value <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>123</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x7b</span></code> in hex) into the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>ecx</span></code> register, which holds the argument to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code>, calls <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code>, then takes the result (from the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>eax</span></code> register) and multiples it by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>11</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0xb</span></code> in hex), returning that result. We can see <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code> in turn takes the input from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>ecx</span></code> and multiplies it by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>7</span></code>, storing the result into <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>eax</span></code> for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Compute</span></code> to consume. Now, what happens if we remove the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NoInlining</span></code>:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Compute</span></code> 将值 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>123</span></code> （十六进制为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x7b</span></code> ）加载到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>ecx</span></code> 寄存器中，该寄存器保存 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code> 的参数，调用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code> ，然后获取结果（来自 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>eax</span></code> 寄存器）并将其乘以 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>11</span></code> （十六进制为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0xb</span></code> ），返回该结果。我们可以看到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ComputeValue</span></code> 依次从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>ecx</span></code> 获取输入，并将其乘以 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>7</span></code> ，将结果存储到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>eax</span></code> 中，供 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Compute</span></code> 使用。现在，如果我们删除 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NoInlining</span></code> 会发生什么：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Compute</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>24FF</span></span><span class=pln><span class=pln>
       ret</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The multiplications and method calls have evaporated, and we’re left with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Compute</span></code> simply returning the value <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x24ff</span></code>, as the JIT has computed at compile-time the result of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>(</span><span class=lit>123</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>7</span><span class=pun>)</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>11</span></code>, which is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>9471</span></code>, or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x24ff</span></code> in hex. In other words, we didn’t just save the method call, we also transformed the entire operation into a constant. Inlining is a very powerful optimization.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>乘法和方法调用已经消失了，我们只剩下 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Compute</span></code> 简单地返回值 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x24ff</span></code> ，因为JIT在编译时计算了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>(</span><span class=lit>123</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>7</span><span class=pun>)</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>11</span></code> 的结果，也就是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>9471</span></code> 或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x24ff</span></code> 十六进制。换句话说，我们不仅保存了方法调用，还将整个操作转换为常量。内联是一个非常强大的优化。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course, you also need to be careful with inlining. If you inline too much, you bloat the code in your methods, potentially very significantly. That can make microbenchmarks look very good in some circumstances, but it can also have some bad net effects. Let’s say all of the code associated with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Int32</span><span class=pun>.</span><span class=typ>Parse</span></code> is 1,000 bytes of assembly code (I’m making up that number for explanatory purposes), and let’s say we forced it to all always inline. Every call site to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Int32</span><span class=pun>.</span><span class=typ>Parse</span></code> will now end up carrying a (potentially optimized with knock-on effects) copy of the code; call it from 100 different locations, and you now have 100,000 bytes of assembly code rather than 1,000 that are reused. That means more memory consumption for the assembly code, and if it was AOT-compiled, more size on disk. But it also has other potentially deleterious affects. Computers use very fast and limited size instruction caches to store code to be run. If you have 1000 bytes of code that you invoke from 100 different places, each of those places can potentially reuse the bytes previously loaded into the cache. But give each of those places their own (likely mutated) copy, and as far as the hardware is concerned, that’s different code, meaning the inlining can result in code actually running slower due to forcing more evictions and loads from and to that cache. There’s also the impact on the JIT compiler itself, as the JIT has limits on things like the size of a method before it’ll give up on optimizing further; inline too much code, and you can exceed said limits.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当然，您也需要小心内联。如果内联太多，就会使方法中的代码膨胀，这可能非常严重。在某些情况下，这会使微基准测试看起来非常好，但也会产生一些坏的净效应。假设与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Int32</span><span class=pun>.</span><span class=typ>Parse</span></code> 相关的所有代码都是1，000字节的汇编代码（我将这个数字用于解释），假设我们强制它总是内联。现在，每个调用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Int32</span><span class=pun>.</span><span class=typ>Parse</span></code> 的站点都将携带一个代码副本（潜在的优化与连锁效应）;从100个不同的位置调用它，现在您有100，000字节的汇编代码，而不是1，000字节的可重用。这意味着汇编代码会消耗更多的内存，如果是AOT编译的，磁盘上的容量会更大。但它也有其他潜在的有害影响。计算机使用非常快和有限大小的指令高速缓存来存储要运行的代码。 如果您有1000字节的代码从100个不同的位置调用，那么这些位置中的每一个都可能重用先前加载该高速缓存中的字节。但是，给予这些地方各自的（可能是变异的）副本，就硬件而言，这是不同的代码，这意味着内联会导致代码实际上运行得更慢，因为强制更多的驱逐和加载来自缓存。这也是对JIT编译器本身的影响，因为JIT在给予进一步优化之前对方法的大小有限制;内联太多代码，你可能会超过上述限制。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Net net, inlining is hugely powerful, but also something to be employed carefully, and the JIT methodically (but necessarily quickly) weighs decisions it makes about what to inline and what not to with a variety of heuristics.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Net net，内联是非常强大的，但也是一种需要谨慎使用的东西，JIT系统地（但必须快速）权衡它所做的关于内联和不内联的决定，用各种启发式方法。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In this light, <a href=https://github.com/dotnet/runtime/pull/50675 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50675</a>, <a href=https://github.com/dotnet/runtime/pull/51124 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51124</a>,
<a href=https://github.com/dotnet/runtime/pull/52708 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52708</a>, <a href=https://github.com/dotnet/runtime/pull/53670 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53670</a>, and <a href=https://github.com/dotnet/runtime/pull/55478 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55478</a> improved the JIT by helping it to understand (and more efficiently understand) what methods were being invoked by the callee; by teaching the inliner about new things to look for, e.g. whether the callee could benefit from folding if handed constants; and by teaching the inliner how to inline various constructs it previously considered off-limits, e.g. switches. Let’s take just one example from a comment on one of those PRs:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在这种情况下，dotnet/runtime#50675、dotnet/runtime#51124、dotnet/runtime#52708、dotnet/runtime#53670和dotnet/runtime#55478通过帮助JIT理解（更有效地理解）被调用者调用的方法来改进JIT;通过教导内联者关于要寻找的新事物，例如，被调用者是否可以受益于折叠如果手握常数;并且通过教导内联器如何内联它以前认为是禁区的各种构造，例如，开关.让我们从其中一个PR的评论中举一个例子：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> _value </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>12345</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Utf8Formatter</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>TryFormat</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> _</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>StandardFormat</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>'D'</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>));</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Running this for .NET 5 vs .NET 6, we can see a few things changed:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在.NET 5和.NET 6上运行这个版本，我们可以看到一些变化： </font></font></font></p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>代码大小 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Format<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>格式 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>13.21 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>13.21纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,649 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>一千六百四十九B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Format<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>格式 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>10.37 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>10.37纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.78</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>590 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B </font></font></font></td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>First, it got faster, yet there was little-to-no work done within <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Utf8Formatter</span></code> itself in .NET 6 to improve the performance of this benchmark. Second, the code size (which is emitted thanks to using the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DisassemblyDiagnoser</span><span class=pun>]</span></code> attribute in our <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Program</span><span class=pun>.</span><span class=pln>cs</span></code>) was cut to 35% of what it was in .NET 5. How is that possible? In both versions, the employed <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormat</span></code> call is a one-liner that delegates to a <a href=https://github.com/dotnet/runtime/blob/d019e70d2b7c2f7cd1137fac084dbcdc3d2e05f5/src/libraries/System.Private.CoreLib/src/System/Buffers/Text/Utf8Formatter/Utf8Formatter.Integer.Signed.cs#L16-L17 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>private <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormatInt64</span></code> method</a>, and the developer of that method decided to annotate it with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodImplOptions</span><span class=pun>.</span><span class=typ>AggressiveInlining</span></code>, which tells the JIT to override its heuristics and inline the method if it’s possible rather than if it’s possible and deemed useful. That method is a switch on the input <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>format</span><span class=pun>.</span><span class=typ>Symbol</span></code>, branching to call various other methods based on the format symbol employed (e.g. ‘D’ vs ‘G’ vs ‘N’). But we’ve actually already passed by the most interesting part, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>StandardFormat</span><span class=pun>(</span><span class=str>'D'</span><span class=pun>,</span><span class=pln> </span><span class=lit>2</span><span class=pun>)</span></code> at the call site. In .NET 5, the JIT deems it not worthwhile to inline the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StandardFormat</span></code> constructor, and so we end up with a call to it:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>首先，它变得更快了，但在.NET 6中， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Utf8Formatter</span></code> 本身几乎没有做任何工作来提高这个基准测试的性能。其次，代码大小（由于在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Program</span><span class=pun>.</span><span class=pln>cs</span></code> 中使用了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DisassemblyDiagnoser</span><span class=pun>]</span></code> 属性而发出）被削减到了.NET 5中的35%。这怎么可能呢？在这两个版本中，使用的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormat</span></code> 调用都是委托给私有 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormatInt64</span></code> 方法的单行代码，该方法的开发者决定用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodImplOptions</span><span class=pun>.</span><span class=typ>AggressiveInlining</span></code> 注释它，它告诉JIT重写它的启发式方法，如果它是可能的，而不是如果它是可能的，并认为有用的。该方法是输入 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>format</span><span class=pun>.</span><span class=typ>Symbol</span></code> 上的开关，基于所采用的格式符号分支以调用各种其他方法（例如，“D”对“G”对“N”）。但我们实际上已经通过了最有趣的部分，调用站点的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>StandardFormat</span><span class=pun>(</span><span class=str>'D'</span><span class=pun>,</span><span class=pln> </span><span class=lit>2</span><span class=pun>)</span></code> 。在.NET 5中，JIT认为不值得内联 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StandardFormat</span></code> 构造函数，因此我们最终调用它：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>       mov       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>44</span></span><span class=pln><span class=pln>
       mov       r8d</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Buffers</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>StandardFormat</span></span><span class=pun><span class=pun>..</span></span><span class=pln><span class=pln>ctor</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Char</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Byte</span></span><span class=pun><span class=pun>)</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As a result, even though <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormat</span></code> gets inlined, in .NET 5, the JIT is unable to connect the dots to see that the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>'D'</span></code> passed into the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StandardFormat</span></code> constructor will influence which branch of that switch statement in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormatInt64</span></code> gets taken. In .NET 6, the JIT does inline the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StandardFormat</span></code> constructor, the effect of which is that it effectively can shrink the contents of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormatInt64</span></code> from:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>因此，即使 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormat</span></code> 被内联，在.NET 5中，JIT也无法将这些点连接起来，以查看传递到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StandardFormat</span></code> 构造函数的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>'D'</span></code> 将影响 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormatInt64</span></code> 中的switch语句的哪个分支被采用。在.NET 6中，JIT确实内联了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StandardFormat</span></code> 构造函数，其效果是它可以有效地将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormatInt64</span></code> 的内容从：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>format</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsDefault</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatInt64Default</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> bytesWritten</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>switch</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>format</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Symbol</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>case</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'G'</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>case</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'g'</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>format</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>HasPrecision</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NotSupportedException</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>SR</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Argument_GWithPrecisionNotSupported</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatInt64D</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> format</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Precision</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> bytesWritten</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>case</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'d'</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>case</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'D'</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatInt64D</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> format</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Precision</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> bytesWritten</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>case</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'n'</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>case</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'N'</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatInt64N</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> format</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Precision</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> bytesWritten</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>case</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'x'</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatUInt64X</span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>ulong</span></span><span class=pun><span class=pun>)</span></span><span class=kwd><span class=kwd>value</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;</span></span><span class=pln><span class=pln> mask</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> format</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Precision</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> bytesWritten</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>case</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'X'</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatUInt64X</span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>ulong</span></span><span class=pun><span class=pun>)</span></span><span class=kwd><span class=kwd>value</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;</span></span><span class=pln><span class=pln> mask</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> format</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Precision</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> bytesWritten</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>default</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>FormattingHelpers</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>TryFormatThrowFormatException</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> bytesWritten</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>to the equivalent of just:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=typ><span class=typ>TryFormatInt64D</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> bytesWritten</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>avoiding the extra branches and not needing to inline the second copy of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormatInt64D</span></code> (for the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>'G'</span></code> case) or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormatInt64N</span></code>, both which are <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AggressiveInlining</span></code>.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Inlining also goes hand-in-hand with devirtualization, which is the act in which the JIT takes a virtual or interface method call, determines statically the actual end target of the invocation, and emits a direct call to that target, saving on the cost of the virtual dispatch. Once devirtualized, the target may also be inlined (subject to all of the same rules and heuristics), in which case it can avoid not only the virtual dispatch overhead, but also potentially benefit from the further optimizations inlining can enable. For example, consider a function like the following, which you might find in a collection implementation:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _values </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Find</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Find</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_values</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>99</span></span><span class=pln><span class=pln>_999</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Find</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;(</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> T item</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>EqualityComparer</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>array</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln> item</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>A previous release of .NET Core taught the JIT how to devirtualize <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code> in such a use, resulting in an ~2x improvement over .NET Framework 4.8 in this example.</p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Find</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>115.4 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>127 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Find</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>69.7 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.60</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>71 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Find</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>69.8 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.60</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>63 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Find</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>53.4 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.46</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>57 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>However, while the JIT has been able to devirtualize <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span><span class=pun>.</span><span class=typ>Equals</span></code> (for value types), not so for its sibling <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span><span class=pun>.</span><span class=typ>Compare</span></code>. <a href=https://github.com/dotnet/runtime/pull/48160 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48160</a> addresses that. This can be seen with a benchmark like the following, which compares <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span></code> instances (the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code>.<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CompareTo</span></code> method uses <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code> to compare each element of the tuple):</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> _value1 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>15</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> _value2 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>15</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Compare</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _value1</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompareTo</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_value2</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Compare</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>17.467 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>240 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Compare</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>9.193 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.53</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>209 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Compare</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.533 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.15</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>186 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>But devirtualization improvements have gone well beyond such known intrinsic methods. Consider this microbenchmark:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetLength</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>((</span></span><span class=typ><span class=typ>ITuple</span></span><span class=pun><span class=pun>)(</span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pun><span class=pun>)).</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The fact that I’m using a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=str>'3</span></code> and the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ITuple</span></code> interface here doesn’t matter: I just selected an arbitrary value type that implements an interface. A previous release of .NET Core enabled the JIT to avoid the boxing operation here (from casting a value type to an interface it implements) and emit this purely as a constrained method call, and then a subsequent release enabled it to be devirtualized and inlined:</p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetLength</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>6.3495 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>106 B</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetLength</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4.0185 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.628</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>66 B</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetLength</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.1223 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.019</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>27 B</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetLength</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.0204 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.003</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>27 B</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Great. But now let’s make a small tweak:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetLength</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>ITuple</span></span><span class=pln><span class=pln> t </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>Ignore</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>t</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> t</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Ignore</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>object</span></span><span class=pln><span class=pln> o</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Here I’ve forced the boxing by needing the object to exist in order to call the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Ignore</span></code> method, and previously that was enough to disable the ability to devirtualize the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>t</span><span class=pun>.</span><span class=typ>Length</span></code> call. But .NET 6 now “gets it.” We can also see this by looking at the assembly. Here’s what we get for .NET 5:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetLength</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       push      rsi
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>30</span></span><span class=pln><span class=pln>
       vzeroupper
       vxorps    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0
       vmovdqu   xmmword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>xmm0
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>5</span></span><span class=pln><span class=pln>
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>24</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>6</span></span><span class=pln><span class=pln>
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>28</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>7</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>offset MT_System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ValueTuple</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>[[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>],[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>],[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>]]</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_NEWSFAST
       mov       rsi</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       vmovdqu   xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmmword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovdqu   xmmword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsi</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>xmm0
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rsi
       call      </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Ignore</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Object</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rsi
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>30</span></span><span class=pln><span class=pln>
       pop       rsi
       jmp       near ptr </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ValueTuple</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>[[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>],[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>],[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>]].</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Runtime</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompilerServices</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ITuple</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>get_Length</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>92</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and for .NET 6:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetLength</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       push      rsi
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>30</span></span><span class=pln><span class=pln>
       vzeroupper
       vxorps    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0
       vmovupd   </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>xmm0
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>5</span></span><span class=pln><span class=pln>
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>24</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>6</span></span><span class=pln><span class=pln>
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>28</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>7</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>offset MT_System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ValueTuple</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>[[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>],[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>],[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>]]</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_NEWSFAST
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       lea       rsi</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovupd   xmm0</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovupd   </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsi</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>xmm0
       call      </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Ignore</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Object</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsi</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>esi
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>30</span></span><span class=pln><span class=pln>
       pop       rsi
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>92</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Note in .NET 5 it’s tail calling to the interface implementation (jumping to the target method at the end rather than making a call that will need to return back to this method):</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>       jmp       near ptr </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ValueTuple</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>[[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>],[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>],[</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Private</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CoreLib</span></span><span class=pun><span class=pun>]].</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Runtime</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompilerServices</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ITuple</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>get_Length</span></span><span class=pun><span class=pun>()</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>whereas in .NET 6 it’s not only devirtualized but also inlined the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ITuple</span><span class=pun>.</span><span class=typ>Length</span></code> call, with the assembly now limited to moving the answer (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>3</span></code>) into the return register:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>3</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Nice.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>A multitude of other changes have impacted devirtualization as well. For example, <a href=https://github.com/dotnet/runtime/pull/53567 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53567</a> improves devirtualization in AOT ReadyToRun images, and <a href=https://github.com/dotnet/runtime/pull/45526 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45526</a> improves devirtualization with generics such that information about the exact class obtained is then made available to improve inlining.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course, there are many situations in which it’s impossible for the JIT to statically determine the exact target for a method call, thus preventing devirtualization and inlining… or does it?</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One of my favorite features of .NET 6 is PGO (profile-guided optimization). PGO as a concept isn’t new; it’s been implemented in a variety of development stacks, and has existed in .NET in multiple forms over the years. But the implementation in .NET 6 is something special when compared to previous releases; in particular, from my perspective, “dynamic PGO”. The general idea behind profile-guided optimization is that a developer can first compile their app, using special tooling that instruments the binary to track various pieces of interesting data. They can then run their instrumented application through typical use, and the resulting data from the instrumentation can then be fed back into the compiler the next time around to influence how the compiler compiles the code. The interesting statement there is “next time”. Traditionally, you’d build your app, run the data gathering process, and then rebuild the app feeding in the resulting data, and typically this would all be automated as part of a build pipeline; that process is referred to as “static PGO”. However, with tiered compilation, a whole new world is available.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“Tiered compilation” is enabled by default since .NET Core 3.0. For JIT’d code, it represents a compromise between getting going quickly and running with highly-optimized code. Code starts in “tier 0,” during which the JIT compiler applies very few optimizations, which also means the JIT compiles code very quickly (optimizations are often what end up taking the most time during compilation). The emitted code includes some tracking data to count how frequently methods are invoked, and once members pass a certain threshold, the JIT queues them to be recompiled in “tier 1,” this time with all the optimizations the JIT can muster, and learning from the previous compilation, e.g. an accessed <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span><span class=pln> </span><span class=kwd>int</span></code> can become a constant, as its value will have already been computed by the time the tier 1 code is compiled (<a href=https://github.com/dotnet/runtime/pull/45901 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45901</a> improves the aforementioned queueing, using a dedicated thread rather than using the thread pool). You can see where this is going. With “dynamic PGO,” the JIT can now do further instrumentation during tier 0, to track not just call counts but all of the interesting data it can use for profile-guided optimization, and then it can employ that during the compilation of tier 1.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In .NET 6, dynamic PGO is off by default. To enable it, you need to set the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>DOTNET_TieredPGO</span></code> environment variable:</p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=com><span class=com># with bash</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>export</span></span><span class=pln><span class=pln> DOTNET_TieredPGO</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>

</span></span><span class=com><span class=com># in cmd</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>set</span></span><span class=pln><span class=pln> DOTNET_TieredPGO</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>

</span></span><span class=com><span class=com># with PowerShell</span></span><span class=pln><span class=pln>
$env</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>DOTNET_TieredPGO</span></span><span class=pun><span class=pun>=</span></span><span class=str><span class=str>"1"</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>That enables gathering all of the interesting data during tier 0. On top of that, there are some other environment variables you’ll also want to consider setting. Note that the core libraries that make up .NET are installed with ReadyToRun images, which means they’ve essentially already been compiled into assembly code. ReadyToRun images can participate in tiering, but they don’t go through a tier 0, rather they go straight from the ReadyToRun code to tier 1; that means there’s no opportunity for dynamic PGO to instrument the binary for dynamically gathering insights. To enable instrumenting the core libraries as well, you can disable ReadyToRun:</p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>$env</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>DOTNET_ReadyToRun</span></span><span class=pun><span class=pun>=</span></span><span class=str><span class=str>"0"</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Then the core libraries will also participate. Finally, you can consider setting <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>DOTNET_TC_QuickJitForLoops</span></code>:</p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>$env</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>DOTNET_TC_QuickJitForLoops</span></span><span class=pun><span class=pun>=</span></span><span class=str><span class=str>"1"</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which enables tiering for methods that contain loops: otherwise, anything that has a backward jump goes straight to tier 1, meaning it gets optimized immediately as if tiered compilation didn’t exist, but in doing so loses out on the benefits of first going through tier 0. You may hear folks working on .NET referring to “full PGO”: that’s the case of all three of these environment variables being set, as then everything in the app is utilizing “dynamic PGO”. (Note that the ReadyToRun code for the framework assemblies does include implementations optimized based on PGO, just “static PGO”. The framework assemblies are compiled with PGO, used to execute a stable of representative apps and services, and then the resulting data is used to generate the final code that’s part of the shipped assemblies.)</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Enough setup… what does this do for us? Let’s take an example:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerator</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _source </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>MaxValue</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>GetEnumerator</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MoveNext</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _source</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>MoveNext</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This is a pretty simple benchmark: we have an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerator</span><span class=str>&lt;int&gt;</span></code> stored in a field, and our benchmark is simply moving the iterator forward. When compiled on .NET 6 normally, we get this:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>MoveNext</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       r11</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>7FFF8BB40378</span></span><span class=pln><span class=pln>
       call      qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFF8BEB0378</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       nop
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>That assembly code is the interface dispatch to whatever implementation backs that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerator</span><span class=str>&lt;int&gt;</span></code>. Now let’s set:</p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>$env</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>DOTNET_TieredPGO</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and try it again. This time, the code looks very different:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>MoveNext</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       r11</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>offset MT_System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Linq</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>+</span></span><span class=typ><span class=typ>RangeIterator</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>r11
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L03
       mov       r11d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>0C</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       cmp       r11d</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       cmp       r11d</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       mov       r11d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       inc       r11d
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>r11d
       cmp       r11d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>18</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       jmp       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L02
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       mov       r11d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>14</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>r11d
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>0C</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
       jmp       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L02
M00_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>0C</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>0FFFFFFFF</span></span><span class=pln><span class=pln>
M00_L02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M00_L03</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       mov       r11</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>7FFF8BB50378</span></span><span class=pln><span class=pln>
       call      qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFF8BEB0378</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       jmp       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L02</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>A few things to notice, beyond it being much longer. First, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov r11</span><span class=pun>,</span><span class=lit>7FFF8BB40378</span></code> followed by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call qword ptr </span><span class=pun>[</span><span class=lit>7FFF8BEB0378</span><span class=pun>]</span></code> sequence for doing the interface dispatch still exists here, but it’s at the end of the method. One optimization common in PGO implementations is “hot/cold splitting”, where sections of a method frequently executed (“hot”) are moved close together at the beginning of the method, and sections of a method infrequently executed (“cold”) are moved to the end of the method. That enables better use of instruction caches and minimizes loads necessary to bring in likely-unsed code. So, this interface dispatch has moved to the end of the method, as based on PGO data the JIT expects it to be cold / rarely invoked. Yet this is the entirety of the original implementation; if that’s cold, what’s hot? Now at the beginning of the method, we see:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>有几件事要注意，除了它是更长的。首先，执行接口分派的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov r11</span><span class=pun>,</span><span class=lit>7FFF8BB40378</span></code> 后面跟着 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call qword ptr </span><span class=pun>[</span><span class=lit>7FFF8BEB0378</span><span class=pun>]</span></code> 序列仍然存在，但它位于方法的末尾。PGO实现中常见的一种优化是“热/冷拆分”，其中频繁执行的方法的部分（“热”）在方法的开始处被移动到一起，并且不频繁执行的方法的部分（“冷”）被移动到方法的结束。这使得能够更好地使用指令缓存，并最小化引入可能未sed代码所需的负载。因此，这个接口分派已经移动到方法的末尾，因为基于PGO数据，JIT期望它被冷/很少调用。然而，这是原始实现的全部;如果那是冷的话，那什么是热的？现在在方法的开头，我们看到：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>       mov       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       r11</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>offset MT_System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Linq</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>+</span></span><span class=typ><span class=typ>RangeIterator</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>r11
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L03</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This is the magic. When the JIT instrumented the tier 0 code for this method, that included instrumenting this interface dispatch to track the concrete type of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>_source</span></code> on each invocation. And the JIT found that every invocation was on a type called <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>+</span><span class=typ>RangeIterator</span></code>, which is a <a href=https://github.com/dotnet/runtime/blob/d019e70d2b7c2f7cd1137fac084dbcdc3d2e05f5/src/libraries/System.Linq/src/System/Linq/Range.cs#L31 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>private class</a> used to implement <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Range</span></code> inside of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span></code> implementation. As such, for tier 1 the JIT has emitted a check to see whether the type of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>_source</span></code> is that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>+</span><span class=typ>RangeIterator</span></code>: if it isn’t, then it jumps to the cold section we previously highlighted that’s performing the normal interface dispatch. But if it is, which, based on the profiling data, is expected to be the case the vast majority of the time, it can then proceed to directly invoke the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>+</span><span class=typ>RangeIterator</span><span class=pun>.</span><span class=typ>MoveNext</span></code> method, devirtualized. Not only that, but it decided it was profitable to inline that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MoveNext</span></code> method. That <a href=https://github.com/dotnet/runtime/blob/d019e70d2b7c2f7cd1137fac084dbcdc3d2e05f5/src/libraries/System.Linq/src/System/Linq/Range.cs#L47-L67 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MoveNext</span></code></a> implementation is then the assembly code that immediately follows. The net effect of this is a bit larger code, but optimized for the exact scenario expected to be most common:<font data-immersive-translate-effect=1 data-immersive-translate-error-id=1366 class="notranslate immersive-translate-target-wrapper immersive-translate-target-wrapper-error" translate=no lang=zh-CN><a><font class="immersive-translate-error notranslate"><font class=immersive-translate-error-wrapper><font data-immersive-translate-action=retry title=重试全部错误段落 data-immersive-translate-paragraph-id=1366 class="immersive-translate-clickable-button notranslate"><img draggable=false role=img class=emoji alt=🔄 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iIzNCODhDMyIgZD0iTTM2IDMyYzAgMi4yMDktMS43OTEgNC00IDRINGMtMi4yMDkgMC00LTEuNzkxLTQtNFY0YzAtMi4yMDkgMS43OTEtNCA0LTRoMjhjMi4yMDkgMCA0IDEuNzkxIDQgNHYyOHoiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMjIuMjQyIDIyLjI0MmwyLjgyOSAyLjgyOWMtMy45MDUgMy45MDUtMTAuMjM3IDMuOTA0LTE0LjE0My0uMDAxLTIuMjQ3LTIuMjQ2LTMuMTk0LTUuMjk2LTIuODU0LTguMjI1bC00LjAzNy4zNjdjLS4yMTUgMy44NCAxLjEyOCA3Ljc1MiA0LjA2MiAxMC42ODcgNS40NjcgNS40NjcgMTQuMzMzIDUuNDY4IDE5Ljc5OSAwbDIuODI4IDIuODI4Ljg0OS05LjMzNC05LjMzMy44NDl6TTI3Ljg5OSA4LjFDMjIuNDMxIDIuNjMzIDEzLjU2OCAyLjYzMyA4LjEgOC4xTDUuMjcyIDUuMjcybC0uODQ5IDkuMzM0IDkuMzM0LS44NDktMi44MjktMi44MjljMy45MDYtMy45MDUgMTAuMjM2LTMuOTA1IDE0LjE0MiAwIDIuMjQ4IDIuMjQ3IDMuMTk0IDUuMjk3IDIuODU2IDguMjI2bDQuMDM2LS4zNjZjLjIxNi0zLjg0MS0xLjEyOC03Ljc1My00LjA2My0xMC42ODh6Ii8+PC9zdmc+></font>&nbsp;&nbsp;<font data-immersive-translate-action=toast-error data-immersive-translate-tooltip-text="Server is busy now, (10000), please retry later" title=点击查看错误原因 class="immersive-translate-help-button notranslate"><img draggable=false role=img class=emoji alt=❓ src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0JFMTkzMSIgZD0iTTE3IDI3Yy0xLjY1NyAwLTMtMS4zNDMtMy0zdi00YzAtMS42NTcgMS4zNDMtMyAzLTMgLjYwMy0uMDA2IDYtMSA2LTUgMC0yLTItNC01LTQtMi40NDEgMC00IDItNCAzIDAgMS42NTctMS4zNDMgMy0zIDNzLTMtMS4zNDMtMy0zYzAtNC44NzggNC41OC05IDEwLTkgOCAwIDExIDUuOTgyIDExIDExIDAgNC4xNDUtMi4yNzcgNy4zMTMtNi40MTMgOC45Mi0uOS4zNTEtMS43OS41ODctMi41ODcuNzQ3VjI0YzAgMS42NTctMS4zNDMgMy0zIDN6Ii8+PGNpcmNsZSBmaWxsPSIjQkUxOTMxIiBjeD0iMTciIGN5PSIzMiIgcj0iMyIvPjwvc3ZnPg=="></font></font></font></a></font></p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>PGO Disabled</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.905 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>30 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>PGO Enabled</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.7071 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>105 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The JIT optimizes for PGO data in a variety of ways. Given the data it knows about how the code behaves, it can be more aggressive about inlining, as it has more data about what will and won’t be profitable. It can perform this “guarded devirtualization” for most interface and virtual dispatch, emitting both one or more fast paths that are devirtualized and possibly inlined, with a fallback that performs the standard dispatch should the actual type not match the expected type. It can actually reduce code size in various circumstances by choosing to not apply optimizations that might otherwise increase code size (e.g. inlining, loop cloning, etc.) in blocks discovered to be cold. It can optimize for type casts, emitting checks that do a direct type comparison against the actual object type rather than always relying on more complicated and expensive cast helpers (e.g. ones that need to search ancestor hierarchies or interface lists or that can handle generic co- and contra-variance). The list will continue to grow over time as the JIT learns more and more how to, well, learn.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Lots of PRs contributed to PGO. Here are just a few:</p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/44427 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44427</a> added support to the inliner that utilized call site frequency to boost the profitability metric (i.e. how valuable would it be to inline a method).</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/45133 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45133</a> added the initial support for determining the distribution of concrete types used at virtual and interface dispatch call sites, in order to enable guarded devirtualization. <a href=https://github.com/dotnet/runtime/pull/51157 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51157</a> further enhanced this with regards to small struct types, while <a href=https://github.com/dotnet/runtime/pull/51890 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51890</a> enabled improved code generation by chaining together guarded devirtualization call sites, grouping together the frequently-taken code paths where applicable.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/52827 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52827</a> added support for special-casing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>switch</span></code> cases when PGO data is available to support it. If there’s a dominant <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>switch</span></code> case, where the JIT sees that branch being taken at least 30% of the time, the JIT can emit a dedicated <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code> check for that case up front, rather than having it go through the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>switch</span></code> with the rest of the cases. (Note this applies to actual switches in the IL; not all C# <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>switch</span></code> statements will end up as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>switch</span></code> instructions in IL, and in fact many won’t, as the C# compiler will often optimize smaller or more complicated switches into the equivalent of a cascading set of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code>/<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>else</span><span class=pln> </span><span class=kwd>if</span></code> checks.)</li>
</ul>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>That’s probably enough for now about inlining. There are other categories of optimization critical to high-performance C# and .NET code, as well. For example, bounds checking. One of the great things about C# and .NET is that, unless you go out of your way to circumvent the protections put in place (e.g. by using the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>unsafe</span></code> keyword, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Unsafe</span></code> class, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Marshal</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MemoryMarshal</span></code> classes, etc.), it’s near impossible to experience typical security vulnerabilities like buffer overruns. That’s because all accesses to arrays, strings, and spans are automatically “bounds checked” by the JIT, meaning it ensures before indexing into one of these data structures that the index is properly within bounds. You can see that with a simple example:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> M</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> arr</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> index</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> arr</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>index</span></span><span class=pun><span class=pun>];</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>for which the JIT will generate code similar to this:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>M</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>[],</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       cmp       r8d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       jae       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L00
       movsxd    rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       mov       eax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>*</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M01_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_RNGCHKFAIL
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>28</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>rdx</span></code> register here stores the address of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span></code>, and the length of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span></code> is stored 8 bytes beyond that (in this 64-bit process), so <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=pln>rdx</span><span class=pun>+</span><span class=lit>8</span><span class=pun>]</span></code> is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span><span class=pun>.</span><span class=typ>Length</span></code>, and the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>cmp r8d</span><span class=pun>,</span><span class=pln> </span><span class=pun>[</span><span class=pln>rdx</span><span class=pun>+</span><span class=lit>8</span><span class=pun>]</span></code> instruction is comparing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span><span class=pun>.</span><span class=typ>Length</span></code> against the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>index</span></code> value stored in the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>r8d</span></code> register. If the index is equal to or greater than the array length, it jumps to the end of the method, which calls a helper that throws an exception. That comparison is the “bounds check.”<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这里的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>rdx</span></code> 寄存器存储 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span></code> 的地址，而 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span></code> 的长度存储超过8字节（在这个64位过程中），因此 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=pln>rdx</span><span class=pun>+</span><span class=lit>8</span><span class=pun>]</span></code> 是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span><span class=pun>.</span><span class=typ>Length</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>cmp r8d</span><span class=pun>,</span><span class=pln> </span><span class=pun>[</span><span class=pln>rdx</span><span class=pun>+</span><span class=lit>8</span><span class=pun>]</span></code> 指令将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span><span class=pun>.</span><span class=typ>Length</span></code> 与存储在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>r8d</span></code> 寄存器中的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>index</span></code> 值进行比较。如果索引等于或大于数组长度，它将跳转到方法的末尾，这将调用引发异常的帮助器。这种比较就是“边界检查”。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course, such bounds checks add overhead. For most code, the overhead is negligible, but if you’re reading this post, there’s a good chance you’ve written code where it’s not. And you certainly rely on code where it’s not: a lot of lower-level routines in the core .NET libraries do rely on avoiding this kind of overhead wherever possible. As such, the JIT goes to great lengths to avoid emitting bounds checking when it can prove going out of bounds isn’t possible. The prototypical example is a loop from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0</span></code> to an array’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Length</span></code>. If you write:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当然，这种边界检查增加了开销。对于大多数代码来说，开销可以忽略不计，但是如果你正在阅读这篇文章，你很有可能在没有的地方编写了代码。你当然依赖代码，但它不是：核心.NET库中的许多低级例程确实依赖于尽可能避免这种开销。因此，JIT在可以证明不可能越界的情况下，尽可能避免发出边界检查。原型示例是从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0</span></code> 到数组的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Length</span></code> 的循环。如果你写：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> arr</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> sum </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> arr</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln> sum </span></span><span class=pun><span class=pun>+=</span></span><span class=pln><span class=pln> arr</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> sum</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>the JIT will output code like this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>JIT将输出如下代码： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>[])</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       xor       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       mov       r8d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      r8d</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       jle       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M02_L01
M02_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       movsxd    r9</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       eax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>r9</span></span><span class=pun><span class=pun>*</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       inc       ecx
       cmp       r8d</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       jg        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M02_L00
M02_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>29</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Note there’s no tell-tale <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call</span></code> followed by an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>int3</span></code> instruction at the end of the method; that’s because no call to a throw helper is required here, as there’s no bounds checking needed. The JIT can see that, by construction, the loop can’t walk off either end of the array, and thus it needn’t emit a bounds check.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Every release of .NET sees the JIT become wise to more and more patterns where it can safely eliminate bounds checking, and .NET 6 follows suit. <a href=https://github.com/dotnet/runtime/pull/40180 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#40180</a> and <a href=https://github.com/dotnet/runtime/pull/43568 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43568</a> from <a href=https://github.com/nathan-moore target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@nathan-moore</a> are great (and very helpful) examples. Consider the following benchmark:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatTrue</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatTrue</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryFormatTrue</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Span</span></span><span class=str><span class=str>&lt;char&gt;</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>destination</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&gt;=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        destination</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'t'</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
        destination</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'r'</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
        destination</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'u'</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
        destination</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'e'</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This represents relatively typical code you might see in some lower-level formatting, where the length of a span is checked and then data written into the span. In the past, the JIT has been a little finicky about which guard patterns here are recognized and which aren’t, and .NET 6 makes that a whole lot better, thanks to the aforementioned PRs. On .NET 5, this benchmark would result in assembly like the following:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这代表了您可能在一些较低级别的格式化中看到的相对典型的代码，其中检查跨度的长度，然后将数据写入跨度。在过去，JIT对于识别哪些保护模式，哪些不识别有些挑剔，而.NET 6使这一点变得更好，这要归功于前面提到的PR。在.NET 5上，此基准测试将导致如下所示的汇编： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>TryFormatTrue</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Span</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Char</span></span><span class=pun><span class=pun>&gt;)</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       cmp       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>4</span></span><span class=pln><span class=pln>
       jl        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L00
       cmp       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L01
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>74</span></span><span class=pln><span class=pln>
       cmp       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L01
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>72</span></span><span class=pln><span class=pln>
       cmp       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L01
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>75</span></span><span class=pln><span class=pln>
       cmp       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L01
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>65</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M01_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M01_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_RNGCHKFAIL
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The beginning of the assembly loads the span’s reference into the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>eax</span></code> register and the length of the span into the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>edx</span></code> register:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>程序集的开头将span的引用加载到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>eax</span></code> 寄存器中，并将span的长度加载到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>edx</span></code> 寄存器中：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and then each assignment into the span ends up checking against this length, as in this sequence from above where we’re executing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>destination</span><span class=pun>[</span><span class=lit>2</span><span class=pun>]</span><span class=pln> </span><span class=pun>=</span><span class=pln> </span><span class=str>'u'</span></code>:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然后每个赋值到span的时候都会检查这个长度，就像上面执行 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>destination</span><span class=pun>[</span><span class=lit>2</span><span class=pun>]</span><span class=pln> </span><span class=pun>=</span><span class=pln> </span><span class=str>'u'</span></code> 的顺序一样：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>       cmp       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L01
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>75</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>To save you from having to look at an ASCII table, lowercase ‘u’ has an ASCII hex value of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x75</span></code>, so this code is validating that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>2</span></code> is less than the span’s length (and jumping to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call CORINFO_HELP_RNGCHKFAIL</span></code> if it’s not), then storing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>'u'</span></code> into the 2nd element of the span (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=pln>rax</span><span class=pun>+</span><span class=lit>4</span><span class=pun>]</span></code>). That’s four bounds checks, one for each character in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"true"</span></code>, even though we know they’re all in-bounds. The JIT in .NET 6 knows that, too:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>为了保存你不必查看ASCII表，小写字母“u”的ASCII十六进制值为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x75</span></code> ，所以这段代码验证 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>2</span></code> 是否小于span的长度（如果不是，则跳转到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call CORINFO_HELP_RNGCHKFAIL</span></code> ），然后将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>'u'</span></code> 存储到span的第二个元素（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=pln>rax</span><span class=pun>+</span><span class=lit>4</span><span class=pun>]</span></code> ）中。这是四个边界检查，一个对应于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"true"</span></code> 中的每个字符，尽管我们知道它们都是在边界内的。.NET 6中的JIT也知道这一点：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>TryFormatTrue</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Span</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Char</span></span><span class=pun><span class=pun>&gt;)</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       cmp       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>4</span></span><span class=pln><span class=pln>
       jl        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L00
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>74</span></span><span class=pln><span class=pln>
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>72</span></span><span class=pln><span class=pln>
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>75</span></span><span class=pln><span class=pln>
       mov       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>65</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       ret
M01_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       ret</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Much better. Those changes then also allowed undoing some hacks (e.g. <a href=https://github.com/dotnet/runtime/pull/49450 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49450</a> from <a href=https://github.com/SingleAccretion target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@SingleAccretion</a>) in the core libraries that had previously been done to work around the lack of the bounds checking removal in such cases.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>好多了这些变化还允许撤销一些黑客（例如：dotnet/runtime#49450来自@SingleAccretion）的核心库中，以前已经完成了解决在这种情况下缺乏边界检查移除的工作。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another bounds-checking improvement comes in <a href=https://github.com/dotnet/runtime/pull/49271 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49271</a> from <a href=https://github.com/SingleAccretion target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@SingleAccretion</a>. In previous releases, there was an issue in the JIT where an inlined method call could cause subsequent bounds checks that otherwise would have been removed to now no longer be removed. This PR fixes that, the effect of which is evident in this benchmark<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>另一个边界检查改进来自@SingleAccretion的dotnet/runtime#49271。在以前的版本中，JIT中存在一个问题，即内联方法调用可能导致后续的边界检查，否则这些检查将被删除，现在不再被删除。这个PR修复了这个问题，其效果在这个基准中是显而易见的</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DateTime</span></span><span class=pln><span class=pln> _now </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DateTime</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>UtcNow</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Store</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Store</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _now</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Store</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Span</span></span><span class=str><span class=str>&lt;long&gt;</span></span><span class=pln><span class=pln> span</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DateTime</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(!</span></span><span class=pln><span class=pln>span</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsEmpty</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        span</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Ticks</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Store</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Span</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Int64</span></span><span class=pun><span class=pun>&gt;,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>DateTime</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       ecx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L00
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L01
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0FFFFFFFFFFFF</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>and</span></span><span class=pln><span class=pln>       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rcx
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rdx
M01_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M01_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_RNGCHKFAIL
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>46</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Store</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Span</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Int64</span></span><span class=pun><span class=pun>&gt;,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>DateTime</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       ecx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L00
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0FFFFFFFFFFFF</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>and</span></span><span class=pln><span class=pln>       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rcx
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rdx
M01_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>27</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In other cases, it’s not about whether there’s a bounds check, but what code is emitted for a bounds check that isn’t elided. For example, <a href=https://github.com/dotnet/runtime/pull/42295 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42295</a> special-cases indexing into an array with a constant 0 index (which is actually fairly common) and emits a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>test</span></code> instruction rather than a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>cmp</span></code> instruction, which makes the code both slightly smaller and slightly faster.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another bounds-checking optimization that’s arguably a category of its own is “loop cloning.” The idea behind loop cloning is the JIT can duplicate a loop, creating one variant that’s the original and one variant that removes bounds checking, and then at run-time decide which to use based on an additional up-front check. For example, consider this code:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> length</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> sum </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        sum </span></span><span class=pun><span class=pun>+=</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> sum</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The JIT still needs to bounds check the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>array</span><span class=pun>[</span><span class=pln>i</span><span class=pun>]</span></code> access, as while it knows that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>&gt;=</span><span class=pln> </span><span class=lit>0</span></code> &amp;&amp; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>&lt;</span><span class=pln> length</span></code>, it doesn’t know whether <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>length </span><span class=pun>&lt;=</span><span class=pln> array</span><span class=pun>.</span><span class=typ>Length</span></code> and thus doesn’t know whether <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>&lt;</span><span class=pln> array</span><span class=pun>.</span><span class=typ>Length</span></code>. However, doing such a bounds check on each iteration of the loop adds an extra comparison and branch on each iteration. Loop cloning enables the JIT to generate code that’s more like the equivalent of this:<font data-immersive-translate-effect=1 data-immersive-translate-error-id=1347 class="notranslate immersive-translate-target-wrapper immersive-translate-target-wrapper-error" translate=no lang=zh-CN><a><font class="immersive-translate-error notranslate"><font class=immersive-translate-error-wrapper><font data-immersive-translate-action=retry title=重试全部错误段落 data-immersive-translate-paragraph-id=1347 class="immersive-translate-clickable-button notranslate"><img draggable=false role=img class=emoji alt=🔄 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iIzNCODhDMyIgZD0iTTM2IDMyYzAgMi4yMDktMS43OTEgNC00IDRINGMtMi4yMDkgMC00LTEuNzkxLTQtNFY0YzAtMi4yMDkgMS43OTEtNCA0LTRoMjhjMi4yMDkgMCA0IDEuNzkxIDQgNHYyOHoiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMjIuMjQyIDIyLjI0MmwyLjgyOSAyLjgyOWMtMy45MDUgMy45MDUtMTAuMjM3IDMuOTA0LTE0LjE0My0uMDAxLTIuMjQ3LTIuMjQ2LTMuMTk0LTUuMjk2LTIuODU0LTguMjI1bC00LjAzNy4zNjdjLS4yMTUgMy44NCAxLjEyOCA3Ljc1MiA0LjA2MiAxMC42ODcgNS40NjcgNS40NjcgMTQuMzMzIDUuNDY4IDE5Ljc5OSAwbDIuODI4IDIuODI4Ljg0OS05LjMzNC05LjMzMy44NDl6TTI3Ljg5OSA4LjFDMjIuNDMxIDIuNjMzIDEzLjU2OCAyLjYzMyA4LjEgOC4xTDUuMjcyIDUuMjcybC0uODQ5IDkuMzM0IDkuMzM0LS44NDktMi44MjktMi44MjljMy45MDYtMy45MDUgMTAuMjM2LTMuOTA1IDE0LjE0MiAwIDIuMjQ4IDIuMjQ3IDMuMTk0IDUuMjk3IDIuODU2IDguMjI2bDQuMDM2LS4zNjZjLjIxNi0zLjg0MS0xLjEyOC03Ljc1My00LjA2My0xMC42ODh6Ii8+PC9zdmc+></font>&nbsp;&nbsp;<font data-immersive-translate-action=toast-error data-immersive-translate-tooltip-text="Server is busy now, (10000), please retry later" title=点击查看错误原因 class="immersive-translate-help-button notranslate"><img draggable=false role=img class=emoji alt=❓ src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0JFMTkzMSIgZD0iTTE3IDI3Yy0xLjY1NyAwLTMtMS4zNDMtMy0zdi00YzAtMS42NTcgMS4zNDMtMyAzLTMgLjYwMy0uMDA2IDYtMSA2LTUgMC0yLTItNC01LTQtMi40NDEgMC00IDItNCAzIDAgMS42NTctMS4zNDMgMy0zIDNzLTMtMS4zNDMtMy0zYzAtNC44NzggNC41OC05IDEwLTkgOCAwIDExIDUuOTgyIDExIDExIDAgNC4xNDUtMi4yNzcgNy4zMTMtNi40MTMgOC45Mi0uOS4zNTEtMS43OS41ODctMi41ODcuNzQ3VjI0YzAgMS42NTctMS4zNDMgMy0zIDN6Ii8+PGNpcmNsZSBmaWxsPSIjQkUxOTMxIiBjeD0iMTciIGN5PSIzMiIgcj0iMyIvPjwvc3ZnPg=="></font></font></font></a></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> length</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> sum </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>array </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>not</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;&amp;</span></span><span class=pln><span class=pln> length </span></span><span class=pun><span class=pun>&lt;=</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
            sum </span></span><span class=pun><span class=pun>+=</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln> </span></span><span class=com><span class=com>// bounds check removed</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>else</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
            sum </span></span><span class=pun><span class=pun>+=</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln> </span></span><span class=com><span class=com>// bounds check not removed</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> sum</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>We end up paying for the extra up-front one time checks, but as long as there’s at least a couple of iterations, the elimination of the bounds check pays for that and more. Neat. However, as with other bounds checking removal optimizations, the JIT is looking for very specific patterns, and things that deviate and fall off the golden path lose out on the optimization. That can include something as simple as the type of the array itself: change the previous example to use <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> instead of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pun>[]</span></code>, and that’s enough to throw the JIT off the scent… or, at least it was in .NET 5. Thanks to <a href=https://github.com/dotnet/runtime/pull/48894 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48894</a>, in .NET 6 the loop is now cloned, as can be seen from this benchmark:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我们最终要为额外的前期一次性检查付费，但只要至少有几次迭代，消除边界检查就能为这些付出代价，甚至更多。很好然而，与其他边界检查移除优化一样，JIT正在寻找非常具体的模式，偏离和掉在黄金路径上的东西会在优化中损失。它可以包括像数组本身的类型这样简单的东西：将前面的例子改为使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 而不是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pun>[]</span></code> ，这就足以让JIT消失......或者，至少在.NET 5中是这样。多亏了dotnet/runtime#48894，在.NET 6中，循环现在被克隆了，从这个基准测试中可以看出：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>999</span></span><span class=pln><span class=pln>_999</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> length</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> sum </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        sum </span></span><span class=pun><span class=pun>+=</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> sum</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>代码大小 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sum</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>471.3 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>471.3美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>54 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sum</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>350.0 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.74</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>97 B</td>
</tr>
</tbody>
</table></div>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       xor       edx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       xor       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       mov       r8d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       jae       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       movsxd    r9</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       movzx     r9d</span></span><span class=pun><span class=pun>,</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pln><span class=pln> ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>r9</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r9d
       inc       ecx
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0F423F</span></span><span class=pln><span class=pln>
       jl        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M00_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_RNGCHKFAIL
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>54</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       xor       edx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       xor       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       test      rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       cmp       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>0F423F</span></span><span class=pln><span class=pln>
       jl        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       nop       word ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       movsxd    r8</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       movzx     r8d</span></span><span class=pun><span class=pun>,</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pln><span class=pln> ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>r8</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       inc       ecx
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0F423F</span></span><span class=pln><span class=pln>
       jl        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       jmp       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L02
M00_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       cmp       ecx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       jae       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L03
       movsxd    r8</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       movzx     r8d</span></span><span class=pun><span class=pun>,</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pln><span class=pln> ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>r8</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       r8d</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       mov       edx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       inc       ecx
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0F423F</span></span><span class=pln><span class=pln>
       jl        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
M00_L02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M00_L03</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_RNGCHKFAIL
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>97</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Not just bytes, but the same issue manifests for arrays of non-primitive structs. <a href=https://github.com/dotnet/runtime/pull/55612 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55612</a> addressed that. Additionally, <a href=https://github.com/dotnet/runtime/pull/55299 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55299</a> improved loop cloning for various loops over multidimensional arrays.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Since we’re on the topic of loop optimization, consider loop inversion. “Loop inversion” is a standard compiler transform that’s aimed at eliminating some branching from a loop. Consider a loop like:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
    i</span></span><span class=pun><span class=pun>++;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Loop inversion involves the compiler transforming this into:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>循环反转涉及编译器将其转换为： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>do</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
        i</span></span><span class=pun><span class=pun>++;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In other words, change the while into a do..while, moving the condition check from the beginning of each iteration to the end of each iteration, and then add a one-time condition check at the beginning to compensate. Now imagine that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>==</span><span class=pln> </span><span class=lit>2</span></code>. In the original structure, we enter the loop, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span></code> is incremented, and then we jump back to the beginning to do the condition test, it’ll fail (as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span></code> is now 3), and we’ll then jump again to just past the end of the loop. Now consider the same situation with the inverted loop. We pass the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code> condition, as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>==</span><span class=pln> </span><span class=lit>2</span></code>. We then enter the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>do</span><span class=pun>..</span><span class=kwd>while</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span></code> is incremented, and we check the condition. The condition fails, and we’re already at the end of the loop, so we don’t jump back to the beginning and instead just keep running past the loop. Summary: we saved two jumps. And in either case, if <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span></code> was <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>&gt;=</span><span class=pln> </span><span class=lit>3</span></code>, we have exactly the same number of jumps as we just jump to after the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>while</span></code>/<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code>. The inverted structure also often affords additional optimizations; for example, the JIT’s pattern recognition used for loop cloning and the hoisting of invariants depend on the loop being in an inverted form. Both <a href=https://github.com/dotnet/runtime/pull/50982 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50982</a> and <a href=https://github.com/dotnet/runtime/pull/52347 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52347</a> improved the JIT’s support for loop inversion.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>换句话说，把while改成do..同时，将条件检查从每次迭代的开始移动到每次迭代的结束，然后在开始时添加一次性条件检查进行补偿。想象一下 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>==</span><span class=pln> </span><span class=lit>2</span></code> 。在原始结构中，我们进入循环， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span></code> 递增，然后我们跳回到开始进行条件测试，它将失败（因为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span></code> 现在是3），然后我们将再次跳到刚刚过循环结束。现在考虑反向循环的相同情况。我们传递 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code> 条件，作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>==</span><span class=pln> </span><span class=lit>2</span></code> 。然后我们输入 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>do</span><span class=pun>..</span><span class=kwd>while</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span></code> 递增，然后我们检查条件。条件失败了，我们已经处于循环的末尾，所以我们不会跳回到开头，而是继续运行循环。总结：我们拯救了两个跳跃。无论哪种情况，如果 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span></code> 是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>&gt;=</span><span class=pln> </span><span class=lit>3</span></code> ，我们有完全相同的跳跃次数，我们在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>while</span></code> / <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code> 之后跳到的跳跃次数。 倒置结构还经常提供额外的优化;例如，用于循环克隆和不变量提升的JIT模式识别取决于处于反转形式的循环。dotnet/runtime#50982和dotnet/runtime#52347都改进了JIT对循环反转的支持。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ok, we’ve talked about inlining optimizations, bounds checking optimizations, and loop optimizations. What about constants?<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>好了，我们已经讨论了内联优化、边界检查优化和循环优化。常数呢？ </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“Constant folding” is simply a fancy term to mean a compiler computing values at compile-time rather than leaving it to run-time. Folding can happen at various levels of compilation. If you write this C#:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>“常量折叠”只是一个花哨的术语，意思是编译器在编译时计算值，而不是将其留给运行时。折叠可以发生在编译的不同级别。如果你写这个C#： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> M</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>20</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>30</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>/</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>40</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>^</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>50</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>60</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>70</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>the C# compiler will fold this while compiling to IL, computing the constant value <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>47</span></code> from all of those operations:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>C#编译器会在编译到IL时折叠它，从所有这些操作中计算常量值 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>47</span></code> ：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>IL_0000</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> ldc</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>i4</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>s </span></span><span class=lit><span class=lit>47</span></span><span class=pln><span class=pln>
IL_0002</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> ret</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Folding can also happen in the JIT, which is particularly valuable in the face of inlining. If I have this C#:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> M</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> N</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> N</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>the C# compiler doesn’t (and in many cases shouldn’t) do any kind of interprocedural analysis to determine that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>N</span></code> always returns <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>20</span></code>, so you end up with this IL for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>M</span></code>:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>IL_0000</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> ldc</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>i4</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>s </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>
IL_0002</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> call int32 C</span></span><span class=pun><span class=pun>::</span></span><span class=pln><span class=pln>N</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
IL_0007</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>
IL_0008</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> ret</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>But with inlining, the JIT is able to generate this for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>M</span></code>:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pln><span class=pln>L0000</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> mov eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0x1e</span></span><span class=pln><span class=pln>
L0005</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> ret</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>having inlined the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>20</span></code>, constant folded <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>10</span><span class=pln> </span><span class=pun>+</span><span class=pln> </span><span class=lit>20</span></code>, and gotten the constant value <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>30</span></code> (hex <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0x1e</span></code>). Constant folding also goes hand-in-hand with “constant propagation,” which is the practice of the compiler substituting a constant value into an expression, at which point compilers will often be able to iterate, apply more constant folding, do more constant propagation, and so on. Let’s say I have this non-trivial set of helper methods:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ContainsSpace</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> s</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Contains</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>' '</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Contains</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> s</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> s</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> s</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Based on whatever their needs were, the developer of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Contains</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>)</span></code> decided that it would very frequently be called with string literals, and that single character literals were common. Now if I write:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> M</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ContainsSpace</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>" "</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>the entirety of the generated code produced by the JIT for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>M</span></code> is:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pln><span class=pln>L0000</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> mov eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
L0005</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> ret</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>How is that possible? The JIT inlines <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Contains</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>)</span></code> into <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ContainsSpace</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>)</span></code>, and inlines <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ContainsSpace</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>)</span></code> into <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>M</span><span class=pun>()</span></code>. The implementation of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ContainsSpace</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>)</span></code> is then exposed to the fact that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pln> s</span></code> is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>" "</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pln> c</span></code> is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>' '</span></code>. It can then propagate the fact that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s</span><span class=pun>.</span><span class=typ>Length</span></code> is actually the constant <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1</span></code>, which enables deleting as dead code everything after the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code> block. It can then see that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s</span><span class=pun>[</span><span class=lit>0</span><span class=pun>]</span></code> is in-bounds, and remove any bounds checking, and can see that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s</span><span class=pun>[</span><span class=lit>0</span><span class=pun>]</span></code> is the first character in the constant string <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>" "</span></code>, a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>' '</span></code>, and can then see that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>' '</span><span class=pln> </span><span class=pun>==</span><span class=pln> </span><span class=str>' '</span></code>, making the entire operation return a constant <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code>, hence the resulting <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov eax</span><span class=pun>,</span><span class=pln> </span><span class=lit>1</span></code>, which is used to return a Boolean value <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code>. Neat, right? Of course, you may be asking yourself, “Does code really call such methods with literals?” And the answer is, absolutely, in lots of situations; the PR in .NET 5 that introduced the ability to treat <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"literalString"</span><span class=pun>.</span><span class=typ>Length</span></code> as a constant highlighted thousands of bytes of improvements in the generated assembly code across the core libraries. But a good example in .NET 6 that makes extra-special use of this is <a href=https://github.com/dotnet/runtime/pull/57217 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#57217</a>. The methods being changed in this PR are expected to be called from C# compiler-generated code with literals, and being able to specialize based on the length of the string literal passed effectively enables multiple implementations of the method the JIT can choose from based on its knowledge of the literal used at the call site, resulting in faster and smaller code when such a literal is used.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这怎么可能呢？JIT将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Contains</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>)</span></code> 内联到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ContainsSpace</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>)</span></code> ，将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ContainsSpace</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>)</span></code> 内联到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>M</span><span class=pun>()</span></code> 。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ContainsSpace</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>)</span></code> 的实现然后暴露于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pln> s</span></code> 是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>" "</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pln> c</span></code> 是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>' '</span></code> 的事实。然后，它可以传播 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s</span><span class=pun>.</span><span class=typ>Length</span></code> 实际上是常量 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1</span></code> 的事实，这使得能够将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code> 块之后的所有内容作为死代码删除。然后它可以看到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s</span><span class=pun>[</span><span class=lit>0</span><span class=pun>]</span></code> 是内界，并删除任何边界检查，并且可以看到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s</span><span class=pun>[</span><span class=lit>0</span><span class=pun>]</span></code> 是常量字符串 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>" "</span></code> 中的第一个字符，即 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>' '</span></code> ，然后可以看到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>' '</span><span class=pln> </span><span class=pun>==</span><span class=pln> </span><span class=str>' '</span></code> ，使得整个操作返回常量 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code> ，因此得到的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov eax</span><span class=pun>,</span><span class=pln> </span><span class=lit>1</span></code> ，用于返回布尔值 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code> 。很干净，对吧？当然，您可能会问自己，“代码真的用文字调用这样的方法吗？“答案是，绝对的，在很多情况下;.NET 5中的PR引入了将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"literalString"</span><span class=pun>.</span><span class=typ>Length</span></code> 视为常量的能力，突出了跨核心库生成的汇编代码中数千字节的改进。但在。NET 6特别使用这一点的是dotnet/runtime#57217。在此PR中被更改的方法预计将从C#编译器生成的具有文字的代码中调用，并且能够基于传递的字符串文字的长度进行专门化，有效地实现了JIT可以基于其在调用站点使用的文字的知识选择的方法的多种实现，从而在使用这种文字时产生更快更小的代码。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>But, the JIT needs to be taught what kinds of things can be folded. <a href=https://github.com/dotnet/runtime/pull/49930 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49930</a> teaches it how to fold null checks when used with constant strings, which as in the previous example, is most valuable with inlining. Consider the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Microsoft</span><span class=pun>.</span><span class=typ>Extensions</span><span class=pun>.</span><span class=typ>Logging</span><span class=pun>.</span><span class=typ>Console</span><span class=pun>.</span><span class=typ>ConsoleFormatter</span></code> abstract base class. It exposes a protected constructor that looks like this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>但是，JIT需要被教导什么样的东西可以折叠。dotnet/runtime#49930教它如何在使用常量字符串时折叠空检查，这与前面的例子一样，在内联中最有价值。考虑 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Microsoft</span><span class=pun>.</span><span class=typ>Extensions</span><span class=pun>.</span><span class=typ>Logging</span><span class=pun>.</span><span class=typ>Console</span><span class=pun>.</span><span class=typ>ConsoleFormatter</span></code> 抽象基类。它公开了一个如下所示的受保护构造函数：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>protected</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ConsoleFormatter</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> name</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>Name</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> name </span></span><span class=pun><span class=pun>??</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArgumentNullException</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nameof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>name</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which is a fairly typical construct: validating that an argument isn’t null, throwing an exception if it is, and storing it if it’s not. Now look at one of the built-in types derived from it, like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonConsoleFormatter</span></code>:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这是一个相当典型的结构：验证参数是否为空，如果为空则抛出异常，如果为空则存储异常。现在看看从它派生的内置类型之一，比如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonConsoleFormatter</span></code> ：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>JsonConsoleFormatter</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IOptionsMonitor</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>JsonConsoleFormatterOptions</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> options</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>base</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>ConsoleFormatterNames</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Json</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>ReloadLoggerOptions</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>options</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CurrentValue</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _optionsReloadToken </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> options</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>OnChange</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>ReloadLoggerOptions</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Note that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>base</span><span class=pln> </span><span class=pun>(</span><span class=typ>ConsoleFormatterNames</span><span class=pun>.</span><span class=typ>Json</span><span class=pun>)</span></code> call. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConsoleFormatterNames</span><span class=pun>.</span><span class=typ>Json</span></code> is defined as:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>base</span><span class=pln> </span><span class=pun>(</span><span class=typ>ConsoleFormatterNames</span><span class=pun>.</span><span class=typ>Json</span><span class=pun>)</span></code> 调用。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConsoleFormatterNames</span><span class=pun>.</span><span class=typ>Json</span></code> 定义为：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>const</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Json</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"json"</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>so this <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>base</span></code> call is really:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>所以这个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>base</span></code> 电话实际上是：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>base</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"json"</span></span><span class=pun><span class=pun>)</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>When the JIT inlines the base constructor, it’ll now be able to see that the input is definitively not null, at which point it can eliminate as dead code the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>??</span><span class=pln> </span><span class=kwd>throw</span><span class=pln> </span><span class=kwd>new</span><span class=pln> </span><span class=typ>ArgumentNullException</span><span class=pun>(</span><span class=pln>nameof</span><span class=pun>(</span><span class=pln>name</span><span class=pun>)</span></code>, and the entire inlined call will simply be the equivalent of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Name</span><span class=pln> </span><span class=pun>=</span><span class=pln> </span><span class=str>"json"</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当JIT内联基构造函数时，它现在可以看到输入绝对不是null，此时它可以消除 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>??</span><span class=pln> </span><span class=kwd>throw</span><span class=pln> </span><span class=kwd>new</span><span class=pln> </span><span class=typ>ArgumentNullException</span><span class=pun>(</span><span class=pln>nameof</span><span class=pun>(</span><span class=pln>name</span><span class=pun>)</span></code> 作为死代码，整个内联调用将简单地等同于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Name</span><span class=pln> </span><span class=pun>=</span><span class=pln> </span><span class=str>"json"</span></code> 。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50000 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50000</a> is similar. As mentioned earlier, thanks to tiered compilation, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span></code>s initialized in tier 0 can become consts in tier 1. This was enabled in previous .NET releases. For example, you might find code that dynamically enables or disables a feature based on an environment variable and then stores the result of that into a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span><span class=pln> </span><span class=kwd>bool</span></code>. When code reading that static field is recompiled in tier 1, the Boolean value can be considered a constant, enabling branches based on that value to be trimmed away. For example, given this benchmark:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#50000类似。如前所述，由于分层编译，在第0层初始化的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span></code> 可以成为第1层的常量。在以前的.NET版本中启用了此功能。例如，您可能会找到基于环境变量动态启用或禁用特性的代码，然后将结果存储到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span><span class=pln> </span><span class=kwd>bool</span></code> 中。当阅读该静态字段的代码在第1层中重新编译时，布尔值可以被视为常量，从而可以删除基于该值的分支。例如，给定这个基准：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> s_coolFeatureEnabled </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetCoolFeatureEnabled</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetCoolFeatureEnabled</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> envVar </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Environment</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetEnvironmentVariable</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"EnableCoolFeature"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> envVar </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"1"</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>||</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"true"</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>envVar</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>StringComparison</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>OrdinalIgnoreCase</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UsedWhenCoolEnabled</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UsedWhenCoolNotEnabled</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CallCorrectMethod</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s_coolFeatureEnabled</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>UsedWhenCoolEnabled</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>else</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>UsedWhenCoolNotEnabled</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>since I’ve not set the environment variable, when I run this and examine the resulting tier 1 assembly for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CallCorrectMethod</span></code>, I see this:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CallCorrectMethod</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       jmp       near ptr </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>UsedWhenCoolNotEnabled</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>5</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>That is the entirety of the implementation; there’s no call to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UsedWhenCoolEnabled</span></code> anywhere in sight, because the JIT was able to prune away the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code> block as dead code based on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s_coolFeatureEnabled</span></code> being a constant <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>false</span></code>. The aforementioned PR builds on that capability by enabling null folding for such values. Consider a library that exposes a method like:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;(</span></span><span class=pln><span class=pln>T i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> T j</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEqualityComparer</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> comparer</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    comparer </span></span><span class=pun><span class=pun>??=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EqualityComparer</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> comparer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> j</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>comparing two values using the specified comparer, and if the specified comparer is null, using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code>. Now, with our benchmark we pass in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=str>&lt;int&gt;</span><span class=pun>.</span><span class=typ>Default</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>使用指定的比较器比较两个值，并且如果指定的比较器为空，则使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code> 。现在，通过我们的基准测试，我们通过了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=str>&lt;int&gt;</span><span class=pun>.</span><span class=typ>Default</span></code> 。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Arguments</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> j</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> j</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EqualityComparer</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;(</span></span><span class=pln><span class=pln>T i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> T j</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEqualityComparer</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> comparer</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    comparer </span></span><span class=pun><span class=pun>??=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EqualityComparer</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> comparer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> j</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This is what the resulting assembly looks like with .NET 5 and .NET 6:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>下面是.NET 5和.NET 6的结果程序集的外观： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1503FF62D58</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rcx
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1503FF62D58</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       mov       r11</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>7FFE420C03A0</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=lit><span class=lit>7FFE424403A0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       jmp       rax
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>51</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Equals</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1B4CE6C2F78</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       r11</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>7FFE5AE60370</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=lit><span class=lit>7FFE5B1C0370</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       jmp       rax
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>33</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>On .NET 5, those first two <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code> instructions are loading the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=str>&lt;int&gt;</span><span class=pun>.</span><span class=typ>Default</span></code>. Then with the call to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Equals</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;(</span><span class=kwd>int</span><span class=pun>,</span><span class=pln> </span><span class=kwd>int</span><span class=pun>,</span><span class=pln> </span><span class=typ>IEqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> inlined, that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>test rcx</span><span class=pun>,</span><span class=pln> rcx</span></code> is the null check for the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=str>&lt;int&gt;</span><span class=pun>.</span><span class=typ>Default</span></code> passed as an argument. If it’s not null (it won’t be null), it then jumps to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>M00_L00</span></code>, where those two <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code>s and a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>jmp</span></code> are a tail call to the interface <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Equals</span></code> method. On .NET 6, you can see those first two instructions are still there, and the last three instructions are still there, but the middle four instructions (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>test</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>jne</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code>) have evaporated, because the compiler is now able to propagate the non-nullness of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span></code> and eliminate completely the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>comparer </span><span class=pun>??=</span><span class=pln> </span><span class=typ>EqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span><span class=pun>;</span></code> from the inlined helper.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在.NET 5上，前两条 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code> 指令正在加载 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=str>&lt;int&gt;</span><span class=pun>.</span><span class=typ>Default</span></code> 。然后，对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Equals</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;(</span><span class=kwd>int</span><span class=pun>,</span><span class=pln> </span><span class=kwd>int</span><span class=pun>,</span><span class=pln> </span><span class=typ>IEqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的调用内联， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>test rcx</span><span class=pun>,</span><span class=pln> rcx</span></code> 是作为参数传递的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=str>&lt;int&gt;</span><span class=pun>.</span><span class=typ>Default</span></code> 的空校验。如果它不是null（它不会是null），它就会跳转到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>M00_L00</span></code> ，其中这两个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code> 和一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>jmp</span></code> 是对接口 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Equals</span></code> 方法的尾部调用。在.NET 6上，你可以看到前两条指令仍然存在，最后三条指令仍然存在，但中间的四条指令（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>test</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>jne</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code> ）已经消失了，因为编译器现在能够传播 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span></code> 的非空性，并从内联帮助器中完全消除 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>comparer </span><span class=pun>??=</span><span class=pln> </span><span class=typ>EqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span><span class=pun>;</span></code> 。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/47321 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47321</a> also adds a lot of power with regards to folding. Most of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Math</span></code> methods can now participate in constant folding, so if their inputs end up as constants for whatever reason, the results can become constants as well, and with constant propagation, this leads to the potential for serious reduction in run-time evaluation. Here’s a benchmark I created by copying some of the sample code from the <a href=https://docs.microsoft.com/dotnet/api/system.math target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>System.Math docs</a>, editing it to create a method that computes the height of a trapezoid.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>double</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetHeight</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetHeight</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>20.0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10.0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8.0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AggressiveInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>double</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetHeight</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>double</span></span><span class=pln><span class=pln> longbase</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>double</span></span><span class=pln><span class=pln> shortbase</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>double</span></span><span class=pln><span class=pln> leftLeg</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>double</span></span><span class=pln><span class=pln> rightLeg</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>double</span></span><span class=pln><span class=pln> x </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>rightLeg</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2.0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>leftLeg</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2.0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>longbase</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2.0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>shortbase</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2.0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> shortbase </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> longbase</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>/</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>longbase </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln> shortbase</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sqrt</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>rightLeg</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2.0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>x</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2.0</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>These are what I get for benchmark results:</p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetHeight</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>151.7852 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>179 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetHeight</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.0000 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>12 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Note the time spent for .NET 6 has dropped to nothing, and the code size has dropped from 179 bytes to 12. How is that possible? Because the entire operation became a single constant. The .NET 5 assembly looked like this:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetHeight</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>38</span></span><span class=pln><span class=pln>
       vzeroupper
       vmovsd    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31CA0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovsd    xmm1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31CB0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       vmovsd    qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>28</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>xmm0
       vmovsd    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31CC0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovsd    xmm1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31CD0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       vmovsd    xmm2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>28</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vsubsd    xmm3</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0
       vmovsd    qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>30</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>xmm3
       vmovsd    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31CE0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovsd    xmm1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31CF0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       vaddsd    xmm2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>30</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovsd    qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>30</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>xmm2
       vmovsd    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31D00</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovsd    xmm1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31D10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       vaddsd    xmm1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qwor44562d ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>30</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vsubsd    xmm1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31D20</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vdivsd    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm1</span></span><span class=pun><span class=pun>,[</span></span><span class=lit><span class=lit>7FFE66C31D30</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vmovsd    xmm1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE66C31D40</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Math</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pow</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Double</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       vmovsd    xmm2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>28</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       vsubsd    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0
       vsqrtsd   xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>xmm0
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>38</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>179</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>with at least five calls to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Math</span><span class=pun>.</span><span class=typ>Pow</span></code> on top of a bunch of double addition, subtraction, and square root operations, whereas with .NET 6, we get:</p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetHeight</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       vzeroupper
       vmovsd    xmm0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>7FFE5B1BCE70</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>12</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which is just returning a constant double value. It’s hard not to smile when seeing that.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There were additional folding-related improvements. <a href=https://github.com/dotnet/runtime/pull/48568 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48568</a> from <a href=https://github.com/SingleAccretion target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@SingleAccretion</a> improved the handling of unsigned comparisons as part of constant folding and propagation; <a href=https://github.com/dotnet/runtime/pull/47133 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47133</a> from <a href=https://github.com/SingleAccretion target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@SingleAccretion</a> changed in what phase of the JIT certain folding is performed in order to improve its impact on inlining; and <a href=https://github.com/dotnet/runtime/pull/43567 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43567</a> improved the folding of commutative operators. Further, for ReadyToRun, <a href=https://github.com/dotnet/runtime/pull/42831 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42831</a> from <a href=https://github.com/nathan-moore target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@nathan-moore</a> ensured that the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Length</span></code> of an array created from a constant could be propagated as a constant.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Most of the improvements we’ve talked about thus far are cross-cutting. Sometimes, though, improvements are much more focused, with a change intended to improve the code generated for a very specific pattern. And there have been a lot of those in .NET 6. Here are a few examples:</p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li style=list-style-type:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/37245 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#37245</a>. When implicitly casting a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> to a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code>, the operator performs a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>null</span></code> check on the input, such that it’ll return an empty span if the string is null. The operator is aggressively inlined, however, and so if the call site can prove that the string is not null, the null check can be eliminated.
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ReadOnlySpan</span></span><span class=str><span class=str>&lt;char&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Const</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"hello world"</span></span><span class=pun><span class=pun>;</span></span></code></pre>
</li>
</ul>
</li>
</ul>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Const</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>12AE3A09B48</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       xor       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       xor       r8d</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       jmp       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>eax
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>eax
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0C</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       mov       r8d</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0B</span></span><span class=pln><span class=pln>
M00_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rcx
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>r8d
       mov       rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rdx
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>53</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Const</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>18030C4A038</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0C</span></span><span class=pln><span class=pln>
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rax
       mov       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>0B</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rdx
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>31</span></span></code></pre>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li style=list-style-type:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/37836 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#37836</a>. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BitOperations</span><span class=pun>.</span><span class=typ>PopCount</span></code> was added in .NET Core 3.0, and returns the “popcount”, or “population count”, of the input number, meaning the number of bits set. It’s implemented as a hardware intrinsic if the underlying hardware supports it, or via a software fallback otherwise, but it’s also easily computed at compile time if the input is a constant (or if it becomes a constant from the JIT’s perspective, e.g. if the input is a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span></code>). This PR turns <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PopCount</span></code> into a JIT intrinsic, enabling the JIT to substitute a value for the whole method invocation if it deems that appropriate.
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PopCount</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BitOperations</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PopCount</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>42</span></span><span class=pun><span class=pun>);</span></span></code></pre>
</li>
</ul>
</li>
</ul>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PopCount</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2A</span></span><span class=pln><span class=pln>
       popcnt    eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PopCount</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>6</span></span></code></pre>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li style=list-style-type:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50997 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50997</a>. This is a great example of improvements being made to the JIT based on an evolving need from the kinds of things libraries end up doing. In particular, this came about because of improvements to string interpolation that we’ll discuss later in this post. Previously, if you wrote the interpolated string <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>$</span><span class=str>"{_nullableValue}"</span></code> where <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>_nullableValue</span></code> was, say, an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pun>?</span></code>, this would result in a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Format</span></code> call that passes <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>_nullableValue</span></code> as an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code> argument. Boxing that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pun>?</span></code> translates into either null if the nullable value is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>null</span></code> or boxing its <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> value if it’s not null. With C# 10 and .NET 6, this will instead result in a call to a generic method, passing in the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>_nullableValue</span></code> strongly-typed as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code>==<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pun>?</span></code>, and that generic method then checks for various interfaces on the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> and uses them if they exist. In performance testing of the feature, this exposed a measurable performance cliff due to the code generation employed for the nullable value types, both in allocation and in throughput. This PR helped to avoid that cliff by optimizing the boxing involved for this pattern of interface checking and usage.
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> _nullableValue </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_nullableValue</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>T </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IFormatProvider</span></span><span class=pln><span class=pln> provider </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IFormattable</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>((</span></span><span class=typ><span class=typ>IFormattable</span></span><span class=pun><span class=pun>)</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> provider</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
</li>
</ul>
</li>
</ul>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Format</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>87.71 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>154 B</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Format</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>51.88 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.59</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>100 B</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>24 B</td>
</tr>
</tbody>
</table></div>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50112 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50112</a>. For hot code paths, especially those concerned about size, there’s a common “throw helper” pattern employed where the code to perform a throw is moved out into a separate method, as the JIT won’t inline a method that is discovered to always throw. If there’s a common check being employed, that’s often then put it into its own helper. So, for example, if you wanted a helper method that checked to see if some reference type argument was null and then threw an exception if it was, that might look like this:
<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#50112。对于热代码路径，特别是那些关注大小的代码路径，有一个常见的“抛出帮助器”模式，其中执行抛出的代码被移出到一个单独的方法中，因为JIT不会内联一个发现总是抛出的方法。如果有一个共同的支票被使用，那通常然后把它放在自己的助手。所以，例如，如果你想要一个helper方法来检查某个引用类型参数是否为null，然后如果是，抛出一个异常，这可能看起来像这样： </font></font></font><pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ThrowIfNull</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>NotNull</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>object</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> argument</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>CallerArgumentExpression</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"argument"</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> paramName </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>argument </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Throw</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>paramName</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>DoesNotReturn</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Throw</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> paramName</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArgumentNullException</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>paramName</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>And, in fact, that’s exactly what the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArgumentNullException</span><span class=pun>.</span><span class=typ>ThrowIfNull</span></code> helper introduced in <a href=https://github.com/dotnet/runtime/pull/55594 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55594</a> looks like. The trouble with this, however, is that in order to call the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThrowIfNull</span></code> method with a string literal, we end up needing to materialize that string literal as a string object (e.g. for a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pln> input</span></code> argument, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>nameof</span><span class=pun>(</span><span class=pln>input</span><span class=pun>)</span></code>, aka <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"input"</span></code>). If the check were being done inline, the JIT already has logic to deal with that, e.g. this:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Arguments</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"hello"</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ThrowIfNull</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> input</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=com><span class=com>//ThrowIfNull(input, nameof(input));</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>input </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArgumentNullException</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nameof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>input</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>produces on .NET 5:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在.NET 5上生成： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowIfNull</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>String</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       push      rsi
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>20</span></span><span class=pln><span class=pln>
       test      rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rdx
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>20</span></span><span class=pln><span class=pln>
       pop       rsi
       ret
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>offset MT_System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ArgumentNullException</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_NEWSFAST
       mov       rsi</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       mov       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       mov       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>7FFE715BB748</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_STRCNS
       mov       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rsi
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ArgumentNullException</span></span><span class=pun><span class=pun>..</span></span><span class=pln><span class=pln>ctor</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>String</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rsi
       call      CORINFO_HELP_THROW
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>74</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In particular, we’re talking about that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call CORINFO_HELP_STRCNS</span></code>. But with the check and throw moved into the helper, that lazy initialization of the string literal object doesn’t happen. We end up with the assembly for the check looking nice and slim, but from an overall memory perspective, it’s likely a regression to force all of those string literals to be materialized. This PR addressed that, by ensuring the lazy initialization still happens, only if we’re about to throw, even with the helper being used.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>特别是，我们正在谈论 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call CORINFO_HELP_STRCNS</span></code> 。但是将检查和抛出移到helper中后，字符串文本对象的延迟初始化就不会发生了。最后，检查的程序集看起来很漂亮，但从整体内存的角度来看，很可能是一种回归，迫使所有这些字符串文字都具体化。这个PR解决了这个问题，通过确保延迟初始化仍然发生，只有当我们将要抛出时，即使使用了helper。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Arguments</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"hello"</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ThrowIfNull</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> input</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>ThrowIfNull</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>input</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> nameof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>input</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ThrowIfNull</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>NotNull</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>object</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> argument</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>CallerArgumentExpression</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"argument"</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> paramName </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>argument </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Throw</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>paramName</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>DoesNotReturn</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Throw</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> paramName</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArgumentNullException</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>paramName</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowIfNull</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>String</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       test      rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rdx
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1FC48939520</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       jmp       near ptr </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Throw</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>String</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>24</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowIfNull</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>String</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       test      rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rdx
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       mov       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       mov       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>7FFEBF512BE8</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_STRCNS
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       jmp       near ptr </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Throw</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>String</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>46</span></span></code></pre>
</li>
</ul>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li style=list-style-type:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/43811 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43811</a> and <a href=https://github.com/dotnet/runtime/pull/46237 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46237</a>. It’s fairly common, in particular in the face of inlining, to end up with sequences that have redundant comparison operations. Consider a fairly typical expression when dealing with nullable value types: <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span><span class=pln> </span><span class=pun>(</span><span class=pln>i</span><span class=pun>.</span><span class=typ>HasValue</span><span class=pun>)</span><span class=pln> </span><span class=pun>{</span><span class=pln> </span><span class=typ>Use</span><span class=pun>(</span><span class=pln>i</span><span class=pun>.</span><span class=typ>Value</span><span class=pun>);</span><span class=pln> </span><span class=pun>}</span></code>. That <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i</span><span class=pun>.</span><span class=typ>Value</span></code> access invokes the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Nullable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Value</span></code> getter, which itself checks <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HasValue</span></code>, leading to a redundant comparison with the developer-written <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HasValue</span></code> check in the guard. This specific example has led some folks to adopt a pattern of using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetValueOrDefault</span><span class=pun>()</span></code> after a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HasValue</span></code> check, since somewhat ironically <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetValueOrDefault</span><span class=pun>()</span></code> just returns the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>value</span></code> field without any additional checks. But there shouldn’t be a penalty for writing the simpler code that makes logical sense. And thanks to this PR, there isn’t. The JIT will now walk the control flow graph to see if any <a href=https://en.wikipedia.org/wiki/Dominator_%28graph_theory%29 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dominating block</a> (basically, code we had to go through to get to this point) has a similar compare.
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsGreaterThan</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsGreaterThan</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>42</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>40</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsGreaterThan</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> j</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>HasValue</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;&amp;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Value</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> j</span></span><span class=pun><span class=pun>;</span></span></code></pre>
</li>
</ul>
</li>
</ul>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsGreaterThan</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Nullable</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>&gt;,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>30</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rcx
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pln><span class=pln> ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>30</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L00
       test      eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L01
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>34</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>edx
       setg      al
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>al
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M01_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M01_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowHelper</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowInvalidOperationException_InvalidOperation_NoValue</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>50</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsGreaterThan</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Nullable</span></span><span class=pun><span class=pun>~</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>&gt;,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rcx
       cmp       </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pln><span class=pln> ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L00
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rsp</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>0C</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>edx
       setg      al
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>al
       ret
M01_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>26</span></span></code></pre>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li style=list-style-type:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/49585 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49585</a>. Learning from others is very important. Division is typically a relatively slow operation on modern hardware, and thus compilers try to find ways to avoid it, especially when dividing by a constant. In such cases, the JIT will try to find an alternative, which typically involves some combination of shifting and multiplying by a “magic number” that’s derived from the particular constant. This PR implements the techniques from <a href=https://ridiculousfish.com/files/faster_unsigned_division_by_constants.pdf target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Faster Unsigned Division by Constants</a> to improve the magic number selected for a certain subset of constants, enabling better code generation when dividing by numbers like 7 or 365.
<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#49585。向他人学习是非常重要的。除法在现代硬件上通常是一个相对较慢的操作，因此编译器试图找到方法来避免它，特别是当除以常数时。在这种情况下，JIT将尝试找到一个替代方案，这通常涉及移位和乘以从特定常数导出的“幻数”的某种组合。此PR实现了常量快速无符号除法的技术，以改进为常量的某个子集选择的幻数，从而在除以7或365等数字时实现更好的代码生成。 </font></font></font><pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>uint</span></span><span class=pln><span class=pln> _value </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>12345</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>uint</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Div7</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _value </span></span><span class=pun><span class=pun>/</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pun><span class=pun>;</span></span></code></pre>
</li>
</ul>
</li>
</ul>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Div</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       ecx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>24924925</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       mul       edx
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       shr       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       lea       eax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       shr       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>23</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Div</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>492492492493</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       mul       rdx
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>21</span></span></code></pre>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li style=list-style-type:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/45463 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45463</a>. It’s fairly common to see code check whether a value is even by using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>%</span><span class=pln> </span><span class=lit>2</span><span class=pln> </span><span class=pun>==</span><span class=pln> </span><span class=lit>0</span></code>. The JIT can now transform that into code more like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>&amp;</span><span class=pln> </span><span class=lit>1</span><span class=pln> </span><span class=pun>==</span><span class=pln> </span><span class=lit>0</span></code> to arrive at the same answer but with less ceremony.
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Arguments</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>42</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsEven</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>%</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span></code></pre>
</li>
</ul>
</li>
</ul>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsEven</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       shr       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1F</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       </span></span><span class=kwd><span class=kwd>and</span></span><span class=pln><span class=pln>       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0FFFFFFFE</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       sete      al
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>al
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>19</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsEven</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       test      dl</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       sete      al
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>al
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>10</span></span></code></pre>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li style=list-style-type:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/44562 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44562</a>. It’s common in high-performance code that uses cached arrays to see the code first store the arrays into locals and then operate on the locals. This enables the JIT to prove to itself, if it sees nothing else assigning into the array reference, that the array is invariant, such that it can learn from previous use of the array to optimize subsequent use. For example, if you iterate <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>for</span><span class=pln> </span><span class=pun>(</span><span class=kwd>int</span><span class=pln> i </span><span class=pun>=</span><span class=pln> </span><span class=lit>0</span><span class=pun>;</span><span class=pln> i </span><span class=pun>&lt;</span><span class=pln> arr</span><span class=pun>.</span><span class=typ>Length</span><span class=pun>;</span><span class=pln> i</span><span class=pun>++)</span><span class=pln> </span><span class=typ>Use</span><span class=pun>(</span><span class=pln>arr</span><span class=pun>[</span><span class=pln>i</span><span class=pun>]);</span></code>, it can eliminate the bounds check on the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span><span class=pun>[</span><span class=pln>i</span><span class=pun>]</span></code>, as it trusts <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>&lt;</span><span class=pln> arr</span><span class=pun>.</span><span class=typ>Length</span></code>. However, if this had instead been written as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>for</span><span class=pln> </span><span class=pun>(</span><span class=kwd>int</span><span class=pln> i </span><span class=pun>=</span><span class=pln> </span><span class=lit>0</span><span class=pun>;</span><span class=pln> i </span><span class=pun>&lt;</span><span class=pln> s_arr</span><span class=pun>.</span><span class=typ>Length</span><span class=pun>;</span><span class=pln> i</span><span class=pun>++)</span><span class=pln> </span><span class=typ>Use</span><span class=pun>(</span><span class=pln>s_arr</span><span class=pun>[</span><span class=pln>i</span><span class=pun>]);</span></code>, where <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s_arr</span></code> is defined as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span><span class=pln> </span><span class=kwd>int</span><span class=pun>[]</span><span class=pln> s_arr </span><span class=pun>=</span><span class=pln> </span><span class=pun>...;</span></code>, the JIT would not eliminate the bounds check, as the JIT wasn’t satisfied that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s_arr</span></code> was definitely not going to change, despite the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>readonly</span></code>. This PR fixed that, enabling the JIT to see this static readonly array as being invariant, which then enables subsequent optimizations like bounds check elimination and common subexpression elimination.
<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#44562。在使用缓存数组的高性能代码中，这种情况很常见，代码首先将数组存储到局部变量中，然后对局部变量进行操作。这使得JIT能够向自己证明，如果没有看到任何其他的赋值到数组引用中，则数组是不变的，使得它可以从数组的先前使用中学习以优化后续使用。例如，如果迭代 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>for</span><span class=pln> </span><span class=pun>(</span><span class=kwd>int</span><span class=pln> i </span><span class=pun>=</span><span class=pln> </span><span class=lit>0</span><span class=pun>;</span><span class=pln> i </span><span class=pun>&lt;</span><span class=pln> arr</span><span class=pun>.</span><span class=typ>Length</span><span class=pun>;</span><span class=pln> i</span><span class=pun>++)</span><span class=pln> </span><span class=typ>Use</span><span class=pun>(</span><span class=pln>arr</span><span class=pun>[</span><span class=pln>i</span><span class=pun>]);</span></code> ，它可以消除对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arr</span><span class=pun>[</span><span class=pln>i</span><span class=pun>]</span></code> 的边界检查，因为它信任 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>&lt;</span><span class=pln> arr</span><span class=pun>.</span><span class=typ>Length</span></code> 。然而，如果它被写为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>for</span><span class=pln> </span><span class=pun>(</span><span class=kwd>int</span><span class=pln> i </span><span class=pun>=</span><span class=pln> </span><span class=lit>0</span><span class=pun>;</span><span class=pln> i </span><span class=pun>&lt;</span><span class=pln> s_arr</span><span class=pun>.</span><span class=typ>Length</span><span class=pun>;</span><span class=pln> i</span><span class=pun>++)</span><span class=pln> </span><span class=typ>Use</span><span class=pun>(</span><span class=pln>s_arr</span><span class=pun>[</span><span class=pln>i</span><span class=pun>]);</span></code> ，其中 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s_arr</span></code> 被定义为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>readonly</span><span class=pln> </span><span class=kwd>int</span><span class=pun>[]</span><span class=pln> s_arr </span><span class=pun>=</span><span class=pln> </span><span class=pun>...;</span></code> ，JIT将不会消除边界检查，因为JIT不满意 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>s_arr</span></code> 肯定不会改变，尽管 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>readonly</span></code> 。此PR修复了这一点，使JIT能够将这个静态只读数组视为不变的，从而实现后续优化，如边界检查消除和公共子表达式消除。 </font></font></font><pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> s_array </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s_array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&gt;=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> s_array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> s_array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> s_array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> s_array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
</li>
</ul>
</li>
</ul>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>15434127338</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       cmp       dword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=lit><span class=lit>4</span></span><span class=pln><span class=pln>
       jl        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       mov       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       mov       ecx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       mov       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       r8</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>r8</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>14</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       r8</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>r8</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>18</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       cmp       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
       jbe       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>1C</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M00_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_RNGCHKFAIL
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>89</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sum</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28B98007338</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       cmp       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>4</span></span><span class=pln><span class=pln>
       jl        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       mov       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       mov       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>14</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>18</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       edx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>1C</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       ret
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>48</span></span></code></pre>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li style=list-style-type:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/49548 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49548</a>. This PR optimized various patterns involving comparisons against 0. Given an expression like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>a </span><span class=pun>==</span><span class=pln> </span><span class=lit>0</span><span class=pln> </span><span class=pun>&amp;&amp;</span><span class=pln> b </span><span class=pun>==</span><span class=pln> </span><span class=lit>0</span></code>, the JIT can now optimize that to be equivalent to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>(</span><span class=pln>a </span><span class=pun>|</span><span class=pln> b</span><span class=pun>)</span><span class=pln> </span><span class=pun>==</span><span class=pln> </span><span class=lit>0</span></code>, replacing a branch and second comparison with an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>or</span></code>.
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AreZero</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AreZero</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>MethodImpl</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>MethodImplOptions</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoInlining</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AreZero</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> x</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> y</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> x </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;&amp;</span></span><span class=pln><span class=pln> y </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span></code></pre>
</li>
</ul>
</li>
</ul>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AreZero</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       test      ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M01_L00
       test      edx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>edx
       sete      al
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>al
       ret
M01_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>16</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AreZero</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Int32</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>or</span></span><span class=pln><span class=pln>        edx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       sete      al
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>al
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>9</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I can’t cover all of the pattern changes in as much detail, but there have been many more, e.g.</p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/46253 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46253</a> converted the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>And</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>Or</span></code> methods introduced in .NET 5 into JIT intrinsics on ARM64.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#46253将.NET 5中引入的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>And</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>Or</span></code> 方法转换为ARM 64上的JIT内部函数。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/46243 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46243</a> and <a href=https://github.com/dotnet/runtime/pull/45311 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45311</a> avoided cast helpers from being emitted for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>(</span><span class=pln>T</span><span class=pun>)</span><span class=pln>array</span><span class=pun>.</span><span class=typ>Clone</span><span class=pun>()</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>.</span><span class=typ>MemberwiseClone</span><span class=pun>()</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#46243和dotnet/runtime#45311避免了为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>(</span><span class=pln>T</span><span class=pun>)</span><span class=pln>array</span><span class=pun>.</span><span class=typ>Clone</span><span class=pun>()</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>.</span><span class=typ>MemberwiseClone</span><span class=pun>()</span></code> 发出强制转换帮助程序。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/43947 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43947</a> added support for unrolling single-iteration loops.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#43947增加了对展开单次迭代循环的支持。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/54864 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54864</a> enabled more methods to be tail-called by allowing implicit widening.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#54864通过允许隐式扩展允许更多的方法被尾部调用。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/53214 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53214</a> eliminated redundant <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>test</span></code> instructions in some situations.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#53214在某些情况下消除了冗余的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>test</span></code> 指令。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/44419 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44419</a> enabled common subexpression elimination (CSE) for floating-point constants.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#44419启用了浮点常量的通用子表达式消除（CSE）。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/45604 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45604</a> from <a href=https://github.com/alexcovington target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@alexcovington</a> optimized division like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>-</span><span class=pln>i </span><span class=pun>/</span><span class=pln> </span><span class=lit>7</span></code> to instead be emitted as the equivalent of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>/</span><span class=pln> </span><span class=pun>-</span><span class=lit>7</span></code>, saving on a negation operation.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#45604来自@alexcovington的优化除法，如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>-</span><span class=pln>i </span><span class=pun>/</span><span class=pln> </span><span class=lit>7</span></code> ，而不是作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>/</span><span class=pln> </span><span class=pun>-</span><span class=lit>7</span></code> 的等价物发出，节省了求反操作。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/48589 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48589</a> extended support for throw helpers that are non-void returning.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#48589扩展了对非void返回的throw helper的支持。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/52298 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52298</a> optimized how floating-point constants are assigned to ref parameters.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#52298优化了浮点常量分配给ref参数的方式。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/32000 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#32000</a> from <a href=https://github.com/damageboy target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@damageboy</a> taught the JIT how to remove double-negation (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>~(~</span><span class=pln>x</span><span class=pun>)</span></code>).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 来自@damageboy的dotnet/runtime#32000教JIT如何删除双重否定（例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>~(~</span><span class=pln>x</span><span class=pun>)</span></code> ）。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/49238 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49238</a> enabled the JIT to elide some additional null checks.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#49238使JIT能够省略一些额外的null检查。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/35627 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#35627</a> caused the JIT to emit better instructions for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>&lt;</span><span class=pln> </span><span class=lit>0</span></code> checks.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#35627导致JIT为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>i </span><span class=pun>&lt;</span><span class=pln> </span><span class=lit>0</span></code> 检查发出更好的指令。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/42164 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42164</a> yielded better code generation for floating-point <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>-</span><span class=pln>X</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MathF</span><span class=pun>.</span><span class=typ>Abs</span><span class=pun>(</span><span class=pln>X</span><span class=pun>)</span></code> operations.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#42164为浮点 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>-</span><span class=pln>X</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MathF</span><span class=pun>.</span><span class=typ>Abs</span><span class=pun>(</span><span class=pln>X</span><span class=pun>)</span></code> 操作提供了更好的代码生成。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/41772 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#41772</a> enabled use of the BMI2 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>rorx</span></code> instruction as part of rotate operations (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BitOperations</span><span class=pun>.</span><span class=typ>RotateRight</span></code>).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#41772允许使用BMI 2 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>rorx</span></code> 指令作为旋转操作的一部分（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BitOperations</span><span class=pun>.</span><span class=typ>RotateRight</span></code> ）。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/55614 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55614</a> increased the number of loops in a given method that the JIT will optimize from 16 to 64.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#55614将JIT优化的给定方法中的循环数从16增加到64。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/51158 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51158</a> avoided some unnecessary spilling when storing into fields.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#51158避免了一些不必要的溢出时存储到字段。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50813 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50813</a> updated the JIT’s knowledge of the execution characteristics of several operations (SQRT, RCP, RSQRT).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#50813更新了JIT对几个操作（SQRT、RCP、RSQRT）执行特性的知识。</font></font></font></li>
</ul>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>At this point, I’ve spent a lot of blog real estate writing a love letter to the improvements made to the JIT in .NET 6. There’s still a lot more, but rather than share long sections about the rest, I’ll make a few final shout outs here:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在这一点上，我花了大量的博客真实的写了一封情书，以表达对.NET 6中JIT的改进。还有很多，但与其分享其余部分的长部分，我将在这里做一些最后的呼喊： </font></font></font></p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Value types have become more and more critical to optimize for, as developers focused on driving down allocations have turned to structs for salvation. However, historically the JIT hasn’t been able to optimize structs as well as one might have hoped, in particular around being able to keeps struct in registers aggressively. A lot of work happened in .NET 6 to improve the situation, and while there’s still some more to be done in .NET 7, things have come a long way.
<a href=https://github.com/dotnet/runtime/pull/43870 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43870</a>,
<a href=https://github.com/dotnet/runtime/pull/39326 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#39326</a>, <a href=https://github.com/dotnet/runtime/pull/44555 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44555</a>,
<a href=https://github.com/dotnet/runtime/pull/48377 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48377</a>,
<a href=https://github.com/dotnet/runtime/pull/55045 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55045</a>,
<a href=https://github.com/dotnet/runtime/pull/55535 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55535</a>,
<a href=https://github.com/dotnet/runtime/pull/55558 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55558</a>, and
<a href=https://github.com/dotnet/runtime/pull/55727 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55727</a>, among others, all contributed here.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>值类型的优化变得越来越重要，因为专注于降低分配的开发人员已经转向结构来拯救它。然而，从历史上看，JIT并不能像人们所希望的那样优化结构，特别是在能够积极地将结构保持在寄存器中的情况下。在.NET 6中进行了大量的工作来改善这种情况，虽然.NET 7中还有更多的工作要做，但事情已经取得了很大的进展。dotnet/runtime#43870，dotnet/runtime#39326，dotnet/runtime#44555，dotnet/runtime#48377，dotnet/runtime#55045，dotnet/runtime#55535，dotnet/runtime#55558，and dotnet/runtime#55727，除其他外，都有贡献在这里.</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Registers are really, really fast memory used to store data being used immediately by instructions. In any given code, there are typically many more variables in use than there are registers, and so something needs to determine which of those variables gets to live in which registers when. That process is referred to as “register allocation,” and getting it right contributes significantly to how well code performs. <a href=https://github.com/dotnet/runtime/pull/48308 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48308</a> from <a href=https://github.com/alexcovington target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@alexcovington</a>, <a href=https://github.com/dotnet/runtime/pull/54345 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54345</a>, <a href=https://github.com/dotnet/runtime/pull/47307 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47307</a>, <a href=https://github.com/dotnet/runtime/pull/45135 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45135</a>, and <a href=https://github.com/dotnet/runtime/pull/52269 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52269</a> all contributed to improving the JIT’s register allocation heuristics in .NET 6. There’s also a <a href=https://github.com/dotnet/runtime/blob/main/docs/design/coreclr/jit/lsra-heuristic-tuning.md target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>great write-up in dotnet/runtime</a> about some of these tuning efforts.<font data-immersive-translate-effect=1 data-immersive-translate-error-id=1331 class="notranslate immersive-translate-target-wrapper immersive-translate-target-wrapper-error" translate=no lang=zh-CN><a><font class="immersive-translate-error notranslate"><font class=immersive-translate-error-wrapper><font data-immersive-translate-action=retry title=重试全部错误段落 data-immersive-translate-paragraph-id=1331 class="immersive-translate-clickable-button notranslate"><img draggable=false role=img class=emoji alt=🔄 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iIzNCODhDMyIgZD0iTTM2IDMyYzAgMi4yMDktMS43OTEgNC00IDRINGMtMi4yMDkgMC00LTEuNzkxLTQtNFY0YzAtMi4yMDkgMS43OTEtNCA0LTRoMjhjMi4yMDkgMCA0IDEuNzkxIDQgNHYyOHoiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMjIuMjQyIDIyLjI0MmwyLjgyOSAyLjgyOWMtMy45MDUgMy45MDUtMTAuMjM3IDMuOTA0LTE0LjE0My0uMDAxLTIuMjQ3LTIuMjQ2LTMuMTk0LTUuMjk2LTIuODU0LTguMjI1bC00LjAzNy4zNjdjLS4yMTUgMy44NCAxLjEyOCA3Ljc1MiA0LjA2MiAxMC42ODcgNS40NjcgNS40NjcgMTQuMzMzIDUuNDY4IDE5Ljc5OSAwbDIuODI4IDIuODI4Ljg0OS05LjMzNC05LjMzMy44NDl6TTI3Ljg5OSA4LjFDMjIuNDMxIDIuNjMzIDEzLjU2OCAyLjYzMyA4LjEgOC4xTDUuMjcyIDUuMjcybC0uODQ5IDkuMzM0IDkuMzM0LS44NDktMi44MjktMi44MjljMy45MDYtMy45MDUgMTAuMjM2LTMuOTA1IDE0LjE0MiAwIDIuMjQ4IDIuMjQ3IDMuMTk0IDUuMjk3IDIuODU2IDguMjI2bDQuMDM2LS4zNjZjLjIxNi0zLjg0MS0xLjEyOC03Ljc1My00LjA2My0xMC42ODh6Ii8+PC9zdmc+></font>&nbsp;&nbsp;<font data-immersive-translate-action=toast-error data-immersive-translate-tooltip-text="Server is busy now, (10000), please retry later" title=点击查看错误原因 class="immersive-translate-help-button notranslate"><img draggable=false role=img class=emoji alt=❓ src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0JFMTkzMSIgZD0iTTE3IDI3Yy0xLjY1NyAwLTMtMS4zNDMtMy0zdi00YzAtMS42NTcgMS4zNDMtMyAzLTMgLjYwMy0uMDA2IDYtMSA2LTUgMC0yLTItNC01LTQtMi40NDEgMC00IDItNCAzIDAgMS42NTctMS4zNDMgMy0zIDNzLTMtMS4zNDMtMy0zYzAtNC44NzggNC41OC05IDEwLTkgOCAwIDExIDUuOTgyIDExIDExIDAgNC4xNDUtMi4yNzcgNy4zMTMtNi40MTMgOC45Mi0uOS4zNTEtMS43OS41ODctMi41ODcuNzQ3VjI0YzAgMS42NTctMS4zNDMgMy0zIDN6Ii8+PGNpcmNsZSBmaWxsPSIjQkUxOTMxIiBjeD0iMTciIGN5PSIzMiIgcj0iMyIvPjwvc3ZnPg=="></font></font></font></a></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“Loop alignment” is a technique in which nop instructions are added before a loop to ensure that the beginning of the loop’s instructions fall at an address most likely to minimize the number of fetches required to load the instructions that make up that loop. Rather than trying to do justice to the topic, I recommend <a href=https://devblogs.microsoft.com/dotnet/loop-alignment-in-net-6/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Loop alignment in .NET 6</a>, which is very well written and provides excellent details on the topic, including highlighting the improvements that came from <a href=https://github.com/dotnet/runtime/pull/44370 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44370</a>, <a href=https://github.com/dotnet/runtime/pull/42909 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42909</a>, and <a href=https://github.com/dotnet/runtime/pull/55047 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55047</a>.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Checking whether a type implements an interface (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span><span class=pln> </span><span class=pun>(</span><span class=pln>something </span><span class=kwd>is</span><span class=pln> </span><span class=typ>ISomething</span><span class=pun>)</span></code>) can be relatively expensive, and in the worst case involves a linear walk through all of a type’s implemented interfaces to see whether the specified one is in the list. The implementation here is relegated by the JIT to several helper functions, which, as of .NET 5, are now written in C# and live in the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>CompilerServices</span><span class=pun>.</span><span class=typ>CastHelpers</span></code> type as the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsInstanceOfInterface</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ChkCastInterface</span></code> interface methods. It’s not an understatement to say that the performance of these methods is critical to many applications running efficiently. So, lots of folks were excited to see <a href=https://github.com/dotnet/runtime/pull/49257 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49257</a> from <a href=https://github.com/benaadams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@benaadams</a>, which managed to improve the performance of these methods by ~15% to ~35%, depending on the usage.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>检查类型是否实现接口（例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span><span class=pln> </span><span class=pun>(</span><span class=pln>something </span><span class=kwd>is</span><span class=pln> </span><span class=typ>ISomething</span><span class=pun>)</span></code> ）可能相对昂贵，并且在最坏的情况下涉及到线性遍历一个类型的所有实现的接口，以查看指定的接口是否在列表中。这里的实现被JIT归为几个helper函数，从.NET 5开始，这些helper函数现在是用C#编写的，并以 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>CompilerServices</span><span class=pun>.</span><span class=typ>CastHelpers</span></code> 类型作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsInstanceOfInterface</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ChkCastInterface</span></code> 接口方法。毫不夸张地说，这些方法的性能对许多高效运行的应用程序至关重要。所以，很多人都很高兴看到来自@benaadams的dotnet/runtime#49257，它设法提高了这些方法的性能约15%到35%，具体取决于使用情况。</font></font></font></li>
</ul>
<h3 id=gc data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GC<a aria-labelledby=gc class=linkicon href=#gc data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There’s been a lot of work happening in .NET 6 on the GC (garbage collector), the vast majority of which has been in the name of switching the GC implementation to be based on “regions” rather than on “segments”. The initial commit for regions is in <a href=https://github.com/dotnet/runtime/pull/45172 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45172</a>, with over 30 PRs since expanding on it. <a href=https://github.com/maoni0 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@maoni0</a> is shepherding this effort and has already written on the topic; I encourage reading her post <a href=https://devblogs.microsoft.com/dotnet/put-a-dpad-on-that-gc/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Put a DPAD on that GC!</a> to learn more in depth. But here are a few key statements from her post to help shed some light on the terminology:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在.NET 6中有很多关于GC（垃圾收集器）的工作，其中绝大多数都是以将GC实现切换为基于“区域”而不是基于“段”的名义进行的。区域的初始提交是在dotnet/runtime#45172中，自扩展以来，已经有超过30个PR。@maoni0正在指导这项工作，并已经写了关于这个主题的文章;我鼓励阅读她的文章把一个DPAD放在那个GC！深入学习。但以下是她帖子中的一些关键陈述，以帮助阐明术语：</font></font></font></p>
<blockquote data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“So what are the key differences between segments and regions? Segments are large units or memory – on Server GC 64-bit if the segment sizes are 1GB, 2GB or 4GB each (for Workstation it’s much smaller – 256MB) on SOH. Regions are much smaller units, they are by default 4MB each. So you might ask, “so they are smaller, why is that significant?”<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>“那么，细分市场和地区之间的主要区别是什么？段是大单位或内存-在服务器GC 64位，如果段大小分别为1GB、2GB或4GB（对于Workstation，它小得多-256 MB），则在SOH上。区域是小得多的单位，默认情况下每个区域是4 MB。所以你可能会问，“所以它们比较小，为什么这很重要？“ </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“[Imagine] a scenario where we have free spaces in one generation, say gen0 because there’s some async IO going on that caused us to demote a bunch of pins in gen0, that we don’t actually use (this could be due to not waiting for so long to do the next GC or we’d have accumulated too much survival which means the GC pause would be too long). Wouldn’t it be nice if we could use those free spaces for other generations if they need them! Same with free spaces in gen2 and LOH – you might have some free spaces in gen2, it would be nice to use them to allocate some large objects. We do decommit on a segment but only the end of the segment which is after the very last live object on that segment (denoted by the light gray space at the end of each segment). And if you have pinning that prevents the GC from retracting the end of the segment, then we can only form free spaces and free spaces are always committed memory. Of course you might ask, “why don’t you just decommit the middle of a segment that has large free spaces?”. But that requires bookkeeping to remember which parts in the middle of a segment are decommitted so we need to re-commit them when we want to use them to allocate objects. And now we are getting into the idea of regions anyway, which is to have much smaller amounts of memory being manipulated separately by the GC.”<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>“想象一下，我们在一代中有空闲空间，比如gen 0，因为有一些异步IO正在进行，导致我们降级gen 0中的一堆引脚，我们实际上并不使用（这可能是由于没有等待这么长时间来执行下一个GC，或者我们积累了太多的生存时间，这意味着GC暂停时间太长）。如果我们能为其他世代使用这些自由空间，那岂不是很好吗？gen 2和洛中的自由空间也一样--gen 2中可能有一些自由空间，最好用它们来分配一些大型对象。我们确实在一个片段上分解，但仅在该片段上的最后一个活动对象之后的片段的末端（由每个片段末端的浅灰色空间表示）。如果你有固定，阻止GC收回段的末尾，那么我们只能形成空闲空间，空闲空间总是提交内存。 当然，你可能会问，“为什么你不直接分解一个有很大空闲空间的片段的中间呢？“.但这需要簿记来记住段中间的哪些部分是分解的，所以当我们想要使用它们分配对象时，我们需要重新提交它们。现在我们开始考虑区域的概念，即GC单独操作的内存量要小得多。“</font></font></font></p></blockquote>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Beyond regions, there have been other improvements to the GC in .NET 6:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>除了区域之外，.NET 6中的GC还有其他改进： </font></font></font></p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/45208 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45208</a> optimized the “plan phase” of foreground GCs (gen0 and gen1 GCs done while a background GC is in progress) by enabling it to use its list of marked objects, shaving a significant amount of time off the operation.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#45208优化了前景GC的“计划阶段”（gen 0和gen 1 GC在后台GC进行时完成），使其能够使用其标记对象列表，从而节省了大量的操作时间。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/41599 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#41599</a> helps reduce pause times by ensuring that the mark lists are distributely evenly across all of the GC heaps / threads in server GC.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/55174 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55174</a> added a time-based decay that enables gen 0 and gen1 budgets to shrink over time with inactivity after they’d previously significantly expanded.</li>
</ul>
<h3 id=threading data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Threading<a aria-labelledby=threading class=linkicon href=#threading data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Moving up the stack a bit, let’s talk threading, starting with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadPool</span></code>.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sometimes performance optimizations are about eliminating unnecessary work, or making tradeoffs that optimize for the common case while slightly pessimizing niche cases, or taking advantage of new lower-level capabilities to do something faster, or any number of other things. But sometimes, performance optimizations are about finding ways to help bad-but-common code be a little less bad.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>A thread pool’s job is simple: run work items. To do that, at its core a thread pool needs two things: a queue of work to be processed, and a set of threads to process them. We can write a functional, trivial thread pool, well, trivially:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SimpleThreadPool</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlockingCollection</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Action</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> s_work </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>QueueUserWorkItem</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Action</span></span><span class=pln><span class=pln> action</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> s_work</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Add</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>action</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SimpleThreadPool</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Environment</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ProcessorCount</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Thread</span></span><span class=pun><span class=pun>(()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> s_work</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Take</span></span><span class=pun><span class=pun>()();</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>})</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsBackground</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}.</span></span><span class=typ><span class=typ>Start</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Boom, functional thread pool. But… not a very good one. The hardest part of a good thread pool is in the management of the threads, and in particular determining at any given point how many threads should be servicing the queue of work. Too many threads, and you can grind a system to a halt, as all threads are fighting for the system’s resources, adding huge overheads with context switching, and getting in each other’s way with cache thrashing. Too few threads, and you can grind a system to a halt, as work items aren’t getting processed fast enough or, worse, running work items are blocked waiting for other work items to run but without enough additional threads to run them. The .NET <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadPool</span></code> has multiple mechanisms in place for determining how many threads should be in play at any point in time. First, it has a starvation detection mechanism. This mechanism is a fairly straightforward gate that kicks in once or twice a second and checks to see whether any progress has been made on removing items from the pool’s queues: if progress hasn’t been made, meaning nothing has been dequeued, the pool assumes the system is starved and injects an additional thread. Second, it has a hill climbing algorithm that is constantly seeking to maximimize work item throughput by manipulating available thread count; after every N work item completions, it evaluates whether adding or removing a thread to/from circulation helps or hurts work item throughput, thereby making it adaptive to the current needs of the system. However, the hill climbing mechanism has a weakness: in order to properly do its job, work items need to be completing… if work items aren’t completing because, say, all of the threads in the pool are blocked, hill climbing becomes temporarily useless, and the only mechanism for injecting additional threads is the starvation mechanism, which is (by design) fairly slow.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Boom，功能线程池。但是...不是一个很好的。一个好的线程池最困难的部分是线程的管理，特别是在任何给定的时间点上确定应该有多少线程为工作队列服务。线程太多，你可能会使系统陷入停顿，因为所有线程都在争夺系统资源，通过上下文切换增加了巨大的开销，并通过缓存颠簸相互干扰。线程太少，您可能会使系统陷入停顿，因为工作项的处理速度不够快，或者更糟糕的是，正在运行的工作项被阻塞，等待其他工作项运行，但没有足够的额外线程来运行它们。.NET <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadPool</span></code> 有多种机制来确定在任何时间点应该运行多少线程。首先，它有饥饿检测机制。 这种机制是一个相当简单的门，每秒启动一到两次，检查是否在从池的队列中删除项目方面取得了进展：如果还没有取得进展，意味着没有出队，则池假定系统处于饥饿状态，并注入一个额外的线程。第二，它有一个爬山算法，通过操纵可用线程数不断寻求最大化工作项吞吐量;在每N个工作项完成之后，它评估在循环中添加线程或从循环中移除线程是有助于还是损害工作项吞吐量，从而使其适应系统的当前需要。 不过，爬山机制有一个弱点：为了正确地完成它的工作，工作项需要完成……如果工作项没有完成，比如说，池中的所有线程都被阻塞了，爬山就暂时无用了，注入额外线程的唯一机制是饥饿机制，这是（设计上）相当慢的。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Such a situation might emerge when a system is flooded with “sync over async” work, a term <a href=https://devblogs.microsoft.com/pfxteam/should-i-expose-synchronous-wrappers-for-asynchronous-methods/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>coined</a> to mean kicking off asynchronous work and then synchronously blocking waiting for it to complete; in the common case, such an anti-pattern ends up blocking one thread pool thread that depends on another thread pool thread doing work in order to unblock the first, and that can quickly result in all thread pool threads being blocked until enough have been injected to enable everyone to make forward progress. Such “sync-over-async” code, which often manifests as calling an async method and then blocking waiting on the returned task (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pln> i </span><span class=pun>=</span><span class=pln> </span><span class=typ>GetValueAsync</span><span class=pun>().</span><span class=typ>Result</span></code>) is invariably considered a no-no in production code meant to be scalable, but sometimes it’s unavoidable, e.g. you’re forced to implement an interface that’s synchronous and the only means at your disposal to do so is with functionality exposed only as an async method.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当系统被“同步over async”工作淹没时，这种情况可能会出现，这个术语被创造出来，意思是启动异步工作，然后同步阻塞等待它完成;在常见的情况下，这样的反模式最终阻塞依赖于另一线程池线程进行工作的线程池线程以便解除阻塞第一线程池线程，并且这可以快速地导致所有线程池线程被阻塞，直到已经注入足够的线程池线程以使每个线程都能够向前进展。这种“sync-over-async”代码，通常表现为调用异步方法，然后阻塞等待返回的任务（例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pln> i </span><span class=pun>=</span><span class=pln> </span><span class=typ>GetValueAsync</span><span class=pun>().</span><span class=typ>Result</span></code> ）在生产代码中总是被认为是禁忌，意味着是可伸缩的，但有时这是不可避免的，例如：你不得不实现一个同步接口，而唯一的方法是将功能公开为异步方法。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>We can see the impact of this with a terrible repro:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Collections</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Generic</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Diagnostics</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Threading</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tasks</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> tcs </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TaskCompletionSource</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> tasks </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>List</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>&gt;();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Environment</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ProcessorCount</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> id </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    tasks</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Add</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Console</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteLine</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>$</span></span><span class=str><span class=str>"{DateTime.UtcNow:MM:ss.ff}: {id}"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        tcs</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Wait</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}));</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
tasks</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Add</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> tcs</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SetResult</span></span><span class=pun><span class=pun>()));</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> sw </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Stopwatch</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>StartNew</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WaitAll</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>tasks</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>());</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Console</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteLine</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>$</span></span><span class=str><span class=str>"Done: {sw.Elapsed}"</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This queues a bunch of work items to the thread pool, all of which block waiting for a task to complete, but that task won’t complete until the final queued work item completes it to unblock all the other workers. Thus, we end up blocking every thread in the pool, waiting for the thread pool to detect the starvation and inject another thread, which the repro then dutifully blocks, and on and on, until finally there are enough threads that every queued work item can be running concurrently. On .NET Framework 4.8 and .NET 5, the above repro on my 12-logical-core machine takes ~32 seconds to complete. You can see the output here; pay attention to the timestamps on each work item, where you can see that after ramping up very quickly to have a number of threads equal to the number of cores, it then very slowly introduces additional threads.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这将一堆工作项排队到线程池，所有这些工作项都阻塞等待任务完成，但该任务不会完成，直到最后一个排队的工作项完成它以解除阻塞所有其他worker。因此，我们最终阻塞池中的每个线程，等待线程池检测到饥饿并注入另一个线程，然后repro尽职地阻塞，直到最后有足够的线程可以每个排队的工作项并发运行。在.NET Framework 4.8和.NET 5上，在我的12个逻辑核计算机上进行的上述再现需要大约32秒才能完成。你可以在这里看到输出;注意每个工作项上的时间戳，在那里你可以看到，在快速上升到线程数等于内核数之后，它会非常缓慢地引入额外的线程。 </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>5</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>11</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>55.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>12</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>56.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>13</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>57.53</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>14</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>58.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>15</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>59.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>00.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>17</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>01.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>18</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>01.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>19</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>02.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>20</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>03.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>21</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>04.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>22</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>05.03</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>23</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>06.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>24</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>07.03</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>25</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>08.01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>26</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>09.03</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>27</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>10.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>11.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>29</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>11.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>30</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>12.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>31</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>13.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>32</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>14.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>33</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>15.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>34</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>15.53</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>35</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>16.51</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>36</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>17.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>37</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>18.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>38</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>18.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>39</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>19.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>40</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>20.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>41</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>21.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>42</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>22.55</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>43</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>23.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>44</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>24.53</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>45</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>25.52</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>46</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>26.02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>47</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Done</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>00</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>00</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>32.5128769</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I’m happy to say the situation improves here for .NET 6. This is not license to start writing more sync-over-async code, but rather a recognition that sometimes it’s unavoidable, especially in existing applications that may not be able to move to an asynchronous model all at once, that might have some legacy components, etc. <a href=https://github.com/dotnet/runtime/pull/53471 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53471</a> teaches the thread pool about the most common form of blocking we see in these situations, waiting on a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> that hasn’t yet completed. In response, the thread pool becomes much more aggressive about increasing its target thread count while the blocking persists, and then immediately lowers the target count again as soon as the blocking has ended. Running the same console app again on .NET 6, we can see that ~32 seconds drops to ~1.5 seconds, with the pool injecting threads much faster in response to the blocking.</p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>5</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>9</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.39</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>12</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>11</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>13</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>14</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>15</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>22</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>17</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>18</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>19</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>21</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>20</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.50</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>23</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.53</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>24</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.56</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>25</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.59</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>26</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.63</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>27</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.66</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.69</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>29</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.72</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>30</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.75</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>31</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.78</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>32</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.81</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>33</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.84</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>34</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.91</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>35</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>53.97</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>36</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.03</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>37</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.10</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>38</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.16</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>39</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.22</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>40</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.28</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>41</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.35</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>42</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.41</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>43</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.47</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>44</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.54</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>45</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.60</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>46</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>07</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>54.68</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>47</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Done</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>00</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>00</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>01.3649530</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Interestingly, this improvement was made easier by another large thread pool related change in .NET 6: the implementation is now entirely in C#. In previous releases of .NET, the thread pool’s core dispatch routine was in managed code, but all of the logic around thread management was all still in native in the runtime. All of that logic was ported to C# previously in support of CoreRT and mono, but it wasn’t used for coreclr. As of .NET 6 and <a href=https://github.com/dotnet/runtime/pull/43841 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43841</a>, it now is used everywhere. This should make further improvements and optimizations easier and enable more advancements in the pool in future releases.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Moving on from the thread pool, <a href=https://github.com/dotnet/runtime/pull/55295 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55295</a> is an interesting improvement. One of the things you find a lot in multithreaded code, whether direct usage in low-lock algorithms or indirect usage in concurrency primitives like locks and semaphores, is spinning. Spinning is based on the idea that blocking in the operating system waiting for something to happen is very efficient for longer waits but incurs non-trivial overheads at the start and end of the waiting operation; if the thing you’re waiting for will likely happen very, very soon, you might be better off just looping around to try again immediately or after a very short pause. My use of the word “pause” there is not coincidental, as the x86 instruction set includes the “PAUSE” instruction, which tells the processor the code is doing a spin-wait and helps it to optimize accordingly. However, the delay incurred by the “PAUSE” instruction can varely greatly across processor architectures, e.g. it might take only 9 cycles on an Intel Core i5, but 65 cycles on an AMD Ryzen 7, or 140 cycles on an Intel Core i7. That makes it challenging for tuning the behavior of higher-level code written using spin loops, which core code in the runtime and key concurrency-related types in the core libraries do. To address this discrepancy and provide a consistent view of pauses, previous releases of .NET have tried to measure at startup the duration of pauses, and then used those metrics to normalize how many pauses are used when one is needed. However, this approach has a few downsides. While the measurement wasn’t being done on the main thread of the startup path, it was still contributing milliseconds of CPU time to every process, a number that can add up over the millions or billions of .NET process invocations that happen every day. It also was only done once for a process, but for a variety of reasons that overhead could actually change during a process’ lifetime, for example if a VM was suspended and moved from one physical machine to another. To address this, the aforementioned PR changes its scheme. Rather than measuring once at startup for a longer period of time, it periodically does a short measurement and uses that to refresh its perspective on how long pauses take. This should lead to an overall decrease in CPU usage as well as a more up-to-date understanding of what these pauses cost, leading to a more consistent behavior of the apps and services that rely on it.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s move on to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>, where there have been a multitude of improvements. One notable and long overdue change is enabling <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> to return a cached instance. When async methods were added in .NET Framework 4.5, we added a cache that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> methods could use for synchronously-completing operations (synchronously completing async methods are counterintuitively extremely common; consider a method where the first invocation does I/O to fill a buffer, but subsequent operations simply consume from that buffer). Rather than constructing a new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> for every invocation of such a method, the cache would be consulted to see if a singleton <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> could be used instead. The cache obviously can’t store a singleton for every possible value of every <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code>, but it can special-case some <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code>s and cache a few values for each. For example, it caches two <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=str>&lt;bool&gt;</span></code> instances, one for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code> and one for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>false</span></code>, and around 10 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=str>&lt;int&gt;</span></code> instances, one for each of the values between <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>-</span><span class=lit>1</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>8</span></code>, inclusive. But <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> never used this cache, always returning a new instance even if there was a task for it in the cache. This has led to one of two commonly-seen occurrences: either a developer using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span></code> recognizes this deficiency and has to maintain their own cache for values like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>false</span></code>, or a developer using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span></code> doesn’t recognize it and ends up paying arguably unnecessary allocations. For .NET 6, <a href=https://github.com/dotnet/runtime/pull/43894 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43894</a> changes <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> to consult the cache, so creating tasks for a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>bool</span></code> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code> or an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1</span></code>, for example, no longer allocates. This adds a tiny bit of overhead (a branch or two) when <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> is used with a type that can be cached but for which the specific value is not; however, on the balance it’s worthwhile given the savings for extremely common values.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course, tasks are very closely tied to async methods in C#, and it’s worth looking at a small but significant feature in C# 10 and .NET 6 that is likely to impact a lot of .NET code, directly or indirectly. This requires some backstory. When the C# compiler goes to implement an async method with the signature <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>SomeTaskLikeType</span></code>, it consults the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeTaskLikeType</span></code> to see what “builder” should be used to help implement the method. For example, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> is attributed with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>AsyncMethodBuilder</span><span class=pun>(</span><span class=kwd>typeof</span><span class=pun>(</span><span class=typ>AsyncValueTaskMethodBuilder</span><span class=pun>))]</span></code>, and so any <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>ValueTask</span></code> method will cause the compiler to use <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span></code> as the builder for that method. We can see that if we compile a simple async method:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ExampleAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>for which the compiler produces approximately the following as the implementation of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ExampleAsync</span></code>:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ExampleAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>ExampleAsync</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln>d__0 stateMachine </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>default</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    stateMachine</span></span><span class=pun><span class=pun>.&lt;&gt;</span></span><span class=pln><span class=pln>t__builder </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AsyncValueTaskMethodBuilder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    stateMachine</span></span><span class=pun><span class=pun>.&lt;&gt;</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>__state </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    stateMachine</span></span><span class=pun><span class=pun>.&lt;&gt;</span></span><span class=pln><span class=pln>t__builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Start</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>ref</span></span><span class=pln><span class=pln> stateMachine</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> stateMachine</span></span><span class=pun><span class=pun>.&lt;&gt;</span></span><span class=pln><span class=pln>t__builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This builder type is used in the generated code to create the builder instance (via a static <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Create</span></code> method), to access the built task (via a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> instance property), to complete that built task (via <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SetResult</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SetException</span></code> instance methods), and to handle the state management associated with that built task when an await yields (via <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AwaitOnCompleted</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UnsafeAwaitOnCompleted</span></code> instance methods). And as there are four types built into the core libraries that are intended to be used as the return type from async methods (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code>, and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>), the core libraries also include four builders (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncTaskMethodBuilder</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncTaskMethodBuilder</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span></code>, and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>), all in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>CompilerServices</span></code>. Most developers should never see these types in any code they read or write.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One of the downsides to this model, however, is that which builder is selected is tied to the definition of the type being returned from the async method. So, if you want to define your async method to return <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code>, or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, you have no way to control the builder that’s employed: it’s determined by that type and only by that type. Why would you want to change the builder? There are a variety of reasons someone might want to control the details of the lifecycle of the task, but one of the most prominent is pooling. When an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>Task</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>ValueTask</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> method completes synchronously, nothing need be allocated: for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>, the implementation can just hand back <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>CompletedTask</span></code>, for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> it can just hand back <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>.</span><span class=typ>CompletedTask</span></code> (which is the same as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>default</span><span class=pun>(</span><span class=typ>ValueTask</span><span class=pun>)</span></code>), and for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> it can hand back <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, which creates a struct that wraps the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> value. However, when the method completes asynchronously, the implementations need to allocate some object (a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>) to uniquely identify this async operation and provide a conduit via which the completion information can be passed back to the caller awaiting the returned instance.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> supports being backed not only by a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> or a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, but also by an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, which allows enterprising developers to plug in a custom implementation, including one that could potentially be pooled. What if, instead of using the aforementioned builders, we could author a builder that used and pooled custom <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> instances? It could use those instead of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> to back a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> returned from an asynchronously-completing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> method. As outlined in the blog post <a href=https://devblogs.microsoft.com/dotnet/async-valuetask-pooling-in-net-5/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Async ValueTask Pooling in .NET 5</a>, .NET 5 included that as an opt-in experiment, where <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> had a custom <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span></code>/<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> implementation they could instantiate and pool and use as the backing object behind a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>. The first time an async method needed to yield and move all its state from the stack to the heap, these builders would consult the pool and try to use an object already there, only allocating a new one if one wasn’t available in the pool. Then upon <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetResult</span><span class=pun>()</span></code> being called via an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> on the resulting <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code>/<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, the object would be returned to the pool. That experiment is complete and the environment variable removed for .NET 6. In its stead, this capability is supported in a new form in .NET 6 and C# 10.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>AsyncMethodBuilder</span><span class=pun>]</span></code> attribute we saw before can now be placed on methods in addition to on types, thanks to <a href=https://github.com/dotnet/roslyn/pull/54033 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn#54033</a>; when an async method is attributed with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>AsyncMethodBuilder</span><span class=pun>(</span><span class=kwd>typeof</span><span class=pun>(</span><span class=typ>SomeBuilderType</span><span class=pun>))]</span></code>, the C# compiler will then prefer that builder over the default. And along with the C# 10 language/compiler feature, .NET 6 includes two new builder types, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PoolingAsyncValueTaskMethodBuilder</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, thanks to <a href=https://github.com/dotnet/runtime/pull/50116 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50116</a> and <a href=https://github.com/dotnet/runtime/pull/55955 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55955</a>. If we change our previous example to be:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>AsyncMethodBuilder</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></span><span class=pun><span class=pun>))]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ExampleAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>now the compiler generates:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ExampleAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>ExampleAsync</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln>d__0 stateMachine </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>default</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    stateMachine</span></span><span class=pun><span class=pun>.&lt;&gt;</span></span><span class=pln><span class=pln>t__builder </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    stateMachine</span></span><span class=pun><span class=pun>.&lt;&gt;</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>__state </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    stateMachine</span></span><span class=pun><span class=pun>.&lt;&gt;</span></span><span class=pln><span class=pln>t__builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Start</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>ref</span></span><span class=pln><span class=pln> stateMachine</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> stateMachine</span></span><span class=pun><span class=pun>.&lt;&gt;</span></span><span class=pln><span class=pln>t__builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which means <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ExampleAsync</span></code> may now use pooled objects to back the returned <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> instances. We can see that with a simple benchmark:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>const</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WithoutPooling</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>YieldAsync</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>YieldAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Yield</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WithPooling</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>YieldAsync</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>AsyncMethodBuilder</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></span><span class=pun><span class=pun>))]</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>YieldAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Yield</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithoutPooling</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>763.9 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>112 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithPooling</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>781.9 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.02</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Note the allocation per call dropping from 112 bytes to 0. So, why not just make this the default behavior of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>? Two reasons. First, it does create a functional difference. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>s are more capable than <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code>s, supporting concurrent usage, multiple awaiters, and synchronous blocking. If consuming code was, for example, doing:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>请注意，每个调用的分配从112字节下降到0。那么，为什么不把它作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsyncValueTaskMethodBuilder</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的默认行为呢？两个原因第首先，它确实产生了功能上的差异。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> 比 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> 更有能力，支持并发使用、多等待者和同步阻塞。例如，如果消费代码正在做：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> vt </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SomeMethodAsync</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> vt</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> vt</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>that would have “just worked” when <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> was backed by a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>, but failed in one of multiple ways and varying levels of severity when pooling was enabled. Code analysis rule <a href=https://docs.microsoft.com/dotnet/fundamentals/code-analysis/quality-rules/ca2012 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CA2012</a> is meant to help avoid such code, but that alone is insufficient to prevent such breaks. Second, as you can see from the benchmark above, while the pooling avoided the allocation, it came with a bit more overhead. And not shown here is the additional overhead in memory and working set of having to maintain the pool at all, which is maintained per async method. There are also some potential overheads not shown here, things that are common pitfalls to any kind of pooling. For example, the GC is optimized to make gen0 collections really fast, and one of the ways it can do that is by not having to scan gen1 or gen2 as part of a gen0 GC. But if there are references to gen0 objects from gen1 or gen2, then it does need to scan portions of those generations (this is why storing references into fields involves “GC write barriers,” to see if a reference to a gen0 object is being stored into one from a higher generation). Since the entire purpose of pooling is to keep objects around for a long time, those objects will likely end up being in these higher generations, and any references they store could end up making GCs more expensive; that can easily be the case with these state machines, as every parameter and local used in the method could potentially need to be tracked as such. So, from a performance perspective, it’s best to use this capability only in places where it’s both likely to matter and where performance testing demonstrates it moves the needle in the right direction. We can see, of course, that there are scenarios where in addition to saving on allocation, it actually does improve throughput, which at the end of the day is typically what one is really focusing on improving when they’re measuring allocation reduction (i.e. reducing allocation to reduce time spent in garbage collection).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> 由 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> 支持时，它“刚刚工作”，但在启用池化时，它以多种方式之一和不同严重级别失败。代码分析规则CA2012旨在帮助避免此类代码，但仅凭此不足以防止此类中断。其次，正如您从上面的基准测试中看到的，虽然池化避免了分配，但它带来了更多的开销。这里没有显示的是必须维护池的内存和工作集的额外开销，池是每个异步方法维护的。还有一些潜在的管理费用没有在这里显示，这些都是任何类型的池化常见的陷阱。例如，GC被优化为使gen0收集速度非常快，其中一种方法是不必扫描gen1或gen2作为gen0 GC的一部分。 但是，如果有来自gen 1或gen 2的gen 0对象的引用，那么它确实需要扫描这些代的部分（这就是为什么将引用存储到字段中涉及到“GC写障碍”，以查看对gen 0对象的引用是否被存储到来自更高代的一个中）。由于池化的整个目的是将对象保存很长一段时间，这些对象很可能最终会出现在这些更高的代中，并且它们存储的任何引用最终都可能使GC变得更昂贵;对于这些状态机来说，这很容易是这种情况，因为在该方法中使用的每个参数和局部可能需要被跟踪。因此，从性能的角度来看，最好只在可能重要且性能测试表明它能将指针推向正确方向的地方使用此功能。 当然，我们可以看到，在某些情况下，除了节省分配，它实际上确实提高了吞吐量，这通常是人们在衡量分配减少时真正关注的改进（即，减少分配以减少在垃圾收集中花费的时间）。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>const</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Concurrency</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>256</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>const</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonPooling</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WhenAll</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>from</span></span><span class=pln><span class=pln> i </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Concurrency</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
                        </span></span><span class=kwd><span class=kwd>select</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>delegate</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                            </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
                                </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> A</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ConfigureAwait</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>}));</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> A</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ConfigureAwait</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> C</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ConfigureAwait</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> C</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ConfigureAwait</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Yield</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Pooling</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WhenAll</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>from</span></span><span class=pln><span class=pln> i </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Concurrency</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
                        </span></span><span class=kwd><span class=kwd>select</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>delegate</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                            </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
                                </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> A</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ConfigureAwait</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>}));</span></span><span class=pln><span class=pln>

    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>AsyncMethodBuilder</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></span><span class=pun><span class=pun>))]</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> A</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ConfigureAwait</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>AsyncMethodBuilder</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></span><span class=pun><span class=pun>))]</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> C</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ConfigureAwait</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>AsyncMethodBuilder</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></span><span class=pun><span class=pun>))]</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> C</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ConfigureAwait</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>AsyncMethodBuilder</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></span><span class=pun><span class=pun>))]</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Yield</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NonPooling</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.271 s</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>11,800,058 KB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Pooling</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.896 s</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.88</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>214 KB</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Beyond these new builders, there have been other new APIs introduced in .NET 6 related to tasks. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>WaitAsync</span></code> was introduced in <a href=https://github.com/dotnet/runtime/pull/48842 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48842</a> and provides an optimized implementation for creating a new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> that will complete when either the previous one completes or when a specified timeout has elapsed or a specified <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> has had cancellation requested. This is useful in replacing a fairly common pattern that shows up (and that, unfortunately, developers often get wrong) with developers wanting to wait for a task to complete but with either or both a timeout and cancellation. For example, this:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> t </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>...;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> cts </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WhenAny</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Delay</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>timeout</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> t</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> t</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TimeoutException</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Cancel</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> t</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>can now be replaced with just this:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> t </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>...;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> t</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WaitAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>timeout</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and be faster with less overhead. A good example of that comes from <a href=https://github.com/dotnet/runtime/pull/55262 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55262</a>, which used the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>WaitAsync</span></code> to replace a similar implementation that existed inside of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SemaphoreSlim</span><span class=pun>.</span><span class=typ>WaitAsync</span></code>, such that the latter is now both simpler to maintain and faster with less allocation.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>并且以更少的开销更快。一个很好的例子来自dotnet/runtime#55262，它使用了新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>WaitAsync</span></code> 来替换存在于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SemaphoreSlim</span><span class=pun>.</span><span class=typ>WaitAsync</span></code> 内部的类似实现，这样后者现在既更容易维护，也更快，分配更少。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SemaphoreSlim</span></span><span class=pln><span class=pln> _sem </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SemaphoreSlim</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pln><span class=pln> _cts </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WithCancellationToken</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> t </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _sem</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WaitAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _sem</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Release</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> t</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WithTimeout</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> t </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _sem</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WaitAsync</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>TimeSpan</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FromMinutes</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
    _sem</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Release</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> t</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WithCancellationTokenAndTimeout</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> t </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _sem</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WaitAsync</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>TimeSpan</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FromMinutes</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> _cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _sem</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Release</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> t</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithCancellationToken</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.993 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2.993美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,263 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithCancellationToken</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.327 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.327美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.44</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>536 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>小行星536 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithCancellationToken</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.337 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.337美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.45</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>496 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>小行星496 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithCancellationToken</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.056 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.056美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.35</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>448 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>小行星448 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithTimeout</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.267 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>3.267美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,304 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithTimeout</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.768 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.768美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.54</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,064 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithTimeout</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.769 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.769美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.54</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,056 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1，B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithTimeout</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.086 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.33</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>544 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithCancellationTokenAndTimeout</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.838 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,409 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithCancellationTokenAndTimeout</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.901 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.50</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,080 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithCancellationTokenAndTimeout</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.929 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.50</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,072 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WithCancellationTokenAndTimeout</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.186 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.31</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>544 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6 also sees the long-requested addition of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Parallel</span><span class=pun>.</span><span class=typ>ForEachAsync</span></code> (<a href=https://github.com/dotnet/runtime/pull/46943 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46943</a>), which makes it easy to asynchronously enumerate an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IAsyncEnumerable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> and run a delegate for each yielded element, with those delegates executed in parallel, and with some modicum of control over how it happens, e.g. what <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskScheduler</span></code> should be used, the maximum level of parallelism to enable, and what <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> to use to cancel the work.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>On the subject of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code>, the cancellation support in .NET 6 has also seen performance improvements, both for existing functionality and for new APIs that enable an app to do even better. One interesting improvement is <a href=https://github.com/dotnet/runtime/pull/48251 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48251</a>, which is a good example of how one can design and implement and optimize for one scenario only to find that it’s making the wrong tradeoffs. When <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code> were introduced in .NET Framework 4.0, the expectation at the time was that the majority use case would be lots of threads registering and unregistering from the same <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> in parallel. That led to a really neat (but complicated) lock-free implementation that involved quite a bit of allocation and overhead. If you were in fact registering and unregistering from the same token from lots of threads in parallel, the implementation was very efficient and resulted in good throughput. But if you weren’t, you were paying a lot of overhead for something that wasn’t providing reciprocal benefit. And, as luck would have it, that’s almost never the scenario these days. It’s much, much more common to have a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> that’s used serially, often with multiple registrations all in place at the same time, but with those registrations mostly having been added as part of the serial flow of execution rather than all concurrently. This PR recognizes this reality and reverts the implementation to a much simpler, lighterweight, and faster one that performs better for the vast majority use case (while taking a hit if it is actually hammered by multiple threads concurrently).</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pln><span class=pln> _source </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CreateTokenDispose</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> cts </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
        _ </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CreateRegisterDispose</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> cts </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
        cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Register</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>},</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CreateLinkedTokenDispose</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> cts </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateLinkedTokenSource</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_source</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln>
        _ </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CreateManyRegisterDispose</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> cts </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pln><span class=pln> ct </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
            ct</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Register</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>},</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CreateManyRegisterMultipleDispose</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> cts </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationTokenSource</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pln><span class=pln> ct </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> cts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Token</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> ctr1 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> ct</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Register</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>},</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> ctr2 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> ct</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Register</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>},</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> ctr3 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> ct</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Register</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>},</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> ctr4 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> ct</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Register</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>},</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> ctr5 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> ct</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Register</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>},</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
            ctr5</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
            ctr4</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
            ctr3</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
            ctr2</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
            ctr1</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateTokenDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>10.236 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>72 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateTokenDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>6.934 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.68</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>64 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateTokenDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>7.268 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.71</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>64 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateTokenDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>6.200 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.61</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateRegisterDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>144.218 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>385 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateRegisterDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>79.392 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.55</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>352 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateRegisterDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>79.431 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.55</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>352 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateRegisterDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>56.715 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.39</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>192 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateLinkedTokenDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>103.622 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>209 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateLinkedTokenDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>61.944 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.60</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>112 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateLinkedTokenDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>53.526 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.52</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>80 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateLinkedTokenDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>38.631 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.37</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>64 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateManyRegisterDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>87.713 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>56 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateManyRegisterDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>43.491 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.50</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateManyRegisterDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>41.124 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.47</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateManyRegisterDispose</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>35.437 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.40</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateManyRegisterMultipleDispose<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建多个注册多个处置 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>439.874 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>439.874纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>281 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateManyRegisterMultipleDispose<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建多个寄存器多个处理 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>234.367 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>234.367纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.53</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateManyRegisterMultipleDispose<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建多个注册多个处置 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>229.483 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>229.483纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.52</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>CreateManyRegisterMultipleDispose<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建多个注册多个处置 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>192.213 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>192.213纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.44</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> also has new APIs that help with performance. <a href=https://github.com/dotnet/runtime/pull/43114 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43114</a> added new overloads of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Register</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Unregister</span></code> that, rather than taking an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Action</span><span class=str>&lt;object&gt;</span></code> delegate, accept an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Action</span><span class=pun>&lt;</span><span class=kwd>object</span><span class=pun>,</span><span class=pln> </span><span class=typ>CancellationToken</span><span class=pun>&gt;</span></code> delegate. This gives the delegate access to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> responsible for the callback being invoked, enabling code that was instantiating a new delegate and potentially a closure in order to get access to that information to instead be able to use a cached delegate instance (as the compiler generates for lambdas that don’t close over any state). And <a href=https://github.com/dotnet/runtime/pull/50346 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50346</a> makes it easier to reuse <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code> instances for applications that want to pool them. In the past there have been multiple requests to be able to reuse any <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code>, enabling its state to be reset from one that’s had cancellation requested to one that hasn’t. That’s <em data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>not</em> something we’ve done nor plan to do, as a <em data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>lot</em> of code depends on the idea that once a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code>‘s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsCancellationRequested</span></code> is true it’ll always be true; if that’s not the case, it’s very difficult to reason about. However, the vast majority of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code>s are never canceled, and if they’re not canceled, there’s nothing that prevents them from continuing to be used, potentially stored into a pool for someone else to use in the future. This gets a bit tricky, however, if <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancelAfter</span></code> is used or if the constructor is used that takes a timeout, as both of those cause a timer to be created, and there are race conditions possible between the timer firing and someone checking to see whether <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsCancellationRequested</span></code> is true (to determine whether to reuse the instance). The new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryReset</span></code> method avoids this race condition. If you do want to reuse such a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code>, call <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryReset</span></code>: if it returns true, it hasn’t had cancellation requested and any underlying timer has been reset as well such that it won’t fire without a new timeout being set. If it returns false, well, don’t try to reuse it, as no guarantees are made about its state. You can see how the Kestrel web server does this, via <a href=https://github.com/dotnet/aspnetcore/pull/31528 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/aspnetcore#31528</a> and <a href=https://github.com/dotnet/aspnetcore/pull/34075 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/aspnetcore#34075</a>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> 还提供了有助于提高性能的新API。dotnet/runtime#43114添加了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Register</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Unregister</span></code> 的新重载，而不是接受 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Action</span><span class=str>&lt;object&gt;</span></code> 委托，接受 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Action</span><span class=pun>&lt;</span><span class=kwd>object</span><span class=pun>,</span><span class=pln> </span><span class=typ>CancellationToken</span><span class=pun>&gt;</span></code> 委托。这使得委托访问负责调用回调的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> ，使正在实例化一个新委托和一个闭包的代码能够使用缓存的委托实例（因为编译器生成的lambda在任何状态下都不会关闭）。dotnet/runtime#50346使得对于想要将它们池化的应用程序重用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code> 实例变得更容易。在过去，已经有多个请求能够重用任何 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code> ，使其状态能够从一个有取消请求的状态重置为一个没有取消请求的状态。这不是我们已经做过也没有计划做的事情，因为很多代码依赖于这样一个想法：一旦一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsCancellationRequested</span></code> 为真，它将永远为真;如果不是这样的话，那就很难讲道理了。 然而，绝大多数 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code> 从未被取消，如果它们没有被取消，也没有什么可以阻止它们继续被使用，可能会被存储到池中供其他人将来使用。然而，如果使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancelAfter</span></code> 或者使用超时的构造函数，这就有点棘手了，因为这两种构造函数都会导致创建一个计时器，并且计时器触发和某人检查 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsCancellationRequested</span></code> 是否为真（以确定是否重用实例）之间可能存在竞争条件。新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryReset</span></code> 方法避免了这种竞争条件。如果您确实想重用这样的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code> ，请调用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryReset</span></code> ：如果它返回true，则表示它没有请求取消，并且任何底层计时器也被重置，因此在没有设置新超时的情况下，它将不会触发。如果它返回false，那么，不要尝试重用它，因为它的状态没有任何保证。您可以通过dotnet/aspnetcore#31528和dotnet/aspnetcore#34075了解Kestrel Web服务器是如何做到这一点的。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Those are some of the bigger performance-focused changes in threading. There are a myriad of smaller ones as well, for example the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Thread</span><span class=pun>.</span><span class=typ>UnsafeStart</span></code> <a href=https://github.com/dotnet/runtime/pull/47056 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47056</a>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PreAllocatedOverlapped</span><span class=pun>.</span><span class=typ>UnsafeCreate</span></code> <a href=https://github.com/dotnet/runtime/pull/53196 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53196</a>, and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadPoolBoundHandle</span><span class=pun>.</span><span class=typ>UnsafeAllocateNativeOverlapped</span></code> APIs that make it easier and cheaper to avoid capturing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ExecutingContext</span></code>; <a href=https://github.com/dotnet/runtime/pull/43891 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43891</a> and <a href=https://github.com/dotnet/runtime/pull/44199 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44199</a> that avoided several volatile accesses in threading types (this is mainly impactful on ARM); <a href=https://github.com/dotnet/runtime/pull/44853 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44853</a> from <a href=https://github.com/LeaFrock target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@LeaFrock</a> that optimized the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ElapsedEventArgs</span></code> constructor to avoid some unnecessary roundtripping of a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span></code> through a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>FILETIME</span></code>; <a href=https://github.com/dotnet/runtime/pull/38896 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#38896</a> from <a href=https://github.com/Bond-009 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@Bond-009</a> that added a fast path to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>WhenAny</span><span class=pun>(</span><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=typ>Task</span><span class=pun>&gt;)</span></code> for the relatively common case of the input being an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ICollection</span><span class=pun>&lt;</span><span class=typ>Task</span><span class=pun>&gt;</span></code>; and <a href=https://github.com/dotnet/runtime/pull/47368 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47368</a>, which improved the code generation for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>Exchange</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>CompareExchange</span></code> when used with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>nint</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IntPtr</span></code>) or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>nuint</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UIntPtr</span></code>) by enabling them to reuse the existing intrinsics for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>long</span></code>:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这些是线程中一些更大的以性能为中心的变化。还有无数的较小的API，例如新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Thread</span><span class=pun>.</span><span class=typ>UnsafeStart</span></code> dotnet/runtime#47056、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PreAllocatedOverlapped</span><span class=pun>.</span><span class=typ>UnsafeCreate</span></code> dotnet/runtime#53196和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadPoolBoundHandle</span><span class=pun>.</span><span class=typ>UnsafeAllocateNativeOverlapped</span></code> API，它们使得避免捕获 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ExecutingContext</span></code> ; dotnet/runtime#43891和dotnet/runtime#44199避免了线程类型中的几个易失性访问（这主要对ARM有影响）;来自@LeaFrock的dotnet/runtime#44853优化了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ElapsedEventArgs</span></code> 构造函数，以避免一些不必要的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span></code> 到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>FILETIME</span></code> 的往返;来自@Bond-009的dotnet/runtime#38896，其为输入是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ICollection</span><span class=pun>&lt;</span><span class=typ>Task</span><span class=pun>&gt;</span></code> 的相对常见的情况添加了到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>WhenAny</span><span class=pun>(</span><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=typ>Task</span><span class=pun>&gt;)</span></code> 的快速路径;和dotnet/runtime#47368，当与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>nint</span></code> （ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IntPtr</span></code> ）或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>nuint</span></code> （ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UIntPtr</span></code> ）一起使用时，它改进了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>Exchange</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>CompareExchange</span></code> 的代码生成，使它们能够重用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>long</span></code> 的现有内在函数：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> nint _value</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> nint </span></span><span class=typ><span class=typ>CompareExchange</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Interlocked</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompareExchange</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>ref</span></span><span class=pln><span class=pln> _value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nint</span></span><span class=pun><span class=pun>)</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nint</span></span><span class=pun><span class=pun>)</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nint</span></span><span class=pun><span class=pun>)</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>5</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompareExchange</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>ecx
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>8</span></span><span class=pln><span class=pln>
       mov       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       xor       r8d</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       call      </span></span><span class=lit><span class=lit>00007FFEC051F8B0</span></span><span class=pln><span class=pln>
       inc       rax
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>31</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompareExchange</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>ecx
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>8</span></span><span class=pln><span class=pln>
       mov       edx</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
       </span></span><span class=kwd><span class=kwd>lock</span></span><span class=pln><span class=pln> cmpxchg </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rdx
       inc       rax
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>22</span></span></code></pre>
<h3 id=system-types data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>System Types<a aria-labelledby=system-types class=linkicon href=#system-types data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Every .NET app uses types from the core <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span></code> namespace, and so improvements to these types often have wide-reaching impact. There have been many performance enhancements to these types in .NET 6.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s start with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Guid</span></code>. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Guid</span></code> is used to provide unique identifiers for any number of things and operations. The ability to create them quickly is important, as is the ability to quickly format and parse them. Previous releases have seen significant improvements on all these fronts, but they get even better in .NET 6. Let’s take a simple benchmark for parsing:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> _guid </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Guid</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NewGuid</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Guid</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Parse</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Guid</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Parse</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_guid</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/44918 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44918</a> helped avoid some overheads involved in unnecessarily accessing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CultureInfo</span><span class=pun>.</span><span class=typ>CurrentCulture</span></code> during parsing, as culture isn’t necessary or desired when parsing hexadecimal digits. And <a href=https://github.com/dotnet/runtime/pull/55792 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55792</a> and <a href=https://github.com/dotnet/runtime/pull/56210 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56210</a> rewrote parsing for the ‘D’, ‘B’, ‘P’, and ‘N’ formats (all but the antiquated ‘X’) to be much more streamlined, with careful attention paid to avoidance of bounds checking, how data is moved around, number of instructions to be executed, and so on. The net result is a very nice increase in throughput:</p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Parse</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>251.88 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Parse</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>100.78 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.40</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Parse</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>80.13 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.32</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Parse</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>33.84 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.13</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I love seeing tables like this. A 2.5x speedup going from .NET Framework 4.8 to .NET Core 3.1, another 1.3x on top of that going from .NET Core 3.1 to .NET 5, and then another 2.3x going from .NET 5 to .NET 6. Just one small example of how the platform gets better every release.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One other <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Guid</span></code> related improvement won’t actually show up as a performance improvement (potentially even a tiny regression), but is worth mentioning in this context, anway. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Guid</span><span class=pun>.</span><span class=typ>NewGuid</span></code> has never guaranteed that the values generated would employ cryptographically-secure randomness, however as an implementation detail, on Windows <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NewGuid</span></code> was implemented with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CoCreateGuid</span></code> which was in turn implemented with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptGenRandom</span></code>, and developers starting using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Guid</span><span class=pun>.</span><span class=typ>NewGuid</span></code> as an easy source of randomness seeded by a cryptographically-secure generator. On Linux, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Guid</span><span class=pun>.</span><span class=typ>NewGuid</span></code> was then implemented using data read from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>/dev/</span><span class=pln>urandom</span></code>, which is also intended to provide cryptographic-level entropy, but on macOS, due to performance problems on macOS with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>/dev/</span><span class=pln>urandom</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Guid</span><span class=pun>.</span><span class=typ>NewGuid</span></code> was years ago switched to using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arc4random_buf</span></code>, which is for non-cryptographic purposes. It was decided in <a href=https://github.com/dotnet/runtime/pull/42770 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42770</a> in the name of defense-in-depth security that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NewGuid</span></code> should revert back to using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>/dev/</span><span class=pln>urandom</span></code> on macOS and accept the resulting regression. Thankfully, it doesn’t have to accept it; as of <a href=https://github.com/dotnet/runtime/pull/51526 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51526</a>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Guid</span><span class=pun>.</span><span class=typ>NewGuid</span></code> on macOS is now able to use CommonCrypto’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CCRandomGenerateBytes</span></code>, which not only returns cryptographically-strong random bits, but is also comparable in performance to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>arc4random_buf</span></code>, such that there shouldn’t be a perceivable impact release-over-release:</p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NewGuid</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>94.94 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NewGuid</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>96.32 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.01</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Moving on in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Version</span></code> is another such example of just getting better and better every release. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Version</span><span class=pun>.</span><span class=typ>ToString</span></code>/<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Version</span><span class=pun>.</span><span class=typ>TryFormat</span></code> had been using a cached <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code> for formatting. <a href=https://github.com/dotnet/runtime/pull/48511 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48511</a> rewrote <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormat</span></code> to format directly into the caller-supplied span, rather than first formatting into a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code> and then copying to the span. Then <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToString</span></code> was implemented as a wrapper for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormat</span></code>, stack-allocating a span with enough space to hold any possible version, formatting into that, and then slicing and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToString</span></code>‘ing that span to produce the final string. <a href=https://github.com/dotnet/runtime/pull/56051 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56051</a> then further improved upon this by being a little more thoughtful about how the code was structured. For example, it had been using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Int32</span><span class=pun>.</span><span class=typ>TryFormat</span></code> to format each of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> version components (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Major</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Minor</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Build</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Revision</span></code>), but these components are guaranteed to never be negative, so we could actually format them as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>uint</span></code> with no difference in behavior. Why is that helpful here? Because there’s an extra non-inlined function call on the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> code path than there is on the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>uint</span></code> code path, due to the former needing to be able to handle negative rendering as well, and when you’re counting nanoseconds at this low-level of the stack, such calls can make a measurable difference.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Version</span></span><span class=pln><span class=pln> _version </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Version</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>21412</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>VersionToString</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _version</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>VersionToString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>184.50 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>56 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>VersionToString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>107.35 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.58</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>VersionToString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>67.75 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.37</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>VersionToString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>44.83 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.24</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One of my personal favorite sets of changes in .NET 6 is the overhauling of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Random</span></code>. There are many ways performance improvements can come about, and one of the most elusive but also impactful is completely changing the algorithm used to something much faster. Until .NET 6, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> employed the same algorithm it had been using for the last two decades, a variant of Knuth’s subtractive random number generator algorithm that dates back to the 1980s. That served .NET well, but it was time for an upgrade. In the intervening years, a myriad number of pseudo-random algorithms have emerged, and for .NET 6 in <a href=https://github.com/dotnet/runtime/pull/47085 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47085</a>, we picked the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>xoshiro</span><span class=pun>**</span></code> family, using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>xoshiro128</span><span class=pun>**</span></code> on 32-bit and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>xoshiro256</span><span class=pun>**</span></code> on 64-bit. These algorithms were introduced by <a href=https://prng.di.unimi.it/ target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Blackman and Vigna in 2018</a>, are very fast, and yield good enough pseudo-randomness for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code>‘s needs (for cryptographically-secure random number generation, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Security</span><span class=pun>.</span><span class=typ>Cryptography</span><span class=pun>.</span><span class=typ>RandomNumberGenerator</span></code> should be used instead). However, beyond the algorithm employed, the implementation is now smarter about overheads. For good or bad reasons, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> was introduced with almost all of its methods virtual. In addition to that leading to virtual dispatch overheads, it has additional impact on the evolution of the type: because someone could have overridden one of the methods, any new method we introduce has to be written in terms of the existing virtuals… so, for example, when we added the span-based <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NextBytes</span></code> method, we had to implement that in terms of one of the existing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Next</span></code> methods, to ensure that any existing overrides would have their behavior respected (imagine if we didn’t, and someone had a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadSafeRandom</span></code> derived type, which overrode all the methods, and locked around each one… except for the ones unavailable at the time the derived type was created). Now in .NET 6, we check at construction time whether we’re dealing with a derived type, and fall back to the old implementation if this is a derived type, otherwise preferring to use an implementation that needn’t be concerned about such compatibility issues. Similarly, over the years we’ve been hesitant to change <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code>‘s implementation for fear of changing the numerical sequence yielded if someone provided a fixed seed to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code>‘s constructor (which is common, for example, in tests); now in .NET 6, just as for derived types, we fall back to the old implementation if a seed is supplied, otherwise preferring the new algorithm. This sets us up for the future where we can freely change and evolve the algorithm used by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>Random</span><span class=pun>()</span></code> as better approaches present themselves. On top of that, <a href=https://github.com/dotnet/runtime/pull/47390 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47390</a> from <a href=https://github.com/colgreen target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@colgreen</a> tweaked the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NextBytes</span></code> implementation further to avoid unnecessary moves between locals and fields, yielding another significant gain in throughput.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在.NET 6中，我个人最喜欢的一组变化是对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Random</span></code> 的大修。有很多方法可以实现性能改进，其中最难以捉摸但也最有影响力的方法之一是完全改变算法，使其速度更快。在.NET 6之前， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> 使用了过去二十年一直使用的相同算法，这是Knuth的减法随机数生成器算法的变体，可以追溯到20世纪80年代。这对.NET服务很好，但是时候升级了。在此期间，出现了无数的伪随机算法，对于dotnet/runtime#47085中的.NET 6，我们选择了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>xoshiro</span><span class=pun>**</span></code> 家族，在32位上使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>xoshiro128</span><span class=pun>**</span></code> ，在64位上使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>xoshiro256</span><span class=pun>**</span></code> 。这些算法由Blackman和Vigna在2018年引入，速度非常快，并且产生足够好的伪随机性，以满足 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> 的需求（对于密码安全的随机数生成，应该使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Security</span><span class=pun>.</span><span class=typ>Cryptography</span><span class=pun>.</span><span class=typ>RandomNumberGenerator</span></code> 代替）。然而，除了所采用的算法之外，现在的实施方式在管理费用方面更加智能。 不管是好是坏的原因， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> 被引入时几乎所有的方法都是虚拟的。除了导致虚拟派单开销外，它还对类型的演变产生了额外的影响：因为有人可能已经重写了其中一个方法，所以我们引入的任何新方法都必须按照现有的虚拟值编写......所以，例如，当我们添加基于span的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NextBytes</span></code> 方法时，我们必须按照现有的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Next</span></code> 方法之一来实现它，以确保任何现有的重写都能得到尊重（想象一下，如果我们不这样做，并且有人有一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadSafeRandom</span></code> 派生类型，它覆盖了所有的方法，并锁定了每个方法......除了在创建派生类型时不可用的方法）。现在在.NET 6中，我们在构建时检查是否处理派生类型，如果是派生类型，则退回到旧的实现，否则更喜欢使用无需担心此类兼容性问题的实现。 类似地，多年来，我们一直在犹豫是否要改变 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> 的实现，因为担心如果有人给 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> 的构造函数提供了一个固定的种子（这在测试中是很常见的），那么会改变产生的数值序列;现在在.NET 6中，就像对于派生类型一样，如果提供了种子，我们会回到旧的实现，否则会更倾向于使用新算法。这为我们的未来做好了准备，我们可以自由地改变和发展 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>Random</span><span class=pun>()</span></code> 使用的算法，因为更好的方法出现了。最重要的是，来自@colgreen的dotnet/runtime#47390进一步调整了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NextBytes</span></code> 实现，以避免局部变量和字段之间不必要的移动，从而在吞吐量上产生了另一个显著的增益。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000_000</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Random</span></span><span class=pln><span class=pln> _random </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Random</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Random</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Ctor</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Random</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Next</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _random</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Next</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NextMax</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _random</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Next</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>64</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NextMinMax</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _random</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Next</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>64</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>double</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NextDouble</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _random</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NextDouble</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NextBytes_Array</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _random</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NextBytes</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NextBytes_Span</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _random</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NextBytes</span></span><span class=pun><span class=pun>((</span></span><span class=typ><span class=typ>Span</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ctor</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,473.7 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ctor</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>112.9 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.08</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Next</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>7.653 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Next</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.033 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.27</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextMax</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>10.146 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextMax</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.032 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.30</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextMinMax</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>10.537 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextMinMax</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.110 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.30</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextDouble</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>8.682 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextDouble</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.354 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.27</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextBytes_Array</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>72,202,543.956 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextBytes_Array</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,199,496.150 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.02</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextBytes_Span</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>76,654,821.111 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NextBytes_Span</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,199,474.872 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.02</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> changes also highlight tradeoffs made in optimizations. The approach of dynamically choosing the implementation to use when the instance is constructed means we incur an extra virtual dispatch on each operation. For the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>Random</span><span class=pun>()</span></code> case that utilizes a new, faster algorithm, that overhead is well worth it and is much less than the significant savings incurred. But for the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>Random</span><span class=pun>(</span><span class=pln>seed</span><span class=pun>)</span></code> case, we don’t have those algorithmic wins to offset things. As the overhead is small (on my machine 1-2ns) and as the scenarios for providing a seed are a minority use case in situations where counting nanoseconds matters (passing a specific seed is often used in testing, for example, where repeatable results are required), we accepted the tradeoff. But even the smallest, planned regressions can nag at you, especially when discussing them very publicly in a blog post, so in <a href=https://github.com/dotnet/runtime/pull/57530 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#57530</a> we mitigated most of them (basically everything other than the simplest seeded <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Next</span><span class=pun>()</span></code> overload, which on my machine is ~4% slower in .NET 6 than in .NET 5) and even managed to turn most into improvements. This was done primarily by splitting the compat strategy implementation further into one for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>Random</span><span class=pun>(</span><span class=pln>seed</span><span class=pun>)</span></code> and one for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>DerivedRandom</span><span class=pun>()</span></code>, which enables the former to avoid any virtual dispatch between members (and for the latter, derived types can override to provide their own completion implementation). As previously noted, a method like `Next(int, int)` delegates to another virtual method on the instance, but that virtual delegation can now be removed entirely for the seeded case as well.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In addition to changes in the implementation, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> also gained new surface area in .NET 6. This includes new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NextInt64</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NextSingle</span></code> methods, but also <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span><span class=pun>.</span><span class=typ>Shared</span></code> (<a href=https://github.com/dotnet/runtime/pull/50297 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50297</a>). The static <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span><span class=pun>.</span><span class=typ>Shared</span></code> property returns a thread-safe instance that can be used from any thread. This means code no longer needs to pay the overheads of creating a new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> instance when it might sporadically want to get a pseudo-random value, nor needs to manage its own scheme for caching and using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> instances in a thread-safe manner. Code can simply do <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span><span class=pun>.</span><span class=typ>Shared</span><span class=pun>.</span><span class=typ>Next</span><span class=pun>()</span></code>.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NewNext</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Random</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>Next</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SharedNext</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Random</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Next</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NewNext<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>新闻动态 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>114.713 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>114.713纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>72 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>SharedNext</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5.377 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>5.377纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.05</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Next, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span></code> provides access to key information about the current machine and process. <a href=https://github.com/dotnet/runtime/pull/45057 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45057</a> and <a href=https://github.com/dotnet/runtime/pull/49484 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49484</a> updated <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetEnvironmentVariables</span></code> to use <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span></code> to search for the separators between key/value pairs, rather than using an open-coded loop. In addition to reducing the amount of code needed in the implementation, this takes advantage of the fact that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span></code> is heavily optimized using a vectorized implementation. The net result is much faster retrieval of all environment variables: on my machine, with the environment variables I have in my environment, I get results like these:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>接下来， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span></code> 提供对当前机器和进程的关键信息的访问。dotnet/runtime#45057和dotnet/runtime#49484更新了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetEnvironmentVariables</span></code> ，使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span></code> 搜索键/值对之间的分隔符，而不是使用开放编码循环。除了减少实现中所需的代码量之外，这还利用了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span></code> 使用向量化实现进行了大量优化的事实。最终结果是更快地检索所有环境变量：在我的机器上，使用环境中的环境变量，我得到了如下结果：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IDictionary</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetEnvironmentVariables</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Environment</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetEnvironmentVariables</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetEnvironmentVariables</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>35.04 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>35.04美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>33 KB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetEnvironmentVariables</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>13.43 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>13.43美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.38</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>33 KB</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6 also sees new APIs added to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span></code> to provide not only simpler access to commonly-accessed information, but also much faster access. It’s pretty common for apps, for example in logging code, to want to get the current process’ ID. To achieve that prior to .NET 5, code would often do something like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Process</span><span class=pun>.</span><span class=typ>GetCurrentProcess</span><span class=pun>().</span><span class=typ>Id</span></code>, and .NET 5 added <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span><span class=pun>.</span><span class=typ>ProcessId</span></code> to make that easier and faster. Similarly, code that wants access to the current process’ executable’s path would typically use code along the lines of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Process</span><span class=pun>.</span><span class=typ>GetCurrentProcess</span><span class=pun>().</span><span class=typ>MainModule</span><span class=pun>.</span><span class=typ>FileName</span></code>; now in .NET 6 with <a href=https://github.com/dotnet/runtime/pull/42768 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42768</a>, that code can just use <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span><span class=pun>.</span><span class=typ>ProcessPath</span></code>:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET 6还看到了新的API添加到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span></code> ，不仅提供了对常见访问信息的更简单的访问，而且还提供了更快的访问。应用程序（例如在日志代码中）想要获取当前进程的ID是很常见的。为了在.NET 5之前实现这一点，代码通常会做类似 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Process</span><span class=pun>.</span><span class=typ>GetCurrentProcess</span><span class=pun>().</span><span class=typ>Id</span></code> 的事情，而.NET 5添加了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span><span class=pun>.</span><span class=typ>ProcessId</span></code> 以使其更容易和更快。类似地，想要访问当前进程的可执行文件的路径的代码通常将使用沿着 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Process</span><span class=pun>.</span><span class=typ>GetCurrentProcess</span><span class=pun>().</span><span class=typ>MainModule</span><span class=pun>.</span><span class=typ>FileName</span></code> ;现在在.NET 6中，dotnet/runtime#42768，代码可以使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span><span class=pun>.</span><span class=typ>ProcessPath</span></code> ：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetPathViaProcess</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Process</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetCurrentProcess</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>MainModule</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FileName</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetPathViaEnvironment</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Environment</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ProcessPath</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetPathViaProcess</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>85,570.951 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,072 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetPathViaEnvironment</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.174 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The .NET 6 SDK also includes new analyzers, introduced in <a href=https://github.com/dotnet/roslyn-analyzers/pull/4909 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn-analyzers#4909</a>, to help find places these new APIs might be valuable. There are other new analyzers as well:</p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/roslyn-analyzers/pull/4764 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn-analyzers#4764</a> from <a href=https://github.com/NewellClark target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@NewellClark</a> to help find places <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Concat</span></code> can be used with spans.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/roslyn-analyzers/pull/4806 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn-analyzers#4806</a> from <a href=https://github.com/NewellClark target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@NewellClark</a> to help find places <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AsSpan</span></code> can be used instead of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Substring</span></code>.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/roslyn-analyzers/pull/5116 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn-analyzers#5116</a> from <a href=https://github.com/NewellClark target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@NewellClark</a> to help find places <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Equals</span></code> can be used instead of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Compare</span></code>.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/roslyn-analyzers/pull/4908 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn-analyzers#4908</a> from <a href=https://github.com/MeikTranel target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@MeikTranel</a> to help find places <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Contains</span></code> can be used with a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span></code> rather than a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code>.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/roslyn-analyzers/pull/4687 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn-analyzers#4687</a> from <a href=https://github.com/NewellClark target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@NewellClark</a> to help find places <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;,&gt;.</span><span class=typ>Keys</span><span class=pun>.</span><span class=typ>Contains</span></code> is used but <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;,&gt;.</span><span class=typ>ContainsKey</span></code> would suffice.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/roslyn-analyzers/pull/4726 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn-analyzers#4726</a> from <a href=https://github.com/MeikTranel target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@MeikTranel</a> to help find <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code>-derived types that would benefit from the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Memory</span></code>-based <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadAsync</span></code>/<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteAsync</span></code> overloads being overridden.</li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/roslyn-analyzers/pull/4841 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn-analyzers#4841</a> from <a href=https://github.com/ryzngard target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@ryzngard</a> to help find places <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>WhenAll</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>WaitAll</span></code> are used unnecessarily.</li>
</ul>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enum</span></code> has also seen both improvements to the performance of its existing methods (so that existing usage just gets faster) and new methods added to it (such that minor tweaks to how it’s being consumed in an app can yield further fruit). <a href=https://github.com/dotnet/runtime/pull/44355 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44355</a> is a small PR with a sizeable impact, improving the performance of the generic <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enum</span><span class=pun>.</span><span class=typ>IsDefined</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enum</span><span class=pun>.</span><span class=typ>GetName</span></code>, and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enum</span><span class=pun>.</span><span class=typ>GetNames</span></code>. There were several issues to be addressed here. First, originally there weren’t any generic APIs on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enum</span></code> (since it was introduced before generics existed), and thus all input values for methods like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsDefined</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetName</span></code> were typed as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code>. That then meant that internal helpers for doing things like getting the numerical value of an enum were also typed to accept <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code>. When the generic overloads came along in .NET 5, they utilized the same internal helpers, and ended up boxing the strongly-typed input as an implementation detail. This PR fixes that by adding a strongly-typed internal helper, and it tweaks what existing methods these generic methods delegate to so as to use ones that can operate faster given the strongly-typed nature of the generic methods. The net result is some nice wins.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DayOfWeek</span></span><span class=pln><span class=pln> _value </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DayOfWeek</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Friday</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsDefined</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enum</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsDefined</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_value</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetName</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enum</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetName</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_value</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetNames</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enum</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetNames</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>DayOfWeek</span></span><span class=pun><span class=pun>&gt;();</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsDefined</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>31.46 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>31.46纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>24 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsDefined</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>19.30 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>19.30纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.61</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetName</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>50.23 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>50.23纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>24 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetName</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>19.77 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>19.77纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.39</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetNames</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>36.78 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>36.78纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>80 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetNames</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>21.04 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>21.04纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.57</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>80 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>And via <a href=https://github.com/dotnet/runtime/pull/43255 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43255</a> from <a href=https://github.com/hrrrrustic target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@hrrrrustic</a>, .NET 6 also sees additional generic <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Parse</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryParse</span></code> overloads added that can parse <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code> in addition to the existing support for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code>. While not directly faster than their <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code>-based counterparts (in fact, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code>-based implementations eventually call into the same <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code>-based logic), they enable code parsing out enums from larger strings to do so with zero additional allocations and copies.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>通过来自@hrrrrustic的dotnet/runtime#43255，.NET 6还添加了额外的通用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Parse</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryParse</span></code> 重载，除了对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> 的现有支持之外，还可以解析 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code> 。虽然没有直接比基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> 的对应物快（事实上，基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> 的实现最终调用相同的基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code> 的逻辑），但它们允许代码从更大的字符串中解析出枚举，从而无需额外的分配和副本。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another very common operation in many apps is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span><span class=pun>.</span><span class=typ>UtcNow</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTimeOffset</span><span class=pun>.</span><span class=typ>UtcNow</span></code>, often used as part of tracing or logging code that’s designed to add as little overhead as possible. <a href=https://github.com/dotnet/runtime/pull/45479 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45479</a> and <a href=https://github.com/dotnet/runtime/pull/45281 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45281</a> streamlined <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span><span class=pun>.</span><span class=typ>UtcNow</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTimeOffset</span><span class=pun>.</span><span class=typ>UtcNow</span></code>, respectively, by avoiding some duplicative validation, ensuring fast paths are appropriately inlined (and slow paths aren’t), and other such tweaks. Those changes impacted all operating systems. But the biggest impact came from negating the regressions incurred when leap seconds support was added in .NET Core 3.0 (<a href=https://github.com/dotnet/coreclr/pull/21420 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/coreclr#21420</a>). “Leap seconds” are rare, one-second adjustments made to UTC that stem from the fact that the Earth’s rotation speed can and does actually vary over time. When this support was added to .NET Core 3.0 (and to .NET Framework 4.8 at the same time), it (knowingly) regressed the performance of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UtcNow</span></code> by around 2.5x when the Windows feature is enabled. Thankfully, in .NET 6, <a href=https://github.com/dotnet/runtime/pull/50263 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50263</a> provides a scheme for still maintaining the leap seconds support while avoiding the impactful overhead, getting back to the same throughput as without the feature.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>许多应用程序中另一个非常常见的操作是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span><span class=pun>.</span><span class=typ>UtcNow</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTimeOffset</span><span class=pun>.</span><span class=typ>UtcNow</span></code> ，通常用作跟踪或日志代码的一部分，旨在尽可能少地增加开销。dotnet/runtime#45479和dotnet/runtime#45281分别简化了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span><span class=pun>.</span><span class=typ>UtcNow</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTimeOffset</span><span class=pun>.</span><span class=typ>UtcNow</span></code> ，避免了一些重复验证，确保快速路径被适当内联（而慢速路径没有），以及其他类似的调整。这些变化影响了所有操作系统。但最大的影响来自于否定在.NET Core 3.0中添加闰秒支持时产生的回归（dotnet/coreclr#21420）。“闰秒”是罕见的，对UTC进行的一秒调整源于地球的自转速度可以并且实际上确实会随着时间而变化的事实。当此支持被添加到.NET Core 3.0（同时添加到.NET Framework 4.8）时，当启用Windows功能时，它（故意地）将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UtcNow</span></code> 的性能倒退了约2.5倍。幸运的是，在NET 6，dotnet/runtime#50263提供了一个方案，它仍然保持闰秒支持，同时避免了影响性的开销，恢复到没有该特性时的吞吐量。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DateTime</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UtcNow</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DateTime</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>UtcNow</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>UtcNow</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 2.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>20.96 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>20.96纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.40</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>UtcNow</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>52.25 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>52.25纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>UtcNow</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>63.35 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>63.35纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.21</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>UtcNow</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>58.22 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>58.22纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.11</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>UtcNow</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>19.95 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.38</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Other small but valuable changes have gone into various primitives. For example, the newly public <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ISpanFormattable</span></code> interface was previously internal and implemented on a handful of primitive types, but it’s now also implemented by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Char</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Rune</span></code> as of <a href=https://github.com/dotnet/runtime/pull/50272 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50272</a>, and by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IntPtr</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UIntPtr</span></code> as of <a href=https://github.com/dotnet/runtime/pull/44496 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44496</a>. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ISpanFormattable</span></code> is already recognized by various string formatting implementations, including that used by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Format</span></code>; you can see the impact of these interface implementations with a little benchmark, which gets better on .NET 6 as each instance’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryFormat</span></code> is used to format directly into the target buffer rather than first having to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToString</span></code>.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"{0} {1} {2} {3}"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'a'</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Rune</span></span><span class=pun><span class=pun>)</span></span><span class=str><span class=str>'b'</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nint</span></span><span class=pun><span class=pun>)</span></span><span class=str><span class=str>'c'</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nuint</span></span><span class=pun><span class=pun>)</span></span><span class=str><span class=str>'d'</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Format</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>212.3 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>312 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Format</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>179.7 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.85</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>312 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Format</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>137.1 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.65</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>200 B</td>
</tr>
</tbody>
</table></div>
<h3 id=arrays-strings-spans data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Arrays, Strings, Spans<a aria-labelledby=arrays-strings-spans class=linkicon href=#arrays-strings-spans data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>For many apps and services, creating and manipulating arrays, strings, and spans represent a significant portion of their processing, and lot of effort goes into finding ways to continually drive down the costs of these operations. .NET 6 is no exception.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s start with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Clear</span></code>. The current <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Clear</span></code> signature accepts the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span></code> to clear, the starting position, and the number of elements to clear. However, if you look at usage, the vast majority use case is with code like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Clear</span><span class=pun>(</span><span class=pln>array</span><span class=pun>,</span><span class=pln> </span><span class=lit>0</span><span class=pun>,</span><span class=pln> array</span><span class=pun>.</span><span class=typ>Length</span><span class=pun>)</span></code>… in other words, clearing the whole array. For a fundamental operation that’s used on hot paths, the extra validation that’s required in order to ensure the offset and count are in-bounds adds up. <a href=https://github.com/dotnet/runtime/pull/51548 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51548</a> and <a href=https://github.com/dotnet/runtime/pull/53388 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53388</a> add a new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Clear</span><span class=pun>(</span><span class=typ>Array</span><span class=pun>)</span></code> method that avoids these overheads and changes many call sites across dotnet/runtime to use the new overload.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _array </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Clear</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_array</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Clear</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_array</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5.563 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.775 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.68</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In a similar vein is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Fill</span></code>, which doesn’t just zero but sets every element to a specific value. <a href=https://github.com/dotnet/runtime/pull/51365 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51365</a> provides a significant improvement here: while for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> it’s already been able to directly invoke the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>initblk</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>memset</span></code>) implementation, which is vectorized, for other <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span><span class=pun>[]</span></code> arrays where <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> is a primitive type (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span></code>), it can now also use a vectorized implementation, leading to quite nice speedups. Then <a href=https://github.com/dotnet/runtime/pull/52590 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52590</a> from <a href=https://github.com/xtqqczze target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@xtqqczze</a> reuses <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Fill</span></code> as the underlying implementation for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Fill</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> as well.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _array </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>128</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pln><span class=pln> _c </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>'c'</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SpanFill</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AsSpan</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>Fill</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_c</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArrayFill</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Fill</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_array</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _c</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>SpanFill</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32.103 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>SpanFill</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.675 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.11</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ArrayFill</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>55.994 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ArrayFill</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.810 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.07</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Interestingly, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Fill</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> can’t simply delegate to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Fill</span></code>, for a reason that’s relevant to others looking to rebase array-based implementations on top of (mutable) spans. Arrays of reference types in .NET are covariant, meaning given a reference type <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> that derives from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code>, you can write code like:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> arrB </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
A</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> arrA </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> arrB</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Now you’ve got an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span><span class=pun>[]</span></code> where you can happily read out instances as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code>s but that can only store <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> instances, e.g. this is fine:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pln><span class=pln>arrA</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>but this will throw an exception:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pln><span class=pln>arrA</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> A</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>along the lines of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>ArrayTypeMismatchException</span><span class=pun>:</span><span class=pln> </span><span class=typ>Attempted</span><span class=pln> to access an element </span><span class=kwd>as</span><span class=pln> a type incompatible </span><span class=kwd>with</span><span class=pln> the array</span><span class=pun>.</span></code> This also incurs measurable overhead every time an element is stored into an array of (most) reference types. When spans were introduced, it was recognized that if you create a writeable span, you’re very likely going to write to it, and thus if the cost of a check needs to be paid somewhere, it’s better to pay that cost once when the span is created rather than on every write into the span. As such, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> is invariant and its constructor includes this code:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(!</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>IsValueType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;&amp;</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetType</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>[]))</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>ThrowHelper</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowArrayTypeMismatchException</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The check, which is removed entirely by the JIT for value types and which is optimized heavily by the JIT for reference types, validates that the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> specified matches the concrete type of the array. As an example, if you write this code:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Span</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>A</span></span><span class=pun><span class=pun>&gt;(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>]);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>that will throw an exception. Why is this relevant to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Fill</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>? It can accept arbitrary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span><span class=pun>[]</span></code> arrays, and there’s no guarantee that the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> exactly matches the array type, e.g.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> arr </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Fill</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>A</span></span><span class=pun><span class=pun>&gt;(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> B</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>If <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Fill</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> were implemented purely as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;(</span><span class=pln>array</span><span class=pun>).</span><span class=typ>Fill</span><span class=pun>(</span><span class=kwd>value</span><span class=pun>)</span></code>, the above code would throw an exception from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>‘s constructor. Instead, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span><span class=pun>.</span><span class=typ>Fill</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> itself performs the same check that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>‘s constructor does; if the check passes, it creates the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> and calls <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Fill</span></code>, but if the check doesn’t pass, it falls back to a typical loop, writing the value into each element of the array.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As long as we’re on the topic of vectorization, other support in this release has been vectorized. <a href=https://github.com/dotnet/runtime/pull/44111 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44111</a> takes advantage of SSSE3 hardware intrinsics (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Ssse3</span><span class=pun>.</span><span class=typ>Shuffle</span></code>) to optimize the implementation of the internal <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HexConverter</span><span class=pun>.</span><span class=typ>EncodeToUtf16</span></code> which is used in a few places, including the public <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Convert</span><span class=pun>.</span><span class=typ>ToHexString</span></code>:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _data</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _data </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>64</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>RandomNumberGenerator</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Fill</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_data</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ToHexString</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Convert</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToHexString</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_data</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ToHexString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>130.89 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>130.89纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ToHexString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>44.78 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>44.78纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.34</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/44088 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44088</a> also takes advantage of vectorization, though indirectly, by using the already vectorized <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span></code> methods to improve the performance of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Replace</span><span class=pun>(</span><span class=typ>String</span><span class=pun>,</span><span class=pln> </span><span class=typ>String</span><span class=pun>)</span></code>. This PR is another good example of “optimizations” frequently being tradeoffs, making some scenarios faster at the expense of making others slower, and needing to make a decision based on the expected frequency of these scenarios occurring. In this case, the PR improves three specific cases significantly:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#44088也利用了矢量化的优势，尽管是间接的，通过使用已经矢量化的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span></code> 方法来提高 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Replace</span><span class=pun>(</span><span class=typ>String</span><span class=pun>,</span><span class=pln> </span><span class=typ>String</span><span class=pun>)</span></code> 的性能。这个PR是“优化”经常被权衡的另一个很好的例子，使一些场景更快，以使其他场景更慢为代价，并且需要基于这些场景发生的预期频率做出决策。在这种情况下，PR显著改善了三种具体情况：</font></font></font></p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>If both inputs are just a single character (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>str</span><span class=pun>.</span><span class=typ>Replace</span><span class=pun>(</span><span class=str>"\n"</span><span class=pun>,</span><span class=pln> </span><span class=str>" "</span><span class=pun>)</span></code>), then it can delegate to the already-optimized <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Replace</span><span class=pun>(</span><span class=kwd>char</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>)</span></code> overload.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>如果两个输入都是单个字符（例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>str</span><span class=pun>.</span><span class=typ>Replace</span><span class=pun>(</span><span class=str>"\n"</span><span class=pun>,</span><span class=pln> </span><span class=str>" "</span><span class=pun>)</span></code> ），则它可以委托给已经优化的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Replace</span><span class=pun>(</span><span class=kwd>char</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>)</span></code> 重载。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>If the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>oldValue</span></code> is a single character, the implementation can use <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span><span class=pun>(</span><span class=kwd>char</span><span class=pun>)</span></code> to find it, rather than using a hand-rolled loop.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>如果 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>oldValue</span></code> 是单个字符，则实现可以使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span><span class=pun>(</span><span class=kwd>char</span><span class=pun>)</span></code> 来查找它，而不是使用手动滚动循环。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>If the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>oldValue</span></code> is multiple characters, the implementation can use the equivalent of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=typ>StringComparison</span><span class=pun>.</span><span class=typ>Ordinal</span><span class=pun>)</span></code> to find it.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>如果 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>oldValue</span></code> 是多个字符，则实现可以使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IndexOf</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=typ>StringComparison</span><span class=pun>.</span><span class=typ>Ordinal</span><span class=pun>)</span></code> 的等价物来查找它。</font></font></font></li>
</ul>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The second and third bullet points significantly speed up operation if the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>oldValue</span></code> being searched for isn’t super frequent in the input, enabling the vectorization to pay for itself and more. If, however, it’s very frequent (like every or every other character in the input), this change can actually regress performance. Our bet, based on reviewing use cases in a variety of code bases, is this overall will be a very positive win.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>如果正在搜索的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>oldValue</span></code> 在输入中不是超级频繁，则第二个和第三个要点显著加快了操作，从而使向量化能够为自己支付更多费用。但是，如果它非常频繁（就像输入中的每一个或每一个字符一样），这种变化实际上会使性能倒退。基于对各种代码库中用例的审查，我们的赌注是，这总体上将是一个非常积极的胜利。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> _str</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> hc </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpClient</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    _str </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> hc</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetStringAsync</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"https://www.gutenberg.org/cache/epub/3200/pg3200.txt"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln> </span></span><span class=com><span class=com>// The Entire Project Gutenberg Works of Mark Twain</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Yell</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _str</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Replace</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"."</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"!"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ConcatLines</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _str</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Replace</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"\n"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>""</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NormalizeEndings</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _str</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Replace</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"\r\n"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"\n"</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Yell</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32.85 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Yell</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>16.99 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.52</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ConcatLines</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>34.36 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ConcatLines</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>22.93 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.67</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NormalizeEndings</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>33.09 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NormalizeEndings</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>23.61 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.71</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Also for vectorization, previous .NET releases saw vectorization added to various algorithms in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Encodings</span><span class=pun>.</span><span class=typ>Web</span></code>, but specifically employing x86 hardware intrinsics, such that these optimizations didn’t end up applying on ARM. <a href=https://github.com/dotnet/runtime/pull/49847 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49847</a> now augments that with support from the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AdvSimd</span></code> hardware intrinsics, enabling similar speedups on ARM64 devices. And as long as we’re looking at <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Encodings</span><span class=pun>.</span><span class=typ>Web</span></code>, it’s worth calling out <a href=https://github.com/dotnet/runtime/pull/49373 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49373</a>, which completely overhauls the implementation of the library, with a primary goal of significantly reducing the amount of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>unsafe</span></code> code involved; in the process, however, as we’ve seen now time and again, using spans and other modern practices to replace <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>unsafe</span></code> pointer-based code often not only makes the code simpler and safer but also faster. Part of the change involved vectorizing the “skip over all ASCII chars which don’t require encoding” logic that all of the encoders utilize, helping to yield some significant speedups in common scenarios.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> _text</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Params</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"HTML"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"URL"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"JSON"</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Encoder</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TextEncoder</span></span><span class=pln><span class=pln> _encoder</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> hc </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpClient</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
        _text </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> hc</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetStringAsync</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"https://www.gutenberg.org/cache/epub/3200/pg3200.txt"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    _encoder </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Encoder</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>switch</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=str><span class=str>"HTML"</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HtmlEncoder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>
        </span></span><span class=str><span class=str>"URL"</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UrlEncoder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>
        _ </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>JavaScriptEncoder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Encode</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _encoder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Encode</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_text</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encoder<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码器 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>HTML</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>106.44 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>106.44毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>128 MB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>HTML</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>101.58 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>101.58毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.96</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>128 MB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>HTML</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>43.97 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>43.97毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.41</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>36 MB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>36兆字节 </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JSON</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>113.70 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>113.70毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>124 MB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>124兆字节 </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JSON</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>96.36 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>96.36毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.85</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>124 MB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>124兆字节 </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JSON</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>39.73 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>39.73毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.35</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>33 MB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>URL</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>165.60 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>165.60毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>136 MB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>URL</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>141.26 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>141.26毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.85</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>136 MB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>URL</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>70.63 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>70.63毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.43</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>44 MB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>44兆字节 </font></font></font></td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> API that’s been enhanced for .NET 6 is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Join</span></code>. One of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Join</span></code> overloads takes the strings to be joined as an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=kwd>string</span><span class=pun>?&gt;</span></code>, which it iterates, appending to a builder as it goes. But there’s already a separate array-based code path that does two passes over the strings, one to count the size required and then another to fill in the resulting string of the required length. <a href=https://github.com/dotnet/runtime/pull/44032 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44032</a> converts that functionality to be based on a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=pun>&lt;</span><span class=kwd>string</span><span class=pun>?&gt;</span></code> rather than <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>?[]</span></code>, and then special-cases enumerables that are actually <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=kwd>string</span><span class=pun>?&gt;</span></code> to go through the span-based path as well, utilizing the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CollectionsMarshal</span><span class=pun>.</span><span class=typ>AsSpan</span></code> method to get a span for the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=kwd>string</span><span class=pun>?&gt;</span></code>‘s backing array. <a href=https://github.com/dotnet/runtime/pull/56857 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56857</a> then does the same for the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>-based overload.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>另一个为. NET 6增强的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> API是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Join</span></code> 。其中一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Join</span></code> 重载将要连接的字符串作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=kwd>string</span><span class=pun>?&gt;</span></code> ，它会迭代，并在运行过程中附加到构建器中。但是已经有一个单独的基于数组的代码路径，它对字符串进行两次传递，一次是计算所需的大小，另一次是填充所需长度的结果字符串。dotnet/runtime#44032将该功能转换为基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=pun>&lt;</span><span class=kwd>string</span><span class=pun>?&gt;</span></code> 而不是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>?[]</span></code> ，然后将实际上是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=kwd>string</span><span class=pun>?&gt;</span></code> 的特殊情况枚举数也通过基于span的路径，利用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CollectionsMarshal</span><span class=pun>.</span><span class=typ>AsSpan</span></code> 方法为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=kwd>string</span><span class=pun>?&gt;</span></code> 的后备数组获取span。dotnet/runtime#56857然后对基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的重载执行相同的操作。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>List</span></span><span class=str><span class=str>&lt;string&gt;</span></span><span class=pln><span class=pln> _strings </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>List</span></span><span class=str><span class=str>&lt;string&gt;</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"Hi"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"How"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"are"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"you"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"today"</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Join</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Join</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>", "</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _strings</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Join<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>加入 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>124.81 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>124.81纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>120 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Join<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>加入 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>123.54 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>123.54纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.99</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>112 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Join<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>加入 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>51.08 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>51.08纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.41</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>72 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One of the biggest string-related improvements, though, comes from the new interpolated string handler support in C# 10 and .NET 6, with new language support added in <a href=https://github.com/dotnet/roslyn/pull/54692 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/roslyn#54692</a> and library support added in <a href=https://github.com/dotnet/runtime/pull/51086 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51086</a> and <a href=https://github.com/dotnet/runtime/pull/51653 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51653</a>. If I write:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然而，与字符串相关的最大改进之一来自C# 10和.NET 6中新的插值字符串处理程序支持，dotnet/roslyn#54692中添加了新的语言支持，dotnet/runtime#51086和dotnet/runtime#51653中添加了库支持。如果我写：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> major</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> minor</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> build</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> revision</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    $</span></span><span class=str><span class=str>"{major}.{minor}.{build}.{revision}"</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>C# 9 would compile that as:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>C# 9会编译为： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> major</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> minor</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> build</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> revision</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> array </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>object</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> major</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> minor</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> build</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> revision</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"{0}.{1}.{2}.{3}"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which incurs a variety of overheads, such as having to parse the composite format string on every call at run-time, box each of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code>s, and allocate an array to store them. With C# 10 and .NET 6, that’s instead compiled as:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这导致了各种开销，例如必须在运行时的每次调用时解析复合格式字符串，将每个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> 装箱，并分配数组来存储它们。对于C# 10和.NET 6，它被编译为：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> major</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> minor</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> build</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> revision</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> h </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DefaultInterpolatedStringHandler</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendFormatted</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>major</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendLiteral</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"."</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendFormatted</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>minor</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendLiteral</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"."</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendFormatted</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>build</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendLiteral</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"."</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendFormatted</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>revision</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToStringAndClear</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>with all of the parsing handled at compile-time, no additional array allocation, and no additional boxing allocations. You can see the impact of the changes with the aforementioned examples turned into a benchmark:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>所有的解析都在编译时处理，没有额外的数组分配，也没有额外的装箱分配。您可以通过将上述示例转化为基准测试来看到这些变化的影响： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Major</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Minor</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Build</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Revision</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>21380</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>object</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> array </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>object</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Major</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Minor</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Build</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    array</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Revision</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"{0}.{1}.{2}.{3}"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> h </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DefaultInterpolatedStringHandler</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendFormatted</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Major</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendLiteral</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"."</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendFormatted</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Minor</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendLiteral</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"."</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendFormatted</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Build</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendLiteral</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"."</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AppendFormatted</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Revision</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> h</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToStringAndClear</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>127.31 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>127.31纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>200 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>69.62 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>69.62纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.55</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>For an in-depth look, including discussion of various custom interpolated string handlers built-in to .NET 6 for improved support with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Debug</span><span class=pun>.</span><span class=typ>Assert</span></code>, and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MemoryExtensions</span></code>, see the <a href=https://devblogs.microsoft.com/dotnet/string-interpolation-in-c-10-and-net-6 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>String Interpolation in C# 10 and .NET 6</a>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>如需深入了解，包括对.NET 6内置的各种自定义插值字符串处理程序的讨论，以改进对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Debug</span><span class=pun>.</span><span class=typ>Assert</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MemoryExtensions</span></code> 的支持，请参阅C# 10和.NET 6中的字符串插值。</font></font></font></p>
<h3 id=buffering data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Buffering<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>缓冲 </font></font></font><a aria-labelledby=buffering class=linkicon href=#buffering data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Performance improvements can manifest in many ways: increasing throughput, reducing working set, reducing latencies, increasing startup speeds, lowering size on disk, and so on. Anyone paying attention to the performance of .NET will also notice a focus on reducing allocation. This is typically a means to an end rather than a goal in and of itself, as managed allocations themselves are easily trackable / measurable and incur varying costs, in particular the secondary cost of causing GCs to happen more frequently and/or take longer periods of time. Sometimes reducing allocations falls into the category of just stopping doing unnecessary work, or doing something instead that’s way cheaper; for example, <a href=https://github.com/dotnet/runtime/pull/42776 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42776</a> changed an eight-byte array allocation to an eight-byte stack-allocation, the latter of which is very close to free (in particular as this code is compiled with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>SkipLocalsInit</span><span class=pun>]</span></code> and thus doesn’t need to pay to zero out that stack-allocated space). Beyond that, though, there are almost always real tradeoffs. One common technique is pooling, which can look great on microbenchmarks because it drives down that allocation number, but it doesn’t always translate into a measurable improvement in one of the other metrics that’s actually an end goal. In fact, it can make things worse, such as if the overhead of renting and returning from the pool is higher than expected (especially if it incurs synchronization costs), if it leads to cache problems as something returned on one NUMA node ends up being consumed from another, if it leads to GCs taking longer by increasing the number of references from Gen1 or Gen2 objects to Gen0 objects, and so on. However, one place that pooling has shown to be quite effective is with arrays, in particular larger arrays of value types (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>[]</span></code>), which has led to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> being used <em data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>everywhere</em>. This places a high premium on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> being as efficient as possible, and this release sees several impactful improvements in this area.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>性能改进可以表现在许多方面：提高吞吐量、减少工作集、减少延迟、提高启动速度、降低磁盘大小等等。任何关注.NET性能的人也会注意到减少分配的重点。这通常是达到目的的手段，而不是其本身的目标，因为管理分配本身是容易跟踪/测量的，并产生不同的成本，特别是导致GC更频繁地发生和/或花费更长时间的次要成本。有时候减少分配福尔斯停止做不必要的工作，或者做一些更便宜的事情;例如，dotnet/runtime#42776将一个8字节的数组分配更改为一个8字节的堆栈分配，后者非常接近于空闲（特别是因为这段代码是用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>SkipLocalsInit</span><span class=pun>]</span></code> 编译的，因此不需要支付将堆栈分配的空间归零）。 然而，除此之外，几乎总是有真正的权衡。一种常见的技术是池化，它在微基准测试中看起来很棒，因为它降低了分配数量，但它并不总是转化为实际上是最终目标的其他指标之一的可衡量的改进。事实上，它会使事情变得更糟，例如，如果租用和从池返回的开销高于预期（特别是如果它会导致同步成本），如果它导致缓存问题，因为一个NUMA节点返回的东西最终被另一个节点消耗，如果它导致GC花费更长的时间，增加从Gen1或Gen2对象到Gen0对象的引用数量，等等。然而，池化已经证明非常有效的一个地方是数组，特别是值类型的较大数组（例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>[]</span></code> ），这导致 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> 被广泛使用。 这使得 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> 尽可能高效，这个版本在这方面看到了几个有影响力的改进。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Probably the most visible change in this area in .NET 6 is the for-all-intents-and-purposes removal of the upper limit on the size of arrays <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> will cache. Previously, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> would only cache up to approximately one million elements (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1024</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>1024</span></code>), a fact evident from this test run on .NET 5:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在.NET 6中，这方面最明显的变化可能是为了所有目的和目的删除了数组 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> 将缓存的大小上限。以前， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> 最多只能缓存大约100万个元素（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1024</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>1024</span></code> ），这一事实在.NET 5上运行的测试中显而易见：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RentReturn_1048576</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArrayPool</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Return</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>ArrayPool</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Rent</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1024</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1024</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RentReturn_1048577</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArrayPool</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Return</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>ArrayPool</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Rent</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1024</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1024</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>));</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_1048576<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1048576 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>21.90 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_1048577<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1048577租赁 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>18,210.30 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>18，210.30 ns </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>883.37</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,048,598 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1，048，598 B </font></font></font></td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ouch. That is a large cliff to fall off of, and either the developer is aware of the cliff and is forced to adapt to it in their code, or they’re not aware of it and end up having unexpected performance problems. This somewhat arbitrary limit was originally put in place before the pool had “trimming,” a mechanism that enabled the pool to drop cached arrays in response to Gen2 GCs, with varying levels of aggressiveness based on perceived memory pressure. But then that trimming was added, and the limit was never revisited… until now. <a href=https://github.com/dotnet/runtime/pull/55621 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55621</a> raises the limit as high as the current implementation’s scheme enables, which means it can now cache arrays up to approximately one billion elements (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1024</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>1024</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>1024</span></code>); that should hopefully be larger than almost anyone wants to pool.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>哎哟这是一个巨大的悬崖，开发人员要么意识到了悬崖，被迫在代码中适应它，要么他们没有意识到它，最终出现了意想不到的性能问题。这个有点武断的限制最初是在池进行“修整”之前就设置的，修整是一种使池能够响应Gen 2 GC丢弃缓存阵列的机制，基于感知的内存压力具有不同级别的侵略性。但后来那个修剪被添加了，这个限制从未被重新审视...直到现在。dotnet/runtime#55621将限制提高到当前实现方案允许的最高水平，这意味着它现在可以缓存多达大约10亿个元素的阵列（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1024</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>1024</span><span class=pln> </span><span class=pun>*</span><span class=pln> </span><span class=lit>1024</span></code> ）;希望它比任何人都要大。</font></font></font></p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_1048576<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1048576 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>21.01 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>21.01纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_1048576<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1048576 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>16.36 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>16.36纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.78</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_1048577<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1048577租赁 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>12,132.90 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>12，132.90 ns </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,048,593 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1，048，593 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_1048577<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1048577租赁 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>16.38 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>16.38纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.002</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course, pooling such arrays means it’s important that trimming works as expected, and while there’s an unending amount of tuning we could do to the trimming heuristics, the main gap that stood out had to do with how arrays in the pool are stored. With today’s implementation, the pool is divided into buckets with sizes equal to powers of two, so for example there’s a bucket for arrays with a length up to 16, then up to 32, then up to 64, and so on: requesting an array of size 100 will garner you an array of size 128. The pool is also split into two layers. The first layer is stored in thread-local storage, where each thread can store at most one array of each bucket size. The second layer is itself split into <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span><span class=pun>.</span><span class=typ>ProcessorCount</span></code> stacks, each of which is logically associated with one core, and each of which is individually synchronized. Code renting an array first consults the thread-local storage slot, and if it’s unable to get an array from there, proceeds to examine each of the stacks, starting with the one associated with the core it’s currently running on (which can of course change at any moment, so the affinity is quite soft and accesses require synchronization). Upon returning an array, a similar path is followed, with the code first trying to return to the thread-local slot, and then proceeding to try to find space in one of the stacks. The trimming implementation in .NET 5 and earlier is able to remove arrays from the stacks, and is given the opportunity on every Gen2 GC, but it will only ever drop arrays from the thread-local storage if there’s very high memory pressure. This can lead to some rarely-used arrays sticking around for a very long time, negatively impacting working set. <a href=https://github.com/dotnet/runtime/pull/56316 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56316</a> addresses this by tracking approximately how long arrays have been sitting in thread-local storage, and enabling them to be culled regardless of high memory pressure, instead using memory pressure to indicate what’s an acceptable duration for an array to remain.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当然，池化这样的数组意味着修剪按预期工作很重要，虽然我们可以对修剪启发式进行无休止的调整，但突出的主要差距与池中数组的存储方式有关。在今天的实现中，池被划分为大小等于2的幂的桶，因此例如，有一个用于数组的桶，长度最大为16，然后最大为32，然后最大为64，以此类推：请求大小为100的数组将获得大小为128的数组。池也分为两层。第一层存储在线程本地存储中，其中每个线程可以存储每个存储桶大小的至多一个数组。第二层本身被分成 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Environment</span><span class=pun>.</span><span class=typ>ProcessorCount</span></code> 堆栈，每个堆栈与一个核逻辑关联，并且每个堆栈单独同步。 租用数组的代码首先咨询线程本地存储槽，如果无法从那里获取数组，则继续检查每个堆栈，从与当前运行的核心相关联的堆栈开始（当然可以随时更改，因此亲和性相当软，访问需要同步）。返回数组时，遵循类似的路径，代码首先尝试返回线程本地槽，然后继续尝试在其中一个堆栈中寻找空间。.NET 5和更早版本中的修剪实现能够从堆栈中删除数组，并且在每个Gen2 GC上都有机会，但只有在内存压力非常高的情况下，它才会从线程本地存储中删除数组。这可能导致一些很少使用的阵列在很长时间内停留，对工作集产生负面影响。 dotnet/runtime#56316通过跟踪阵列在线程本地存储器中大约停留了多长时间来解决这个问题，并使它们能够被剔除而不管高内存压力，而不是使用内存压力来指示阵列保留的可接受持续时间。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>On top of these changes around what can be cached and for how long, more typical performance optimizations have also been done. <a href=https://github.com/dotnet/runtime/pull/55710 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55710</a> and <a href=https://github.com/dotnet/runtime/pull/55959 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55959</a> reduced typical overheads for renting and returning arrays. This entailed paying attention to where and why bounds checks were happening and avoiding them where possible, ordering checks performed to prioritize common cases (e.g. a request for a pooled size) over rare cases (e.g. a request for a size of 0), and reducing code size to make better use of instruction caches.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>除了这些关于可以缓存的内容和缓存时间的更改之外，还进行了更典型的性能优化。dotnet/runtime#55710和dotnet/runtime#55959减少了租用和归还阵列的典型开销。这需要注意边界检查发生的地点和原因，并尽可能避免它们，对执行的检查进行排序，以优先考虑常见情况（例如对于池化大小的请求）在罕见情况下（例如，大小为0的请求），以及减小代码大小以更好地利用指令高速缓存。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RentReturn_Single</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArrayPool</span></span><span class=str><span class=str>&lt;char&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Return</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>ArrayPool</span></span><span class=str><span class=str>&lt;char&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Rent</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>4096</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>[][]</span></span><span class=pln><span class=pln> _arrays </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>][];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RentReturn_Multi</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>[][]</span></span><span class=pln><span class=pln> arrays </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _arrays</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> arrays</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        arrays</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ArrayPool</span></span><span class=str><span class=str>&lt;char&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Rent</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>4096</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> arrays</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>ArrayPool</span></span><span class=str><span class=str>&lt;char&gt;</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Shared</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Return</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>arrays</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>]);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_Single</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>23.60 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_Single</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>18.48 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.78</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_Single</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>16.27 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.69</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_Multi</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>248.57 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_Multi</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>204.13 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.82</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RentReturn_Multi</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>197.21 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.79</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<h3 id=io data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IO<a aria-labelledby=io class=linkicon href=#io data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>A good deal of effort in .NET 6 has gone into fixing the performance of one of the oldest types in .NET: <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code>. Every app and service reads and writes files. Unfortunately, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> has also been plagued over the years by numerous performance-related issues, most of which are part of its asynchronous I/O implementation on Windows. For example, a call to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadAsync</span></code> might have issued an overlapped I/O read operation, but typically that read would end up then blocking in a sync-over-async manner, in order to avoid potential race conditions in the implementation that could otherwise result. Or when flushing its buffer, even when flushing asynchronously, those flushes would end up doing synchronous writes. Such issues often ended up defeating any scalability benefits of using asynchronous I/O while still incurring the overheads associated with asynchronous I/O (async I/O often has higher overheads in exchange for being more scalable). All of this was complicated further by the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> code being a tangled web difficult to unravel, in large part because it was trying to integrate a bunch of different capabilities into the same code paths: using overlapped I/O or not, buffering or not, targeting disk files or pipes, etc., with different logic for each, all interwined. Combined, this has meant that, with a few exceptions, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> code has remained largely untouched, until now.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6 sees <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> entirely rewritten, and in the process, all of these issues resolved. The result is a much more maintainable implementation that’s also dramatically faster, in particular for asynchronous operations. There have been a plethora of PRs as part of this effort, but I’ll call out a few. First <a href=https://github.com/dotnet/runtime/pull/47128 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47128</a> laid the groundwork for the new implementation, refactoring <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> to be a wrapper around a “strategy” (as in the Strategy design pattern), which then enables the actual implementation to be substituted and composed at runtime (similar to the approach discussed with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code>), with the existing implementation moved into one strategy that can be used in .NET 6 if maximum compatibility is required (it’s off by default but can be enabled with an environment variable or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AppContext</span></code> switch). <a href=https://github.com/dotnet/runtime/pull/48813 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48813</a> and <a href=https://github.com/dotnet/runtime/pull/49750 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49750</a> then introduced the beginnings of the new implementation, splitting it apart into several strategies on Windows, one for if the file was opened for synchronous I/O, one for if it was opened for asynchronous I/O, and one that enabled buffering to be layered on top of any strategy. <a href=https://github.com/dotnet/runtime/pull/55191 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55191</a> then introduced a Unix-optimized strategy for the new scheme. All the while, additional PRs were flowing in to optimize various conditions. <a href=https://github.com/dotnet/runtime/pull/49975 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49975</a> and <a href=https://github.com/dotnet/runtime/pull/56465 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56465</a> avoided an expensive syscall made on every operation on Windows to track the file’s length, while <a href=https://github.com/dotnet/runtime/pull/44097 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44097</a> removed an unnecessary seek when setting file length on Unix. <a href=https://github.com/dotnet/runtime/pull/50802 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50802</a> and <a href=https://github.com/dotnet/runtime/pull/51363 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51363</a> changed the overlapped I/O implementation on Windows to use a custom, reusable <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span></code>-based implementation rather than one based on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskCompletionSource</span></code>, which enabled making (non-buffered) async reads and writes amortized-allocation-free when using async I/O. <a href=https://github.com/dotnet/runtime/pull/55206 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55206</a> from <a href=https://github.com/tmds target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@tmds</a> used knowledge from an existing syscall being made on Unix to then avoid a subsequent unnecessary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>stat</span></code> system call. <a href=https://github.com/dotnet/runtime/pull/56095 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56095</a> took advantage of the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></code> previously discussed to reduce allocations involved in async operations on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> when buffering is being used (which is the default). <a href=https://github.com/dotnet/runtime/pull/56387 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56387</a> avoided a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadFile</span></code> call on Windows if we already had enough information to prove nothing would be available to read. And <a href=https://github.com/dotnet/runtime/pull/56682 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56682</a> took the same optimizations that had been done for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Read</span><span class=pun>/</span><span class=typ>WriteAsync</span></code> on Unix and applied them to Windows as well when the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> was opened for synchronous I/O. In the end, all of this adds up to huge maintainability benefits for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code>, huge performance improvements for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> (in particular for but not limited to asynchronous operations), and much better scalability for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code>. Here are just a few microbenchmarks to highlight some of the impact:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET 6看到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 完全重写，在这个过程中，所有这些问题都得到了解决。其结果是一个更易于维护的实现，而且速度也大大加快，特别是对于异步操作。作为这项努力的一部分，已经有过多的公关，但我会呼吁一些。首先，dotnet/runtime#47128为新的实现奠定了基础，重构 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 成为围绕“策略”的包装器（如Strategy设计模式），然后使实际的实现能够在运行时被替换和组合（类似于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Random</span></code> 讨论的方法），现有的实现移动到一个可以在.NET 6中使用的策略中，如果需要最大的兼容性（默认情况下是关闭的，但可以通过环境变量或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AppContext</span></code> 开关启用）。 dotnet/runtime#48813和dotnet/runtime#49750随后介绍了新实现的开始，将其拆分为Windows上的几个策略，一个用于如果文件是为同步I/O打开的，一个用于如果文件是为异步I/O打开的，还有一个用于在任何策略之上分层缓冲。dotnet/runtime#55191然后为新方案引入了Unix优化策略。一直以来，额外的PR流入以优化各种条件。dotnet/runtime#49975和dotnet/runtime#56465避免了在Windows上的每个操作中进行昂贵的系统调用来跟踪文件的长度，而dotnet/runtime#44097消除了在Unix上设置文件长度时不必要的查找。 dotnet/runtime#50802和dotnet/runtime#51363将Windows上的重叠I/O实现更改为使用自定义的、可重用的基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span></code> 的实现，而不是基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskCompletionSource</span></code> 的实现，这使得在使用异步I/O时能够进行（非缓冲的）异步读取和写入（非缓冲的）分配-free。来自@tmds的dotnet/runtime#55206使用了Unix上现有系统调用的知识，从而避免了后续不必要的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>stat</span></code> 系统调用。dotnet/runtime#56095利用了前面讨论的新 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PoolingAsyncValueTaskMethodBuilder</span></code> 来减少在使用缓冲时（默认）在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 上异步操作中涉及的分配。dotnet/runtime#56387避免了在Windows上的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadFile</span></code> 调用，如果我们已经有足够的信息来证明没有可用的内容可以读取。dotnet/runtime#56682采用了与Unix上 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Read</span><span class=pun>/</span><span class=typ>WriteAsync</span></code> 相同的优化，并在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 为同步I/O打开时也将其应用到Windows。 最后，所有这些都为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 带来了巨大的可维护性优势，为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 带来了巨大的性能提升（特别是但不限于异步操作），以及为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 带来了更好的可扩展性。 以下是一些微基准测试，以突出一些影响：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>FileStream</span></span><span class=pln><span class=pln> _fileStream</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1024</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Params</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsAsync</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Params</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4096</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BufferSize</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> data </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000_000</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Random</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>42</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>NextBytes</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>data</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> path </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Path</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetTempFileName</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>File</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteAllBytes</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>path</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> data</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    _fileStream </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>FileStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>path</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>FileMode</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Open</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>FileAccess</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Read</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>FileShare</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Read</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BufferSize</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsAsync</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalCleanup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Cleanup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _fileStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>File</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Delete</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_fileStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Name</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Read</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _fileStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Position</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_fileStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Read</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer
</span></span><span class=com><span class=com>#if !NETCOREAPP2_1_OR_GREATER</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _buffer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pln><span class=pln>
</span></span><span class=com><span class=com>#endif</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ReadAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _fileStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Position</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> _fileStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReadAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer
</span></span><span class=com><span class=com>#if !NETCOREAPP2_1_OR_GREATER</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _buffer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pln><span class=pln>
</span></span><span class=com><span class=com>#endif</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsAsync</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>BufferSize</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>30.717 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>30.745 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>31.156 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.01</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>30.772 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>50.806 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2,125,865 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>44.505 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.88</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,953,592 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>39.212 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.77</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,094,096 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>36.018 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.71</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>247 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>9.593 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>9.761 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.02</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>9.446 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.99</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>9.569 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>30.920 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2,141,481 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>23.758 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.81</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,953,592 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>25.101 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.82</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,094,096 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>13.108 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.42</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>382 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>413.228 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2,121,728 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>217.891 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.53</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3,050,056 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>219.388 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.53</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3,062,741 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>83.070 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.20</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2,109,867 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>355.670 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3,833,856 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>262.625 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.74</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3,048,120 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>259.284 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.73</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3,047,496 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>119.573 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.34</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>403 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>106.696 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>530,842 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>56.785 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.54</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>353,151 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>54.359 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.51</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>353,966 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>22.971 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.22</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>527,930 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>143.082 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3,026,980 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>55.370 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.38</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>355,001 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>54.436 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.38</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>354,036 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReadAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4096</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32.478 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.23</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>420 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Some of the improvements in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> also involved moving the read/write aspects of its implementation out into a separate public class: <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=pln>IO</span><span class=pun>.</span><span class=typ>RandomAccess</span></code>. Implemented in <a href=https://github.com/dotnet/runtime/pull/53669 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53669</a>, <a href=https://github.com/dotnet/runtime/pull/54266 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54266</a>, and <a href=https://github.com/dotnet/runtime/pull/55490 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55490</a> (with additional optimizations in <a href=https://github.com/dotnet/runtime/pull/55123 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55123</a> from <a href=https://github.com/teo-tsirpanis target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@teo-tsirpanis</a>), <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RandomAccess</span></code> provides overloads that enable sync and async reading and writing, for both a single and multiple buffers at a time, and specifying the exact offset into the file at which the read or write should occur. All of these static methods accept a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeFileHandle</span></code>, which can now be obtained from the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>File</span><span class=pun>.</span><span class=typ>OpenHandle</span></code> method. This all means code is now able to access files without going through <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> if the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code>-based interface isn’t desirable, and it means code is able to issue concurrent reads or writes for the same <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeFileHandle</span></code>, if parallel processing of a file is desired. Subsequent PRs like <a href=https://github.com/dotnet/runtime/pull/55150 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55150</a> took advantage of these new APIs to avoid the extra allocations and complexity involved in using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> when all that was really needed was the handle and the ability to perform a single read or write. (<a href=https://github.com/adamsitnik target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@adamsitnik</a> is working on a dedicated blog post focused on these <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> improvements; look for that on the <a href=https://devblogs.microsoft.com/dotnet/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Blog</a> soon.)<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 中的一些改进还包括将其实现的读/写方面移到一个单独的公共类中：第一名。在dotnet/runtime#53669、dotnet/runtime#54266和dotnet/runtime#55490中实现（在@teo-tsirpanis的dotnet/runtime#55123中进行了额外的优化）， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RandomAccess</span></code> 提供了允许同步和异步阅读和写入的重载，一次为单个和多个缓冲区，并指定读取或写入应该发生的文件的确切偏移量。所有这些静态方法都接受 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeFileHandle</span></code> ，现在可以从新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>File</span><span class=pun>.</span><span class=typ>OpenHandle</span></code> 方法中获得。这一切意味着如果不需要基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 的接口，代码现在能够访问文件而不需要通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> ，并且这意味着如果需要并行处理文件，代码能够为同一 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeFileHandle</span></code> 发出并发读取或写入。 后来的PR，如dotnet/runtime#55150利用了这些新的API，以避免使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 时所涉及的额外分配和复杂性，因为真正需要的只是句柄和执行单个读取或写入的能力。（@adamsitnik正在撰写一篇专门的博客文章，重点关注这些 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 改进;很快就可以在. NET博客上找到它了。）</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course, there’s more to working with files than just <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code>. <a href=https://github.com/dotnet/runtime/pull/55210 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55210</a> from <a href=https://github.com/tmds target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@tmds</a> eliminated a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>stat</span></code> syscall from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Directory</span><span class=pun>/</span><span class=typ>File</span><span class=pun>.</span><span class=typ>Exists</span></code> when the target doesn’t exist, <a href=https://github.com/dotnet/runtime/pull/47118 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47118</a> from <a href=https://github.com/gukoff target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@gukoff</a> avoids a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>rename</span></code> syscall when moving a file across volumes on Unix, and <a href=https://github.com/dotnet/runtime/pull/55644 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55644</a> simplifies <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>File</span><span class=pun>.</span><span class=typ>WriteAllTextAsync</span></code> and makes it faster with less allocation (this benchmark of course also benefits from the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> improvements:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当然，除了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 之外，还有更多的文件。来自@tmds的dotnet/runtime#55210在目标不存在时消除了来自 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Directory</span><span class=pun>/</span><span class=typ>File</span><span class=pun>.</span><span class=typ>Exists</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>stat</span></code> 系统调用，来自@gukoff的dotnet/runtime#47118在Unix上跨卷移动文件时避免了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>rename</span></code> 系统调用，而dotnet/runtime#55644简化了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>File</span><span class=pun>.</span><span class=typ>WriteAllTextAsync</span></code> ，并通过更少的分配使其更快（这个基准测试当然也受益于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 改进：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> s_contents </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Concat</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>)(</span></span><span class=str><span class=str>'a'</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>%</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>26</span></span><span class=pun><span class=pun>))));</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> s_path </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Path</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetRandomFileName</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WriteAllTextAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>File</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteAllTextAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s_path</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> s_contents</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WriteAllTextAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.609 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.609毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>23 KB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WriteAllTextAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.590 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.590毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>23 KB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>WriteAllTextAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.143 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.143毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.72</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>15 KB</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>And, of course, there’s more to I/O than just files. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NamedPipeServerStream</span></code> on Windows provides an overlapped I/O-based implementation very similar to that of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code>. With <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code>‘s implementation being overhauled, <a href=https://github.com/dotnet/runtime/pull/52695 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52695</a> from <a href=https://github.com/manandre target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@manandre</a> also overhauled the pipes implementation to mimic the same updated structure as that used in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code>, and thereby incur many of the same benefits, in particular around allocation reduction due to a reusable <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span></code>-based implementation rather than a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskCompletionSource</span></code>-based implementation.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当然，I/O不仅仅是文件。Windows上的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NamedPipeServerStream</span></code> 提供了一个与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 非常相似的基于重叠I/O的实现。随着 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 的实现被大修，来自@manandre的dotnet/runtime#52695也大修了pipes实现以模仿与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 中使用的相同的更新结构，从而产生了许多相同的好处，特别是由于可重用的基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span></code> 的实现而不是基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskCompletionSource</span></code> 的实现而导致的分配减少。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>On the compression front, in addition to the introduction of the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ZlibStream</span></code> (<a href=https://github.com/dotnet/runtime/pull/42717 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42717</a>), the underlying <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Brotli</span></code> code that’s used behind <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BrotliStream</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BrotliEncoder</span></code>, and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BrotliDecoder</span></code> was upgraded from v1.0.7 in <a href=https://github.com/dotnet/runtime/pull/44107 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44107</a> from <a href=https://github.com/saucecontrol target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@saucecontrol</a> to v1.0.9. That upgrade brings with it various <a href=https://github.com/google/brotli/releases/tag/v1.0.9 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>performance improvements</a>, including code paths that make better use of intrinsics. Not all compression/decompression measurably benefits, but some certainly does:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在压缩方面，除了引入新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ZlibStream</span></code> （dotnet/runtime#42717）之外，在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BrotliStream</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BrotliEncoder</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BrotliDecoder</span></code> 后面使用的底层 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Brotli</span></code> 代码也从dotnet/runtime#44107的v1.0.7从@saucecontrol升级到v1.0.9。该升级带来了各种性能改进，包括更好地利用内部函数的代码路径。并非所有的压缩/解压缩都有可衡量的好处，但有些确实有：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _toCompress</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MemoryStream</span></span><span class=pln><span class=pln> _destination </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MemoryStream</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> hc </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpClient</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    _toCompress </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> hc</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetByteArrayAsync</span></span><span class=pun><span class=pun>(@</span></span><span class=str><span class=str>"https://raw.githubusercontent.com/dotnet/performance/5584a8b201b8c9c1a805fae4868b30a678107c32/src/benchmarks/micro/corefx/System.IO.Compression/TestData/alice29.txt"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Compress</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _destination</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Position</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> ds </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BrotliStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CompressionLevel</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Fastest</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> leaveOpen</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    ds</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Write</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_toCompress</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Compress</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,050.2 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Compress</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>786.6 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.75</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/47125 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47125</a> from <a href=https://github.com/NewellClark target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@NewellClark</a> also added some missing overrides to various <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> types, including <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code>, which has an effect of reducing the overhead of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span><span class=pun>.</span><span class=typ>WriteAsync</span></code>.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There’s one more interesting, performance-related improvement in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> (and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GZipStream</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BrotliStream</span></code>). The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> contract for asynchronous read operations is that, assuming you request at least one byte, the operation won’t complete until at least one byte is read; however, the contract makes no guarantees whatsoever that the operation will return all that you requested, in fact it’s rare to find a stream that does make such a guarantee, and it’s problematic in many cases when it does. Unfortunately, as an implementation detail, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> was in fact trying to return as much data as was requested, by issuing as many reads against the underlying stream as it needed to in order to make that happen, stopping only when it decoded a sufficient amount of data to satisfy the request or hit EOF (end of file) on the underlying stream. This is a problem for multiple reasons. First, it prevents overlapping the processing of any data that may have already been received with the waiting for more data to receive; if 100 bytes are already available, but I asked for 200, I’m then forced to wait to process the 100 until another 100 are received or the stream hits EOF. Second, and more impactful, is it effectively prevents <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> from being used in any bidirectional communication scenario. Imagine a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> wrapped around a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NetworkStream</span></code>, and the stream is being used to send and receive compressed messages to and from a remote party. Let’s say I pass <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> a 1K buffer, the remote party sends me a 100-byte message, and I’m supposed to read that message and respond (a response the remote party will be waiting for before sending me anything further). <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code>‘s behavior here will deadlock the whole system, as it will prevent the receipt of the 100-byte message waiting for another 900 bytes or EOF that will never arrive. <a href=https://github.com/dotnet/runtime/pull/53644 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53644</a> fixes that by enabling <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> (and a few other streams) to return once it has data to hand back, even if not the sum total requested. This has been <a href=https://docs.microsoft.com/dotnet/core/compatibility/core-libraries/6.0/partial-byte-reads-in-streams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>documented as a breaking change</a>, not because the previous behavior was guaranteed (it wasn’t), but we’ve seen enough code erroneously depend on the old behavior that it was important to call out.<font data-immersive-translate-effect=1 data-immersive-translate-error-id=1133 class="notranslate immersive-translate-target-wrapper immersive-translate-target-wrapper-error" translate=no lang=zh-CN><a><font class="immersive-translate-error notranslate"><font class=immersive-translate-error-wrapper><font data-immersive-translate-action=retry title=重试全部错误段落 data-immersive-translate-paragraph-id=1133 class="immersive-translate-clickable-button notranslate"><img draggable=false role=img class=emoji alt=🔄 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iIzNCODhDMyIgZD0iTTM2IDMyYzAgMi4yMDktMS43OTEgNC00IDRINGMtMi4yMDkgMC00LTEuNzkxLTQtNFY0YzAtMi4yMDkgMS43OTEtNCA0LTRoMjhjMi4yMDkgMCA0IDEuNzkxIDQgNHYyOHoiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMjIuMjQyIDIyLjI0MmwyLjgyOSAyLjgyOWMtMy45MDUgMy45MDUtMTAuMjM3IDMuOTA0LTE0LjE0My0uMDAxLTIuMjQ3LTIuMjQ2LTMuMTk0LTUuMjk2LTIuODU0LTguMjI1bC00LjAzNy4zNjdjLS4yMTUgMy44NCAxLjEyOCA3Ljc1MiA0LjA2MiAxMC42ODcgNS40NjcgNS40NjcgMTQuMzMzIDUuNDY4IDE5Ljc5OSAwbDIuODI4IDIuODI4Ljg0OS05LjMzNC05LjMzMy44NDl6TTI3Ljg5OSA4LjFDMjIuNDMxIDIuNjMzIDEzLjU2OCAyLjYzMyA4LjEgOC4xTDUuMjcyIDUuMjcybC0uODQ5IDkuMzM0IDkuMzM0LS44NDktMi44MjktMi44MjljMy45MDYtMy45MDUgMTAuMjM2LTMuOTA1IDE0LjE0MiAwIDIuMjQ4IDIuMjQ3IDMuMTk0IDUuMjk3IDIuODU2IDguMjI2bDQuMDM2LS4zNjZjLjIxNi0zLjg0MS0xLjEyOC03Ljc1My00LjA2My0xMC42ODh6Ii8+PC9zdmc+></font>&nbsp;&nbsp;<font data-immersive-translate-action=toast-error data-immersive-translate-tooltip-text="Server is busy now, (10000), please retry later" title=点击查看错误原因 class="immersive-translate-help-button notranslate"><img draggable=false role=img class=emoji alt=❓ src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0JFMTkzMSIgZD0iTTE3IDI3Yy0xLjY1NyAwLTMtMS4zNDMtMy0zdi00YzAtMS42NTcgMS4zNDMtMyAzLTMgLjYwMy0uMDA2IDYtMSA2LTUgMC0yLTItNC01LTQtMi40NDEgMC00IDItNCAzIDAgMS42NTctMS4zNDMgMy0zIDNzLTMtMS4zNDMtMy0zYzAtNC44NzggNC41OC05IDEwLTkgOCAwIDExIDUuOTgyIDExIDExIDAgNC4xNDUtMi4yNzcgNy4zMTMtNi40MTMgOC45Mi0uOS4zNTEtMS43OS41ODctMi41ODcuNzQ3VjI0YzAgMS42NTctMS4zNDMgMy0zIDN6Ii8+PGNpcmNsZSBmaWxsPSIjQkUxOTMxIiBjeD0iMTciIGN5PSIzMiIgcj0iMyIvPjwvc3ZnPg=="></font></font></font></a></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The PR also fixes one more performance-related thing. One issue scalable web servers need to be cognizant of is memory utilization. If you’ve got a thousand open connections, and you’re waiting for data to arrive on each connection, you could perform an asynchronous read on each using a buffer, but if that buffer is, say, 4K, that’s 4MB worth of buffers that are sitting there wasting working set. If you could instead issue a zero-byte read, where you perform an empty read simply to be notified when there is data that could be received, you can then avoid any working set impact from buffers, only allocating or renting a buffer to be used once you know there’s data to put in it. Lots of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Streams</span></code> intended for bidirectional communication, like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NetworkStream</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code>, support such zero-byte reads, not returning from an empty read operation until there’s at least one byte that could be read. For .NET 6, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> can now also be used in this capacity, with the PR changing the implementation to ensure that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> will still issue a read to its underlying <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> in the case the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code>‘s output buffer is empty, even if the caller asked for zero bytes. Callers that don’t want this behavior can simply avoid making the 0-byte call.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>公关还修复了一个与性能相关的事情。可扩展Web服务器需要认识的一个问题是内存利用率。如果你有一千个打开的连接，并且你在等待数据到达每个连接，你可以使用缓冲区对每个连接执行异步读取，但如果缓冲区是，比方说，4K，那就是4MB的缓冲区，浪费了工作集。如果您可以改为发出零字节读取，执行空读取只是为了在有数据可以被接收时得到通知，那么您就可以避免缓冲区对工作集的任何影响，只分配或租用缓冲区以便在您知道有数据要放入时使用。许多用于双向通信的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Streams</span></code> ，如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NetworkStream</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> ，支持这样的零字节读取，直到至少有一个字节可以被读取，才从空读取操作返回。For .NET 6， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> 现在也可以在这个容量中使用，PR改变了实现，以确保在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> 的输出缓冲区为空的情况下， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> 仍然会向其底层 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 发出读取，即使调用者要求零字节。不希望这种行为的调用者可以简单地避免进行0字节调用。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Moving on, for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=pln>IO</span><span class=pun>.</span><span class=typ>Pipelines</span></code>, a couple of PRs improved performance. <a href=https://github.com/dotnet/runtime/pull/55086 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55086</a> added overrides of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadByte</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteByte</span></code> that avoid the asynchronous code paths when a byte to read is already buffered or space in the buffer is available to write the byte, respectively. And <a href=https://github.com/dotnet/runtime/pull/52159 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52159</a> from <a href=https://github.com/manandre target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@manandre</a> added a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CopyToAsync</span></code> override to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PipeReader</span></code> used for reading from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code>s, optimizing it to first copy whatever data was already buffered and then delegate to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code>‘s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CopyToAsync</span></code>, taking advantage of whatever optimizations it may have.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>继续，对于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=pln>IO</span><span class=pun>.</span><span class=typ>Pipelines</span></code> ，几个PR提高了性能。dotnet/runtime#55086增加了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadByte</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteByte</span></code> 的覆盖，当要读取的字节已经被缓冲或缓冲区中的空间可用于写入字节时，它们分别避免了异步代码路径。来自@manandre的dotnet/runtime#52159为用于从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 阅读的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PipeReader</span></code> 添加了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CopyToAsync</span></code> 覆盖，优化它首先复制已经缓冲的任何数据，然后委托给 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CopyToAsync</span></code> ，利用它可能有的任何优化。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Beyond that, there were a variety of small improvements. <a href=https://github.com/dotnet/runtime/pull/55373 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55373</a> and <a href=https://github.com/dotnet/runtime/pull/56568 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56568</a> from <a href=https://github.com/steveberdy target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@steveberdy</a> removed unnecessary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Contains</span><span class=pun>(</span><span class=str>'\0'</span><span class=pun>)</span></code> calls from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Path</span><span class=pun>.</span><span class=typ>GetFullPath</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=kwd>string</span><span class=pun>)</span></code>; <a href=https://github.com/dotnet/runtime/pull/54991 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54991</a> from <a href=https://github.com/lateapexearlyspeed target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@lateapexearlyspeed</a> improved <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BufferedStream</span><span class=pun>.</span><span class=typ>Position</span></code>‘s setter to avoid pitching buffered read data if it would still be valuable for the new position; <a href=https://github.com/dotnet/runtime/pull/55147 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55147</a> removed some casting overhead from the base <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> type; <a href=https://github.com/dotnet/runtime/pull/53070 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53070</a> from <a href=https://github.com/DavidKarlas target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@DavidKarlas</a> avoided unnecessarily roundtripping a file time through local time in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>File</span><span class=pun>.</span><span class=typ>GetLastWriteTimeUtc</span></code> on Unix; and <a href=https://github.com/dotnet/runtime/pull/43968 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43968</a> consolidating the argument validation logic for derived <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> types into public helpers (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span><span class=pun>.</span><span class=typ>ValidateBufferArguments</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span><span class=pun>.</span><span class=typ>ValidateCopyToArguments</span></code>), which, in addition to eliminating duplicated code and helping to ensure consistency of behavior, helps to streamline the validation logic using a shared, efficient implementation of the relevant checks.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>除此之外，还有各种各样的小改进。来自@steveberdy的dotnet/runtime#55373和dotnet/runtime#56568删除了来自 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Path</span><span class=pun>.</span><span class=typ>GetFullPath</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>,</span><span class=pln> </span><span class=kwd>string</span><span class=pun>)</span></code> 的不必要的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Contains</span><span class=pun>(</span><span class=str>'\0'</span><span class=pun>)</span></code> 调用;来自@lateapexearlyspeed的dotnet/runtime#54991改进了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BufferedStream</span><span class=pun>.</span><span class=typ>Position</span></code> 的设置器，以避免在缓冲的读取数据对新位置仍然有价值的情况下倾斜; dotnet/runtime#55147从基本 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 类型中删除了一些铸造开销;来自@DavidKarlas的dotnet/runtime#53070避免了在Unix上 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>File</span><span class=pun>.</span><span class=typ>GetLastWriteTimeUtc</span></code> 中不必要地通过本地时间往返文件时间; dotnet/runtime#43968将派生的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 类型的参数验证逻辑合并到公共帮助器（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span><span class=pun>.</span><span class=typ>ValidateBufferArguments</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span><span class=pun>.</span><span class=typ>ValidateCopyToArguments</span></code> ）中，这除了消除重复代码并帮助确保行为的一致性之外，还有助于使用相关检查的共享、高效实现来简化验证逻辑。</font></font></font></p>
<h3 id=networking data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Networking<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>联网 </font></font></font><a aria-labelledby=networking class=linkicon href=#networking data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s turn our attention to networking. It goes without saying that networking is at the heart of services and most significant apps today, and so improvements in networking performance are critical to the platform.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>让我们把注意力转向网络。不言而喻，网络是当今服务和最重要应用的核心，因此网络性能的改进对平台至关重要。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>At the bottom of the networking stack, we have <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Net</span><span class=pun>.</span><span class=typ>Sockets</span></code>. One of my favorite sets of changes in this release is that we finally rid the System.Net.Sockets.dll assembly of all custom <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IAsyncResult</span></code> implementations; all of the remaining places where <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndXx</span></code> methods provided an implementation and a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>-based <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>XxAsync</span></code> method wrapped that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndXx</span></code> have now been flipped, with the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>XxAsync</span></code> method providing the implementation, and the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndXx</span></code> methods just delegating to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>-based methods. So, for example, <a href=https://github.com/dotnet/runtime/pull/43886 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43886</a> reimplemented <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>BeginSend</span><span class=pun>/</span><span class=typ>EndSend</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>BeginReceive</span><span class=pun>/</span><span class=typ>EndReceive</span></code> as wrappers for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>SendAsync</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>ReceiveAsync</span></code>, and <a href=https://github.com/dotnet/runtime/pull/43661 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43661</a> rewrote <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>ConnectAsync</span></code> using tasks and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pun>/</span><span class=kwd>await</span></code>, and then <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndConnect</span></code> were just implemented in terms of that. Similarly, <a href=https://github.com/dotnet/runtime/pull/53340 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53340</a> added new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AcceptAsync</span></code> overloads that are not only task-based but also cancelable (a long requested feature), and <a href=https://github.com/dotnet/runtime/pull/51212 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51212</a> then deleted a lot of code by having the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndAccept</span></code> methods just use the task-based implementation. These changes not only reduced the size of the assembly, reduced dependencies from System.Net.Sockets.dll (the custom <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IAsyncResult</span></code> implementations were depending on libraries like System.Security.Windows.Principal.dll), and reduced the complexity of the code, they also reduced allocation. To see the impact, here’s a little microbenchmark that repeatedly establishes a new loopback connection:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在网络堆栈的底部，我们有 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Net</span><span class=pun>.</span><span class=typ>Sockets</span></code> 。在这个版本中我最喜欢的一组变化是，我们终于摆脱了所有自定义 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IAsyncResult</span></code> 实现的System.Net.Sockets.dll程序集; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndXx</span></code> 方法提供实现的所有剩余位置，以及 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndXx</span></code> 包装的基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>XxAsync</span></code> 方法现在已经被翻转， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>XxAsync</span></code> 方法提供实现， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndXx</span></code> 方法仅委托给基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> 的方法。例如，dotnet/runtime#43886重新实现了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>BeginSend</span><span class=pun>/</span><span class=typ>EndSend</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>BeginReceive</span><span class=pun>/</span><span class=typ>EndReceive</span></code> 作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>SendAsync</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>ReceiveAsync</span></code> 的包装器，dotnet/runtime#43661使用task和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pun>/</span><span class=kwd>await</span></code> 重写了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>ConnectAsync</span></code> ，然后 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndConnect</span></code> 就这样实现了。类似地，dotnet/runtime#53340添加了新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AcceptAsync</span></code> 重载，不仅是基于任务的，而且是可取消的（一个长期要求的特性），然后dotnet/runtime#51212删除了很多代码，让 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>EndAccept</span></code> 方法只使用基于任务的实现。 这些更改不仅减少了程序集的大小，减少了对System.Net.Sockets.dll的依赖性（自定义的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IAsyncResult</span></code> 实现依赖于System.Security.Windows.Principal.dll等库），降低了代码的复杂性，还减少了分配。 为了了解影响，这里有一个小的微基准测试，它反复建立一个新的环回连接：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ConnectAcceptAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> listener </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tcp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Bind</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IPEndPoint</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IPAddress</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Loopback</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
    listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Listen</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> client </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tcp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ConnectAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> server </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AcceptAsync</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ConnectAcceptAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>282.3 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2,780 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ConnectAcceptAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>278.3 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.99</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,698 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ConnectAcceptAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>273.8 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.97</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,402 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Then for .NET 6, I can also add <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span><span class=pun>.</span><span class=kwd>None</span></code> as an argument to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConnectAsync</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AcceptAsync</span></code>. Passing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span><span class=pun>.</span><span class=kwd>None</span></code> as the last argument changes the overload used; this overload doesn’t just enable cancellation (if you were to pass in a cancelable token), but those new overloads return <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>s, further reducing allocation. With that, I get the following, for an additional reduction:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Params</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NewOverload</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ConnectAcceptAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> listener </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tcp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Bind</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IPEndPoint</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IPAddress</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Loopback</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
    listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Listen</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> client </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tcp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>NewOverload</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ConnectAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>else</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ConnectAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> server </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AcceptAsync</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NewOverload<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>新过载 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ConnectAcceptAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>False<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>假 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>270.5 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>270.5美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,403 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1，403 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ConnectAcceptAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>True<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>真 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>262.5 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>262.5美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,324 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1，B </font></font></font></td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/47781 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47781</a> is another example of flipping the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>End</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code>-based implementations. It adds new task-based overloads for the UDP-focused sending and receiving operations on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendTo</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveFrom</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveMessageFrom</span></code>), and then reimplements the existing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>End</span></code> methods on top of the new task-based (actually <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code>) methods. Here’s an example; note that technically these benchmarks are flawed given that UDP is lossy, but I’ve ignored that for the purposes of determining the costs of these methods.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#47781是翻转基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>End</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span></code> 的实现的另一个示例。它为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span></code> （ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendTo</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveFrom</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveMessageFrom</span></code> ）上的UDP发送和接收操作添加了新的基于任务的重载，然后在新的基于任务的（实际上是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> ）方法之上重新实现现有的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Begin</span><span class=pun>/</span><span class=typ>End</span></code> 方法。这里有一个例子请注意，考虑到UDP是有损的，这些基准在技术上是有缺陷的，但是为了确定这些方法的成本，我忽略了这一点。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pln><span class=pln> _client</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pln><span class=pln> _server</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _client </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dgram</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Udp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Bind</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IPEndPoint</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IPAddress</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Loopback</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>

    _server </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dgram</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Udp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Bind</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IPEndPoint</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IPAddress</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Loopback</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ReceiveSendAsync</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> receive </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReceiveFromAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketFlags</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> _server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SendToAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketFlags</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> receive</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReceiveSendAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>36.24 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,888 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReceiveSendAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>36.22 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,672 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ReceiveSendAsync</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>28.50 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.79</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>384 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Then, as in the previous example, I can try adding in the additional <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> argument:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> receive </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReceiveFromAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketFlags</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> _server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SendToAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketFlags</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> receive</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> receive </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReceiveFromAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketFlags</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> _server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SendToAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketFlags</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pun><span class=pun>.</span></span><span class=kwd><span class=kwd>None</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> receive</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>28.95 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>28.95美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>384 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>27.83 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>27.83美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.96</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>288 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Other new overloads have also been added in .NET 6 (almost all of the operations on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span></code> now have overloads accepting <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>{</span><span class=typ>ReadOnly</span><span class=pun>}</span><span class=typ>Memory</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, complete with functioning support for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code>). <a href=https://github.com/dotnet/runtime/pull/47230 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47230</a> from <a href=https://github.com/gfoidl target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@gfoidl</a> added a span-based overload of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>SendFile</span></code>, enabling the pre- and post- buffers to be specified as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> rather than <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code>, which makes it cheaper to send only a portion of some array (the alternative with the existing overloads would be to allocate a new array of the desired length and copy the relevant data into it), and then <a href=https://github.com/dotnet/runtime/pull/52208 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52208</a> also from <a href=https://github.com/gfoidl target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@gfoidl</a> added a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Memory</span></code>-based overload of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>SendFileAsync</span></code>, returning a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> (subsequently <a href=https://github.com/dotnet/runtime/pull/53062 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53062</a> provided the cancellation support that had been stubbed out in the previous PR). On top of that, <a href=https://github.com/dotnet/runtime/pull/55232 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55232</a>, and then <a href=https://github.com/dotnet/runtime/pull/56777 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56777</a> from <a href=https://github.com/huoyaoyuan target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@huoyaoyuan</a>, reduced the overhead of these <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendFile</span><span class=pun>{</span><span class=typ>Async</span><span class=pun>}</span></code> operations by utilizing the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RandomAccess</span></code> class to create <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeFileHandle</span></code> instances directly rather than going through <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> to open the appropriate handles to the files to be sent. The net result is a nice reduction in overhead for these operations, beyond the improvements in usability.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET 6中还添加了其他新的重载（几乎所有的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span></code> 操作现在都有接受 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>{</span><span class=typ>ReadOnly</span><span class=pun>}</span><span class=typ>Memory</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的重载，并支持 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationToken</span></code> ）。@gfoidl的dotnet/runtime#47230添加了一个基于跨度的重载 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>SendFile</span></code> ，使得前置和后置缓冲区可以指定为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> 而不是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> ，这使得只发送某个数组的一部分更便宜（对于现有过载的替代方案将是分配期望长度的新阵列并将相关数据复制到其中），然后来自@gfoidl的dotnet/runtime#52208添加了一个基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Memory</span></code> 的重载 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span><span class=pun>.</span><span class=typ>SendFileAsync</span></code> ，返回 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> （随后dotnet/runtime#53062提供了在之前PR中被删除的取消支持）。 最重要的是，dotnet/runtime#55232，然后是来自@huoyaoyuan的dotnet/runtime#56777，通过利用新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RandomAccess</span></code> 类直接创建 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeFileHandle</span></code> 实例，而不是通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileStream</span></code> 打开要发送的文件的适当句柄，减少了这些 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendFile</span><span class=pun>{</span><span class=typ>Async</span><span class=pun>}</span></code> 操作的开销。最终的结果是，除了可用性的改进之外，这些操作的开销也得到了很好的降低。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As long as we’re on the subject of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendFileAsync</span></code>, it’s somewhat interesting to look at <a href=https://github.com/dotnet/runtime/pull/55263 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55263</a>. This is a tiny PR that reduced the size of some allocations in the networking stack, including one in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendFileAsync</span></code> (or, rather, in the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendPacketsAsync</span></code> that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendFileAsync</span></code> wraps). The internal <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketPal</span><span class=pun>.</span><span class=typ>SendPacketsAsync</span></code> on Unix is implemented as an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>Task</span></code> method, which means that all “locals” in the method that need to survive across <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code>s are lifted by the compiler to live as fields on the generated state machine type for that async method, and that state machine will end up being allocated to live on the heap if the async method needs to complete asynchronously. The fewer and smaller fields we can have on these state machines, the smaller the resulting allocation will be for asynchronously completing async methods. But locals written by the developer aren’t the only reason for fields being added. Let’s take a look at an example:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>只要我们讨论 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendFileAsync</span></code> ，看看dotnet/runtime#55263就有点有趣了。这是一个很小的PR，它减少了网络堆栈中一些分配的大小，包括 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendFileAsync</span></code> 中的一个（或者，更确切地说，是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendFileAsync</span></code> 包装的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendPacketsAsync</span></code> 中的一个）。Unix上的内部 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketPal</span><span class=pun>.</span><span class=typ>SendPacketsAsync</span></code> 被实现为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span><span class=pln> </span><span class=typ>Task</span></code> 方法，这意味着所有需要在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> 中生存的“局部变量”都被编译器提升为该异步方法生成的状态机类型上的字段，如果异步方法需要异步完成，该状态机将最终被分配到堆上。我们在这些状态机上可以拥有的字段越少越小，异步完成异步方法的分配就越小。但是开发人员编写的本地字符并不是添加字段的唯一原因。我们来看一个例子：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> C
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Example1</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> someParameter</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Process</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>someParameter</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FromResult</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>42</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Example2</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> someParameter</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FromResult</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>42</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Process</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>someParameter</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Process</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Just focusing on fields, the C# compiler will produce for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Example1</span></code> a type like this:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>StructLayout</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>LayoutKind</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Auto</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>CompilerGenerated</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>struct</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Example1</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln>d__0 </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IAsyncStateMachine</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AsyncTaskMethodBuilder</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&gt;</span></span><span class=pln><span class=pln>t__builder</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&gt;</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>__state</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> someParameter</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TaskAwaiter</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&gt;</span></span><span class=pln><span class=pln>u__1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&gt;</span></span><span class=lit><span class=lit>7</span></span><span class=pln><span class=pln>__wrap1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>....</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s examine a few of these fields:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>让我们检查其中的几个字段： </font></font></font></p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;t__builder</span></code> here is the “builder” we discussed earlier when talking about pooling in async methods.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;t__builder</span></code> 这里是我们前面讨论异步方法池化时讨论的“builder”。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;1__state</span></code> is the “state” of the state machine. The compiler rewrites an async method to have a jump table at the beginning, where the current state dictates to where in the method it jumps. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code>s are assigned a state based on their position in the source code, and the code for awaiting something that’s not yet completed involves updating <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;1__state</span></code> to refer to the await that should be jumped to when the continuation is invoked to re-enter the async method after the awaited task has completed.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;1__state</span></code> 是状态机的状态。编译器重写异步方法，使其在开头有一个跳转表，其中当前状态指示它跳转到方法中的哪个位置。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> 根据它们在源代码中的位置被分配一个状态，等待尚未完成的事情的代码涉及更新 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;1__state</span></code> ，以引用在等待的任务完成后调用continuation以重新进入async方法时应该跳转到的await。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>someParameter</span></code> is the argument to the method. It needs to be on the state machine to feed it into the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MoveNext</span></code> method generated by the compiler, but it would also need to be on the state machine if code after an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> wanted to read its value.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>someParameter</span></code> 是方法的参数。它需要在状态机上将其馈送到编译器生成的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MoveNext</span></code> 方法中，但是如果 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> 之后的代码想要读取其值，它也需要在状态机上。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;u__1</span></code> stores the awaiter for the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> on the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=str>&lt;int&gt;</span></code> returned by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>(</span><span class=lit>42</span><span class=pun>)</span></code>. The code generated for the await involves calling <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetAwaiter</span><span class=pun>()</span></code> on the awaited thing, checking its <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsCompleted</span></code> property, and if that’s false, storing the awaiter into this field so that it can be read and its <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetResult</span><span class=pun>()</span></code> method called upon completion of the task.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;u__1</span></code> 在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>(</span><span class=lit>42</span><span class=pun>)</span></code> 返回的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=str>&lt;int&gt;</span></code> 上存储 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> 的等待者。为await生成的代码包括调用等待的东西的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetAwaiter</span><span class=pun>()</span></code> ，检查它的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IsCompleted</span></code> 属性，如果是假的，将awaiter存储到这个字段中，以便它可以被读取，并在任务完成时调用它的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetResult</span><span class=pun>()</span></code> 方法。</font></font></font></li>
</ul>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>But… what is this <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;7__wrap1</span></code> thing? The answer has to do with order of operations. Let’s look at the code generated for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Example2</span></code>:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;7__wrap1</span></code> 是什么？答案与操作顺序有关。让我们看看 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Example2</span></code> 生成的代码：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>struct</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Example2</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln>d__1 </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IAsyncStateMachine</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&gt;</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>__state</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AsyncTaskMethodBuilder</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&gt;</span></span><span class=pln><span class=pln>t__builder</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> someParameter</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TaskAwaiter</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&gt;</span></span><span class=pln><span class=pln>u__1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This code has the exact same fields as the state machine for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Example1</span></code>, except it’s missing the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;7__wrap1</span></code> field. The reason is the compiler is required to respect the order of operations in an expression like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Process</span><span class=pun>(</span><span class=pln>someParameter</span><span class=pun>)</span><span class=pln> </span><span class=pun>+</span><span class=pln> </span><span class=kwd>await</span><span class=pln> </span><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>(</span><span class=lit>42</span><span class=pun>)</span></code>. That means it must compute <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Process</span><span class=pun>(</span><span class=pln>someParameter</span><span class=pun>)</span></code> before it computes <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span><span class=pln> </span><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>(</span><span class=lit>42</span><span class=pun>)</span></code>. But <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Process</span><span class=pun>(</span><span class=pln>someParameter</span><span class=pun>)</span></code> returns an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> value; where should that be stored while <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span><span class=pln> </span><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>(</span><span class=lit>42</span><span class=pun>)</span></code> is being processed? On the state machine. That “spilled” field is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>&lt;&gt;7__wrap1</span></code>. This also explains why the field isn’t there in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Example2</span></code>: the order of operations was explicitly reversed by the developer to be <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span><span class=pln> </span><span class=typ>Task</span><span class=pun>.</span><span class=typ>FromResult</span><span class=pun>(</span><span class=lit>42</span><span class=pun>)</span><span class=pln> </span><span class=pun>+</span><span class=pln> </span><span class=typ>Process</span><span class=pun>(</span><span class=pln>someParameter</span><span class=pun>)</span></code>, so we don’t have to stash the result of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Process</span><span class=pun>(</span><span class=pln>someParameter</span><span class=pun>)</span></code> anywhere, as it’s no longer crossing an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> boundary. So, back to the cited PR. The original line of code in question was <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>bytesTransferred </span><span class=pun>+=</span><span class=pln> </span><span class=kwd>await</span><span class=pln> socket</span><span class=pun>.</span><span class=typ>SendAsync</span><span class=pun>(...)</span></code>, which is the same as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>bytesTransferred </span><span class=pun>=</span><span class=pln> bytesTransferred </span><span class=pun>+</span><span class=pln> </span><span class=kwd>await</span><span class=pln> socket</span><span class=pun>.</span><span class=typ>SendAsync</span><span class=pun>(...)</span></code>. Look familiar? Technically the compiler needs to stash away the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>bytesTransferred</span></code> value in order to preserve the order of operations with regards to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendAsync</span></code> operation, and so the PR just explicitly reverses this to be <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>bytesTransferred </span><span class=pun>=</span><span class=pln> </span><span class=kwd>await</span><span class=pln> socket</span><span class=pun>.</span><span class=typ>SendAsync</span><span class=pun>(...)</span><span class=pln> </span><span class=pun>+</span><span class=pln> bytesTransferred</span></code> in order to make the state machine a little smaller. You can see more examples of this in <a href=https://github.com/dotnet/runtime/pull/55190 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55190</a> for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BufferedStream</span></code>. In practice, the compiler should be able to special-case this constrained version of the issue, as it should be able to see that no other code would have access to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>bytesTransferred</span></code> to modify it, and thus the defensive copy shouldn’t be necessary… maybe <a href=https://github.com/dotnet/roslyn/issues/54629 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>some day</a>.<font data-immersive-translate-effect=1 data-immersive-translate-error-id=1105 class="notranslate immersive-translate-target-wrapper immersive-translate-target-wrapper-error" translate=no lang=zh-CN><a><font class="immersive-translate-error notranslate"><font class=immersive-translate-error-wrapper><font data-immersive-translate-action=retry title=重试全部错误段落 data-immersive-translate-paragraph-id=1105 class="immersive-translate-clickable-button notranslate"><img draggable=false role=img class=emoji alt=🔄 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iIzNCODhDMyIgZD0iTTM2IDMyYzAgMi4yMDktMS43OTEgNC00IDRINGMtMi4yMDkgMC00LTEuNzkxLTQtNFY0YzAtMi4yMDkgMS43OTEtNCA0LTRoMjhjMi4yMDkgMCA0IDEuNzkxIDQgNHYyOHoiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMjIuMjQyIDIyLjI0MmwyLjgyOSAyLjgyOWMtMy45MDUgMy45MDUtMTAuMjM3IDMuOTA0LTE0LjE0My0uMDAxLTIuMjQ3LTIuMjQ2LTMuMTk0LTUuMjk2LTIuODU0LTguMjI1bC00LjAzNy4zNjdjLS4yMTUgMy44NCAxLjEyOCA3Ljc1MiA0LjA2MiAxMC42ODcgNS40NjcgNS40NjcgMTQuMzMzIDUuNDY4IDE5Ljc5OSAwbDIuODI4IDIuODI4Ljg0OS05LjMzNC05LjMzMy44NDl6TTI3Ljg5OSA4LjFDMjIuNDMxIDIuNjMzIDEzLjU2OCAyLjYzMyA4LjEgOC4xTDUuMjcyIDUuMjcybC0uODQ5IDkuMzM0IDkuMzM0LS44NDktMi44MjktMi44MjljMy45MDYtMy45MDUgMTAuMjM2LTMuOTA1IDE0LjE0MiAwIDIuMjQ4IDIuMjQ3IDMuMTk0IDUuMjk3IDIuODU2IDguMjI2bDQuMDM2LS4zNjZjLjIxNi0zLjg0MS0xLjEyOC03Ljc1My00LjA2My0xMC42ODh6Ii8+PC9zdmc+></font>&nbsp;&nbsp;<font data-immersive-translate-action=toast-error data-immersive-translate-tooltip-text="Server is busy now, (10000), please retry later" title=点击查看错误原因 class="immersive-translate-help-button notranslate"><img draggable=false role=img class=emoji alt=❓ src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0JFMTkzMSIgZD0iTTE3IDI3Yy0xLjY1NyAwLTMtMS4zNDMtMy0zdi00YzAtMS42NTcgMS4zNDMtMyAzLTMgLjYwMy0uMDA2IDYtMSA2LTUgMC0yLTItNC01LTQtMi40NDEgMC00IDItNCAzIDAgMS42NTctMS4zNDMgMy0zIDNzLTMtMS4zNDMtMy0zYzAtNC44NzggNC41OC05IDEwLTkgOCAwIDExIDUuOTgyIDExIDExIDAgNC4xNDUtMi4yNzcgNy4zMTMtNi40MTMgOC45Mi0uOS4zNTEtMS43OS41ODctMi41ODcuNzQ3VjI0YzAgMS42NTctMS4zNDMgMy0zIDN6Ii8+PGNpcmNsZSBmaWxsPSIjQkUxOTMxIiBjeD0iMTciIGN5PSIzMiIgcj0iMyIvPjwvc3ZnPg=="></font></font></font></a></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s move up the stack a little: DNS. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Net</span><span class=pun>.</span><span class=typ>Dns</span></code> is a relatively thin wrapper for OS functionality. It provides both synchronous and asynchronous APIs. On Windows, the asynchronous APIs are implemented on top of Winsock’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetAddrInfoExW</span></code> function (if available), which provides a scalable overlapped I/O-based model for performing name resolution asynchronously. The story is more convoluted on Unix, where POSIX provides <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>getaddrinfo</span></code> but no asynchronous counterpart. Linux does have <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>getaddrinfo_a</span></code>, which does provide an asynchronous version, and in fact <a href=https://github.com/dotnet/runtime/pull/34633 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#34633</a> from <a href=https://github.com/gfoidl target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@gfoidl</a> did temporarily change <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dns</span></code>‘s async APIs to use it, but that PR was subsequently reverted in <a href=https://github.com/dotnet/runtime/pull/48666 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48666</a> upon realizing that the implementation was just queueing these calls to be executed synchronously on a limited size thread pool internal to glibc, and we could similarly employ an “async-over-sync” solution in managed code and with more control. Here <a href=https://devblogs.microsoft.com/pfxteam/should-i-expose-asynchronous-wrappers-for-synchronous-methods/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“async-over-sync”</a> is referring to the idea of implementing an asynchronous operation that’s just queueing a synchronous piece of work to be done on another thread, rather than having it employ truly asynchronous I/O all the way down to the hardware. This ends up blocking that other thread for the duration of the operation, which inherently limits scalability. It can also be a real bottleneck for something like DNS. Typically an operating system will cache some amount of DNS data, but in cases where a request is made for unavailable data, the OS has to reach out across the network to a DNS server to obtain it. If lots of requests are made concurrently for the same non-cached address, that can starve the pool with all of the operations performing the exact same request. To address this, <a href=https://github.com/dotnet/runtime/pull/49171 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49171</a> implements that async-over-sync in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dns</span></code> in a way that asynchronously serializes all requests for the same destination; that way, if bursts do show up, we only end up blocking one thread for all of them rather than one thread for each. This adds a small amount of overhead for individual operations, but significantly reduces the overhead in the bursty, problematic scenarios. In the future, we will hopefully be able to do away with this once we’re able to implement a true async I/O-based mechanism on Unix, potentially implemented directly on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span></code> in a managed DNS client, or potentially employing a library like <a href=https://c-ares.haxx.se/ target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>c-ares</a>.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another nice improvement in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dns</span></code> comes in the form of new overloads introduced in <a href=https://github.com/dotnet/runtime/pull/33420 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#33420</a> for specifying the desired <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AddressFamily</span></code>. By default, operations on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dns</span></code> can return both IPv4 and IPv6 addresses, but if you know you only care about one or the other, you can now be explicit about it. Doing so can save on both the amount of data transferred and the resulting allocations to hand back that data.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> _hostname </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Dns</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetHostName</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetHostAddresses</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Dns</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetHostAddressesAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_hostname</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>OperationsPerInvoke</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetHostAddresses_OneFamily</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Dns</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetHostAddressesAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_hostname</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetHostAddresses</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>210.1 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>808 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetHostAddresses_OneFamily</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>195.7 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>195.7美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.93</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>370 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B </font></font></font></td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Moving up the stack, we start getting into specifying URLs, which typically uses <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Uri</span></code>. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code> instances are created in many places, and being able to create them more quickly and with less GC impact is a boon for end-to-end performance of networking-related code. The internal <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span><span class=pun>.</span><span class=typ>ReCreateParts</span></code> method is the workhorse behind a lot of the public <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code> surface area, and is responsible for formatting into a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> whatever parts of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code> have been requested (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UriComponents</span><span class=pun>.</span><span class=typ>Path</span><span class=pln> </span><span class=pun>|</span><span class=pln> </span><span class=typ>UriComponents</span><span class=pun>.</span><span class=typ>Query</span><span class=pln> </span><span class=pun>|</span><span class=pln> </span><span class=typ>UriComponents</span><span class=pun>.</span><span class=typ>Fragment</span></code>) while also factoring in desired escaping (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UriFormat</span><span class=pun>.</span><span class=typ>Unescaped</span></code>). It also unfortunately had quite a knack for allocating <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>[]</span></code> arrays. <a href=https://github.com/dotnet/runtime/pull/34864 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#34864</a> fixed that, using stack-allocated space for most <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code>s (e.g. those whose length is &lt;= 256 characters) and falling back to using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=str>&lt;char&gt;</span><span class=pun>.</span><span class=typ>Shared</span></code> for longer lengths, while also cleaning up some code paths to make them a bit more streamlined. The impact of this is visible in these benchmarks:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>向上移动堆栈，我们开始指定URL，通常使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Uri</span></code> 。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code> 实例是在许多地方创建的，能够更快地创建它们，并且对GC的影响更小，这对于网络相关代码的端到端性能是一个布恩。内部 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span><span class=pun>.</span><span class=typ>ReCreateParts</span></code> 方法是许多公共 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code> 表面区域背后的主力，并且负责格式化为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> ，无论 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code> 中的任何部分被请求（例如： <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UriComponents</span><span class=pun>.</span><span class=typ>Path</span><span class=pln> </span><span class=pun>|</span><span class=pln> </span><span class=typ>UriComponents</span><span class=pun>.</span><span class=typ>Query</span><span class=pln> </span><span class=pun>|</span><span class=pln> </span><span class=typ>UriComponents</span><span class=pun>.</span><span class=typ>Fragment</span></code> ），同时还考虑期望的转义（例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UriFormat</span><span class=pun>.</span><span class=typ>Unescaped</span></code> ）。不幸的是，它在分配 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>[]</span></code> 数组方面也很有技巧。dotnet/runtime#34864修复了这个问题，为大多数 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code> 使用堆栈分配的空间（例如长度&lt;= 256个字符的代码），对于更长的代码长度，则退回到使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=str>&lt;char&gt;</span><span class=pun>.</span><span class=typ>Shared</span></code> ，同时也清理了一些代码路径，使它们更加精简。其影响在这些基准中可见：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Uri</span></span><span class=pln><span class=pln> _uri </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Uri</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"http://dot.net"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetComponents</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _uri</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetComponents</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>UriComponents</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PathAndQuery</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UriComponents</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Fragment</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UriFormat</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>UriEscaped</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Uri</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NewUri</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Uri</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"http://dot.net"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PathAndQuery</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _uri</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PathAndQuery</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetComponents</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>49.4856 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>49.4856纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>241 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetComponents</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>47.8179 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>47.8179纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.96</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>232 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetComponents</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>39.5046 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.80</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>232 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetComponents</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>31.0651 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.63</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>24 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NewUri<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>纽乌里 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>280.0722 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>168 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NewUri<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>纽乌里 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>144.3990 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>144.3990纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.52</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>72 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NewUri<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>纽乌里 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>100.0479 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>100.0479纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.36</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>56 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NewUri<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>纽乌里 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>92.1300 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.33</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>56 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>PathAndQuery</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>50.3840 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>241 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>PathAndQuery</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48.7625 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>48.7625纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.97</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>232 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>PathAndQuery</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.1615 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2.1615纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.04</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>PathAndQuery</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.7380 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.01</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course, not all URLs contain pure ASCII. Such cases often involve escaping these characters using percent-encoding, and <a href=https://github.com/dotnet/runtime/pull/32552 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#32552</a> optimized those code paths by changing a multi-pass scheme that involved both a temporary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> buffer and a temporary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>[]</span></code> buffer into a single-pass scheme that used stack-allocation with a fallback to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当然，并非所有URL都包含纯ASCII。这种情况通常涉及使用百分比编码来转义这些字符，dotnet/runtime#32552通过将涉及临时 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 缓冲区和临时 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>[]</span></code> 缓冲区的多遍方案更改为使用堆栈分配的单遍方案并回退至 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Shared</span></code> 来优化这些代码路径。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Unescape</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Uri</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>UnescapeDataString</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"%E4%BD%A0%E5%A5%BD"</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Unescape</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>284.03 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>284.03纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>385 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>小行星385 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Unescape</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>144.55 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>144.55纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.51</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>208 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Unescape</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>125.98 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>125.98纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.44</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>144 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>144个B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Unescape</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>69.85 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.25</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UriBuilder</span></code> is also used in some applications to compose <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Uri</span></code> instances. <a href=https://github.com/dotnet/runtime/pull/51826 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51826</a> reduced the size of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UriBuilder</span></code> itself by getting rid of some fields that weren’t strictly necessary, avoided some string concatenations and substring allocations, and utilized stack-allocation and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayPool</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> as part of its <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToString</span></code> implementation. As a result, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UriBuilder</span></code> is now also lighterweight for most uses:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BuilderToString</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> builder </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UriBuilder</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Scheme</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"https"</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Host</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"dotnet.microsoft.com"</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Port</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>443</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Path</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"/platform/try-dotnet"</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> builder</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>  </span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>BuilderToString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>604.5 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>810 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>BuilderToString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>446.7 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.74</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>432 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>BuilderToString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>225.7 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.38</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>432 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>BuilderToString</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>171.7 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.28</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>216 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As noted previously, I love seeing this continual march of progress, with every release the exact same API getting faster and faster, as more and more opportunities are discovered, new capabilities of the underlying platform utilized, code generation improving, and on. Exciting.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>如前所述，我喜欢看到这种持续的进步，随着越来越多的机会被发现，底层平台的新功能被利用，代码生成得到改进，每个版本的API都变得越来越快。令人兴奋. </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Now we get to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span></code>. There were a few areas in which <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span></code>, and specifically <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code>, was improved from a performance perspective (and many more from a functionality perspective, including preview support for HTTP/3, better standards adherence, distributed tracing integration, and more knobs for configuring how it should behave). One key area is around header management. Previous releases saw a lot of effort applied to driving down the overheads of the HTTP stack, but the public API for headers forced a particular set of work and allocations to be performed. Even within those constraints, we’ve driven down some costs, such as by no longer forcing headers added into the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span><span class=pun>.</span><span class=typ>DefaultRequestHeaders</span></code> collection to be parsed if the developer added them with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryAddWithoutValidation</span></code> (<a href=https://github.com/dotnet/runtime/pull/49673 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49673</a>), removing a lock that’s no longer necessary (<a href=https://github.com/dotnet/runtime/pull/54130 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54130</a>), and enabling a singleton empty enumerator to be returned when enumerating an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpHeaderValueCollection</span></code> (<a href=https://github.com/dotnet/runtime/pull/47010 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47010</a>).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>现在，我们到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span></code> 。从性能角度来看， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span></code> ，特别是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> ，有几个方面得到了改进（从功能角度来看，还有更多，包括对HTTP/3的预览支持，更好的标准遵守，分布式跟踪集成，以及更多用于配置其行为方式的旋钮）。一个关键领域是围绕报头管理。在以前的版本中，人们花了很多精力来降低HTTP堆栈的开销，但是头部的公共API强制执行一组特定的工作和分配。即使在这些限制下，我们也降低了一些成本，例如，如果开发人员使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryAddWithoutValidation</span></code> 添加头，则不再强制解析添加到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span><span class=pun>.</span><span class=typ>DefaultRequestHeaders</span></code> 集合中的头（dotnet/runtime#49673），删除不再需要的锁（dotnet/runtime#54130），以及在枚举 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpHeaderValueCollection</span></code> （dotnet/runtime#47010）时允许返回单例空枚举器。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerate</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> request </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpRequestMessage</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>HttpMethod</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Get</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> s_uri</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> resp </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> s_client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SendAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>request</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>default</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> header </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> resp</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Headers</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> contentHeader </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> resp</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Content</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Headers</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> resp</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Content</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CopyToAsync</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Null</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pln><span class=pln> s_listener </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tcp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpMessageInvoker</span></span><span class=pln><span class=pln> s_client </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpMessageInvoker</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpClientHandler</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UseProxy</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>UseCookies</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AllowAutoRedirect</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>});</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Uri</span></span><span class=pln><span class=pln> s_uri</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CreateSocketServer</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    s_listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Bind</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IPEndPoint</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IPAddress</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Loopback</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
    s_listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Listen</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>MaxValue</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> ep </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IPEndPoint</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>s_listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    s_uri </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Uri</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>$</span></span><span class=str><span class=str>"http://{ep.Address}:{ep.Port}/"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> response </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Encoding</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>UTF8</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetBytes</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"HTTP/1.1 200 OK\r\nDate: Tue, 01 Jul 2021 12:00:00 GMT \r\nServer: Example\r\nAccess-Control-Allow-Credentials: true\r\nAccess-Control-Allow-Origin: *\r\nConnection: keep-alive\r\nContent-Type: text/html; charset=utf-8\r\nContent-Length: 5\r\n\r\nHello"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> endSequence </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>)</span></span><span class=str><span class=str>'\r'</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>)</span></span><span class=str><span class=str>'\n'</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>)</span></span><span class=str><span class=str>'\r'</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>)</span></span><span class=str><span class=str>'\n'</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>

    </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
            </span></span><span class=typ><span class=typ>Socket</span></span><span class=pln><span class=pln> s </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> s_listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AcceptAsync</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
            _ </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> ns </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NetworkStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln>
                </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                    </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1024</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
                    </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> totalRead </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
                    </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
                    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                        </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> read </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> ns</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Read</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> totalRead</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln> totalRead</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
                        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>read </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>return</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
                        totalRead </span></span><span class=pun><span class=pun>+=</span></span><span class=pln><span class=pln> read</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
                        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>buffer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AsSpan</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> totalRead</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>IndexOf</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>endSequence</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                            </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>totalRead </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Resize</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>ref</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
                            </span></span><span class=kwd><span class=kwd>continue</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

                        ns</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Write</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>response</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> response</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

                        totalRead </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
                    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
                </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
            </span></span><span class=pun><span class=pun>});</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>});</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Enumerate<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>枚举 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>145.97 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>145.97美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>18 KB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>简体中文 </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Enumerate<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>枚举 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>85.51 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>85.51美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.56</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3 KB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>3 KB的 </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Enumerate<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>枚举 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>82.45 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>82.45美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.54</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3 KB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>3 KB的 </font></font></font></td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>But the biggest impact in this area comes from the addition of the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpHeaders</span><span class=pun>.</span><span class=typ>NonValidated</span></code> property (<a href=https://github.com/dotnet/runtime/pull/53555 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53555</a>), which returns a view over the headers collection that does not force parsing or validation when reading/enumerating. This has both a functional and a performance benefit. Functionally, it means headers sent by a server can be inspected in their original form, for consumers that really want to see the data prior to it having been sanitized/transformed by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span></code>. But from a performance perspective, it has a significant impact, as it means that a) the validation logic we’d normally run on headers can be omitted entirely, and b) any allocations that would result from that validation are also avoided. Now if we run <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerate</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EnumerateNew</span></code> on .NET 6, we can see the improvement that results from using the new API:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>但在这方面最大的影响来自新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpHeaders</span><span class=pun>.</span><span class=typ>NonValidated</span></code> 属性（dotnet/runtime#53555）的添加，它返回一个对heads集合的视图，在阅读/枚举时不会强制解析或验证。这具有功能和性能两方面的益处。从功能上讲，这意味着服务器发送的头可以以其原始形式进行检查，对于真正希望在数据被 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span></code> 清理/转换之前查看数据的消费者来说。但从性能的角度来看，它具有显著的影响，因为这意味着a）我们通常在头文件上运行的验证逻辑可以完全省略，b）也避免了任何由该验证产生的分配。现在，如果我们在.NET 6上运行 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerate</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EnumerateNew</span></code> ，我们可以看到使用新API带来的改进：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=com><span class=com>// Added to the previous benchmark</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EnumerateNew</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> request </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpRequestMessage</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>HttpMethod</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Get</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> s_uri</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> resp </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> s_client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SendAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>request</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>default</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> header </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> resp</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Headers</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NonValidated</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> contentHeader </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> resp</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Content</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Headers</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NonValidated</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> resp</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Content</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CopyToAsync</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Null</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Enumerate</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>82.70 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3 KB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>EnumerateNew</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>67.36 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.81</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2 KB</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>So, even with all the I/O and HTTP protocol logic being performed, tweaking the API used for header enumeration here results in an ~20% boost in throughput.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another area that saw significant improvement was in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code>‘s connection pooling. One change here comes in <a href=https://github.com/dotnet/runtime/pull/50545 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50545</a>, which simplifies the code and helps on all platforms, but in particular improves a long-standing potential performance issue on Windows (our Unix implementation generally didn’t suffer the same problem, because of differences in how asynchronous I/O is implemented). <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> maintains a pool of connections that remain open to the server and that it can use to service future requests. By default, it needs to scavenge this pool periodically, to close connections that have been around for too long or that, more relevant to this discussion, the server has chosen to close. To determine whether the server has closed a connection, we need to poll the underlying socket, but in some situations, we don’t actually have access to the underlying socket in order to perform the poll (and, with the advent of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConnectCallback</span></code> in .NET 5 that enables an arbitrary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> to be provided for use with a connection, there may not even be a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span></code> involved at all). In such situations, the only way we can be notified of a connection being closed is to perform a read on the connection. Thus, if we were unable to poll the socket directly, we would issue an asynchronous read (which would then be used as the first read as part of handling the next request on that connection), and the scavenging logic could check the task for that read to see whether it had completed erroneously. Now comes the problem. On Windows, overlapped I/O read operations often involve pinning a buffer for the duration of the operation (on Unix, we implement asynchronous reads via epoll, and no buffer need be pinned for the duration); that meant if we ended up with a lot of connections in the pool, and we had to issue asynchronous reads for each, we’d likely end up pinning a whole bunch of sizeable buffers, leading to memory fragmentation and potentially sizeable working set growth. The fix is to use zero-byte reads. Rather than issuing the actual read using the connection’s buffer, we instead issue a read using an empty buffer. All of the streams <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> uses by default (namely <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NetworkStream</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code>) support the notion of zero-byte reads, where rather than returning immediately, they instead wait to complete the asynchronous read until at least some data is available, even though they won’t be returning any of that data as part of the operation. Then, only once that operation has completed, the actual initial read is issued, which is both necessary to actually get the first batch of response data, but also to handle arbitrary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code>s that may return immediately from a zero-byte read without actually waiting. Interestingly, though, just supporting zero-byte reads can sometimes be the “min bar”. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> has long supported zero-byte reads on it, but it did so by in turn issuing a read on the stream it wraps using its internal read buffer. That means <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> was potentially itself holding onto a valuable buffer, and (on Windows) pinning it, even though that was unnecessary. <a href=https://github.com/dotnet/runtime/pull/49123 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49123</a> addresses that by special-casing zero-byte reads to not use a buffer and to not force an internal buffer into existence if one isn’t currently available (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> returns buffers back to a pool when it’s not currently using them).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>另一个显著改进的领域是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> 的连接池。这里的一个变化是dotnet/runtime#50545，它简化了代码并在所有平台上提供帮助，但特别是改善了Windows上一个长期存在的潜在性能问题（我们的Unix实现通常不会遇到同样的问题，因为异步I/O的实现方式不同）。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> 维护一个对服务器开放的连接池，它可以用来服务未来的请求。默认情况下，它需要定期清理这个池，以关闭已经存在太久的连接，或者服务器选择关闭的连接（与本文讨论更相关）。为了确定服务器是否关闭了连接，我们需要轮询底层套接字，但在某些情况下，我们实际上无法访问底层套接字来执行轮询（并且，随着中的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConnectCallback</span></code> 的出现。NET 5允许提供任意 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 以供与连接一起使用，则可能甚至根本不涉及 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Socket</span></code> ）。在这种情况下，通知我们连接关闭的唯一方法是对连接执行读取。因此，如果我们无法直接轮询套接字，我们将发出异步读取（然后将其用作第一次读取，作为处理该连接上的下一个请求的一部分），并且清理逻辑可以检查该读取的任务，以查看它是否错误地完成。现在问题来了。 在Windows上，重叠的I/O读操作通常涉及在操作期间固定一个缓冲区（在Unix上，我们通过epoll实现异步读，在此期间不需要固定缓冲区）;这意味着，如果我们最终在池中有很多连接，并且我们不得不为每个连接发出异步读取，我们很可能最终会固定一大堆相当大的缓冲区，导致内存碎片和潜在的相当大的工作集增长。修复方法是使用零字节读取。我们不使用连接缓冲区发出实际的读取，而是使用空缓冲区发出读取。默认情况下， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> 使用的所有流（即 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NetworkStream</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> ）都支持零字节读取的概念，其中不是立即返回，而是等待完成异步读取，直到至少有一些数据可用，即使它们不会返回任何数据作为操作的一部分。 然后，只有当该操作完成时，才发出实际的初始读取，这对于实际获得第一批响应数据是必要的，而且对于处理可能从零字节读取中立即返回而无需实际等待的任意 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 都是必要的。有趣的是，仅仅支持零字节读取有时就可能是“min bar”。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> 长期以来一直支持零字节读取，但它是通过使用其内部读取缓冲区对它包装的流发出读取来实现的。这意味着 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> 本身可能持有一个有价值的缓冲区，并且（在Windows上）固定它，即使这是不必要的。dotnet/runtime#49123通过特殊的零字节读取来解决这个问题，即不使用缓冲区，并且如果当前没有可用的内部缓冲区，也不强制存在（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> 在当前没有使用缓冲区时将缓冲区返回到池）。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> has seen multiple other performance-related PRs come through for .NET 6. Previously, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> would hand back to a caller of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Read</span><span class=pun>{</span><span class=typ>Async</span><span class=pun>}</span></code> the data from at most one TLS frame. As of <a href=https://github.com/dotnet/runtime/pull/50815 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50815</a>, it can now hand back data from multiple TLS frames should those frames be available and a large enough buffer be provided to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Read</span><span class=pun>{</span><span class=typ>Async</span><span class=pun>}</span></code>. This can help reduce the chattiness of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadAsync</span></code> calls, making better use of buffer space to reduce frequency of calls. <a href=https://github.com/dotnet/runtime/pull/51320 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51320</a> from <a href=https://github.com/benaadams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@benaadams</a> helped avoid some unnecessary buffer growth after he noticed some constants related to TLS frame sizes that had been in the code for a long time were no longer sufficient for newer TLS protocols, and <a href=https://github.com/dotnet/runtime/pull/51324 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51324</a> also from <a href=https://github.com/benaadams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@benaadams</a> helped avoid some casting overheads by being more explicit about the actual types being passed through the system.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> 已经看到了多个其他性能相关的PR为.NET 6通过。以前， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SslStream</span></code> 会把最多一个TLS帧的数据交还给 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Read</span><span class=pun>{</span><span class=typ>Async</span><span class=pun>}</span></code> 的调用者。从dotnet/runtime#50815开始，它现在可以从多个TLS帧返回数据，如果这些帧可用，并且为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Read</span><span class=pun>{</span><span class=typ>Async</span><span class=pun>}</span></code> 提供足够大的缓冲区。这可以帮助减少 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadAsync</span></code> 调用的喋喋不休，更好地利用缓冲区空间来降低调用频率。来自@benaadams的dotnet/runtime#51320帮助避免了一些不必要的缓冲区增长，因为他注意到一些与TLS帧大小相关的常数已经在代码中很长一段时间，不再足够用于新的TLS协议，而来自@benaadams的dotnet/runtime#51324帮助避免了一些转换开销，因为它更明确地说明了通过系统传递的实际类型。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/53851 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53851</a> provides another very interesting improvement related to connection pooling. Let’s say all of the connections for a given server are currently busy handling requests, and another request comes along. Unless you’ve configured a maximum limit on the number of connections per server and hit that limit, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> will happily create a new connection to service your request (in the case of HTTP/2, by default per the HTTP/2 specification there’s only one connection and a limit set by the server to the number of requests/streams multiplexed onto that connection, but <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> allows you to opt-in to using more than one connection). The question then is, what happens to that request if, while waiting for the new connection to be established, one of the existing connections becomes available? Up until now, that request would just wait for and use the new connection. With the aforementioned PR, the request can now use whatever connection becomes available first, whether it be an existing one or a new one, and whatever connection isn’t used will simply find its way back to the pool. This should both improve latency and response time, and potentially reduce the number of connections needed in the pool, thus saving memory and networking resources.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#53851提供了另一个与连接池相关的非常有趣的改进。假设一个给定服务器的所有连接当前都在忙碌着处理请求，然后另一个请求沿着。除非您已经对每台服务器的连接数设置了最大限制，并且达到了这个限制，否则 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> 将很高兴地创建一个新的连接来服务您的请求（在HTTP/2的情况下，默认情况下，HTTP/2规范只有一个连接，并且服务器对复用到该连接上的请求/流的数量设置了限制，但 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> 允许您选择使用多个连接）。那么问题是，如果在等待新连接建立的同时，现有连接中的一个变为可用，那么该请求会发生什么？到目前为止，请求只会等待并使用新连接。 使用上述PR，请求现在可以使用任何首先可用的连接，无论是现有的连接还是新的连接，并且任何未被使用的连接都将简单地找到返回池的方式。这既可以改善延迟和响应时间，也可以减少池中所需的连接数量，从而节省内存和网络资源。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.0 introduced support for HTTP/2, and since then the use of the protocol has been growing. This has led us to discover where things worked well and where more work was needed. One area in particular that needed some love was around <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code>‘s HTTP/2 download performance. Investigations showed slowdowns here were due to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> using a fixed-size receive window (64KB), such that if the receive buffer wasn’t large enough to keep the network busy, the system could stall. To address that, the receive buffer needs to be large enough to handle the “bandwidth-delay product” (a network connection’s capacity multiplied by round-trip communication time). <a href=https://github.com/dotnet/runtime/pull/54755 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54755</a> adds support for dynamically-sizing the receive window, as well as several knobs for tweaking the behavior. This should significantly help with performance in particular on networks with reasonably-high bandwidth along with some meaningful delay in communications (e.g. with geographically distributed data centers), while also not consuming too much memory.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET Core 3.0引入了对HTTP/2的支持，从那时起，该协议的使用一直在增长。这使我们发现了哪些地方运作良好，哪些地方需要做更多的工作。特别需要关注的一个领域是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> 的HTTP/2下载性能。调查显示，这里的速度变慢是由于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> 使用了固定大小的接收窗口（64 KB），因此如果接收缓冲区不够大，无法保持网络忙碌，系统可能会停止。为了解决这个问题，接收缓冲器需要足够大以处理“带宽延迟乘积”（网络连接的容量乘以往返通信时间）。dotnet/runtime#54755增加了对接收窗口动态调整大小的支持，以及一些用于调整行为的旋钮。这应该显著地有助于性能，特别是在具有合理高带宽沿着通信中的一些有意义延迟的网络上（例如， 地理上分布的数据中心），同时也不消耗太多的存储器。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There’s also been a steady stream of small improvements to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span></code>, things that on their own don’t account for much but when added together help to move the needle. For example, <a href=https://github.com/dotnet/runtime/pull/54209 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54209</a> from <a href=https://github.com/teo-tsirpanis target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@teo-tsirpanis</a> converted a small class to a struct, saving an allocation per connection; <a href=https://github.com/dotnet/runtime/pull/50487 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50487</a> removed a closure allocation from the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> connection pool, simply by changing the scope in which a variable was declared so that it wasn’t in scope of a hotter path; <a href=https://github.com/dotnet/runtime/pull/44750 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44750</a> removed a string allocation from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MediaTypeHeaderValue</span></code> in the common case where it has a media type but no additional parameters; and <a href=https://github.com/dotnet/runtime/pull/45303 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45303</a> optimized the loading of the Huffman static encoding table used by HTTP/2. The original code employed a single, long array of tuples, which required the C# compiler to generate a very large function for initializing each element of the array; the PR changed that to instead be two blittable <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>uint</span><span class=pun>[]</span></code> arrays that are cheaply stored in the binary.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>对于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HttpClient</span></code> 也有一系列的小改进，这些改进本身并不占太多，但当加在一起时，有助于推动指针的发展。例如，来自@teo-tsirpanis的dotnet/runtime#54209将一个小类转换为一个结构体，节省了每个连接的分配; dotnet/runtime#50487从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> 连接池中删除了闭包分配，简单地通过改变声明变量的作用域，使其不在更热的路径的作用域中; dotnet/runtime#44750从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MediaTypeHeaderValue</span></code> 中删除了一个字符串分配，在这种情况下，它有媒体类型但没有附加参数; dotnet/runtime#45303优化了HTTP/2使用的霍夫曼静态编码表的加载。原始代码使用了一个单一的、长的元组数组，这需要C#编译器生成一个非常大的函数来初始化数组的每个元素; PR将其改为两个可blittable <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>uint</span><span class=pun>[]</span></code> 数组，它们被廉价地存储在二进制中。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Finally, let’s look at <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebSockets</span></code>. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebSocket</span><span class=pun>.</span><span class=typ>CreateFromStream</span></code> was introduced in .NET Core 2.1 and layers a managed implementation of the <a href=https://datatracker.ietf.org/doc/html/rfc6455 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>websocket protocol</a> on top of an arbitrary bidirectional <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code>; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ClientWebSocket</span></code> uses it with a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> created by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SocketsHttpHandler</span></code> to enable client websockets, and Kestrel uses it to enable server websockets. Thus, any improvements we make to that managed implementation (the internal <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ManagedWebSocket</span></code>) benefit both client and server. There have been a handful of small improvements in this area, such as with <a href=https://github.com/dotnet/runtime/pull/49831 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49831</a> that saved a few hundred bytes in allocation as part of the websocket handshake by using span-based APIs to create the data for the headers used in the websocket protocol, and <a href=https://github.com/dotnet/runtime/pull/52022 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52022</a> from <a href=https://github.com/zlatanov target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@zlatanov</a> that saved a few hundred bytes from each <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ManagedWebSocket</span></code> by avoiding a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CancellationTokenSource</span></code> that was overkill for the target scenario. But there were two significant changes worth examining in more detail.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The first is websocket compression. The implementation for this came in <a href=https://github.com/dotnet/runtime/pull/49304 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49304</a> from <a href=https://github.com/zlatanov target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@zlatanov</a>, providing a long-requested feature of <a href=https://datatracker.ietf.org/doc/html/rfc7692 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>per-message compression</a>. Adding compression increases the CPU cost of sending and receiving, but it decreases the amount of data sent and received, which can in turn decrease the overall cost of communication, especially as networking latency increases. As such, the benefit of this one is harder to measure with BenchmarkDotNet, and I’ll instead just use a console app:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Diagnostics</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Net</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Net</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sockets</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Net</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WebSockets</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=typ><span class=typ>ReadOnlyMemory</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> dataToSend</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> hc </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpClient</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    dataToSend </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> hc</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetByteArrayAsync</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"https://www.gutenberg.org/cache/epub/3200/pg3200.txt"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Memory</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> receiveBuffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>dataToSend</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> compressed </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>})</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> listener </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tcp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Bind</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IPEndPoint</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IPAddress</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Loopback</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
    listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Listen</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> client </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AddressFamily</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InterNetwork</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SocketType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ProtocolType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tcp</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Connect</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LocalEndPoint</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Socket</span></span><span class=pln><span class=pln> server </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Accept</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> clientStream </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PassthroughTrackingStream</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NetworkStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>client</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> ownsSocket</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> clientWS </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocket</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateFromStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>clientStream</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocketCreationOptions</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsServer</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DangerousDeflateOptions</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> compressed </span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocketDeflateOptions</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>});</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> serverWS </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocket</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateFromStream</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NetworkStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>server</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> ownsSocket</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocketCreationOptions</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsServer</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DangerousDeflateOptions</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> compressed </span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocketDeflateOptions</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>});</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> sw </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Stopwatch</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> trial </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> trial </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> trial</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> before </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> clientStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BytesRead</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
        sw</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Restart</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> serverWS</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SendAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>dataToSend</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocketMessageType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Binary</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>default</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(!(</span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> clientWS</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReceiveAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>receiveBuffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>default</span></span><span class=pun><span class=pun>)).</span></span><span class=typ><span class=typ>EndOfMessage</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

        sw</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stop</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Console</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteLine</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>$</span></span><span class=str><span class=str>"Compressed: {compressed,5} Bytes: {clientStream.BytesRead - before,10:N0} Time: {sw.ElapsedMilliseconds:N0}ms"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>sealed</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PassthroughTrackingStream</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Stream</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Stream</span></span><span class=pln><span class=pln> _stream</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BytesRead</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PassthroughTrackingStream</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Stream</span></span><span class=pln><span class=pln> stream</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _stream </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> stream</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CanWrite</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CanRead</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ReadAsync</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Memory</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pln><span class=pln> cancellationToken</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> n </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> _stream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReadAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> cancellationToken</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>BytesRead</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+=</span></span><span class=pln><span class=pln> n</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> n</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ValueTask</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WriteAsync</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>ReadOnlyMemory</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pln><span class=pln> cancellationToken</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
        _stream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> cancellationToken</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>protected</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> disposing</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _stream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CanSeek</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Length</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NotSupportedException</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Position</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NotSupportedException</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NotSupportedException</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Flush</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Read</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> offset</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> count</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NotSupportedException</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Seek</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> offset</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SeekOrigin</span></span><span class=pln><span class=pln> origin</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NotSupportedException</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SetLength</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NotSupportedException</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Write</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> offset</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> count</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>throw</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NotSupportedException</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This app is creating a loopback socket connection and then layering on top of that a websocket connection created using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebSocket</span><span class=pun>.</span><span class=typ>CreateFromStream</span></code>. But rather than just wrapping the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NetworkStream</span></code>s directly, the “client” end of the stream that’s receiving data sent by the “server” is wrapping the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NetworkStream</span></code> in an intermediary stream that’s tracking the number of bytes read, which it then exposes for the console app to print. That way, we can see how much data ends up actually being sent. The app is downloading the complete works of Mark Twain from Project Gutenberg, such that each sent message is ~15MB. When I run this, I get results like the following:</p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>False</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>013</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>945</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>42ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>False</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>013</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>945</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>13ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>False</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>013</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>945</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>13ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>False</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>013</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>945</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>12ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>False</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>013</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>945</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>12ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=kwd><span class=kwd>True</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>326</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>310</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>580ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=kwd><span class=kwd>True</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>325</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>285</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>571ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=kwd><span class=kwd>True</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>325</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>246</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>569ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=kwd><span class=kwd>True</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>325</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>229</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>571ms</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Compressed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=kwd><span class=kwd>True</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Bytes</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>  </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>325</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>168</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>571ms</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>So, we can see that on this very fast loopback connection, the cost of the operation is dominated by the compression; however, we’re sending only a third as much data. That could be a good tradeoff if communicating over a real network with longer latencies, where the additional few hundred milliseconds to perform the compression and decompression is minimal compared to the cost of sending and receiving an additional 10MB.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>所以，我们可以看到，在这个非常快的环回连接上，操作的成本是由压缩决定的;然而，我们只发送了三分之一的数据。如果在具有较长延迟的真实的网络上进行通信，那么这可能是一个很好的权衡，其中执行压缩和解压缩的额外几百毫秒与发送和接收额外的10 MB的成本相比是最小的。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The second is amortized zero-allocation websocket receiving. In .NET Core 2.1, overloads were added to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebSocket</span></code> for the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendAsync</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveAsync</span></code> methods. These overloads accepted <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlyMemory</span><span class=str>&lt;byte&gt;</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Memory</span><span class=str>&lt;byte&gt;</span></code>, respectively, and returned <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=str>&lt;int&gt;</span></code>, respectively. That <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=str>&lt;int&gt;</span></code> in particular was important because it enabled <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveAsync</span></code> to perform in an allocation-free manner when the operation completed synchronously, which would happen if the data being received was already available. When the operation completed asynchronously, however, it would still allocate a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=str>&lt;int&gt;</span></code> to back the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=str>&lt;int&gt;</span></code>, and even with the advent of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span><span class=str>&lt;int&gt;</span></code>, that still remained, given the complexity of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveAsync</span></code> method and how difficult it would be to manually implement the function by hand without the assistance of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code>. However, as previously discussed, C# 10 and .NET 6 now have opt-in support for pooling with async methods. <a href=https://github.com/dotnet/runtime/pull/56282 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56282</a> included adding <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>AsyncMethodBuilder</span><span class=pun>(</span><span class=kwd>typeof</span><span class=pun>(</span><span class=typ>PoolingAsyncValueTaskMethodBuilder</span><span class=pun>))]</span></code> to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveAsync</span></code>. On my 12-logical-core machine, this code:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>二是摊余零分配WebSocket接收。在.NET Core 2.1中，为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SendAsync</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveAsync</span></code> 方法向 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebSocket</span></code> 添加了重载。这些重载分别接受 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlyMemory</span><span class=str>&lt;byte&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Memory</span><span class=str>&lt;byte&gt;</span></code> ，并分别返回 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=str>&lt;int&gt;</span></code> 。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=str>&lt;int&gt;</span></code> 特别重要，因为它使 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveAsync</span></code> 能够在操作同步完成时以无分配的方式执行，如果正在接收的数据已经可用，则会发生这种情况。然而，当操作异步完成时，它仍然会分配 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=str>&lt;int&gt;</span></code> 来支持 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span><span class=str>&lt;int&gt;</span></code> ，并且即使随着 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span><span class=str>&lt;int&gt;</span></code> 的出现，考虑到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveAsync</span></code> 方法的复杂性以及在没有 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>async</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>await</span></code> 的帮助的情况下手动实现该功能是多么困难， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IValueTaskSource</span><span class=str>&lt;int&gt;</span></code> 仍然存在。然而，如前所述，C# 10和.NET 6现在已经选择加入支持使用异步方法池。dotnet/runtime#56282包括将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>AsyncMethodBuilder</span><span class=pun>(</span><span class=kwd>typeof</span><span class=pun>(</span><span class=typ>PoolingAsyncValueTaskMethodBuilder</span><span class=pun>))]</span></code> 添加到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReceiveAsync</span></code> 。在我的12逻辑核机器上，这段代码：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Connection</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _connections </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>256</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_ </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Connection</span></span><span class=pun><span class=pun>()).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>const</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PingPong</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WhenAll</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>from</span></span><span class=pln><span class=pln> c </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> _connections
                    </span></span><span class=kwd><span class=kwd>select</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WhenAll</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>
                    </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
                    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                        </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                            </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReceiveAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ServerBuffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
                            </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Server</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SendAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ServerBuffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocketMessageType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Binary</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> endOfMessage</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
                    </span></span><span class=pun><span class=pun>}),</span></span><span class=pln><span class=pln>
                    </span></span><span class=typ><span class=typ>Task</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Run</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
                    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                        </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Iters</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
                            </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SendAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ClientBuffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocketMessageType</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Binary</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> endOfMessage</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
                            </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Client</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReceiveAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ClientBuffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
                        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
                    </span></span><span class=pun><span class=pun>})));</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Connection</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocket</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Client</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Server</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Memory</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ClientBuffer</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>256</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Memory</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ServerBuffer</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>256</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CancellationToken</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>default</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Connection</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Stream</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Stream1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Stream</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Stream2</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> streams </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ConnectedStreams</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateBidirectional</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Client</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocket</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateFromStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>streams</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> isServer</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> subProtocol</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Timeout</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InfiniteTimeSpan</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Server</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebSocket</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateFromStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>streams</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Stream2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> isServer</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> subProtocol</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Timeout</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InfiniteTimeSpan</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>then yielded this improvement:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然后产生了这种改进： </font></font></font></p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Gen 0<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>第0代 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Gen 1</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Gen 2</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>PingPong<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>乒乓球 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>148.7 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>148.7毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>29750.0000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3000.0000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>250.0000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>180,238 KB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>PingPong<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>乒乓球 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>108.9 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>108.9毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.72</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>249 KB</td>
</tr>
</tbody>
</table></div>
<h3 id=reflection data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Reflection<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>反射 </font></font></font><a aria-labelledby=reflection class=linkicon href=#reflection data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Reflection provides a very powerful mechanism for inspecting metadata about .NET assemblies and invoking functionality in those assemblies. That mechanism can incur non-trivial expense, however. While functionality exists to avoid that overhead for repeated calls (e.g. using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodInfo</span><span class=pun>.</span><span class=typ>CreateDelegate</span></code> to get a strongly-typed delegate directly to the target method), that’s not always relevant or appropriate. As such, it’s valuable to reduce the overhead associated with reflection, which .NET 6 does in multiple ways.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>反射提供了一种非常强大的机制，用于检查有关.NET程序集的元数据并调用这些程序集中的功能。然而，这种机制可能会招致不小的开销。虽然存在避免重复呼叫的开销的功能性（例如使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodInfo</span><span class=pun>.</span><span class=typ>CreateDelegate</span></code> 直接获得目标方法的强类型委托），这并不总是相关或合适的。因此，减少与反射相关的开销是有价值的，.NET 6以多种方式做到了这一点。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>A variety of PRs targeted reducing the overhead involved in inspecting attributes on .NET types and members. <a href=https://github.com/dotnet/runtime/pull/54402 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54402</a> significantly reduced the overhead of calling <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Attribute</span><span class=pun>.</span><span class=typ>GetCustomAttributes</span></code> when specifying that inherited attributes should be included (even if there aren’t any to inherit); <a href=https://github.com/dotnet/runtime/pull/44694 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44694</a> from <a href=https://github.com/benaadams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@benaadams</a> reduced the memory allocation associated with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Attribute</span><span class=pun>.</span><span class=typ>IsDefined</span></code> via a dedicated code path rather than relegating the core logic to an existing shared method (<a href=https://github.com/dotnet/runtime/pull/45292 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45292</a>, from <a href=https://github.com/benaadams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@benaadams</a> as well, also removed some low-level overhead from filtering attribute records); and <a href=https://github.com/dotnet/runtime/pull/54405 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54405</a> eliminated the allocation from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodInfo</span><span class=pun>.</span><span class=typ>GetCustomAttributeData</span></code> when there aren’t any attributes (it’s common to call this API to check if there are, and thus it’s helpful to improve performance in the common case where there aren’t).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>各种PR旨在减少检查.NET类型和成员上的属性所涉及的开销。dotnet/runtime#54402显著降低了调用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Attribute</span><span class=pun>.</span><span class=typ>GetCustomAttributes</span></code> 的开销，当指定应该包含继承的属性时（即使没有任何要继承的属性）;来自@benaadams的dotnet/runtime#44694通过专用代码路径减少了与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Attribute</span><span class=pun>.</span><span class=typ>IsDefined</span></code> 相关的内存分配，而不是将核心逻辑降级到现有的共享方法（来自@benaadams的dotnet/runtime#45292也去除了过滤属性记录的一些低级开销）; dotnet/runtime#54405消除了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodInfo</span><span class=pun>.</span><span class=typ>GetCustomAttributeData</span></code> 中没有任何属性时的分配（调用此API来检查是否有属性是很常见的，因此在没有属性的常见情况下，这有助于提高性能）。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MethodInfo</span></span><span class=pln><span class=pln> _noAttributes </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>C</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>GetMethod</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"NoAttributes"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PropertyInfo</span></span><span class=pln><span class=pln> _hasAttributes </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>C</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>GetProperty</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"HasAttributes"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IList</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>CustomAttributeData</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetCustomAttributesData</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _noAttributes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetCustomAttributesData</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsDefined</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Attribute</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsDefined</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_hasAttributes</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>ObsoleteAttribute</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Attribute</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetCustomAttributes</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Attribute</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetCustomAttributes</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_hasAttributes</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> inherit</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> A </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> C </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> A
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NoAttributes</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Obsolete</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HasAttributes</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetCustomAttributesData<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>获取自定义属性数据 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>329.48 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>329.48纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>168 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetCustomAttributesData<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>获取自定义属性数据 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>85.27 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>85.27纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.26</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetCustomAttributesData</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>73.58 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>73.58纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.22</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetCustomAttributesData<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>获取自定义属性数据 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>69.59 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>69.59纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.21</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsDefined</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>640.15 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>640.15纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>144 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>144个B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsDefined</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>399.75 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>399.75纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.62</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>136 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsDefined</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>292.01 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>292.01纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.46</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsDefined</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>252.00 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.39</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetCustomAttributes</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5,155.93 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>5，155.93 ns </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,380 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetCustomAttributes</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2,702.26 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2，702.26纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.52</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,120 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1, B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetCustomAttributes</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2,406.51 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2，406.51 ns </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.47</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,056 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1，B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetCustomAttributes</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>446.29 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>446.29纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.09</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>128 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code often looks up information beyond attributes, and it can be helpful for performance to special-case common patterns. <a href=https://github.com/dotnet/runtime/pull/44759 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44759</a> recognizes that reflection-based code will often look at method parameters, which many methods don’t have, yet <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetParameters</span></code> was always allocating a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ParameterInfo</span><span class=pun>[]</span></code>, even for zero parameters. A given <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodInfo</span></code> will cache the array, but this would still result in an extra array for every individual method inspected. This PR fixes that.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>代码经常查找属性以外的信息，这对于特殊情况的常见模式的性能很有帮助。dotnet/runtime#44759认识到，基于反射的代码经常会查看方法参数，而许多方法没有这些参数，但是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetParameters</span></code> 总是分配一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ParameterInfo</span><span class=pun>[]</span></code> ，即使是零参数。给定的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodInfo</span></code> 将缓存数组，但这仍然会为每个检查的方法带来额外的数组。这个PR解决了这个问题。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Reflection is valuable not just for getting metadata but also for invoking members. If you ever do an allocation profile for code using reflection to invoke methods, you’ll likely see a bunch of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> allocations showing up, typically coming from a method named <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CheckArguments</span></code>. This is part of the runtime’s type safety validation. Reflection is going to pass the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> of arguments you pass to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodInfo</span><span class=pun>.</span><span class=typ>Invoke</span></code> to the target method, which means it needs to validate that the arguments are of the right types the method expects… if they’re not, it could end up violating type safety by passing type A to a method that instead receives it as a completely unrelated type B, and now all use of that “B” is potentially invalid and corrupting. However, if a caller erroneously mutated the array concurrently with the reflection call, such mutation could happen after the type checks occurred, enabling type safety to be violated, anyway. So, the runtime is forced to make a defensive copy of the argument array and then validate the copy to which the caller doesn’t have access. That’s the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> that shows up in these traces. <a href=https://github.com/dotnet/runtime/pull/50814 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50814</a> addresses this by recognizing that most methods have at most only a few parameters, and special-cases methods with up to four parameters to instead use a stack-allocated <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=str>&lt;object&gt;</span></code> rather than a heap-allocated a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> for storing that defensive copy.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>反射不仅对于获取元数据很有价值，而且对于调用成员也很有价值。如果您曾经为使用反射调用方法的代码做一个分配概要文件，您可能会看到一堆 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> 分配显示，通常来自名为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CheckArguments</span></code> 的方法。这是运行库类型安全验证的一部分。反射会将你传递给 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MethodInfo</span><span class=pun>.</span><span class=typ>Invoke</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> 参数传递给目标方法，这意味着它需要验证参数是否属于该方法所期望的正确类型......如果不是，它可能会违反类型安全性，因为它将类型A传递给一个方法，而这个方法将作为一个完全无关的类型B来接收它，现在所有的“B”的使用都可能是无效的和损坏的。但是，如果调用方错误地在反射调用的同时改变了数组，则这种改变可能发生在类型检查发生之后，从而无论如何都会违反类型安全。 因此，运行时被迫创建参数数组的防御副本，然后验证调用方无权访问的副本。这就是在这些痕迹中出现的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> 。dotnet/runtime#50814通过认识到大多数方法最多只有几个参数来解决这个问题，而特殊情况的方法最多只有四个参数，而使用堆栈分配的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=str>&lt;object&gt;</span></code> 而不是堆分配的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> 来存储防御副本。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MethodInfo</span></span><span class=pln><span class=pln> _method </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>GetMethod</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"M"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> M</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> arg1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> arg2</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Invoke</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _method</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Invoke</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>this</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>object</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"two"</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>});</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Invoke<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>调用 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>195.5 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>104 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Invoke<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>调用 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>156.0 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.80</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>104 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Invoke<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>调用 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>141.0 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.72</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>104 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Invoke<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>调用 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>123.1 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.63</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>64 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another very common form of dynamic invocation is when creating new instances via <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Activator</span><span class=pun>.</span><span class=typ>CreateInstance</span></code>, which is usable directly but is also employed by the C# compiler to implement the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pun>()</span></code> constraint on generic parameters. <a href=https://github.com/dotnet/runtime/pull/32520 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#32520</a> overhauled the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Activator</span><span class=pun>.</span><span class=typ>CreateInstance</span></code> implementation in the runtime, employing a per-type cache of function pointers that can be used to quickly allocate an uninitialized object of the relevant type and invoke its constructor.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>另一种非常常见的动态调用形式是通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Activator</span><span class=pun>.</span><span class=typ>CreateInstance</span></code> 创建新实例，它可以直接使用，但也被C#编译器用来实现对泛型参数的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pun>()</span></code> 约束。dotnet/runtime#32520对运行时中的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Activator</span><span class=pun>.</span><span class=typ>CreateInstance</span></code> 实现进行了彻底的检查，采用了一个按类型缓存的函数指针，可以用来快速分配相关类型的未初始化对象并调用其构造函数。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> T </span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>&gt;()</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>where</span></span><span class=pln><span class=pln> T </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> T</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>&gt;();</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Create<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>49.496 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>49.496纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>24 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Create<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>28.296 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>28.296纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.57</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>24 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Create<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>26.350 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.53</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>24 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Create<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>9.439 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>9.439纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.19</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>24 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another common operation is creating closed generic types from open ones, e.g. given the type for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> creating a type for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=str>&lt;int&gt;</span></code>. <a href=https://github.com/dotnet/runtime/pull/45137 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45137</a> special-cased the most common case of having just one type parameter in order to optimize that path, while also avoiding an extra <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetGenericArguments</span></code> call internally for all arities.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>另一个常见的操作是从开放的泛型类型创建封闭的泛型类型，例如给定 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的类型，创建 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=str>&lt;int&gt;</span></code> 的类型。dotnet/runtime#45137特殊处理了最常见的只有一个类型参数的情况，以优化该路径，同时还避免了对所有类型的内部额外的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetGenericArguments</span></code> 调用。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Type</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _oneRef </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Type</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _twoValue </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Type</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>OneRefType</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>List</span></span><span class=pun><span class=pun>&lt;&gt;).</span></span><span class=typ><span class=typ>MakeGenericType</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_oneRef</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Type</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TwoValueType</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Dictionary</span></span><span class=pun><span class=pun>&lt;,&gt;).</span></span><span class=typ><span class=typ>MakeGenericType</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_twoValue</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>OneRefType</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>363.1 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>363.1纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>128 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>OneRefType</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>266.8 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>266.8纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.74</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>128 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>OneRefType</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>248.7 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>248.7纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.69</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>128 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>OneRefType</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>171.6 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.47</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>TwoValueType</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>418.9 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>160 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>TwoValueType</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>292.3 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.70</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>160 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>TwoValueType</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>290.5 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.69</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>160 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>TwoValueType</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>215.0 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.51</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>120 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Finally, sometimes optimizations are all about deleting code and just calling something else that already exists. <a href=https://github.com/dotnet/runtime/pull/42891 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#42891</a> just changed the implementation of one helper in the runtime to call another existing helper, in order to make <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Type</span><span class=pun>.</span><span class=typ>IsPrimitive</span></code> measurably faster:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Arguments</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>))]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IsPrimitive</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Type</span></span><span class=pln><span class=pln> type</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> type</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>IsPrimitive</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsPrimitive</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5.021 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsPrimitive</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.184 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.63</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsPrimitive</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.032 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>3.032纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.60</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>IsPrimitive</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.376 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2.376纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.47</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course, reflection extends beyond just the core reflection APIs, and a number of PRs have gone in to improving areas of reflection higher in the stack. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DispatchProxy</span></code>, for example. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DispatchProxy</span></code> provides an interface-based alternative to the older remoting-based <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RealProxy</span></code> (<a href=https://devblogs.microsoft.com/dotnet/migrating-realproxy-usage-to-dispatchproxy/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Migrating RealProxy Usage to DispatchProxy</a> provides a good description). It utilizes reflection emit to generate IL at run-time, and <a href=https://github.com/dotnet/runtime/pull/47134 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47134</a> optimizes both that process and the generated code in such a way that it saves several hundred bytes of allocation per method invocation on a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DispatchProxy</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当然，反射不仅仅是核心反射API，而且许多PR已经进入改善堆栈中更高的反射区域。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DispatchProxy</span></code> ，例如。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DispatchProxy</span></code> 提供了一个基于接口的替代方案，替代了旧的基于远程处理的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RealProxy</span></code> （将RealProxy Usage迁移到DispatchProxy提供了很好的描述）。它利用反射发出在运行时生成IL，dotnet/runtime#47134优化了该过程和生成的代码，使得在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DispatchProxy</span></code> 上每个方法调用节省了几百字节的分配。</font></font></font></p>
<h3 id=collections-and-linq data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Collections and LINQ<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>收藏和LINQ </font></font></font><a aria-labelledby=collections-and-linq class=linkicon href=#collections-and-linq data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Every .NET release has seen the core collection types and LINQ get faster and faster. Even as a lot of the low-hanging fruit was picked in previous releases, developers contributing to .NET 6 have still managed to find meaningful improvements, some in the form of optimizing existing APIs, and some in the form of new APIs developers can use to make their own code fly.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>每个.NET版本都看到了核心集合类型和LINQ变得越来越快。尽管在以前的版本中已经收获了许多不易收获的果实，但为.NET 6做出贡献的开发人员仍然设法找到了有意义的改进，一些是优化现有API的形式，一些是开发人员可以使用新API的形式，以使他们自己的代码飞起来。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Improvements to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;</span><span class=typ>TKey</span><span class=pun>,</span><span class=pln> </span><span class=typ>TValue</span><span class=pun>&gt;</span></code> are always exciting, as it’s used <em data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>everywhere</em>, and performance improvements to it have a way of “moving the needle” on a variety of workloads. One improvement to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;</span><span class=typ>TKey</span><span class=pun>,</span><span class=pln> </span><span class=typ>TValue</span><span class=pun>&gt;</span></code> in .NET 6 comes from <a href=https://github.com/benaadams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@benaadams</a> in <a href=https://github.com/dotnet/runtime/pull/41944 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#41944</a>. The PR improves the performance of creating one dictionary from another, by enabling the common case of the source dictionary and the new dictionary sharing a key comparer to copy the underlying buckets without rehashing.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;</span><span class=typ>TKey</span><span class=pun>,</span><span class=pln> </span><span class=typ>TValue</span><span class=pun>&gt;</span></code> 的改进总是令人兴奋的，因为它在任何地方都被使用，对它的性能改进有一种在各种工作负载上“移动指针”的方式。.NET 6中 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;</span><span class=typ>TKey</span><span class=pun>,</span><span class=pln> </span><span class=typ>TValue</span><span class=pun>&gt;</span></code> 的一个改进来自dotnet/runtime#41944中的@benaadams。PR提高了从另一个字典创建一个字典的性能，通过使源字典和新字典共享密钥比较器的共同情况来复制底层桶而不进行重散列。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>KeyValuePair</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;&gt;</span></span><span class=pln><span class=pln> _dictionary </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>ToDictionary</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>(),</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>StringComparer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>OrdinalIgnoreCase</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Dictionary</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Clone</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Dictionary</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;(</span></span><span class=pln><span class=pln>_dictionary</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Clone<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>克隆 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.224 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>3.224美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Clone<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>克隆 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.880 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2.880美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.89</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Clone<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>克隆 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.685 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.685美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.52</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In <a href=https://github.com/dotnet/runtime/pull/45659 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45659</a> and <a href=https://github.com/dotnet/runtime/pull/56634 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56634</a>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SortedDictionary</span><span class=pun>&lt;</span><span class=typ>TKey</span><span class=pun>,</span><span class=pln> </span><span class=typ>TValue</span><span class=pun>&gt;</span></code> also gains a similar optimization:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在dotnet/runtime#45659和dotnet/runtime#56634中， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SortedDictionary</span><span class=pun>&lt;</span><span class=typ>TKey</span><span class=pun>,</span><span class=pln> </span><span class=typ>TValue</span><span class=pun>&gt;</span></code> 也获得了类似的优化：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IDictionary</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> _dictionary </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SortedDictionary</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;(</span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>ToDictionary</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>(),</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>StringComparer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>OrdinalIgnoreCase</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SortedDictionary</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Clone</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SortedDictionary</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;(</span></span><span class=pln><span class=pln>_dictionary</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Clone</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>69.546 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Clone</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>54.560 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.78</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Clone</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>53.196 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.76</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Clone</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.330 us</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.03</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/49388 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49388</a> from <a href=https://github.com/benaadams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@benaadams</a> and <a href=https://github.com/dotnet/runtime/pull/54611 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54611</a> from <a href=https://github.com/Sergio0694 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@Sergio0694</a> are examples of new APIs that developers can use with dictionaries when they want to eke out that last mile of performance. These APIs are defined on the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CollectionMarshal</span></code> class as they provide low-level access to internals of the dictionary, returning a ref into the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;</span><span class=typ>TKey</span><span class=pun>,</span><span class=pln> </span><span class=typ>TValue</span><span class=pun>&gt;</span></code>s data structures; thus, you need to be careful when using them, but they can measurably improve performance in specific situations. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CollectionMarshal</span><span class=pun>.</span><span class=typ>GetValueRefOrNullRef</span></code> returns a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ref</span><span class=pln> </span><span class=typ>TValue</span></code> that will either point to an existing entry in the dictionary or be a null reference (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Unsafe</span><span class=pun>.</span><span class=typ>NullRef</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;()</span></code>) if the key could not be found. And <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CollectionMarshal</span><span class=pun>.</span><span class=typ>GetValueRefOrAddDefault</span></code> returns a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ref</span><span class=pln> </span><span class=typ>TValue</span><span class=pun>?</span></code>, returning a ref to the value if the key could be found, or adding an empty entry and returning a ref to it, otherwise. These can be used to avoid duplicate lookups as well as avoid potentially expensive struct value copies.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Dictionary</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> _counts </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Dictionary</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AddOld</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        _counts</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _counts</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>TryGetValue</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> count</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> count </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AddNew</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>CollectionsMarshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetValueRefOrAddDefault</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_counts</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> _</span></span><span class=pun><span class=pun>)++;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>AddOld<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>添加旧 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>95.39 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>95.39美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>AddNew</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>49.85 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>49.85美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.52</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ImmutableSortedSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ImmutableList</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> indexing also get faster, thanks to <a href=https://github.com/dotnet/runtime/pull/53266 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53266</a> from <a href=https://github.com/L2 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@L2</a>. Indexing into these collections performs a binary search through a tree of nodes, and each layer of the traversal was performing a range check on the index. But for all but the entry point check, that range validation is duplicative and can be removed, which is exactly what the PR does:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ImmutableSortedSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ImmutableList</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 索引也变得更快，这要归功于@L2的dotnet/runtime#53266。索引到这些集合中执行通过节点树的二分搜索，遍历的每一层都在对索引执行范围检查。但是对于除了入口点检查之外的所有检查，范围验证是重复的，可以删除，这正是PR所做的：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ImmutableList</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _list </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ImmutableList</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateRange</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Item</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _list</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>];</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Item<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>项目 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>17.468 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>17.468纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Item<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>项目 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>16.296 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>16.296纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.93</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Item<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>项目 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>9.457 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>9.457纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.54</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ObservableCollection</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> also improves in .NET 6, specifically due to <a href=https://github.com/dotnet/runtime/pull/54899 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54899</a>, which reduces the allocations involved in creating NotifyCollectionChangedEventArgs (as such, this isn’t actually specific to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ObservableCollection</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> and will help other systems that use the event arguments). The crux of the change is introducing an internal <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SingleItemReadOnlyList</span></code> that’s used when an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IList</span></code> is needed to represent a single item; this replaces allocating an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> that’s then wrapped in a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlyList</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ObservableCollection</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 在.NET 6中也有所改进，特别是由于dotnet/runtime#54899，它减少了创建NotifyCollectionChangedEventArgs时涉及的分配（因此，这并不特定于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ObservableCollection</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> ，将有助于其他使用事件参数的系统）。改变的关键是引入了一个内部的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SingleItemReadOnlyList</span></code> ，当需要一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IList</span></code> 来表示单个项目时，它就使用了;这代替了分配一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> ，然后将其包装在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlyList</span></code> 中。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ObservableCollection</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _collection </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ObservableCollection</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ClearAdd</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _collection</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Clear</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        _collection</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Add</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ClearAdd</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4.014 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>4.014美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>17 KB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>简体中文 </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ClearAdd</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>3.104 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>3.104美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.78</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>13 KB<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>简体中文 </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ClearAdd</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.471 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2.471美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.62</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>9 KB</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There have been a variety of other changes, such as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> shrinking in size by a reference field, thanks to <a href=https://github.com/dotnet/runtime/pull/49483 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49483</a>; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConcurrentQueue</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConcurrentBag</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> avoiding some unnecessary writes when T doesn’t contain any references, thanks to <a href=https://github.com/dotnet/runtime/pull/53438 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53438</a>; new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EnsureCapacity</span></code> APIs for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stack</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Queue</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, thanks to <a href=https://github.com/dotnet/runtime/pull/47149 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47149</a> from <a href=https://github.com/lateapexearlyspeed target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@lateapexearlyspeed</a>; and a brand new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PriorityQueue</span><span class=pun>&lt;</span><span class=typ>TElement</span><span class=pun>,</span><span class=pln> </span><span class=typ>TPriority</span><span class=pun>&gt;</span></code>, which was initially added in <a href=https://github.com/dotnet/runtime/pull/46009 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46009</a> by <a href=https://github.com/pgolebiowski target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@pgolebiowski</a> and then subsequently optimized further in PRs like <a href=https://github.com/dotnet/runtime/pull/48315 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48315</a>, <a href=https://github.com/dotnet/runtime/pull/48324 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48324</a>, <a href=https://github.com/dotnet/runtime/pull/48346 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48346</a>, and <a href=https://github.com/dotnet/runtime/pull/50065 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50065</a>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>还有各种各样的其他变化，例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 缩小了参考字段的大小，感谢dotnet/runtime#49483; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConcurrentQueue</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ConcurrentBag</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 在T不包含任何引用时避免了一些不必要的写入，感谢dotnet/runtime#53438; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stack</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Queue</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的新 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EnsureCapacity</span></code> API，感谢来自@lateapexearlyspeed的dotnet/runtime#47149;以及全新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PriorityQueue</span><span class=pun>&lt;</span><span class=typ>TElement</span><span class=pun>,</span><span class=pln> </span><span class=typ>TPriority</span><span class=pun>&gt;</span></code> ，最初由@pgolebiowski添加到dotnet/runtime#46009中，随后在PR中进一步优化，如dotnet/runtime#48315、dotnet/runtime#48324、dotnet/runtime#48346和dotnet/runtime#50065。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Having mentioned <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> gets a new customer in .NET 6: LINQ. Previous releases of LINQ brought with it its own internal <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Set</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> implementation, but in .NET 6 <a href=https://github.com/dotnet/runtime/pull/49591 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49591</a> ripped that out and replaced it with the built-in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>, benefiting LINQ from the myriad of performance improvements that have gone into <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> in the last few years (but especially in .NET 5), while also reducing code duplication.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在提到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 之后， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 在.NET 6中获得了一个新客户：LINQ以前的LINQ版本带来了它自己的内部 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Set</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 实现，但在.NET 6中，dotnet/runtime#49591将其删除并替换为内置的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> ，使LINQ受益于过去几年中 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的无数性能改进（尤其是在.NET 5中），同时也减少了代码重复。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=str><span class=str>&lt;string&gt;</span></span><span class=pln><span class=pln> _data </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>100</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>()).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DistinctCount</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _data</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Distinct</span></span><span class=pun><span class=pun>().</span></span><span class=typ><span class=typ>Count</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>DistinctCount<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>DistincctCount </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5.154 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>5.154毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.04</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5 MB</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>DistinctCount<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>DistincctCount </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.626 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2.626毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.53</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2 MB</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>SequenceEqual</span></code> has also been accelerated when both enumerables are arrays, thanks to <a href=https://github.com/dotnet/runtime/pull/48287 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48287</a> and <a href=https://github.com/dotnet/runtime/pull/48677 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48677</a>. The latter PR adds a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MemoryExtensions</span><span class=pun>.</span><span class=typ>SequenceEqual</span></code> overload that accepts an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> (the existing overloads constrain <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> to being <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEquatable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>), which enables <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>SequenceEqual</span></code> to delegate to the span-based method and obtain vectorization of the comparison “for free” when the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> used is amenable.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当两个枚举数都是数组时， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>SequenceEqual</span></code> 也得到了加速，这要归功于dotnet/runtime#48287和dotnet/runtime#48677。后一个PR添加了接受 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEqualityComparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MemoryExtensions</span><span class=pun>.</span><span class=typ>SequenceEqual</span></code> 重载（现有重载将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> 约束为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEquatable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> ），这使得 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>SequenceEqual</span></code> 能够委托基于跨度的方法，并且当使用的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> 是可接受的时，“免费”地获得比较的向量化。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _e1 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _e2 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SequenceEqual</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _e1</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SequenceEqual</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_e2</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>SequenceEqual<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>序列相等 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>10,822.6 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>10，822.6美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>SequenceEqual<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>序列相等 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5,421.1 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>5，421.1美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.50</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>SequenceEqual<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>序列相等 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>150.2 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>150.2us </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.01</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Min</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Max</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> have also improved, thanks to <a href=https://github.com/dotnet/runtime/pull/48273 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48273</a> and <a href=https://github.com/dotnet/runtime/pull/48289 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48289</a> (and the aforementioned JIT improvements that recognize <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code> as an intrinsic). By special-casing the comparer being <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code>, a dedicated loop could then be written explicitly using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code> rather than going through the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>comparer</span></code> parameter, which enables all of the calls through <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span><span class=pun>.</span><span class=typ>Compare</span></code> to devirtualize when <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> is a value type.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Min</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Max</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 也得到了改进，这要归功于dotnet/runtime#48273和dotnet/runtime#48289（以及前面提到的将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code> 识别为内在的JIT改进）。通过对比较器进行特殊封装，可以使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span></code> 而不是通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>comparer</span></code> 参数显式地编写专用循环，这使得当 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> 是值类型时，通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Comparer</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Default</span><span class=pun>.</span><span class=typ>Compare</span></code> 的所有调用都能够去虚拟化。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TimeSpan</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _values </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TimeSpan</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FromMilliseconds</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>)).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TimeSpan</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Max</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _values</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Max</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TimeSpan</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Min</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _values</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Min</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Max</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5.984 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>5.984毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Max</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4.926 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>4.926毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.82</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Max</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4.222 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>4.222毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.71</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Min</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5.917 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>5.917毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Min</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5.207 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>5.207毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.88</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Min</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>4.291 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>4.291毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.73</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In addition, there have been several new APIs added to LINQ in .NET 6. A new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Zip</span></code> overload accepting three rather than only two sources was added in <a href=https://github.com/dotnet/runtime/pull/47147 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47147</a> from <a href=https://github.com/huoyaoyuan target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@huoyaoyuan</a>, making it both easier and faster to combine three sources:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>此外，在.NET 6中的LINQ中添加了几个新的API。@huoyaoyuan在dotnet/runtime#47147中添加了一个新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Zip</span></code> 重载，接受三个而不是两个源，使得联合收割机三个源变得更容易和更快：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _e1 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _e2 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _e3 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1_000</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=pun><span class=pun>&lt;(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>)&gt;</span></span><span class=pln><span class=pln> zipped </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _e1</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Zip</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_e2</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Zip</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_e3</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>x</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> y</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>x</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>First</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> x</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Second</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> y</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> values </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> zipped</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=pun><span class=pun>&lt;(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>)&gt;</span></span><span class=pln><span class=pln> zipped </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _e1</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Zip</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_e2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _e3</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> values </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> zipped</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>20.50 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>20.50美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>304 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>14.88 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>14.88美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.73</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>232 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/48559 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48559</a> from <a href=https://github.com/Dixin target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@Dixin</a> and <a href=https://github.com/dotnet/runtime/pull/48634 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48634</a> add a new overload of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Take</span></code> that accepts a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Range</span></code> (as well as an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ElementAt</span></code> that takes an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Index</span></code>). In addition to then enabling the C# 8 range syntax to be used with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Take</span></code>, it also reduces some overheads associated with needing to combine multiple existing combinators to achieve the same thing.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 来自@Dixin的dotnet/runtime#48559和dotnet/runtime#48634添加一个新的重载 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>Take</span></code> ，它接受 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Range</span></code> （以及接受 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Index</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ElementAt</span></code> ）。除了使C# 8 range语法能够与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Take</span></code> 一起使用之外，它还减少了一些与需要联合收割机多个现有组合器以实现相同的事情相关联的开销。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> count</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> count</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>yield</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IEnumerable</span></span><span class=str><span class=str>&lt;int&gt;</span></span><span class=pln><span class=pln> _e </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> _e</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Skip</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Take</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> _e</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Take</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1000.</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>1010</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.954 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2.954美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>152 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.935 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2.935美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.99</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>96 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>And <a href=https://github.com/dotnet/runtime/pull/48239 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48239</a> introduced <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>TryGetNonEnumeratedCount</span></code>, which enables getting the count of the number of items in an enumerable if that count can be determined quickly. This can be useful to avoid the overhead of resizes when presizing a collection that will be used to store the contents of the enumerable.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>dotnet/runtime#48239引入了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Enumerable</span><span class=pun>.</span><span class=typ>TryGetNonEnumeratedCount</span></code> ，如果可以快速确定的话，它可以获得枚举中的项目数的计数。这对于避免在调整将用于存储可枚举内容的集合的大小调整开销非常有用。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Lastly, it’s somewhat rare today to see code written against instances of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span></code> rather than a strongly-typed array (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pun>[]</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span><span class=pun>[]</span></code>), but such code does exist. We don’t need to optimize heavily for such code, but sometimes the stars align and efforts to simplify such code actually make it significantly faster as well, as is the case with <a href=https://github.com/dotnet/runtime/pull/51351 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51351</a>, which simplified the implementation of the non-generic <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayEnumerator</span></code>, and in doing so made code like this much faster:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>最后，今天很少看到针对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Array</span></code> 实例而不是强类型数组编写的代码（例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pun>[]</span></code> 或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span><span class=pun>[]</span></code> ），但这样的代码确实存在。我们不需要对这样的代码进行大量优化，但有时候星星对齐，简化这样的代码的努力实际上也会使它更快，就像dotnet/runtime#51351一样，它简化了非泛型 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayEnumerator</span></code> 的实现，这样做使这样的代码更快：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Array</span></span><span class=pln><span class=pln> _array </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>object</span></span><span class=pun><span class=pun>()).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Count</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> count </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>object</span></span><span class=pln><span class=pln> o </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> _array</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> count</span></span><span class=pun><span class=pun>++;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> count</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Count<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>计数 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>14.992 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>14.992美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Count<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>计数 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>14.134 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>14.134美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.94</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Count<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>计数 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>12.866 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>12.866美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.86</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Count<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>计数 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>5.778 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>5.778美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.39</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
</tbody>
</table></div>
<h3 id=cryptography data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Cryptography<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>密码学 </font></font></font><a aria-labelledby=cryptography class=linkicon href=#cryptography data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s turn to cryptography. A lot of work has gone into crypto for the .NET 6 release, mostly functional. However, there are have been a handful of impactful performance improvements in the space.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>让我们转向密码学。对于.NET 6发行版，很多工作都投入到加密领域，主要是功能性的。然而，在该领域有一些影响力的性能改进。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> was improved over the course of multiple PRs. When async support was initially added to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code>, it was decided that, because <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> does compute-intensive work, it shouldn’t block the caller of the asynchronous method; as a result, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> was originally written to forcibly queue encryption and decryption operations to the thread pool. However, typical usage is actually very fast and doesn’t warrant a thread hop, and even if it wasn’t fast, guidance has evolved over the years such that now the recommendation wouldn’t be to queue, anyway. So, <a href=https://github.com/dotnet/runtime/pull/45150 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45150</a> removed that queueing. On top of that, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> hadn’t really kept up with the times, and when new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Memory</span></code>/<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code>-based <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadAsync</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteAsync</span></code> overloads were introduced on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> in .NET Core 2.1, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> didn’t provide overrides; for .NET 6, <a href=https://github.com/dotnet/runtime/pull/47207 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47207</a> from <a href=https://github.com/NewellClark target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@NewellClark</a> addresses that deficiency by adding the appropriate overrides. As in the earlier discussion of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> now also can complete a read operation once at least one byte of output is available and can be used for zero-byte reads.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 在多次PR过程中得到改善。当异步支持最初被添加到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 时，它决定，因为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 做的是计算密集型的工作，所以它不应该阻止异步方法的调用者;结果， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 最初被写入是为了强制将加密和解密操作排队到线程池。然而，典型的用法实际上非常快，并且不保证线程跳跃，即使它不快，指导也在多年来不断发展，以至于现在的建议不会是排队，无论如何。因此，dotnet/runtime#45150删除了排队。最重要的是， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 并没有真正跟上时代的步伐，当新的基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Memory</span></code> / <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTask</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadAsync</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteAsync</span></code> 重载在.NET Core 2.1的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 上引入时， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 没有提供重载;对于.NET 6，来自@NewellClark的dotnet/runtime#47207通过添加适当的覆盖来解决这一缺陷。 正如前面对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DeflateStream</span></code> 的讨论， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 现在也可以在至少一个字节的输出可用时完成读操作，并且可以用于零字节读操作。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> works with arbitrary implementations of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ICryptoTransform</span></code>, of which one is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code>; not exactly cryptography, but it makes it easy to Base64-encode a stream of data. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ICryptoTransform</span></code> is an interesting interface, providing a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CanTransformMultipleBlocks</span></code> property that dictates whether an implementation’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TransformBlock</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Transform</span></code> can transform just one or multiple “blocks” of data at a time. The interface expects that input is processed in blocks of a particular fixed number of input bytes which then yield a fixed number of output bytes, e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> encodes blocks of three input bytes into blocks of four output bytes. Historically, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> returned <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>false</span></code> from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CanTransformMultipleBlocks</span></code>, which then forced <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> to take the slower path of processing only three input bytes at a time. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> uses <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Base64</span><span class=pun>.</span><span class=typ>EncodeToUtf8</span></code>, which is vectorized for fast processing, but three input bytes per call is too small to take advantage of the vectorized code paths, which ended up making <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> quite slow. <a href=https://github.com/dotnet/runtime/pull/55055 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55055</a> fixed this by teaching <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> how to process multiple blocks, which in turn has a big impact on its performance when used with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 可用于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ICryptoTransform</span></code> 的任意实现，其中一个是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> ;不完全是密码学，但它可以很容易地对数据流进行Base64编码。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ICryptoTransform</span></code> 是一个有趣的接口，它提供了一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CanTransformMultipleBlocks</span></code> 属性，该属性指示一个实现的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TransformBlock</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Transform</span></code> 一次只能转换一个数据块还是多个数据块。接口期望输入在特定固定数量的输入字节的块中被处理，然后产生固定数量的输出字节，例如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> 将三个输入字节的块编码为四个输出字节的块。历史上， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> 从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CanTransformMultipleBlocks</span></code> 返回 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>false</span></code> ，然后迫使 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 采取较慢的路径，一次只处理三个输入字节。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> 使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Base64</span><span class=pun>.</span><span class=typ>EncodeToUtf8</span></code> ，它被向量化以实现快速处理，但是每次调用三个输入字节太小，无法利用向量化代码路径，这最终使得 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> 变得相当慢。 dotnet/runtime#55055通过教导 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ToBase64Transform</span></code> 如何处理多个块来修复这个问题，这反过来又会对它与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 一起使用时的性能产生很大影响。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _data </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Enumerable</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Range</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>10</span></span><span class=pln><span class=pln>_000_000</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MemoryStream</span></span><span class=pln><span class=pln> _destination </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MemoryStream</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>async</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Task</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Encode</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _destination</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Position</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> toBase64 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ToBase64Transform</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> stream </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CryptoStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> toBase64</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CryptoStreamMode</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Write</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> leaveOpen</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> stream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteAsync</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_data</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _data</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>329.871 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>329.871毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>213,976,944 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>213，976，944 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Core 3.1</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>251.986 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>251.986毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.765</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>213,334,112 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>213，334，112 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>146.058 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>146.058毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.443</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>974 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>小行星974 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Encode<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码 </font></font></font></td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.998 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.998毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.006</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>300 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B 300 </font></font></font></td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Even as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> improves in .NET 6, sometimes you don’t need the power of a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> and instead just want something simple and fast to handle encrypting and decrypting data you already have in memory. For that, <a href=https://github.com/dotnet/runtime/pull/52510 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52510</a>, <a href=https://github.com/dotnet/runtime/pull/55184 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55184</a>, and <a href=https://github.com/dotnet/runtime/pull/55480 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55480</a> introduced new “one shot” <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EncryptCbc</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EncryptCfb</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EncryptEcb</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DecryptCbc</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DecryptCfb</span></code>, and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DecryptEcb</span></code> methods on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SymmetricAlgorithm</span></code> (along with some protected virtual methods these delegate to) that support encrypting and decrypting <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code>s and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code>s without having to go through a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code>. This not only leads to simpler code when you already have the data to process, it’s also faster.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>即使 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CryptoStream</span></code> 在.NET 6中有所改进，有时候你并不需要 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Stream</span></code> 的强大功能，而只是想要一些简单快速的东西来处理内存中已经存在的数据的加密和解密。为此，dotnet/runtime#52510、dotnet/runtime#55184和dotnet/runtime#55480引入了新的“one shot” <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EncryptCbc</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EncryptCfb</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EncryptEcb</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DecryptCbc</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DecryptCfb</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SymmetricAlgorithm</span></code> 上的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DecryptEcb</span></code> 方法（沿着这些委托给的一些受保护的虚拟方法），支持加密和解密 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> ，而无需通过#十一号。这不仅在已经有数据要处理的情况下使代码变得更简单，而且速度也更快。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _key</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _iv</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _ciphertext</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Aes</span></span><span class=pln><span class=pln> aes </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    _key </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Key</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    _iv </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> aes</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>IV</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    _ciphertext </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>EncryptCbc</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Encoding</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>UTF8</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetBytes</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"This is a test.  This is only a test."</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> _iv</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Aes</span></span><span class=pln><span class=pln> aes </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Key</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _key</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    aes</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>IV </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _iv</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Padding</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PaddingMode</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>PKCS7</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Mode</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CipherMode</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>CBC</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MemoryStream</span></span><span class=pln><span class=pln> destination </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MemoryStream</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ICryptoTransform</span></span><span class=pln><span class=pln> transform </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateDecryptor</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CryptoStream</span></span><span class=pln><span class=pln> cryptoStream </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CryptoStream</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>destination</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> transform</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CryptoStreamMode</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Write</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    cryptoStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Write</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_ciphertext</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    cryptoStream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FlushFinalBlock</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> destination</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToArray</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Aes</span></span><span class=pln><span class=pln> aes </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Key</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _key</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> aes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>DecryptCbc</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_ciphertext</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _iv</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.657 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.657美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1,320 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.073 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.073美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.65</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>664 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>小B 664 </font></font></font></td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I previously mentioned improvements to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Random</span></code> in .NET 6. That’s for non-cryptographically-secure randomness. If you need cryptographically-secure randomness, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Security</span><span class=pun>.</span><span class=typ>Cryptography</span><span class=pun>.</span><span class=typ>RandomNumberGenerator</span></code> is your friend. This type has existed for years but it’s been receiving more love over the last several .NET releases. For example, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RandomNumberGenerator</span></code> is instantiable via the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Create</span></code> method, and instance methods do expose the full spread of the type’s functionality, but there’s no actual need for it to be its own instance, as the underlying OS objects used now on all platforms are thread-safe and implemented in a scalable manner. <a href=https://github.com/dotnet/runtime/pull/43221 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43221</a> added a static <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetBytes</span></code> method that makes it simple and a bit faster to get a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> filled with cryptographically-strong random data:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我之前提到了.NET 6中对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Random</span></code> 的改进。这是非加密安全的随机性。如果你需要加密安全的随机性， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Security</span><span class=pun>.</span><span class=typ>Cryptography</span><span class=pun>.</span><span class=typ>RandomNumberGenerator</span></code> 是你的朋友。这种类型已经存在多年，但在过去的几个.NET版本中，它受到了更多的喜爱。例如， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RandomNumberGenerator</span></code> 可以通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Create</span></code> 方法实例化，并且实例方法确实暴露了该类型的全部功能，但实际上并不需要它作为自己的实例，因为现在所有平台上使用的底层OS对象都是线程安全的，并且以可伸缩的方式实现。dotnet/runtime#43221添加了一个静态 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetBytes</span></code> 方法，使得获得填充有加密强随机数据的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 变得简单且更快：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>RandomNumberGenerator</span></span><span class=pln><span class=pln> rng </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RandomNumberGenerator</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
        rng</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetBytes</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>buffer</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RandomNumberGenerator</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetBytes</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>80.46 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>80.46纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>78.10 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.97</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>However, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Old</span></code> case here is already improved on .NET 6 than on previous releases. <a href=https://github.com/dotnet/runtime/pull/52495 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52495</a> recognizes that there’s little benefit to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Create</span></code> creating a new instance, and converts it into a singleton.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然而，这里的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Old</span></code> 案例在.NET 6上已经比以前的版本有所改进。dotnet/runtime#52495认识到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Create</span></code> 创建一个新实例没有什么好处，并将其转换为单例。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetBytes</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>RandomNumberGenerator</span></span><span class=pln><span class=pln> rng </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RandomNumberGenerator</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>())</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
        rng</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetBytes</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>buffer</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> buffer</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetBytes</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>948.94 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>948.94纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>514 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>514乙 </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetBytes</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>85.35 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.09</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>56 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GetBytes</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>80.12 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.08</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>32 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The addition of the static <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetBytes</span></code> method continues a theme throughout crypto of exposing more “one-shot” APIs as static helpers. The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Rfc2898DeriveBytes</span></code> class enables code to derive bytes from passwords, and historically this has been done by instantiating an instance of this class and calling <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetBytes</span></code>. <a href=https://github.com/dotnet/runtime/pull/48107 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48107</a> adds static <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Pbkdf2</span></code> methods that use the PBKDF2 (Password-Based Key Derivation Function 2) key-derivation function to generate the requested bytes without explicitly creating an instance; this, in turn, enables the implementation to use any “one-shot” APIs provided by the underlying operating system, e.g. those from CommonCrypto on macOS.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>静态 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetBytes</span></code> 方法的添加延续了整个加密主题，即公开更多的“一次性”API作为静态助手。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Rfc2898DeriveBytes</span></code> 类使代码能够从密码中派生字节，历史上这是通过实例化该类的实例并调用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GetBytes</span></code> 来完成的。dotnet/runtime#48107添加了静态 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Pbkdf2</span></code> 方法，该方法使用PBKDF 2（基于密码的密钥导出函数2）密钥导出函数来生成所请求的字节，而无需显式创建实例;这又使得实现能够使用由底层操作系统提供的任何“一次性”API，例如，在macOS上使用CommonCrypto。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _salt </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Rfc2898DeriveBytes</span></span><span class=pln><span class=pln> db </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Rfc2898DeriveBytes</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"my super strong password"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _salt</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HashAlgorithmName</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>SHA256</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> db</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetBytes</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Rfc2898DeriveBytes</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Pbkdf2</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"my super strong password"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _salt</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1000</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HashAlgorithmName</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>SHA256</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>637.5 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>637.5美国 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>561 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>小行星561 B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>554.9 us<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>554.9美元 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.87</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>73 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Other improvements in crypto include avoiding unnecessary zero’ing for padding in symmetric encryption (<a href=https://github.com/dotnet/runtime/pull/52465 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52465</a>); using the span-based support with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IncrementalHash</span><span class=pun>.</span><span class=typ>CreateHMAC</span></code> to avoid some <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> allocations (<a href=https://github.com/dotnet/runtime/pull/43541 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43541</a>); caching failed lookups in addition to successful lookups in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>OidLookup</span><span class=pun>.</span><span class=typ>ToOid</span></code> (<a href=https://github.com/dotnet/runtime/pull/46819 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46819</a>); using stack allocation in signature generation to avoid unnecessary allocation (<a href=https://github.com/dotnet/runtime/pull/46893 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46893</a>); using better OS APIs on macOS for RSA/ECC keys (<a href=https://github.com/dotnet/runtime/pull/52759 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52759</a> from <a href=https://github.com/filipnavara target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@filipnavara</a>); and avoiding closures in the interop layers of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>X509Certificate</span></code>s on both Unix (<a href=https://github.com/dotnet/runtime/pull/50511 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50511</a>) and Windows (<a href=https://github.com/dotnet/runtime/pull/50376 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50376</a>, <a href=https://github.com/dotnet/runtime/pull/50377 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50377</a>). One of my favorites, simply because it eliminates an annoyance I hit now and again, is <a href=https://github.com/dotnet/runtime/pull/53129 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53129</a> from <a href=https://github.com/hrrrrustic target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@hrrrrustic</a>, which adds an implementation of the generic <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> to each of several <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>X509Certificate</span></code>-related collections that previously only implemented the non-generic <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span></code>. This in turn removes the common need to use LINQ’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>OfType</span><span class=pun>&lt;</span><span class=pln>X509Certificate2</span><span class=pun>&gt;</span></code> when enumerating <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>X509CertificateCollection</span></code>, both improving maintainability and reducing overhead.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>密码学中的其他改进包括避免对称加密中填充的不必要的归零（dotnet/runtime#52465）;使用基于跨度的支持与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IncrementalHash</span><span class=pun>.</span><span class=typ>CreateHMAC</span></code> ，以避免一些 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 分配（dotnet/runtime#43541）;除了在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>OidLookup</span><span class=pun>.</span><span class=typ>ToOid</span></code> （dotnet/runtime#46819）中成功的查找之外，还缓存失败的查找;在签名生成中使用堆栈分配以避免不必要的分配（dotnet/runtime#46893）;在macOS上使用更好的OS API来获取RSA/ECC密钥（来自@filipnavara的dotnet/runtime#52759）;并避免Unix（dotnet/runtime#50511）和Windows（dotnet/runtime#50376，dotnet/runtime#50377）上 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>X509Certificate</span></code> 的互操作层中的闭包。我的最爱之一，仅仅是因为它消除了我偶尔遇到的烦恼，是来自@hrrrrustic的dotnet/runtime#53129，它将泛型 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的实现添加到几个与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>X509Certificate</span></code> 相关的集合中的每一个，这些集合以前只实现了非泛型 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IEnumerable</span></code> 。 这反过来又消除了枚举 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>X509CertificateCollection</span></code> 时使用LINQ的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>OfType</span><span class=pun>&lt;</span><span class=pln>X509Certificate2</span><span class=pun>&gt;</span></code> 的常见需求，既提高了可维护性又降低了开销。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> X509Certificate2Collection _certs</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> store </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> X509Store</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>StoreLocation</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CurrentUser</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _certs </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> store</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Certificates</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> s </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> _certs</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>OfType</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>X509Certificate2</span></span><span class=pun><span class=pun>&gt;().</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>c </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Subject</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>foreach</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> s </span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> _certs</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>c </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> c</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Subject</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>63.45 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>63.45纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>160 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B </font></font></font></td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>53.94 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>53.94纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.85</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>128 B</td>
</tr>
</tbody>
</table></div>
<h3 id=peanut-butter data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“Peanut Butter”<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>花生酱 </font></font></font><a aria-labelledby=peanut-butter class=linkicon href=#peanut-butter data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As has been shown in this post and in those that I’ve written for previous versions, there have been literally thousands of PRs into .NET over the last several years to improve its performance. Many of these changes on their own have a profound and very measurable impact to some scenario. However, a fair number of the changes are what we lovingly refer to as “peanut butter”, a thin layer of tiny performance-impacting changes that individually aren’t hugely meaningful but that over time add up to bigger impact. Sometimes these changes make one specific change in one place (e.g. removing one allocation), and it’s the aggregate of all such changes that helps .NET to get better and better. Sometimes it’s a pattern of change applied en mass across the stack. There are dozens of such changes in .NET 6, and I’ll walk through some of them here.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>正如本文和我为以前版本编写的文章所示，在过去几年中，已经有成千上万的PR进入.NET以提高其性能。这些变化中的许多变化本身对某些场景有着深远且非常可衡量的影响。然而，相当多的变化是我们亲切地称之为“花生酱”的，这是一层薄薄的影响性能的微小变化，这些变化单独并没有太大的意义，但随着时间的推移，它们会产生更大的影响。有时候，这些变化会在一个地方产生一个特定的变化（例如：删除一个分配），所有这些更改的集合有助于.NET变得越来越好。有时候，它是一种改变的模式，在整个堆栈中应用。.NET 6中有几十个这样的变化，我将在这里介绍其中的一些。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One of my favorite sets of changes, and a pattern which will hopefully be codified in a future release by an analyzer, shows up in <a href=https://github.com/dotnet/runtime/pull/49958 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49958</a>, <a href=https://github.com/dotnet/runtime/pull/50225 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50225</a>, and <a href=https://github.com/dotnet/runtime/pull/49969 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49969</a>. These PRs changed over 2300 internal and private classes across dotnet/runtime to be sealed. Why does that matter? For some of the types, it won’t, but there are multiple reasons why sealing types can measurably improve performance, and so we’ve adopted a general policy that all non-public types that can be sealed should be, so as to maximize the chances use of these types will simply be better than it otherwise would be.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我最喜欢的一组变化，以及一个希望在未来的版本中被分析器编码的模式，出现在dotnet/runtime#49958、dotnet/runtime#50225和dotnet/runtime#49969中。这些PR改变了超过2300个内部和私有类跨dotnet/runtime被密封。这有什么关系对于某些类型，它不会，但是有很多原因可以说明为什么密封类型可以显著提高性能，因此我们采用了一个通用策略，即所有可以密封的非公共类型都应该是密封的，以便最大限度地提高使用这些类型的机会。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One reason sealing helps is that virtual methods on a sealed type are more likely to be devirtualized by the runtime. If the runtime can see that a given instance on which a virtual call is being made is actually sealed, then it knows for certain what the actual target of the call will be, and it can invoke that target directly rather than doing a virtual dispatch operation. Better yet, once the call is devirtualized, it might be inlineable, and then if it’s inlined, all the previously discussed benefits around optimizing the caller+callee combined kick in.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>密封有帮助的一个原因是密封类型上的虚方法更有可能被运行时去虚拟化。如果运行时可以看到正在进行虚拟调用的给定实例实际上是密封的，那么它肯定地知道调用的实际目标是什么，并且它可以直接调用该目标，而不是执行虚拟调度操作。更好的是，一旦调用被去虚拟化，它可能是可内联的，然后如果它是内联的，前面讨论的优化调用者和被调用者组合的所有好处都将发挥作用。 </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pln><span class=pln> _sealed </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pln><span class=pln> _nonSealed </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _nonSealed</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>M</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>42</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _sealed</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>M</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>42</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BaseType</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>virtual</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> M</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BaseType</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> M</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>sealed</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BaseType</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> M</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>代码大小 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NonSealed<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>非密封 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.9837 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>0.9837纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.000</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>26 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sealed<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>密封 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.0018 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.002</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>12 B</td>
</tr>
</tbody>
</table></div>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NonSealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>40</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       call      qword ptr </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>20</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2A</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>26</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>eax
       mov       eax</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>2C</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>12</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Note the code gen difference. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NonSealed</span><span class=pun>()</span></code> is doing a virtual dispatch (that series of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code> instructions to find the address of the actual method to invoke followed by a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call</span></code>), whereas <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Sealed</span><span class=pun>()</span></code> isn’t calling anything: in fact, it’s been reduced to a null check followed by returning a constant value, as SealedType.M was devirtualized and inlined, at which point the JIT could constant fold the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>2</span><span class=pln> </span><span class=pun>+</span><span class=pln> </span><span class=lit>42</span></code> into just <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>44</span></code> (hex 0x2C). BenchmarkDotNet actually issues a warning (a good warning in this case) about the resulting metrics as a result:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>注意代码生成的差异。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NonSealed</span><span class=pun>()</span></code> 正在执行虚拟分派（一系列 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov</span></code> 指令，用于查找要调用的实际方法的地址，然后是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call</span></code> ），而 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Sealed</span><span class=pun>()</span></code> 没有调用任何东西：事实上，它已经被简化为空检查，然后返回一个常量值，因为SealedType.M被去虚拟化并内联，此时JIT可以将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>2</span><span class=pln> </span><span class=pun>+</span><span class=pln> </span><span class=lit>42</span></code> 常量折叠为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>44</span></code> （十六进制0x2C）。BenchmarkDotNet实际上会发出一个关于结果指标的警告（在这种情况下是一个很好的警告）：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=com><span class=com>// * Warnings *</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>ZeroMeasurement</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sealed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Runtime</span></span><span class=pun><span class=pun>=.</span></span><span class=pln><span class=pln>NET </span></span><span class=lit><span class=lit>6.0</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Toolchain</span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln>net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>The</span></span><span class=pln><span class=pln> method duration </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> indistinguishable </span></span><span class=kwd><span class=kwd>from</span></span><span class=pln><span class=pln> the empty method duration</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In order to measure the cost of a benchmark, it not only times how long it takes to invoke the benchmark but also how long it takes to invoke an empty benchmark with a similar signature, with the results presented subtracting the latter from the former. BenchmarkDotNet is then highlighting that with the method just returning a constant, the benchmark and the empty method are now indistinguishable. Cool.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>为了测量基准测试的成本，它不仅计算调用基准测试所需的时间，还计算调用具有类似签名的空基准测试所需的时间，结果是前者减去后者。BenchmarkDotNet然后强调，由于方法只返回一个常量，基准测试和空方法现在是无法区分的。酷了 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another benefit of sealing is that it can make type checks a lot faster. When you write code like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj </span><span class=kwd>is</span><span class=pln> </span><span class=typ>SomeType</span></code>, there are multiple ways that could be emitted in assembly. If <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> is sealed, then this check can be implemented along the lines of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj </span><span class=kwd>is</span><span class=pln> </span><span class=kwd>not</span><span class=pln> </span><span class=kwd>null</span><span class=pln> </span><span class=pun>&amp;&amp;</span><span class=pln> obj</span><span class=pun>.</span><span class=typ>GetType</span><span class=pun>()</span><span class=pln> </span><span class=pun>==</span><span class=pln> </span><span class=kwd>typeof</span><span class=pun>(</span><span class=typ>SomeType</span><span class=pun>)</span></code>, where the latter clause can be implemented simply by comparing the type handle of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj</span></code> against the known type handle of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code>; after all, if it’s sealed, it’s not possible there could be any type derived from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code>, so there’s no other type than <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> that need be considered. But if <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> isn’t sealed, this check becomes a lot more complicated, needing to determine whether <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj</span></code> is not only <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> but potentially something derived from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code>, which means it needs to examine all of the type’s in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj</span></code>‘s type’s parent hierarchy to see whether any of them are <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code>. There’s enough logic there that it’s actually factored out into a helper method the JIT can emit a call to, the internal <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>CompilerServices</span><span class=pun>.</span><span class=typ>CastHelpers</span><span class=pun>.</span><span class=typ>IsInstanceOfClass</span></code>. We can see this in a benchmark:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>密封的另一个好处是它可以使类型检查快得多。当您编写类似 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj </span><span class=kwd>is</span><span class=pln> </span><span class=typ>SomeType</span></code> 的代码时，有多种方式可以在汇编中发出。如果 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> 是密封的，则该检查可以沿着 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj </span><span class=kwd>is</span><span class=pln> </span><span class=kwd>not</span><span class=pln> </span><span class=kwd>null</span><span class=pln> </span><span class=pun>&amp;&amp;</span><span class=pln> obj</span><span class=pun>.</span><span class=typ>GetType</span><span class=pun>()</span><span class=pln> </span><span class=pun>==</span><span class=pln> </span><span class=kwd>typeof</span><span class=pun>(</span><span class=typ>SomeType</span><span class=pun>)</span></code> 的行来实现，其中后一子句可以简单地通过将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj</span></code> 的类型句柄与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> 的已知类型句柄进行比较来实现;毕竟，如果它是密封的，就不可能有任何类型派生自 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> ，所以除了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> 之外，没有其他类型需要考虑。但是如果 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> 没有被密封，这个检查就变得复杂得多，需要确定 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj</span></code> 是否不仅是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> ，而且可能是从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> 派生的东西，这意味着它需要检查 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>obj</span></code> 的父层次结构中的所有类型，以确定它们中是否有任何一个是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SomeType</span></code> 。这里有足够的逻辑，它实际上被分解成一个帮助器方法，JIT可以发出一个调用，内部的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>CompilerServices</span><span class=pun>.</span><span class=typ>CastHelpers</span><span class=pun>.</span><span class=typ>IsInstanceOfClass</span></code> 。我们可以在基准测试中看到这一点：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>object</span></span><span class=pln><span class=pln> _o </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"hello"</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _o </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _o </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>sealed</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>代码大小 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NonSealed<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>非密封 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.7694 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>37 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sealed<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>密封 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.0749 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.04</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>36 B</td>
</tr>
</tbody>
</table></div>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NonSealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rdx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>offset MT_Program</span></span><span class=pun><span class=pun>+</span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pln><span class=pln>
       call      CORINFO_HELP_ISINSTANCEOFCLASS
       test      rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       setne     al
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>al
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>37</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       mov       rdx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>offset MT_Program</span></span><span class=pun><span class=pun>+</span></span><span class=typ><span class=typ>SealedType</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rdx
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
       xor       eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>eax
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       test      rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       setne     al
       movzx     eax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>al
       ret
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>36</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Note the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NonSealed</span><span class=pun>()</span></code> benchmark is making a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call</span></code> to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>CORINFO_HELP_ISINSTANCEOFCLASS</span></code> helper, whereas <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Sealed</span><span class=pun>()</span></code> is just directly comparing the type handle of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>_o</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov rax</span><span class=pun>,[</span><span class=pln>rcx</span><span class=pun>+</span><span class=lit>8</span><span class=pun>]</span></code>) against the type handle of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SealedType</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov rdx</span><span class=pun>,</span><span class=pln>offset MT_Program</span><span class=pun>+</span><span class=typ>SealedType</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>cmp </span><span class=pun>[</span><span class=pln>rax</span><span class=pun>],</span><span class=pln>rdx</span></code>), and the resulting impact that has on the cost of running this code.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>请注意， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NonSealed</span><span class=pun>()</span></code> 基准测试是对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>CORINFO_HELP_ISINSTANCEOFCLASS</span></code> 助手进行 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call</span></code> ，而 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Sealed</span><span class=pun>()</span></code> 只是直接比较 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>_o</span></code> （ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov rax</span><span class=pun>,[</span><span class=pln>rcx</span><span class=pun>+</span><span class=lit>8</span><span class=pun>]</span></code> ）的类型句柄和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SealedType</span></code> （ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>mov rdx</span><span class=pun>,</span><span class=pln>offset MT_Program</span><span class=pun>+</span><span class=typ>SealedType</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>cmp </span><span class=pun>[</span><span class=pln>rax</span><span class=pun>],</span><span class=pln>rdx</span></code> ）的类型句柄，以及由此产生的对运行此代码的成本的影响。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Yet another benefit here comes when using arrays of types. As has been mentioned, arrays in .NET are covariant, which means if you have a type <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> that derives from type <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code>, and you have an array of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code>s, you can store that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span><span class=pun>[]</span></code> into a reference of type <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span><span class=pun>[]</span></code>. That, however, means the runtime needs to ensure that any <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code> stored into an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span><span class=pun>[]</span></code> is of an appropriate type for the actual array being referenced, e.g. in this case that every <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code> is actually a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> or something derived from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code>. Of course, if the runtime knows that for a given <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span><span class=pun>[]</span></code> the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> being stored couldn’t possibly be anything other than <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> itself, it needn’t employ such a check. How could it know that? For one thing, if <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> is sealed. So given a benchmark like:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这里还有一个好处是使用类型数组。正如前面提到的，.NET中的数组是协变的，这意味着如果你有一个类型 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> 派生自类型 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code> ，你有一个数组 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> ，你可以将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span><span class=pun>[]</span></code> 存储到类型 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span><span class=pun>[]</span></code> 的引用中。然而，这意味着运行时需要确保存储在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span><span class=pun>[]</span></code> 中的任何 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code> 对于被引用的实际数组来说都是适当的类型，例如在这种情况下，每个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code> 实际上都是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> 或从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> 派生的东西。当然，如果运行时知道对于给定的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span><span class=pun>[]</span></code> ，正在存储的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> 不可能是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> 本身之外的任何东西，它就不需要使用这样的检查。它怎么会知道？#13331;，如果是封闭的。因此，给定一个基准，如：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pln><span class=pln> _sealedInstance </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _sealedArray </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pln><span class=pln> _nonSealedInstance </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _nonSealedArray </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>1_000_000</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pln><span class=pln> inst </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _nonSealedInstance</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> arr </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _nonSealedArray</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> arr</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        arr</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> inst</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pln><span class=pln> inst </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _sealedInstance</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> arr </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> _sealedArray</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> arr</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        arr</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> inst</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>sealed</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>we get results like this:</p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NonSealed</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>2.580 ms</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>53 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sealed<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>密封 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.445 ms<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>1.445毫秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.56</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>59 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Beyond arrays, this is also relevant to spans. As previously mentioned, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> is invariant, and its constructor that takes a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span><span class=pun>[]</span></code> prevents you from storing an array of a derived type with a check that validates the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> and the element type of the actual array passed in are the same:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>除了数组，这也与span相关。如前所述， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 是不变的，它的构造函数采用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span><span class=pun>[]</span></code> ，防止你通过检查来存储派生类型的数组，以验证 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> 和传入的实际数组的元素类型是否相同：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(!</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>IsValueType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;&amp;</span></span><span class=pln><span class=pln> array</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetType</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>T</span></span><span class=pun><span class=pun>[]))</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>ThrowHelper</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowArrayTypeMismatchException</span></span><span class=pun><span class=pun>();</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>You get where this is going. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>‘s constructor is aggressively inlined, so the code from the constructor is exposed to the caller, which frequently allows the JIT to know the actual type of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code>; if it then knows that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> is sealed, there’s no way that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>array</span><span class=pun>.</span><span class=typ>GetType</span><span class=pun>()</span><span class=pln> </span><span class=pun>!=</span><span class=pln> </span><span class=kwd>typeof</span><span class=pun>(</span><span class=pln>T</span><span class=pun>[])</span></code>, so it can remove the whole check entirely. A very microbenchmark:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>你知道事情的发展方向。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Span</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的构造函数是主动内联的，因此构造函数中的代码被公开给调用者，这经常允许JIT知道 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> ;如果它知道 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>T</span></code> 是密封的，就不可能知道 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>array</span><span class=pun>.</span><span class=typ>GetType</span><span class=pun>()</span><span class=pln> </span><span class=pun>!=</span><span class=pln> </span><span class=kwd>typeof</span><span class=pun>(</span><span class=pln>T</span><span class=pun>[])</span></code> ，所以它可以完全移除整个支票。一个非常微的基准测试：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _sealedArray </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _nonSealedArray </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Span</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _nonSealedArray</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Span</span></span><span class=pun><span class=pun>&lt;</span></span><span class=typ><span class=typ>SealedType</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _sealedArray</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>sealed</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SealedType</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>highlights this difference:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>突出了这一差异： </font></font></font></p>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Code Size<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>代码大小 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NonSealed<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>非密封 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.2435 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>64 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sealed<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>密封 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.0379 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.16</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>35 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>but it’s most visible in the generated assembly:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>但它在生成的程序集中最为明显： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-assembly prettyprinted"><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NonSealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>sub</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       mov       rcx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>offset MT_Program</span></span><span class=pun><span class=pun>+</span></span><span class=typ><span class=typ>NonSealedType</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln>
       cmp       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rcx
       jne       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L02
       lea       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       r8d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rcx
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>r8d
       mov       rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rdx
       </span></span><span class=kwd><span class=kwd>add</span></span><span class=pln><span class=pln>       rsp</span></span><span class=pun><span class=pun>,</span></span><span class=lit><span class=lit>28</span></span><span class=pln><span class=pln>
       ret
M00_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       xor       r8d</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       jmp       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
M00_L02</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       call      </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowHelper</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ThrowArrayTypeMismatchException</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln>       </span></span><span class=lit><span class=lit>3</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>64</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sealed</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
       mov       rax</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rcx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       test      rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rax
       je        </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L01
       lea       rcx</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
       mov       r8d</span></span><span class=pun><span class=pun>,[</span></span><span class=pln><span class=pln>rax</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
M00_L00</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>rcx
       mov       </span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>rdx</span></span><span class=pun><span class=pun>+</span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln>r8d
       mov       rax</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>rdx
       ret
M00_L01</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
       xor       ecx</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>ecx
       xor       r8d</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>r8d
       jmp       </span></span><span class=kwd><span class=kwd>short</span></span><span class=pln><span class=pln> M00_L00
</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Total</span></span><span class=pln><span class=pln> bytes </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> code </span></span><span class=lit><span class=lit>35</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>where we can see the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call </span><span class=typ>System</span><span class=pun>.</span><span class=typ>ThrowHelper</span><span class=pun>.</span><span class=typ>ThrowArrayTypeMismatchException</span><span class=pun>()</span></code> doesn’t exist in the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Sealed</span><span class=pun>()</span></code> version at all because the check that would lead to it was removed completely.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我们可以看到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>call </span><span class=typ>System</span><span class=pun>.</span><span class=typ>ThrowHelper</span><span class=pun>.</span><span class=typ>ThrowArrayTypeMismatchException</span><span class=pun>()</span></code> 在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Sealed</span><span class=pun>()</span></code> 版本中根本不存在，因为导致它的检查被完全删除了。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/43474 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43474</a> is another example of performing some cleanup operation across a bunch of call sites. The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Buffers</span><span class=pun>.</span><span class=typ>Binary</span><span class=pun>.</span><span class=typ>BinaryPrimitives</span></code> class was introduced in .NET Core 2.1 and has been getting a lot of use with its operations like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReverseEndianness</span><span class=pun>(</span><span class=typ>Int32</span><span class=pun>)</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadInt32BigEndian</span><span class=pun>(</span><span class=typ>ReadOnlySpan</span><span class=pun>&lt;</span><span class=typ>Byte</span><span class=pun>&gt;)</span></code>, but there were a bunch of places in the dotnet/runtime codebase still manually performing such operations when they could have been using these optimized helpers to do it for them. The PR addresses that, nicely changing complicated code like this in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TimeZoneInfo</span></code> on Unix:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#43474是跨一堆调用站点执行一些清理操作的另一个示例。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Buffers</span><span class=pun>.</span><span class=typ>Binary</span><span class=pun>.</span><span class=typ>BinaryPrimitives</span></code> 类是在.NET Core 2.1中引入的，并且已经通过其操作（如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReverseEndianness</span><span class=pun>(</span><span class=typ>Int32</span><span class=pun>)</span></code> 或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadInt32BigEndian</span><span class=pun>(</span><span class=typ>ReadOnlySpan</span><span class=pun>&lt;</span><span class=typ>Byte</span><span class=pun>&gt;)</span></code> ）得到了很多使用，但是在dotnet/runtime代码库中有很多地方仍然手动执行这些操作，而他们本可以使用这些优化的帮助程序来为他们做这些操作。PR解决了这个问题，很好地改变了Unix上 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TimeZoneInfo</span></code> 中的复杂代码：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>unsafe</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TZif_ToInt64</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> startIndex</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>fixed</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> pbyte </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>startIndex</span></span><span class=pun><span class=pun>])</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i1 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>24</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i2 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>24</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>uint</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>i2 </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>long</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>i1 </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>32</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>to instead be this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>而是这样： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TZif_ToInt64</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> startIndex</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> 
    </span></span><span class=typ><span class=typ>BinaryPrimitives</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReadInt64BigEndian</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AsSpan</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>startIndex</span></span><span class=pun><span class=pun>));</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ahhh, so much nicer. Not only is such code simpler, safer, and more readily understandable to a reader, it’s also faster:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>啊，好多了。这样的代码不仅更简单，更安全，更容易被读者理解，而且速度也更快： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>unsafe</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> startIndex</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>fixed</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> pbyte </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>[</span></span><span class=pln><span class=pln>startIndex</span></span><span class=pun><span class=pun>])</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i1 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>24</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>3</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i2 </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>4</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>24</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>5</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>16</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>8</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*(</span></span><span class=pln><span class=pln>pbyte </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>7</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>uint</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>i2 </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>long</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>i1 </span></span><span class=pun><span class=pun>&lt;&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>32</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> startIndex</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>BinaryPrimitives</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ReadInt64BigEndian</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AsSpan</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>startIndex</span></span><span class=pun><span class=pun>));</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean</th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio</th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.9856 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.3853 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.19</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another example of such a cleanup is <a href=https://github.com/dotnet/runtime/pull/54004 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54004</a>, which changes several <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>{</span><span class=pln>U</span><span class=pun>}</span><span class=typ>Int32</span><span class=pun>/</span><span class=lit>64.TryParse</span></code> call sites to explicitly use <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CultureInfo</span><span class=pun>.</span><span class=typ>InvariantCulture</span></code> instead of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>null</span></code>. Passing in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>null</span></code> will cause the implementation to access <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CultureInfo</span><span class=pun>.</span><span class=typ>CurrentCulture</span></code>, which incurs a thread-local storage access, but all of the changed call sites use <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NumberStyles</span><span class=pun>.</span><span class=kwd>None</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NumberStyles</span><span class=pun>.</span><span class=typ>Hex</span></code>. The only reason the culture is required for parsing is to be able to parse a positive or negative symbol, but with these styles set, the implementation won’t actually use those symbol values, and thus the actual culture utilized doesn’t matter. Passing in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>InvariantCulture</span></code> then means we’re paying only for a static field access rather than a thread-static field access. Beyond this, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryParse</span></code> also improved for hexadecimal inputs, thanks to <a href=https://github.com/dotnet/runtime/pull/52470 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52470</a>, which changed an internal routine used to determine whether a character is valid hex, making it branchless (which makes its performance consistent regardless of inputs or branch prediction) and removing the dependency on a lookup table. Corresponding functionality on <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Utf8Parser</span></code> also improved. Whereas a method like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Int32</span><span class=pun>.</span><span class=typ>TryParse</span></code> parses data from a sequence of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span></code>s (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code>), <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Utf8Parser</span><span class=pun>.</span><span class=typ>TryParse</span></code> parses data from a sequence of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span></code>s (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code>) interpreted as UTF8 data. <a href=https://github.com/dotnet/runtime/pull/52423 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52423</a> also improved the performance of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryParse</span></code> for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>long</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ulong</span></code> values. This is another good example of an optimization tradeoff: the tweaks employed here benefit most values but end up slightly penalizing extreme values.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这样的清理的另一个例子是dotnet/runtime#54004，它将几个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>{</span><span class=pln>U</span><span class=pun>}</span><span class=typ>Int32</span><span class=pun>/</span><span class=lit>64.TryParse</span></code> 调用站点更改为显式使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CultureInfo</span><span class=pun>.</span><span class=typ>InvariantCulture</span></code> 而不是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>null</span></code> 。传入 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>null</span></code> 将导致实现访问 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CultureInfo</span><span class=pun>.</span><span class=typ>CurrentCulture</span></code> ，这将导致线程本地存储访问，但所有更改的调用站点都使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NumberStyles</span><span class=pun>.</span><span class=kwd>None</span></code> 或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>NumberStyles</span><span class=pun>.</span><span class=typ>Hex</span></code> 。解析需要区域性的唯一原因是能够解析正符号或负符号，但是设置了这些样式后，实现实际上不会使用这些符号值，因此实际使用的区域性并不重要。传入 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>InvariantCulture</span></code> 意味着我们只为静态字段访问付费，而不是线程静态字段访问付费。除此之外， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryParse</span></code> 还改进了十六进制输入，这要归功于dotnet/runtime#52470，它改变了用于确定字符是否为有效十六进制的内部例程，使其具有无分支（这使得其性能与输入或分支预测无关），并消除了对查找表的依赖。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Utf8Parser</span></code> 的相应功能也得到了改进。而类似 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Int32</span><span class=pun>.</span><span class=typ>TryParse</span></code> 的方法解析来自 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span></code> 序列的数据（例如， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code> ）， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Utf8Parser</span><span class=pun>.</span><span class=typ>TryParse</span></code> 解析来自 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span></code> 序列的数据（例如， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code> ）。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> ）解释为UTF8数据。dotnet/runtime#52423还提高了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TryParse</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>long</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ulong</span></code> 值的性能。这是优化权衡的另一个很好的例子：这里所采用的调整有利于大多数值，但最终会略微损害极值。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> _buffer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>10</span></span><span class=pun><span class=pun>];</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Utf8Formatter</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>TryFormat</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>12345L</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> _</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TryParseInt64</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Utf8Parser</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>TryParse</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_buffer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>long</span></span><span class=pln><span class=pln> _</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>out</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> _</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>TryParseInt64</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Framework 4.8</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>26.490 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>26.490纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>TryParseInt64</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>7.724 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>7.724纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.29</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>TryParseInt64</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>6.552 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>6.552纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.25</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Then there’s <a href=https://github.com/dotnet/runtime/pull/51190 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51190</a>, which recognizes that, at a very low-level, when extending a 32-bit value in a 64-bit process to be native word size, it’s ever so slightly more efficient from a codegen perspective to zero-extend rather than sign-extend; if the code is happening on a path where those are identical (i.e. we know by construction we don’t have negative values), on a really hot path it can be beneficial to change.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然后是dotnet/runtime#51190，它认识到，在一个非常低的层次上，当将64位进程中的32位值扩展为原生字长时，从codegen的角度来看，零扩展比符号扩展更有效率;如果代码发生在那些相同的路径上（即，我们知道通过构造我们没有负值），在一个非常热的路径上，改变可能是有益的。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Along with the new and improved support for interpolated strings, a lot of cleanup across dotnet/runtime was also done with regards to string formatting. <a href=https://github.com/dotnet/runtime/pull/50267 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50267</a>, <a href=https://github.com/dotnet/runtime/pull/55738 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55738</a>, <a href=https://github.com/dotnet/runtime/pull/44765 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44765</a>, <a href=https://github.com/dotnet/runtime/pull/44746 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44746</a>, and <a href=https://github.com/dotnet/runtime/pull/55831 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55831</a> all updated code to use better mechanisms. <a href=https://github.com/dotnet/runtime/pull/51653/commits/91f39e2c545b853ced0bfae08653c89381b32c42 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#commits/91f39e</a> alone updated over 3000 lines of string-formatting related code. Some of these changes are to use string interpolation where it wasn’t used before due to knowledge of the performance implications; for example, there’s code to read the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>status</span></code> file in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>procfs</span></code> on Linux, and that needs to compose the path to the file to use. Previously that code was:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>沿着对插值字符串的新的和改进的支持外，在dotnet/runtime上也进行了大量的清理工作。dotnet/runtime#50267、dotnet/runtime#55738、dotnet/runtime#44765、dotnet/runtime#44746和dotnet/runtime#55831都更新了代码以使用更好的机制。dotnet/runtime#commits/91 f39 e单独更新了超过3000行字符串格式化相关代码。其中一些变化是在以前由于了解性能影响而没有使用字符串插值的地方使用;例如，在Linux上有读取 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>procfs</span></code> 中的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>status</span></code> 文件的代码，这需要编写文件的路径来使用。以前的代码是：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>internal</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetStatusFilePathForProcess</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> pid</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>RootPath</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> pid</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>ToString</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>CultureInfo</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InvariantCulture</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>StatusFileName</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which ends up first creating a string from the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pln> pid</span></code>, and then doing a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Concat</span></code> on the resulting strings. Now, it’s:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>它最终首先从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span><span class=pln> pid</span></code> 创建一个字符串，然后对生成的字符串执行 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>String</span><span class=pun>.</span><span class=typ>Concat</span></code> 。现在，它是：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>internal</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetStatusFilePathForProcess</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> pid</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Create</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>stackalloc</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>char</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>256</span></span><span class=pun><span class=pun>],</span></span><span class=pln><span class=pln> $</span></span><span class=str><span class=str>"{RootPath}{(uint)pid}{MapsFileName}"</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which takes advantage of the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Create</span></code> overload that works with interpolated strings and enables doing the interpolation using stack-allocated buffer space. Also note the lack of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CultureInfo</span><span class=pun>.</span><span class=typ>InvariantCulture</span></code> call; that’s because when formatting an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code>, the culture is only needed if the number is negative and would require looking up the negative sign symbol for the relevant culture, but here we know that process IDs are never negative, making the culture irrelevant. As a bonus, the implementation casts the known non-negative value to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>uint</span></code>, which is slightly faster to format than <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code>, exactly because we needn’t check for a sign.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>其利用了新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Create</span></code> 重载，该重载与内插字符串一起工作，并且使得能够使用堆栈分配的缓冲器空间进行内插。还请注意缺少 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CultureInfo</span><span class=pun>.</span><span class=typ>InvariantCulture</span></code> 调用;这是因为在格式化 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> 时，只有当数字为负数时才需要区域性，并且需要查找相关区域性的负号符号，但在这里我们知道进程ID从来都不是负数，这使得区域性变得无关紧要。作为奖励，实现将已知的非负值转换为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>uint</span></code> ，这比 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>int</span></code> 格式稍微快一点，正是因为我们不需要检查符号。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another pattern of cleanup in those PRs was avoiding creating strings in places spans would suffice. For example, this code from Microsoft.CSharp.dll:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在这些PR中的另一种清理模式是避免在span就足够的地方创建字符串。例如，Microsoft.CSharp.dll中的以下代码： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> arity </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Parse</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>t</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Name</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Substring</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"VariantArray"</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CultureInfo</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InvariantCulture</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>was replaced by:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> arity </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Parse</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>t</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Name</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AsSpan</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"VariantArray"</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> provider</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>CultureInfo</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>InvariantCulture</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>avoiding the intermediate string allocation. Or this code from System.Private.Xml.dll:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Substring</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"INF"</span></span><span class=pun><span class=pun>)</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which was replaced by:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>s</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AsSpan</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>i</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>SequenceEqual</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"INF"</span></span><span class=pun><span class=pun>))</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another pattern is using something other than <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Format</span></code> when the power of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Format</span></code> is unwarranted. For example, this code existed in Microsoft.Extensions.FileSystemGlobbing:</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"{0}/{1}"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> left</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> right</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>where both <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>left</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>right</span></code> are strings. This is forcing the system to parse the composite format string and incur all the associated overhead, when at the end of the day this can be a simple concat operation, which the C# compiler will employ for an interpolated string when all the parts are strings and there are sufficiently few to enable using one of the non-params-array <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Concat</span></code> overloads:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>left</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>right</span></code> 都是字符串。这迫使系统解析复合格式字符串并招致所有相关的开销，当一天结束时，这可能是一个简单的concat操作，当所有部分都是字符串并且有足够少的部分来启用使用非params-array <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Concat</span></code> 重载之一时，C#编译器将使用该操作来处理插值字符串：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> $</span></span><span class=str><span class=str>"{left}/{right}"</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>We can see that difference with a simple benchmark:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我们可以通过一个简单的基准测试来看到这种差异： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> _left </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"hello"</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> _right </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"world"</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Format</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"{0}/{1}"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _left</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _right</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Interpolated</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> $</span></span><span class=str><span class=str>"{_left}/{_right}"</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Format<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>格式 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>58.74 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>58.74纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Interpolated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>内插 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>14.73 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>14.73纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.25</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48 B</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6 also continues the trend of exposing more span-based APIs for things that would otherwise result in creating strings or arrays. For example, <a href=https://github.com/dotnet/runtime/pull/57357 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#57357</a> adds a new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueSpan</span></code> property to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Capture</span></code> class in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>RegularExpressions</span></code> (to go along with the string-returning <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Value</span></code> property that’s already there). That means code can now extract a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code> for a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Match</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Group</span></code>, or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Capture</span></code> rather than having to allocate a string to determine what matched.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET 6还延续了公开更多基于跨度的API的趋势，否则会导致创建字符串或数组。例如，dotnet/runtime#57357向 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>RegularExpressions</span></code> 中的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Capture</span></code> 类添加了一个新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueSpan</span></code> 属性（与已经存在的返回字符串的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Value</span></code> 属性沿着使用）。这意味着代码现在可以为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Match</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Group</span></code> 或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Capture</span></code> 提取 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;char&gt;</span></code> ，而不必分配字符串来确定匹配的内容。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Then there are the plethora of changes that remove an array or boxing allocation here, an unnecessary LINQ query there, and so on. For example:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然后，这里会有过多的更改，删除数组或装箱分配，那里会有不必要的LINQ查询，等等。举例来说： </font></font></font></p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/56207 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56207</a> from <a href=https://github.com/teo-tsirpanis target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@teo-tsirpanis</a> removed ~50 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> allocations from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Reflection</span><span class=pun>.</span><span class=typ>MetadataLoadContext</span></code>, by changing some static readonly <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> fields to instead be <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> properties, taking advantage of the C# compiler’s ability to store constant data used in this capacity in a very efficient manner.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#56207 from @teo-tsirpanis从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Reflection</span><span class=pun>.</span><span class=typ>MetadataLoadContext</span></code> 中删除了约50个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 分配，通过将一些静态只读 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 字段改为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> 属性，利用C#编译器以非常有效的方式存储在此容量中使用的常量数据的能力。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/55652 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55652</a> removed a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>[]</span></code> allocation from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Xml</span><span class=pun>.</span><span class=typ>UniqueId</span><span class=pun>.</span><span class=typ>ToString</span><span class=pun>()</span></code>, replacing the use of a temporary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=kwd>char</span><span class=pun>[</span><span class=pln>length</span><span class=pun>]</span></code> followed by a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=kwd>string</span><span class=pun>(</span><span class=pln>charArray</span><span class=pun>)</span></code> to instead use a call to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Create</span></code> that was able to populate the string instance directly.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#55652从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Xml</span><span class=pun>.</span><span class=typ>UniqueId</span><span class=pun>.</span><span class=typ>ToString</span><span class=pun>()</span></code> 中删除了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>[]</span></code> 分配，取代了使用临时的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=kwd>char</span><span class=pun>[</span><span class=pln>length</span><span class=pun>]</span></code> ，然后是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>new</span><span class=pln> </span><span class=kwd>string</span><span class=pun>(</span><span class=pln>charArray</span><span class=pun>)</span></code> ，而是使用对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Create</span></code> 的调用，该调用能够直接填充字符串实例。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/49485 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49485</a> and <a href=https://github.com/dotnet/runtime/pull/49488 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49488</a> removed <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code> allocations, where a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code> was being allocated and then appended to multiple times, to instead use a single call to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Join</span></code> (which has a much more optimized implementation), making the code both simpler and faster. These also included a few changes where <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code>s were being allocated and then just a handful of appends were always being performed, when a simple <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Concat</span></code> would suffice.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#49485和dotnet/runtime#49488删除了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code> 分配，其中 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code> 被分配，然后被附加到多次，而是使用对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Join</span></code> 的单个调用（其具有更优化的实现），使代码更简单，更快。这些还包括一些更改，其中分配了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StringBuilder</span></code> ，然后总是执行一些附加，当一个简单的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span><span class=pun>.</span><span class=typ>Concat</span></code> 就足够了。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50483 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50483</a> avoided a closure and delegate allocation in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>ComponentModel</span><span class=pun>.</span><span class=typ>Annotations</span></code> by minimizing the scope of the data being closed over.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#50483通过最小化被关闭的数据范围，避免了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>ComponentModel</span><span class=pun>.</span><span class=typ>Annotations</span></code> 中的闭包和委托分配。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50502 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50502</a> avoided a closure and delegate allocation in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ClientWebSocket</span><span class=pun>.</span><span class=typ>ConnectAsync</span></code> by open-coding a loop rather than using using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Find</span></code> with a lambda that captured surrounding state.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#50502通过开放编码循环，而不是使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Find</span></code> 与捕获周围状态的lambda一起使用，避免了在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ClientWebSocket</span><span class=pun>.</span><span class=typ>ConnectAsync</span></code> 中的闭包和委托分配。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50512 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50512</a> avoided a closure and delegate in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Regex</span></code> that slipped in due to using a captured local rather than the exact same state that was already being passed into the lambda. These kinds of issues are easy to miss, and they’re one of the reasons I love being able to add <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span></code> to lambdas, to ensure they’re not closing over anything unexpectedly.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#50512避免了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Regex</span></code> 中的闭包和委托，因为使用了捕获的本地状态，而不是已经传递到lambda中的完全相同的状态。这类问题很容易被忽略，这也是我喜欢在lambdas中添加 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span></code> 的原因之一，以确保它们不会意外地关闭任何东西。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50496 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50496</a> and <a href=https://github.com/dotnet/runtime/pull/50387 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50387</a> avoided closure and delegate allocations in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Diagnostics</span><span class=pun>.</span><span class=typ>Process</span></code>, by being more deliberate about how state is passed around.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#50496和dotnet/runtime#50387避免了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Diagnostics</span><span class=pun>.</span><span class=typ>Process</span></code> 中的闭包和委托分配，因为它们对状态的传递方式更加谨慎。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/50357 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50357</a> avoided a closure and delegate allocation in the polling mechanism employed by <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DiagnosticCounter</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#50357避免了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DiagnosticCounter</span></code> 使用的轮询机制中的闭包和委托分配。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/54621 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54621</a> avoided cloning an immutable <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Version</span></code> object. The original instance could be used just as easily; the only downside would be if someone was depending on object identity here for some reason, of which there’s very low risk.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#54621避免克隆一个不可变的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Version</span></code> 对象。原来的副本，也同样可以用。唯一的缺点是，如果有人出于某种原因依赖于对象身份，风险很低。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/51119 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51119</a> fixed <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DispatchProxyGenerator</span></code>, which was almost humorously cloning an array from another array just to get the new array’s length… when it could have just used the original array’s length.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#51119修复了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DispatchProxyGenerator</span></code> ，这几乎是幽默地从另一个数组克隆一个数组，只是为了获得新数组的长度......而它本可以使用原始数组的长度。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/47473 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47473</a> is more complicated than some of these other PRs, but it removed the need for an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>OrderedDictionary</span></code> (which itself creates an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayList</span></code> and a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Hashtable</span></code>) in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TypeDescriptor</span><span class=pun>.</span><span class=typ>GetAttributes</span></code>, instead using a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> and a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> directly.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#47473比其他PR更复杂，但它消除了在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TypeDescriptor</span><span class=pun>.</span><span class=typ>GetAttributes</span></code> 中使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>OrderedDictionary</span></code> （它本身创建了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ArrayList</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Hashtable</span></code> ）的需要，而是直接使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>HashSet</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/44495 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44495</a> changed <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StreamWriter</span></code>‘s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> buffer to be lazily allocated. For scenarios where only small payloads are written synchronously, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> may never be needed.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#44495将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>StreamWriter</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 缓冲区更改为延迟分配。对于只同步写入小负载的场景，可能永远不需要 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>[]</span></code> 。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/46455 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46455</a> is fun, and a holdover from where this code originated in the .NET Framework. The PR deletes a bunch of code, including the preallocation of a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadAbortException</span></code> that could be used by the system should one ever be needed and the system is too low on memory to allocate one. That might have been useful, if thread aborts were still a thing. Which they’re not. Goodbye.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#46455很有趣，也是.NET Framework中这段代码起源的延续。PR删除了一堆代码，包括预先分配的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ThreadAbortException</span></code> ，如果系统需要一个代码，并且系统内存太少而无法分配一个代码。如果线程中止仍然存在的话，这可能会很有用。但他们不是。再见</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/47453 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47453</a>. Enumerating a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Hashtable</span></code> using a standard <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>foreach</span></code>, even if all of the keys and values are reference types, still incurs an allocation per iteration, as the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DictionaryEntry</span></code> struct yielded for each iteration gets boxed. To avoid this, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Hashtable</span></code>‘s enumerator implemented <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IDictionaryEnumerable</span></code>, which provides strongly-typed access to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DictionaryEntry</span></code> and enables direct use of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MoveNext</span></code>/<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Entry</span></code> to avoid that allocation. This PR takes advantage of that to avoid a bunch of boxing allocations as part of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EnvironmentVariablesConfigurationProvider</span><span class=pun>.</span><span class=typ>Load</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#47453。使用标准的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>foreach</span></code> 枚举 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Hashtable</span></code> ，即使所有的键和值都是引用类型，仍然会导致每次迭代的分配，因为为每个迭代生成的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DictionaryEntry</span></code> 结构被装箱。为了避免这种情况， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Hashtable</span></code> 的枚举器实现了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IDictionaryEnumerable</span></code> ，它提供了对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DictionaryEntry</span></code> 的强类型访问，并允许直接使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MoveNext</span></code> / <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Entry</span></code> 来避免这种分配。这个PR利用了这一点，以避免作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EnvironmentVariablesConfigurationProvider</span><span class=pun>.</span><span class=typ>Load</span></code> 的一部分的一堆装箱分配。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/49883 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49883</a>. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Lazy</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> is one of those types that’s valuable when used correctly, but that’s also easy to overuse. Creating a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Lazy</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> involves at least one if not multiple allocations beyond the cost of whatever’s being lazily-created, plus a delegate invocation to create the thing. But sometimes the double-checked locking you get by default is overkill, and all you really need is an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>CompareExchange</span></code> to provide simple and efficient optimistic concurrency. This PR avoids a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Lazy</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> for just such a case in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UnnamedOptionsManager</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#49883。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Lazy</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 是一种在正确使用时很有价值的类型，但也容易过度使用。创建一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Lazy</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 涉及至少一个（如果不是多个）分配，超出了懒惰创建的任何东西的成本，加上一个委托调用来创建东西。但有时候，默认情况下的双重检查锁定会显得有些矫枉过正，而您真正需要的只是一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>CompareExchange</span></code> 来提供简单有效的乐观并发。此PR避免了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Lazy</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 中的这种情况下的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>UnnamedOptionsManager</span></code> 。</font></font></font></li>
</ul>
<h3 id=json data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JSON<a aria-labelledby=json class=linkicon href=#json data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code> was <a href=https://devblogs.microsoft.com/dotnet/try-the-new-system-text-json-apis/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>introduced in .NET Core 3.0</a> with performance as a primary goal. .NET 5 delivered an enhanced version of the library, providing <a href=https://devblogs.microsoft.com/dotnet/whats-next-for-system-text-json/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>new APIs and even better performance</a>, and .NET 6 continues that trend.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code> 是在.NET Core 3.0中引入的，性能是主要目标。.NET 5提供了该库的增强版本，提供了新的API和更好的性能，而.NET 6则延续了这一趋势。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There have been multiple PRs in .NET 6 to improve the performance of different aspects of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code>. <a href=https://github.com/dotnet/runtime/pull/46460 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46460</a> from <a href=https://github.com/lezzi target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@lezzi</a> is a small but valuable change that avoids boxing every key in a dictionary with a value type <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TKey</span></code>. <a href=https://github.com/dotnet/runtime/pull/51367 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51367</a> from <a href=https://github.com/devsko target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@devsko</a> makes serializing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span></code>s faster by reducing the cost of trimming off ending <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0</span></code>s. And <a href=https://github.com/dotnet/runtime/pull/55350 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55350</a> from <a href=https://github.com/CodeBlanch target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@CodeBlanch</a> cleans up a bunch of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>stackalloc</span></code> usage in the library, including changing a bunch of call sites from using a variable to instead using a constant, the latter of which the JIT can better optimize.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在.NET 6中有多个PR来提高 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code> 不同方面的性能。@lezzi的dotnet/runtime#46460是一个小但有价值的改变，避免了将值类型 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TKey</span></code> 的字典中的每个键装箱。来自@devsko的dotnet/runtime#51367通过减少修剪结束 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>0</span></code> s的成本，使序列化 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span></code> s更快。来自@CodeBlanch的dotnet/runtime#55350清理了库中的一堆 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>stackalloc</span></code> 用法，包括将一堆调用站点从使用变量改为使用常量，后者可以更好地优化。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>But arguably the biggest performance improvement in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code> in .NET 6 comes from source generation. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> needs information about the types it’s serializing to know what what to serialize and how to serialize it. It retrieves that data via reflection, examining for example what properties are exposed on a type and whether there are any customization attributes applied. But reflection is relatively expensive, and certainly not something you’d want to do every time you serialized an instance of a type, so <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> caches that information. That cached information may include, for example, delegates used to access the properties on an instance in order to retrieve the data that needs to be serialized. Depending on how the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> is configured, that delegate might use reflection to invoke the property, or if the system permits it, it might point to specialized code emitted via reflection emit. Unfortunately, both of those techniques have potential downsides. Gathering all of this data, and potentially doing this reflection emit work, at run-time has a cost, and it can measurably impact both the startup performance and the working set of an application. It also leads to increased size, as all of the code necessary to enable this (including support for reflection emit itself) needs to be kept around just in case the serializer needs it. The new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code> source generator introduced in .NET 6 addresses this.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>但可以说，.NET 6中 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code> 最大的性能改进来自源代码生成。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> 需要关于它正在序列化的类型的信息，以知道序列化什么以及如何序列化它。它通过反射检索数据，例如检查类型上公开了哪些属性，以及是否应用了任何自定义属性。但是反射是相对昂贵的，并且肯定不是每次序列化类型的实例时都想做的事情，所以 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> 缓存该信息。该高速缓存的信息可以包括例如用于访问实例上的属性以便检索需要被序列化的数据的委托。根据 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> 的配置方式，委托可能使用反射来调用属性，或者如果系统允许，它可能指向通过反射发出的专用代码。不幸的是，这两种技术都有潜在的缺点。 在运行时收集所有这些数据并潜在地执行反射发出工作是有成本的，并且它可以显著地影响应用程序的启动性能和工作集。这也会导致大小的增加，因为启用此功能所需的所有代码（包括对反射发出本身的支持）都需要保留，以防序列化器需要它。在.NET 6中引入的新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code> 源代码生成器解决了这个问题。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Generating source during a build is nothing new; these techniques have been used in and out of the .NET ecosystem for decades. What is new, however, is the C# compiler making the capability a first-class feature, and core libraries in .NET taking advantage of it. Just as the compiler allows for <a href=https://docs.microsoft.com/visualstudio/extensibility/getting-started-with-roslyn-analyzers target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>analyzers</a> to be plugged into a build to add custom analysis as part of the compiler’s execution (with the compiler giving the analyzer access to all of the syntactical and semantic data it gathers and creates), the compiler now also enables a <a href=https://docs.microsoft.com/dotnet/csharp/roslyn-sdk/source-generators-overview target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>source generator</a> to access the same information and then spit out additional C# code that’s incorporated into the same compilation unit. This makes it very attractive for doing certain operations at compile-time that code may have been doing previously via reflection and reflection emit at run-time… like analyzing types as part of a serializer in order to generate fast member accessors.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在构建期间生成源代码并不是什么新鲜事;这些技术已经在.NET生态系统内外使用了几十年。然而，新的是C#编译器使该功能成为一流的特性，并且.NET中的核心库利用了它。正如编译器允许将分析器插入到构建中以添加自定义分析作为编译器执行的一部分（编译器允许分析器访问其收集和创建的所有语法和语义数据），编译器现在也允许源代码生成器访问相同的信息，然后吐出合并到相同编译单元中的附加C#代码。这使得在编译时执行某些操作非常有吸引力，而代码之前可能已经通过反射和反射在运行时发出……就像分析作为串行化器的一部分的类型以生成快速成员访问器。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/51149 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51149</a>, <a href=https://github.com/dotnet/runtime/pull/51300 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51300</a>, and <a href=https://github.com/dotnet/runtime/pull/51528 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51528</a> introduce a new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span><span class=pun>.</span><span class=typ>SourceGeneration</span></code> component, included as part of the .NET 6 SDK. I create a new app, and I can see in Visual Studio the generator is automatically included:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#51149、dotnet/runtime#51300和dotnet/runtime#51528引入了一个新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span><span class=pun>.</span><span class=typ>SourceGeneration</span></code> 组件，作为.NET 6 SDK的一部分。我创建了一个新的应用程序，我可以看到在Visual Studio中自动包含了生成器：</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=lightbox-link aria-label="Lightbox image, click or press enter to enlarge" href=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/JsonSourceGeneratorSolutionExplorer.png data-featherlight=image data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img decoding=async fetchpriority=high class="alignnone lazyloaded" data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/JsonSourceGeneratorSolutionExplorer.png src=data:image/png;base64,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 alt="Visual Studio Solution Explorer showing JSON source generator" width=682 height=406 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></a></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Then I can add this to my program:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然后我可以把它添加到我的程序中： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Json</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Json</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Serialization</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>namespace</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>JsonExample</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Main</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>JsonSerializer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Serialize</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Console</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>OpenStandardOutput</span></span><span class=pun><span class=pun>(),</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Title</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>".NET 6 Performance"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Author</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"Me"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PublicationYear</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2021</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>},</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MyJsonContext</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>internal</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Title</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Author</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PublicationYear</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>JsonSerializable</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>typeof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>))]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>internal</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>partial</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MyJsonContext</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>JsonSerializerContext</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Over what I might have written in the past, note the addition of the partial <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MyJsonContext</span></code> class (the name here doesn’t matter) and the additional <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MyJsonContext</span><span class=pun>.</span><span class=typ>Default</span><span class=pun>.</span><span class=typ>BlogPost</span></code> argument to JsonSerializer.Serialize. As you’d expect, when I run it, I get this output:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在我过去可能写过的内容中，请注意添加了部分 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MyJsonContext</span></code> 类（这里的名称无关紧要）和JsonSerializer.Serialize的附加 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MyJsonContext</span><span class=pun>.</span><span class=typ>Default</span><span class=pun>.</span><span class=typ>BlogPost</span></code> 参数。正如您所料，当我运行它时，我得到了以下输出：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>{</span></span><span class=str><span class=str>"Title"</span></span><span class=pun><span class=pun>:</span></span><span class=str><span class=str>".NET 6 Performance"</span></span><span class=pun><span class=pun>,</span></span><span class=str><span class=str>"Author"</span></span><span class=pun><span class=pun>:</span></span><span class=str><span class=str>"Me"</span></span><span class=pun><span class=pun>,</span></span><span class=str><span class=str>"PublicationYear"</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>What’s interesting, however, is what happened behind the scenes. If you look again at Solution Explorer, you’ll see a bunch of code the JSON source generator output:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然而，有趣的是幕后发生了什么。如果您再次查看解决方案资源管理器，您会看到JSON源代码生成器输出的一堆代码： </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=lightbox-link aria-label="Lightbox image, click or press enter to enlarge" href=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/JsonSourceGeneratorSolutionExplorer_Populated.png data-featherlight=image data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img decoding=async class="alignnone lazyloaded" data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/JsonSourceGeneratorSolutionExplorer_Populated.png src="data:image/png;base64,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" alt="Generated JSON files" width=678 height=571 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></a></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Those files essentially contain all of the glue code reflection and reflection emit would have generated, including lines like:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这些文件基本上包含反射和反射发出将生成的所有粘合代码，包括以下行： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pln><span class=pln>getter</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>obj</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>global</span></span><span class=pun><span class=pun>::</span></span><span class=typ><span class=typ>JsonExample</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>obj</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Title</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln>
setter</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>obj</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>global</span></span><span class=pun><span class=pun>::</span></span><span class=typ><span class=typ>JsonExample</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>obj</span></span><span class=pun><span class=pun>).</span></span><span class=typ><span class=typ>Title</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>,</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>highlighting the property accessor delegates being generated as part of source generation. The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> is then able to use these delegates just as it’s able to use ones that use reflection or that were generated via reflection emit.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>突出显示作为源代码生成的一部分生成的属性访问器委托。然后 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> 能够使用这些委托，就像它能够使用使用反射或通过反射发出生成的委托一样。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As long as the source generator is spitting out all this code for doing at compile-time what was previously done at run-time, it can take things a step further. If I were writing my own serializer customized specifically for my <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BlogPost</span></code> class, I wouldn’t use all this indirection… I’d just use a writer directly and write out each property, e.g.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>只要源代码生成器在编译时生成所有这些代码，以完成以前在运行时完成的工作，它就可以更进一步。如果我正在为我的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BlogPost</span></code> 类定制自己的序列化器，我不会使用所有这些间接......我会直接使用一个writer并写出每个属性，例如。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Json</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Json</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Serialization</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>namespace</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>JsonExample</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Program</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Main</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> writer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Utf8JsonWriter</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Console</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>OpenStandardOutput</span></span><span class=pun><span class=pun>());</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>BlogPostSerialize</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>writer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Title</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>".NET 6 Performance"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Author</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"Me"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PublicationYear</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2021</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>});</span></span><span class=pln><span class=pln>
        writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Flush</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPostSerialize</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Utf8JsonWriter</span></span><span class=pln><span class=pln> writer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteStartObject</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
        writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteString</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nameof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Title</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Title</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteString</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nameof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Author</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Author</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteNumber</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nameof</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PublicationYear</span></span><span class=pun><span class=pun>),</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PublicationYear</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteEndObject</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>internal</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Title</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Author</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PublicationYear</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>get</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>set</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There’s no reason the source generator shouldn’t be able to output such a streamlined implementation. And as of <a href=https://github.com/dotnet/runtime/pull/53212 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53212</a>, it can. The generated code contains this method on the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MyJsonContext</span></code> class:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>源代码生成器没有理由不能输出这样一个精简的实现。在dotnet/runtime#53212中，它可以。生成的代码在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MyJsonContext</span></code> 类上包含以下方法：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPostSerialize</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>global</span></span><span class=pun><span class=pun>::</span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Json</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Utf8JsonWriter</span></span><span class=pln><span class=pln> writer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>global</span></span><span class=pun><span class=pun>::</span></span><span class=typ><span class=typ>Benchmarks</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>value</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteNullValue</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteStartObject</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteString</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>TitlePropName</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Title</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteString</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>AuthorPropName</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Author</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteNumber</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>PublicationYearPropName</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>value</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PublicationYear</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteEndObject</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Looks familiar. Note, too, that the design of this fast path code enables the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> to use it as well: if the serializer is passed a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializerContext</span></code> that has a fast-path delegate, it’ll use it, which means code only needs to explicitly call the fast-path if it really wants to eke out the last mile of performance.</p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Utf8JsonWriter</span></span><span class=pln><span class=pln> _writer </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Utf8JsonWriter</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Stream</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Null</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pln><span class=pln> _blogPost </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Title</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>".NET 6 Performance"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Author</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"Me"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PublicationYear</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2021</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>};</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>JsonSerializerWithoutFastPath</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Reset</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>JsonSerializer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Serialize</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_writer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _blogPost</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Flush</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>JsonSerializerWithFastPath</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Reset</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>JsonSerializer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Serialize</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_writer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _blogPost</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MyJsonContext</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Flush</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>DirectFastPath</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    _writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Reset</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>MyJsonContext</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Default</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BlogPost</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Serialize</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_writer</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> _blogPost</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    _writer</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Flush</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JsonSerializerWithoutFastPath</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>239.9 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>239.9纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>JsonSerializerWithFastPath</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>150.9 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.63</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>DirectFastPath</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>134.9 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>134.9纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.56</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>–</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The impact of these improvements can be quite meaningful. <a href=https://github.com/aspnet/Benchmarks/pull/1683#issuecomment-864841394 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>aspnet/Benchmarks#1683</a> is a good example. It updates the ASP.NET implementation of the <a href=https://www.techempower.com/benchmarks/ target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>TechEmpower caching benchmark</a> to use the JSON source generator. Previously, a significant portion of the time in that benchmark was being spent doing JSON serialization using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code>, making it a prime candidate. With the changes to use the source generator and benefit from the fast path implicitly being used, the benchmark gets ~30% faster.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这些改进的影响可能是非常有意义的。aspnet/Benchmarks#1683就是一个很好的例子。它更新了TechEmpower缓存基准测试的ASP.NET实现，以使用JSON源代码生成器。以前，该基准测试中很大一部分时间都花在了使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> 进行JSON序列化，这使得它成为了主要候选者。随着使用源代码生成器的更改，并受益于隐式使用的快速路径，基准测试速度提高了约30%。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The blog post <a href=https://devblogs.microsoft.com/dotnet/try-the-new-system-text-json-source-generator data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Try the new System.Text.Json source generator</a> provides a lot more detail and background.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Try the new System.Text.Json源码生成器的博客文章提供了更多的细节和背景。</font></font></font></p>
<h3 id=interop data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Interop<a aria-labelledby=interop class=linkicon href=#interop data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One of the really neat projects worked on during .NET 6 is another source generator, this time one related to interop. Since the beginning of .NET, C# code can call out to native C functions via the P/Invoke (Platform Invoke) mechanism, whereby a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>extern</span></code> method is annotated as <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code>. However, not all <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code>s are created equally. Certain <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code>s are referred to as being “blittable,” which really just means the runtime doesn’t need to do any special transformation or marshaling as part of the call (that includes the <a href=https://docs.microsoft.com/dotnet/framework/interop/blittable-and-non-blittable-types target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>signature’s types being blittable</a>, but also the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>(...)]</span></code> attribute itself not declaring the need for any special processing, like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SetLastError</span><span class=pln> </span><span class=pun>=</span><span class=pln> </span><span class=kwd>true</span></code>). For those that aren’t blittable, the runtime needs to generate a “stub” that does any marshaling or manipulation necessary. For example, if you write:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在.NET 6期间，一个非常整洁的项目是另一个源代码生成器，这次是与互操作相关的。从.NET开始，C#代码可以通过P/Invoke（平台调用）机制调用原生C函数，其中 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>static</span><span class=pln> </span><span class=kwd>extern</span></code> 方法被注释为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> 。然而，并非所有 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> 都是平等创建的。某些 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> 被称为“blittable”，这实际上只是意味着运行时不需要作为调用的一部分进行任何特殊的转换或封送处理（这包括签名的类型是blittable的，但 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>(...)]</span></code> 属性本身不声明需要任何特殊处理，如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SetLastError</span><span class=pln> </span><span class=pun>=</span><span class=pln> </span><span class=kwd>true</span></code> ）。对于那些不是blittable的，运行时需要生成一个“存根”，用于进行任何必要的封送处理或操作。例如，如果你写：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>DllImport</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>SetLastError</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>extern</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetValue</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>SafeHandle</span></span><span class=pln><span class=pln> handle</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>for a native API defined in C as something like the following on Windows:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>对于在C中定义的原生API，类似于Windows上的以下内容： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C prettyprinted"><span class=pln><span class=pln>BOOL </span></span><span class=typ><span class=typ>GetValue</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>HANDLE h</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>or the following on Unix:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>或Unix上的以下操作： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C prettyprinted"><span class=typ><span class=typ>int32_t</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetValue</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>void</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> fileDescriptor</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>there are three special things the runtime needs to handle:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时需要处理三件特殊的事情： </font></font></font></p>
<ol data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeHandle</span></code> needs to be marshaled as an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IntPtr</span></code>, and the runtime needs to ensure the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeHandle</span></code> won’t be released during the native call.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeHandle</span></code> 需要被封送为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>IntPtr</span></code> ，并且运行时需要确保 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SafeHandle</span></code> 不会在本机调用期间被释放。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>bool</span></code> return value needs to be marshaled from a 4-byte integer value.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>bool</span></code> 返回值需要从4字节整数值封送。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SetLastError</span><span class=pln> </span><span class=pun>=</span><span class=pln> </span><span class=kwd>true</span></code> needs to properly ensure any error from the native call is consumable appropriately.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>SetLastError</span><span class=pln> </span><span class=pun>=</span><span class=pln> </span><span class=kwd>true</span></code> 需要正确地确保来自本机调用的任何错误都是适当消耗的。</font></font></font></li>
</ol>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>To do so, the runtime effectively needs to translate that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> into something like:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>要做到这一点，运行时需要有效地将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> 转换为如下内容：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>GetValue</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>SafeHandle</span></span><span class=pln><span class=pln> handle</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> success </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>false</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>try</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        handle</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>DangerousAddRef</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>ref</span></span><span class=pln><span class=pln> success</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>IntPtr</span></span><span class=pln><span class=pln> ptr </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> handle</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>DangerousGetHandle</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

        </span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SetLastSystemError</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> result </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> __GetValue</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>ptr</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SetLastPInvokeError</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetLastSystemError</span></span><span class=pun><span class=pun>());</span></span><span class=pln><span class=pln>

        </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> result </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>finally</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>success</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
            handle</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>DangerousRelease</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>DllImport</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>extern</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> __GetValue</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>IntPtr</span></span><span class=pln><span class=pln> handle</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>using dynamic code generation at run-time to generate a “stub” method that in turn calls an underlying <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> that actually is blittable. Doing that at run-time has multiple downsides, including the startup impact on having to do this code generation on first use. So, for .NET 7 we plan to enable a source generator to do it, and the groundwork has been laid in .NET 6 by building out a prototype. While the <a href=https://github.com/dotnet/runtime/issues/43060 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>P/Invoke source generator</a> won’t ship as part of .NET 6, as part of that prototype various investments were made that will ship in .NET 6, such as changing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code>s that could easily be made blittable to be so. You can see an example of that in <a href=https://github.com/dotnet/runtime/pull/54029 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54029</a>, which changed a handful of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code>s in the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=pln>IO</span><span class=pun>.</span><span class=typ>Compression</span><span class=pun>.</span><span class=typ>Brotli</span></code> library to be blittable. For example, this method:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在运行时使用动态代码生成来生成一个“存根”方法，该方法反过来调用实际上是可blittable的底层 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> 。在运行时这样做有很多缺点，包括在第一次使用时必须执行此代码生成的启动影响。因此，对于.NET 7，我们计划启用一个源代码生成器来完成这一任务，并且已经通过构建一个原型在.NET 6中奠定了基础。虽然P/Invoke源代码生成器不会作为.NET 6的一部分发布，但作为原型的一部分，我们进行了各种投资，这些投资将在.NET 6中发布，例如将可以很容易地使之成为blittable的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> 。你可以在dotnet/runtime#54029中看到一个例子，它将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=pln>IO</span><span class=pun>.</span><span class=typ>Compression</span><span class=pun>.</span><span class=typ>Brotli</span></code> 库中的一些 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> 更改为blittable。例如，该方法：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>DllImport</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Libraries</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompressionNative</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>internal</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>extern</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>unsafe</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BrotliDecoderDecompress</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nuint availableInput</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> inBytes</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>ref</span></span><span class=pln><span class=pln> nuint availableOutput</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> outBytes</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>required the runtime to generate a stub in order to 1) handle the return <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>bool</span></code> marshaling from a 4-byte integer, and 2) handle pinning the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>availableOutput</span></code> parameter passed as a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ref</span></code>. Instead, it can be defined as:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>需要运行时生成一个存根，以便1）处理来自4字节整数的返回 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>bool</span></code> 封送处理，以及2）处理将作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ref</span></code> 传递的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>availableOutput</span></code> 参数固定。相反，它可以被定义为：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>DllImport</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Libraries</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CompressionNative</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>internal</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>extern</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>unsafe</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BrotliDecoderDecompress</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nuint availableInput</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> inBytes</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> nuint</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> availableOutput</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> outBytes</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which is blittable, and then a call site like:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>它是可直接写入本机的，然后是一个调用站点，如： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pln><span class=pln>nuint availableOutput </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nuint</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>destination</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> success </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Interop</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Brotli</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BrotliDecoderDecompress</span></span><span class=pun><span class=pun>((</span></span><span class=pln><span class=pln>nuint</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>source</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> inBytes</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>ref</span></span><span class=pln><span class=pln> availableOutput</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> outBytes</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>can be tweaked to:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>可以调整为： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pln><span class=pln>nuint availableOutput </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nuint</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>destination</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>bool</span></span><span class=pln><span class=pln> success </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Interop</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Brotli</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>BrotliDecoderDecompress</span></span><span class=pun><span class=pun>((</span></span><span class=pln><span class=pln>nuint</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>source</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Length</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> inBytes</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>&amp;</span></span><span class=pln><span class=pln>availableOutput</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> outBytes</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Boom, a small tweak and we’ve saved an extra unlikely-to-be-inlined method call and avoided the need to even generate the stub in the first place. <a href=https://github.com/dotnet/runtime/pull/53968 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53968</a> makes all of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImports</span><span class=pun>]</span></code> for interop with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>zlib</span></code> (System.IO.Compression) to be blittable. And <a href=https://github.com/dotnet/runtime/pull/54370 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54370</a> fixes up more <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code>s across <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Security</span><span class=pun>.</span><span class=typ>Cryptography</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Diagnostics</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=pln>IO</span><span class=pun>.</span><span class=typ>MemoryMappedFiles</span></code>, and elsewhere to be blittable, as well.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>一个小小的调整，我们节省了一个额外的不太可能被内联的方法调用，甚至避免了首先生成存根的需要。dotnet/runtime#53968使所有的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImports</span><span class=pun>]</span></code> 与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>zlib</span></code> （System.IO.Compression）的互操作都可以进行blittable。dotnet/runtime#54370也修复了更多的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> ，跨越 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Security</span><span class=pun>.</span><span class=typ>Cryptography</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Diagnostics</span></code> ， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=pln>IO</span><span class=pun>.</span><span class=typ>MemoryMappedFiles</span></code> 和其他地方。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another area in which we’ve seen cross-cutting improvements in .NET 6 is via the use of function pointers to simplify and streamline interop. C# 9 added support for function pointers, which, via the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>delegate</span><span class=pun>*</span></code> syntax, enable efficient access to the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>ldftn</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>calli</span></code> IL instructions. Let’s say you’re the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PosixSignalRegistration</span></code> type, which was implemented in <a href=https://github.com/dotnet/runtime/pull/54136 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54136</a> from <a href=https://github.com/tmds target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@tmds</a>, <a href=https://github.com/dotnet/runtime/pull/55333 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55333</a>, and <a href=https://github.com/dotnet/runtime/pull/55552 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55552</a> to enable code to register a callback to handle a POSIX signal. Both the Unix and Windows implementations of this type need to hand off to native code a callback to be invoked when a signal is received. On Unix, the native function that’s called to register the callback is declared as:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我们在.NET 6中看到的另一个横向改进是通过使用函数指针来简化和精简互操作。C# 9增加了对函数指针的支持，通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>delegate</span><span class=pun>*</span></code> 语法，可以有效地访问 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>ldftn</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>calli</span></code> IL指令。假设你是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>PosixSignalRegistration</span></code> 类型，它是在dotnet/runtime#54136 from @tmds、dotnet/runtime#55333和dotnet/runtime#55552中实现的，以使代码能够注册一个回调来处理POSIX信号。这种类型的Unix和Windows实现都需要将回调传递给本地代码，以便在接收到信号时调用。在Unix上，调用来注册回调的本机函数声明为：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C prettyprinted"><span class=kwd><span class=kwd>typedef</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>int32_t</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*</span></span><span class=typ><span class=typ>PosixSignalHandler</span></span><span class=pun><span class=pun>)(</span></span><span class=typ><span class=typ>int32_t</span></span><span class=pln><span class=pln> signalCode</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PosixSignal</span></span><span class=pln><span class=pln> signal</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SystemNative_SetPosixSignalHandler</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>PosixSignalHandler</span></span><span class=pln><span class=pln> signalHandler</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>expecting a function pointer it can invoke. Thankfully, on the managed side we want to hand off a static method, so we don’t need to get bogged down in the details of how we pass an instance method, keep the relevant state rooted, and so on. Instead, we can declare the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> as:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>需要一个它可以调用的函数指针。值得庆幸的是，在托管端，我们希望传递一个静态方法，所以我们不需要陷入如何传递实例方法的细节，保持相关状态的根，等等。相反，我们可以将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DllImport</span><span class=pun>]</span></code> 声明为：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>DllImport</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Libraries</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SystemNative</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EntryPoint</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"SystemNative_SetPosixSignalHandler"</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>internal</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>extern</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>unsafe</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>SetPosixSignalHandler</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>delegate</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> unmanaged</span></span><span class=pun><span class=pun>&lt;</span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PosixSignal</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> handler</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Now, we define a method we want to be called that’s compatible with this function pointer type:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>现在，我们定义了一个我们想要被调用的方法，它与这个函数指针类型兼容： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>UnmanagedCallersOnly</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>OnPosixSignal</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> signo</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>PosixSignal</span></span><span class=pln><span class=pln> signal</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and, finally, we can pass the address of this method to the native code:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>最后，我们可以将这个方法的地址传递给本地代码： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=typ><span class=typ>Interop</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Sys</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>SetPosixSignalHandler</span></span><span class=pun><span class=pun>(&amp;</span></span><span class=typ><span class=typ>OnPosixSignal</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Nowhere did we need to allocate a delegate and store it into a static field to prevent it from being collected, just so we can hand off the address of this <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>OnPosixSignal</span></code> method; instead, we just pass down the method’s address. This ends up being simpler and more efficient, and multiple PRs in .NET 6 converted delegate-based interop to function pointer-based interop. <a href=https://github.com/dotnet/runtime/pull/43793 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43793</a> and <a href=https://github.com/dotnet/runtime/pull/43514 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43514</a> converted a bunch of interop on both Windows and Unix to use function pointers. <a href=https://github.com/dotnet/runtime/pull/54636 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54636</a> and <a href=https://github.com/dotnet/runtime/pull/54884 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54884</a> did the same for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Drawing</span></code> as part of a larger effort to migrate <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Drawing</span></code> to use <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>InteropServices</span><span class=pun>.</span><span class=typ>ComWrappers</span></code>. <a href=https://github.com/dotnet/runtime/pull/46690 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46690</a> moved <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span></code> to being a fully managed implementation rather than using <a href=https://github.com/dotnet/runtime/blob/57bfe474518ab5b7cfe6bf7424a79ce3af9d6657/docs/design/coreclr/botr/corelib.md#calling-from-managed-to-native-code target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>“FCalls”</a> into the runtime to get the current time, and in doing so used function pointers to be able to store a pointer to desired native OS function for getting the current time. <a href=https://github.com/dotnet/runtime/pull/52090 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52090</a> converted the macOS implementation of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileSystemWatcher</span></code> to use function pointers. And <a href=https://github.com/dotnet/runtime/pull/52192 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52192</a> did the same for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Net</span><span class=pun>.</span><span class=typ>NetworkInformation</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我们不需要在任何地方分配委托并将其存储到静态字段中以防止它被收集，这样我们就可以传递这个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>OnPosixSignal</span></code> 方法的地址;相反，我们只传递方法的地址。这最终变得更简单和更高效，并且.NET 6中的多个PR将基于委托的互操作转换为基于函数指针的互操作。dotnet/runtime#43793和dotnet/runtime#43514将Windows和Unix上的一堆互操作转换为使用函数指针。dotnet/runtime#54636和dotnet/runtime#54884对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Drawing</span></code> 做了同样的事情，这是将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Drawing</span></code> 迁移到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>InteropServices</span><span class=pun>.</span><span class=typ>ComWrappers</span></code> 的更大努力的一部分。dotnet/runtime#46690将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DateTime</span></code> 移动到完全托管的实现，而不是在运行时使用“FCalls”来获取当前时间，并且在这样做时使用函数指针来存储指向期望的本地OS函数的指针以获取当前时间。dotnet/runtime#52090将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileSystemWatcher</span></code> 的macOS实现转换为使用函数指针。 dotnet/runtime#52192对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Net</span><span class=pun>.</span><span class=typ>NetworkInformation</span></code> 也做了同样的事情。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Beyond these cross-cutting changes, there was also more traditional optimization investment in interop. The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Marshal</span></code> class has long provided the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AllocHGlobal</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FreeHGlobal</span></code> methods which .NET developers could use effectively as the equivalent of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>malloc</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>free</span></code>, in situations where natively allocated memory was preferable to allocation controlled by the GC. <a href=https://github.com/dotnet/runtime/pull/41911 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#41911</a> revised the implementation of these and other <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Marshal</span></code> methods as part of moving all of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Marshal</span></code> allocation-related implementations out of native code in the runtimes up into C#. In doing so, a fair amount of overhead was removed, in particular on Unix where a layer of wrappers was removed, as is evident from this benchmark run on Ubuntu:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>除了这些横向变化之外，interop还有更多传统的优化投资。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Marshal</span></code> 类长期以来提供了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AllocHGlobal</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FreeHGlobal</span></code> 方法，.NET开发人员可以有效地使用这些方法作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>malloc</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>free</span></code> 的等价物，在原生分配内存比GC控制的分配更可取的情况下。dotnet/runtime#41911修改了这些和其他 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Marshal</span></code> 方法的实现，作为将所有 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Marshal</span></code> 分配相关实现从运行时的原生代码移到C#的一部分。这样做，去除了相当多的开销，特别是在Unix上，去除了一层包装器，从Ubuntu上运行的基准测试可以看出：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AllocFree</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FreeHGlobal</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AllocHGlobal</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>));</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>AllocFree</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>58.50 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>58.50纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>AllocFree</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>28.21 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>28.21纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.48</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>In a similar area, the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>InteropServices</span><span class=pun>.</span><span class=typ>NativeMemory</span></code> class (<a href=https://github.com/dotnet/runtime/pull/54006 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54006</a>) provides fast APIs for allocating, reallocating, and freeing native memory, with options including requiring the memory having a particular alignment or having the memory be forcibly zeroed out (note the above numbers and the below numbers were taken on different machines, the above on Ubuntu and the below on Windows, and are not directly comparable).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在类似的领域，新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Runtime</span><span class=pun>.</span><span class=typ>InteropServices</span><span class=pun>.</span><span class=typ>NativeMemory</span></code> 类（dotnet/runtime#54006）提供了用于分配、重新分配和释放本机内存的快速API，其选项包括要求内存具有特定对齐或强制将内存清零（请注意，上面的数字和下面的数字是在不同的机器上取得的，上面的是Ubuntu，下面的是Windows，并且不能直接比较）。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>AllocHGlobal</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FreeHGlobal</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>AllocHGlobal</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>));</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Alloc</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NativeMemory</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Free</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>NativeMemory</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Alloc</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>100</span></span><span class=pun><span class=pun>));</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>RatioSD<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比率SD </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>AllocHGlobal</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>58.34 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>58.34纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Alloc</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>48.33 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>48.33纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.83</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.02</td>
</tr>
</tbody>
</table></div>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There’s also the new <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MemoryMarshal</span><span class=pun>.</span><span class=typ>CreateReadOnlySpanFromNullTerminated</span></code> method (<a href=https://github.com/dotnet/runtime/pull/47539 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47539</a>), which provides two overloads, one for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>*</span></code> and one for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>*</span></code>, and which is intended to simplify the handling of null-terminated strings received while doing interop. As an example, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileSystemWatcher</span></code>‘s implementation on macOS would receive from the operating system a pointer to a null-terminated UTF8 string representing the path of the file that changed. With just the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>*</span></code> pointer to the string, the implementation had code that looked like this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>还有新的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>MemoryMarshal</span><span class=pun>.</span><span class=typ>CreateReadOnlySpanFromNullTerminated</span></code> 方法（dotnet/runtime#47539），它提供了两个重载，一个用于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>char</span><span class=pun>*</span></code> ，一个用于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>*</span></code> ，它的目的是简化在执行互操作时接收到的以null终止的字符串的处理。举个例子， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>FileSystemWatcher</span></code> 在macOS上的实现会从操作系统接收一个指向空终止的UTF8字符串的指针，该字符串表示发生更改的文件的路径。只使用指向字符串的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>byte</span><span class=pun>*</span></code> 指针，实现的代码如下所示：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> temp </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> nativeEventPath</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> byteCount </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(*</span></span><span class=pln><span class=pln>temp </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    temp</span></span><span class=pun><span class=pun>++;</span></span><span class=pln><span class=pln>
    byteCount</span></span><span class=pun><span class=pun>++;</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> span </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ReadOnlySpan</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nativeEventPath</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> byteCount</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>in order to create a span representing the string beginning to end. Now, the implementation is simply:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>以便创建表示字符串开始到结束的跨度。现在，实现简单如下： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=typ><span class=typ>ReadOnlySpan</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> eventPath </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MemoryMarshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateReadOnlySpanFromNullTerminated</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>nativeEventPath</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>More maintainable, safer code, but there’s also a performance benefit. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CreateReadOnlySpanFromNullTerminated</span></code> employs a vectorized search for the null terminator, making it typically much faster than the open-coded manual loop.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>更易维护，更安全的代码，但也有性能优势。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CreateReadOnlySpanFromNullTerminated</span></code> 使用向量化搜索空终止符，这使得它通常比开放编码的手动循环快得多。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>IntPtr</span></span><span class=pln><span class=pln> _ptr</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    _ptr </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>StringToCoTaskMemUTF8</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"And yet, by heaven, I think my love as rare. As any she belies with false compare."</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalCleanup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Cleanup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>Marshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>FreeCoTaskMem</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>_ptr</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Baseline</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>true</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>unsafe</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ReadOnlySpan</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Old</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> byteCount </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln> p </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*)</span></span><span class=pln><span class=pln>_ptr</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>*</span></span><span class=pln><span class=pln>p </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> p</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln> byteCount</span></span><span class=pun><span class=pun>++;</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>return</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ReadOnlySpan</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*)</span></span><span class=pln><span class=pln>_ptr</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> byteCount</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>unsafe</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ReadOnlySpan</span></span><span class=str><span class=str>&lt;byte&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>New</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>MemoryMarshal</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>CreateReadOnlySpanFromNullTerminated</span></span><span class=pun><span class=pun>((</span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>*)</span></span><span class=pln><span class=pln>_ptr</span></span><span class=pun><span class=pun>);</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Old</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>38.536 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>38.536纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>6.597 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>6.597纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.17</td>
</tr>
</tbody>
</table></div>
<h3 id=tracing data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Tracing<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>追踪 </font></font></font><a aria-labelledby=tracing class=linkicon href=#tracing data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET has multiple tracing implementations, with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> at the heart of those used in the most performance-sensitive systems. The runtime itself traces details and exposes counters for the JIT, GC, ThreadPool, and more through a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Runtime"</span></code> event source, and many other components up and down the stack do the same with their own. Even just within the core libraries, among others you can find the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Diagnostics.Metrics"</span></code> event source, which is intended to enable out-of-process tools to do ad-hoc monitoring of the new <a href=https://devblogs.microsoft.com/dotnet/opentelemetry-net-reaches-v1-0/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>OpenTelemtry</a> <a href=https://devblogs.microsoft.com/dotnet/announcing-net-6-preview-5/#libraries-support-for-opentelemetry-metrics data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Metrics APIs</a>; the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Net.Http"</span></code> event source that exposes information such as when requests start and complete; the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Net.NameResolution"</span></code> event source that exposes information such as the number of DNS lookups that have been performed; the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Net.Security"</span></code> event source that exposes data about TLS handshakes; the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Net.Sockets"</span></code> event source that enables monitoring of connections being made and data being transferred; and the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Buffers.ArrayPoolEventSource"</span></code> event source that gives a window into arrays being rented and returned and dropped and trimmed. This level of usage demands the system to be as efficient as possible.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET有多个跟踪实现，其中 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 是那些在性能最敏感的系统中使用的跟踪实现的核心。运行时本身通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Runtime"</span></code> 事件源跟踪细节并公开JIT、GC、ThreadPool等的计数器，堆栈上下的许多其他组件也对它们自己的组件做同样的事情。即使在核心库中，您也可以找到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Diagnostics.Metrics"</span></code> 事件源，它旨在支持进程外工具对新的OpenTelemtry Metrics API进行临时监控; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Net.Http"</span></code> 事件源，公开诸如请求何时开始和完成等信息; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Net.NameResolution"</span></code> 事件源，其公开诸如已执行DNS查找次数的信息;公开TLS握手相关数据的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Net.Security"</span></code> 事件源; <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Net.Sockets"</span></code> 事件源，能够监视正在建立的连接和正在传输的数据;以及 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=str>"System.Buffers.ArrayPoolEventSource"</span></code> 事件源，它提供了一个窗口，可以看到正在租用、返回、丢弃和修剪的数组。 这种使用水平要求系统尽可能高效。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code>-derived types use overloads of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span><span class=pun>.</span><span class=typ>WriteEvent</span></code> or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span><span class=pun>.</span><span class=typ>WriteEventCore</span></code> to do the core of their logging. There are then multiple ways that data from an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> can be consumed. One way is via ETW (Event Tracing for Windows), through which another process can request an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> start tracing and the relevant data will be written by the operating system to a log for subsequent analysis with a tool like Visual Studio, PerfView, or Windows Performance Analyzer. The most general <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteEvent</span></code> overload accepts an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> of all the data to trace, and <a href=https://github.com/dotnet/runtime/pull/54925 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54925</a> reduced the overhead of using this API, specifically when the data is being consumed by ETW, which has dedicated code paths in the implementation; the PR reduced allocation by 3-4x for basic use cases by avoiding multiple temporary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=str>&lt;object&gt;</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> arrays, leading also to an ~8% improvement in throughput.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> -派生类型使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span><span class=pun>.</span><span class=typ>WriteEvent</span></code> 或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span><span class=pun>.</span><span class=typ>WriteEventCore</span></code> 的重载来完成日志的核心。然后，有多种方式可以使用来自 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 的数据。一种方法是通过ETW（Windows的事件跟踪），通过ETW，另一个进程可以请求 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 开始跟踪，相关数据将由操作系统写入日志，以便使用Visual Studio、PerfView或Windows Performance Analyzer等工具进行后续分析。最常见的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteEvent</span></code> 重载接受所有数据的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> 跟踪，dotnet/runtime#54925减少了使用此API的开销，特别是当数据被ETW消耗时，ETW在实现中具有专用代码路径; PR通过避免多个临时 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=str>&lt;object&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> 阵列，将基本用例的分配减少了3- 4倍，从而也导致吞吐量提高了约8%。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another increasingly common way <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> data can be consumed is via <a href=https://docs.microsoft.com/dotnet/core/diagnostics/eventpipe target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>EventPipe</a>, which provides a cross-platform mechanism for serializing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> data either to a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>nettrace</span></code> file or to an out-of-process consumer, such as a tool like <a href=https://docs.microsoft.com/dotnet/core/diagnostics/dotnet-counters target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet-counters</a>. Given the high rate at which data can be generated, it’s important that this mechanism be as low-overhead as possible. <a href=https://github.com/dotnet/runtime/pull/50797 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50797</a> changed how access to buffers in EventPipe were synchronized, leading to significant increases in event throughput, on all operating systems. <a href=https://github.com/dotnet/runtime/pull/46555 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46555</a> also helps here. If either ETW or EventPipe was being used to consume events, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> would P/Invoke into native code for each, but if only one of them was being used, that would lead to an unnecessary P/Invoke; the PR addressed this simply by checking whether the P/Invoke is necessary based on the known state of the consumers.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>另一种越来越常见的使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 数据的方式是通过EventPipe，它提供了一种跨平台机制，用于将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 数据序列化到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>nettrace</span></code> 文件或进程外消费者，例如像dotnet-counters这样的工具。考虑到可以生成数据的高速率，该机制尽可能低开销是很重要的。dotnet/runtime#50797改变了对EventPipe中缓冲区的访问的同步方式，导致所有操作系统上事件吞吐量的显著增加。dotnet/runtime#46555也有帮助。如果ETW或EventPipe被用于消费事件， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 将P/Invoke到每个事件的本地代码中，但如果仅使用其中一个事件，则将导致不必要的P/Invoke; PR简单地通过基于消费者的已知状态检查P/Invoke是否必要来解决这个问题。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Another way <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> data can be consumed is in-process via a custom <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventListener</span></code>. Code can derive from <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventListener</span></code> and override a few methods to say what <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> should be subscribed to and what should be done with the data. For example, here’s a simple app that uses an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventListener</span></code> to dump to the console the events generated for a single HTTP request by the `”System.Net.Http”“ event source:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>另一种使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 数据的方式是通过自定义 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventListener</span></code> 在进程中进行。代码可以从 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventListener</span></code> 派生，并覆盖一些方法来说明应该订阅 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 的内容以及应该对数据做什么。例如，这里有一个简单的应用程序，它使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventListener</span></code> 将`“System.Net.Http””事件源为单个HTTP请求生成的事件转储到控制台：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Diagnostics</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Tracing</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Linq</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Net</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Http</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> listener </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpConsoleListener</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> hc </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpClient</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>await</span></span><span class=pln><span class=pln> hc</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetStringAsync</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"https://dotnet.microsoft.com/"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>sealed</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>HttpConsoleListener</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EventListener</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>protected</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>OnEventSourceCreated</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>EventSource</span></span><span class=pln><span class=pln> eventSource</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>eventSource</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Name</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>==</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"System.Net.Http"</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
            </span></span><span class=typ><span class=typ>EnableEvents</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>eventSource</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EventLevel</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LogAlways</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>protected</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>OnEventWritten</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>EventWrittenEventArgs</span></span><span class=pln><span class=pln> eventData</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> payload </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln>
            eventData</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Payload</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
            eventData</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PayloadNames</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>!=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>null</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>?</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Join</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>", "</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> eventData</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>PayloadNames</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Zip</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>eventData</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Payload</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>n</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> v</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> $</span></span><span class=str><span class=str>"{n}={v}"</span></span><span class=pun><span class=pun>))</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
            </span></span><span class=kwd><span class=kwd>string</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Join</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>", "</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> eventData</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Payload</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=typ><span class=typ>Console</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>WriteLine</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>$</span></span><span class=str><span class=str>"[{eventData.TimeStamp:o}] {eventData.EventName}: {payload}"</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and the output it produced when I ran it:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>以及我运行它时产生的输出： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.4758871Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RequestStart</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> scheme</span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln>https</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> host</span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln>dotnet</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>microsoft</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>com</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> port</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>443</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> pathAndQuery</span></span><span class=pun><span class=pun>=/,</span></span><span class=pln><span class=pln> versionMajor</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> versionMinor</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> versionPolicy</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.5981990Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ConnectionEstablished</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> versionMajor</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> versionMinor</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.5995700Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RequestLeftQueue</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> timeOnQueueMilliseconds</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>86.1312</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> versionMajor</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> versionMinor</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.6011745Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RequestHeadersStart</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.6019475Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RequestHeadersStop</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.7591555Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ResponseHeadersStart</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.7628194Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ResponseHeadersStop</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.7648776Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ResponseContentStart</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.7665603Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ResponseContentStop</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.7667290Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>RequestStop</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=lit><span class=lit>2021</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>08</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06T15</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>38</span></span><span class=pun><span class=pun>:</span></span><span class=lit><span class=lit>47.7684536Z</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>ConnectionClosed</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> versionMajor</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> versionMinor</span></span><span class=pun><span class=pun>=</span></span><span class=lit><span class=lit>1</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The other mechanisms for consuming events are more efficient, but being able to write a custom <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventListener</span></code> like this is very flexible and allows for a myriad of interesting uses, so we still want to drive down the overhead associated with all of these callbacks.
<a href=https://github.com/dotnet/runtime/pull/44026 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44026</a>, <a href=https://github.com/dotnet/runtime/pull/51822 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51822</a>, <a href=https://github.com/dotnet/runtime/pull/52092 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52092</a>, and <a href=https://github.com/dotnet/runtime/pull/52455 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52455</a> all contributed here, doing things like wrapping a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlyCollection</span><span class=str>&lt;object&gt;</span></code> directly around an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> created with the exact right size rather around an intermediate <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=str>&lt;object&gt;</span></code> dynamically grown; using a singleton collection for empty payloads; avoiding unnecessary <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>ThreadStatic</span><span class=pun>]</span></code> accesses; avoiding recalcuating information and instead calculating it once and passing it to everywhere that needs the value; using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Type</span><span class=pun>.</span><span class=typ>GetTypeCode</span></code> to quickly jump to the handling code for the relevant primitive rather than a large cascade of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code>s; reducing the size of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventWrittenEventArgs</span></code> in the common case by pushing off lesser-used fields to a contingently-allocated class; and so on. This benchmark shows an example impact of those changes.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>使用事件的其他机制更有效，但是能够编写像这样的自定义 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventListener</span></code> 非常灵活，并且允许无数有趣的用途，所以我们仍然希望降低与所有这些回调相关的开销。dotnet/runtime#44026、dotnet/runtime#51822、dotnet/runtime#52092和dotnet/runtime#52455都在这里做出了贡献，比如直接将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlyCollection</span><span class=str>&lt;object&gt;</span></code> 包装在以正确大小创建的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span><span class=pun>[]</span></code> 上，而不是围绕动态增长的中间 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>List</span><span class=str>&lt;object&gt;</span></code> ;对空有效载荷使用单例集合;避免不必要的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>ThreadStatic</span><span class=pun>]</span></code> 访问;避免重新计算信息，而是计算一次并将其传递到需要该值的任何地方;使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Type</span><span class=pun>.</span><span class=typ>GetTypeCode</span></code> 快速跳转到相关原语的处理代码，而不是使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>if</span></code> 的大级联;通过将较少使用的字段推到临时分配的类来减小普通情况下的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventWrittenEventArgs</span></code> 的大小;等 此基准测试显示了这些更改的示例影响。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkEventListener</span></span><span class=pln><span class=pln> _listener</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalSetup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Setup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _listener </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkEventListener</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>GlobalCleanup</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Cleanup</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> _listener</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Dispose</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Benchmark</span></span><span class=pun><span class=pun>]</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Log</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>BenchmarkEventSource</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Log</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>NoArgs</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
    </span></span><span class=typ><span class=typ>BenchmarkEventSource</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Log</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>MultipleArgs</span></span><span class=pun><span class=pun>(</span></span><span class=str><span class=str>"hello"</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>6</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>sealed</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkEventListener</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EventListener</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>protected</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>OnEventSourceCreated</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>EventSource</span></span><span class=pln><span class=pln> eventSource</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>eventSource </span></span><span class=kwd><span class=kwd>is</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkEventSource</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
            </span></span><span class=typ><span class=typ>EnableEvents</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>eventSource</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EventLevel</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>LogAlways</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>protected</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>override</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>OnEventWritten</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>EventWrittenEventArgs</span></span><span class=pln><span class=pln> eventData</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>

</span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>sealed</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>class</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkEventSource</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>EventSource</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>static</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>readonly</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkEventSource</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Log</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>BenchmarkEventSource</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>

    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Event</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>NoArgs</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WriteEvent</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>1</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>

    </span></span><span class=pun><span class=pun>[</span></span><span class=typ><span class=typ>Event</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>)]</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>public</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>MultipleArgs</span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> arg1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> arg2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> arg3</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WriteEvent</span></span><span class=pun><span class=pun>(</span></span><span class=lit><span class=lit>2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> arg1</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> arg2</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> arg3</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<div class=table-responsive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><table data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<thead data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Method<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>方法 </font></font></font></th>
<th data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Runtime<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>运行时 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mean<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>意味 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ratio<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>比 </font></font></font></th>
<th style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Allocated<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>分配 </font></font></font></th>
</tr>
</thead>
<tbody data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Log</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 5.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>394.4 ns</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>1.00</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>472 B</td>
</tr>
<tr data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Log</td>
<td data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6.0</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>126.9 ns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>126.9纳秒 </font></font></font></td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>0.32</td>
<td style=text-align:right data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>296 B<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>B </font></font></font></td>
</tr>
</tbody>
</table></div>
<h3 id=startup data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Startup<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>启动 </font></font></font><a aria-labelledby=startup class=linkicon href=#startup data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There are many things that impact how long it takes an application to start up. Code generation plays a large role, which is why .NET has technology like tiered JIT compilation and ReadyToRun. Managed code prior to an application’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Main</span></code> method being invoked also plays a role (yes, there’s managed code that executes before <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Main</span></code>);
<a href=https://github.com/dotnet/runtime/pull/44469 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44469</a>, for example, was the result of profiling for allocations that occurred on the startup path of a simple “hello, world” console application and addressing a variety of issues:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>有许多因素会影响应用程序启动所需的时间。代码生成起着很大的作用，这就是为什么.NET具有分层JIT编译和ReadyToRun等技术。在调用应用程序的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Main</span></code> 方法之前的托管代码也起作用（是的，有在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Main</span></code> 之前执行的托管代码）;例如，dotnet/runtime#44469是分析在简单的“hello，world”控制台应用程序的启动路径上发生的分配并解决各种问题的结果：</font></font></font></p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=str>&lt;string&gt;</span><span class=pun>.</span><span class=typ>Default</span></code> is used by various components on the startup path, but the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CreateDefaultEqualityComparer</span></code> that’s used to initialize that singleton wasn’t special-casing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>type </span><span class=pun>==</span><span class=pln> </span><span class=kwd>typeof</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>)</span></code>, which then meant it ended up going down the more allocation-heavy <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CreateInstanceForAnotherGenericParameter</span></code> code path. The PR fixed it by special-casing <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EqualityComparer</span><span class=str>&lt;string&gt;</span><span class=pun>.</span><span class=typ>Default</span></code> 由启动路径上的各种组件使用，但用于初始化该单例的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CreateDefaultEqualityComparer</span></code> 不是特殊情况下的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>type </span><span class=pun>==</span><span class=pln> </span><span class=kwd>typeof</span><span class=pun>(</span><span class=kwd>string</span><span class=pun>)</span></code> ，这意味着它最终会沿着分配更重的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CreateInstanceForAnotherGenericParameter</span></code> 代码路径。PR用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>string</span></code> 特殊套管固定。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Any use of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Console</span></code> was forcing various <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Encoding</span></code> objects to be instantiated, even if they wouldn’t otherwise be used, purely to access their <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CodePage</span></code>. The PR fixed that by just hardcoding the relevant code page number in a constant.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>任何对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Console</span></code> 的使用都是在强迫各种 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Encoding</span></code> 对象被实例化，即使它们不会被使用，纯粹是为了访问它们的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CodePage</span></code> 。PR通过将相关的代码页编号硬编码在一个常量中来解决这个问题。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Every process was registering with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AppContext</span><span class=pun>.</span><span class=typ>ProcessExit</span></code> in order to clean up after the runtime’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code>s that were being created, and that in turn resulted in several allocations. We can instead sacrifice a small amount of layering purity and just do the cleanup as part of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AppContext</span><span class=pun>.</span><span class=typ>OnProcessExit</span></code> routine that’s already doing other work, like calling <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AssemblyLoadContext</span><span class=pun>.</span><span class=typ>OnProcessExit</span></code> and invoking the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ProcessExit</span></code> event itself.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>每个进程都注册到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AppContext</span><span class=pun>.</span><span class=typ>ProcessExit</span></code> ，以便在创建运行时的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 之后清理，这反过来又导致了几个分配。我们可以牺牲一小部分的分层纯度，将清理作为已经在执行其他工作的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AppContext</span><span class=pun>.</span><span class=typ>OnProcessExit</span></code> 例程的一部分，比如调用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AssemblyLoadContext</span><span class=pun>.</span><span class=typ>OnProcessExit</span></code> 并调用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ProcessExit</span></code> 事件本身。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AppDomain</span></code> was taking a lock to protect the testing-and-setting of some state, and that operation was easily transformed into an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>CompareExchange</span></code>. The benefit to that here wasn’t reduced locking (which is also nice), but rather no longer needing to allocate the object that was there purely to be locked on.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AppDomain</span></code> 使用一个锁来保护某些状态的测试和设置，并且该操作很容易被转换为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>CompareExchange</span></code> 。这样做的好处并不是减少了锁定（这也很好），而是不再需要分配纯粹用于锁定的对象。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> was always allocating an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code> to be used as a lock necessary for synchronization in the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteEventString</span></code> method, which is only used for logging error messages about <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code>s; not a common case. That <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code> can instead be lazily allocated with an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>CompareExchange</span></code> only when there’s first a failure to log. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> was also allocating a pinning <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GCHandle</span></code> in order to pass the address of a pinned array to a P/Invoke. That was just as easily (and more cheaply) done with a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>fixed</span></code> statement.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 总是分配一个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code> 作为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WriteEventString</span></code> 方法同步所需的锁，该锁只用于记录 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> s的错误消息;不是一个普通的案例。只有在第一次出现日志失败时，才可以用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Interlocked</span><span class=pun>.</span><span class=typ>CompareExchange</span></code> 延迟分配 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code> 。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EventSource</span></code> 还分配了一个pinking <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GCHandle</span></code> ，以便将pinking数组的地址传递给P/Invoke。用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>fixed</span></code> 语句同样容易（也更便宜）完成这一点。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Similarly, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EncodingProvider</span></code> was always allocating an <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code> to be used for pessimistic locking, when an optimistic <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CompareExchange</span></code> loop-based scheme was cheaper in the common case.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>类似地， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>EncodingProvider</span></code> 总是分配 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>object</span></code> 用于悲观锁定，而乐观的基于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>CompareExchange</span></code> 循环的方案在常见情况下更便宜。</font></font></font></li>
</ul>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>But beyond both of those, there’s the .NET host. Fundamentally, the .NET runtime is “just” a library that can be hosted inside of a larger application, the “host”; that host calls into various APIs that initialize the runtime and invoke static methods, like <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Main</span></code>. While it’s possible for anyone to <a href=https://docs.microsoft.com/dotnet/core/tutorials/netcore-hosting target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>build a custom host</a>, there are hosts built into .NET, that are used as part of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span></code> tool and as part of building and publishing an app (when you build a .NET console app, for example, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>exe</span></code> that pops out is a .NET host). What that host does or does not do can have a significant impact on the startup performance of the app, and investments were made in .NET 6 to reduce these hosting overheads.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>但除了这两个，还有.NET主机。从根本上讲，.NET运行时“只是”一个库，它可以托管在一个更大的应用程序中，即“host”;它托管对各种API的调用，这些API初始化运行时并调用静态方法，如 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Main</span></code> 。虽然任何人都可以构建自定义主机，但也有内置到.NET中的主机，它们被用作 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span></code> 工具的一部分以及构建和发布应用程序的一部分（例如，当您构建.NET控制台应用程序时，弹出的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>exe</span></code> 是.NET主机）。主机做什么或不做什么会对应用程序的启动性能产生重大影响，因此在.NET 6中进行了投资以减少这些托管开销。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One of the most expensive things a host can do is file I/O, especially if there’s a lot of it. <a href=https://github.com/dotnet/runtime/pull/50671 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50671</a> tries to reduce startup time by avoiding the file existence checks that were being performed for each file listed in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>deps</span><span class=pun>.</span><span class=pln>json</span></code> (which describes a set of dependencies that come from packages). On top of that, <a href=https://github.com/dotnet/sdk/pull/17014 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/sdk#17014</a> stopped generating the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=tag>&lt;app&gt;</span><span class=pln>.runtimeconfig.dev.json</span></code> file as part of builds; this file contained additional probing paths that weren’t actually necessary and were causing the host to probe more than necessary and negating the wins from the previous PR. On top of that, <a href=https://github.com/dotnet/runtime/pull/53631 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53631</a> also helped reduce overheads by removing unnecessary string copies in the hosting layer, shaving milliseconds off execution time.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>主机所能做的最昂贵的事情之一就是文件I/O，尤其是当文件I/O数量很大时。dotnet/runtime#50671试图通过避免对 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>deps</span><span class=pun>.</span><span class=pln>json</span></code> 中列出的每个文件执行的文件存在性检查来减少启动时间（它描述了来自包的一组依赖关系）。最重要的是，dotnet/sdk#17014停止生成 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=tag>&lt;app&gt;</span><span class=pln>.runtimeconfig.dev.json</span></code> 文件作为构建的一部分;此文件包含实际上不需要的额外探测路径，导致主机探测的次数超出了必要范围，并否定了先前PR中的胜利。最重要的是，dotnet/runtime#53631还通过删除托管层中不必要的字符串副本来帮助减少开销，减少执行时间毫秒。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>All told, this adds up to sizeable reductions in app startup. For this example, I used:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>总而言之，这意味着应用程序启动量大幅减少。在这个例子中，我使用了： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> dotnet </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> console </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>o app5 </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>f net5</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>
D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> dotnet </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> console </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>o app6 </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>f net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>to create two “Hello, World” apps, one targeting .NET 5 and one targeting .NET 6. Then I built them both with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet build </span><span class=pun>-</span><span class=pln>c </span><span class=typ>Release</span></code> in each directory, and then used PowerShell’s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Measure</span><span class=pun>-</span><span class=typ>Command</span></code> to time their execution.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>创建两个“Hello，World”应用程序，一个针对.NET 5，另一个针对.NET 6。然后我在每个目录中使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet build </span><span class=pun>-</span><span class=pln>c </span><span class=typ>Release</span></code> 构建了它们，然后使用PowerShell的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Measure</span><span class=pun>-</span><span class=typ>Command</span></code> 来计时它们的执行。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Measure</span></span><span class=pun><span class=pun>-</span></span><span class=typ><span class=typ>Command</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net5</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\app5</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>exe </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>-</span></span><span class=typ><span class=typ>Object</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=typ><span class=typ>Property</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TotalMilliseconds</span></span><span class=pln><span class=pln>

</span></span><span class=typ><span class=typ>TotalMilliseconds</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>-----------------</span></span><span class=pln><span class=pln>
          </span></span><span class=lit><span class=lit>63.9716</span></span><span class=pln><span class=pln>

D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> cd </span></span><span class=pun><span class=pun>..</span></span><span class=pln><span class=pln>app6
D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Measure</span></span><span class=pun><span class=pun>-</span></span><span class=typ><span class=typ>Command</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\app6</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>exe </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>|</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Select</span></span><span class=pun><span class=pun>-</span></span><span class=typ><span class=typ>Object</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-</span></span><span class=typ><span class=typ>Property</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TotalMilliseconds</span></span><span class=pln><span class=pln>

</span></span><span class=typ><span class=typ>TotalMilliseconds</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>-----------------</span></span><span class=pln><span class=pln>
          </span></span><span class=lit><span class=lit>43.2652</span></span><span class=pln><span class=pln>

D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6</span></span><span class=pun><span class=pun>&gt;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>highlighting an ~30% reduction in the cost of executing this “Hello, World” app.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>突出显示了运行这个“Hello，World”应用程序的成本降低了约30%。 </font></font></font></p>
<h3 id=size data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Size<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>大小 </font></font></font><a aria-labelledby=size class=linkicon href=#size data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>When I’ve written about improving .NET performance, throughput and memory have been the primary two metrics on which I’ve focused. Of late, however, another metric has been getting a lot of attention: size, and in particular size-on-disk for a self-contained, trimmed application. That’s primarily because of the <a href=https://docs.microsoft.com/aspnet/core/blazor target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Blazor WebAssembly (WASM)</a> application model, where an entire .NET application, inclusive of the runtime, is downloaded to and executed in a browser. Some amount of work went into .NET 5 to reduce size, but <em data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>a lot</em> of work has gone into .NET 6, inclusive of changes in dotnet/runtime as well as in mono/linker, which provides the trimmer that analyzes and rewrites assemblies to remove (or “trim”, or “tree shake”) unused functionality. A large percentage of the work in .NET 6 actually went into trimming safety, making it possible for any of the core libraries to be used in a trimmed application such that either everything that’s needed will be correctly kept or the trimmer will produce warnings about what’s wrong and how the developer can fix it. However, there was a sizable effort (pun intended, I’m so funny) on the size reduction itself.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当我写关于提高.NET性能的文章时，吞吐量和内存一直是我关注的两个主要指标。然而，最近，另一个指标引起了很多关注：施胶剂，特别是用于独立、修整应用的盘上施胶剂。这主要是因为Blazor WebAssembly（WASM）应用程序模型，其中整个.NET应用程序（包括运行时）被下载到浏览器并在浏览器中执行。在.NET 5中进行了一些工作以减小大小，但在.NET 6中进行了大量工作，包括dotnet/runtime以及mono/linker中的更改，后者提供了分析和重写程序集的微调器，以删除（或“trim”或“tree shake”）未使用的功能。工作的很大一部分。NET 6实际上进入了修剪安全，使得任何核心库都可以在修剪的应用程序中使用，这样要么所需的一切都将被正确保留，要么修剪器将产生关于错误的警告以及开发人员如何修复它。然而，在缩小尺寸本身上有相当大的努力（双关语，我很有趣）。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>To start, let’s take a look at what size looked like for .NET 5. I’ll create and run a new .NET 5 Blazor WASM application using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span></code><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>首先，让我们看看.NET 5的大小。我将使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span></code> 创建并运行一个新的. NET5BlazorWASM应用程序</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> blazorwasm </span></span><span class=pun><span class=pun>--</span></span><span class=pln><span class=pln>framework net5</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>--</span></span><span class=pln><span class=pln>output app5
cd app5
dotnet run</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=lightbox-link aria-label="Lightbox image, click or press enter to enlarge" href=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/BlazorTemplate.png data-featherlight=image data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img decoding=async class="alignnone lazyloaded" data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/BlazorTemplate.png src="data:image/png;base64,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" alt="Blazor App, Performance Improvements in .NET 6" width=1404 height=564 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></a></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>It works, nice. Now, I can publish it, which will create and trim the whole application, and produce all the relevant assets ready for pushing to my server; that includes Brotli-compressing all the required components.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>很好用。现在，我可以发布它，这将创建和修剪整个应用程序，并产生所有相关资产准备推到我的服务器;包括布洛特利压缩所有需要的部件。 </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet publish </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I see output like the following, and it completes successfully:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我看到如下所示的输出，并且它成功完成： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>examples\app5</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> dotnet publish </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Microsoft</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>R</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Build</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Engine</span></span><span class=pln><span class=pln> version </span></span><span class=lit><span class=lit>17.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>preview</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>21411</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>b0bb46ab8 </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET
</span></span><span class=typ><span class=typ>Copyright</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>C</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Microsoft</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Corporation</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>All</span></span><span class=pln><span class=pln> rights reserved</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>

  </span></span><span class=typ><span class=typ>Determining</span></span><span class=pln><span class=pln> projects to restore</span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>All</span></span><span class=pln><span class=pln> projects are up</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>to</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>date </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> restore</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>You</span></span><span class=pln><span class=pln> are </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> a preview version </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>See</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> https</span></span><span class=pun><span class=pun>:</span></span><span class=com><span class=com>//aka.ms/dotnet-core-preview</span></span><span class=pln><span class=pln>
  app5 </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net5</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\app5</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>dll
  app5 </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Blazor</span></span><span class=pln><span class=pln> output</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net5</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\wwwroot
  </span></span><span class=typ><span class=typ>Optimizing</span></span><span class=pln><span class=pln> assemblies </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> size</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> which may change the behavior </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> the app</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Be</span></span><span class=pln><span class=pln> sure to test after publishing</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>See</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> https</span></span><span class=pun><span class=pun>:</span></span><span class=com><span class=com>//aka.ms/dotnet-illink</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>Compressing</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Blazor</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebAssembly</span></span><span class=pln><span class=pln> publish artifacts</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>This</span></span><span class=pln><span class=pln> may take a </span></span><span class=kwd><span class=kwd>while</span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
  app5 </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net5</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\publish
D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5</span></span><span class=pun><span class=pun>&gt;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The published compressed files end up for me in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>D</span><span class=pun>:</span><span class=pln>\examples\app5\b</span><span class=kwd>in</span><span class=pln>\Release\net5</span><span class=pun>.</span><span class=lit>0</span><span class=pln>\publish\wwwroot_framework</span></code>, and if I sum up all of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>br</span></code> files (except for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt_CJK</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt_EFIGS</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt_no_CJK</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code>, which are subsets of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code> that’s also there), I get a total size of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>2.10</span><span class=pln> MB</span></code>. That’s the entirety of the application, including the runtime, all of the library functionality used by the app, and the app code itself. Cool.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>发布的压缩文件在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>D</span><span class=pun>:</span><span class=pln>\examples\app5\b</span><span class=kwd>in</span><span class=pln>\Release\net5</span><span class=pun>.</span><span class=lit>0</span><span class=pln>\publish\wwwroot_framework</span></code> 中结束，如果我将所有 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>br</span></code> 文件相加（除了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt_CJK</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt_EFIGS</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt_no_CJK</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code> ，它们也是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code> 的子集），我得到的总大小为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>2.10</span><span class=pln> MB</span></code> 。这就是整个应用程序，包括运行时、应用程序使用的所有库功能以及应用程序代码本身。酷了</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Now, let’s do the exact same thing, but with .NET 6:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>现在，让我们做完全相同的事情，但对于.NET 6： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet </span></span><span class=kwd><span class=kwd>new</span></span><span class=pln><span class=pln> blazorwasm </span></span><span class=pun><span class=pun>--</span></span><span class=pln><span class=pln>framework net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>--</span></span><span class=pln><span class=pln>output app6
cd app6
dotnet publish </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>which yields:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>其产生： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> dotnet publish </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Microsoft</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>R</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Build</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Engine</span></span><span class=pln><span class=pln> version </span></span><span class=lit><span class=lit>17.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>preview</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>21411</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>b0bb46ab8 </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET
</span></span><span class=typ><span class=typ>Copyright</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>C</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Microsoft</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Corporation</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>All</span></span><span class=pln><span class=pln> rights reserved</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>

  </span></span><span class=typ><span class=typ>Determining</span></span><span class=pln><span class=pln> projects to restore</span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>All</span></span><span class=pln><span class=pln> projects are up</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>to</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>date </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> restore</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>You</span></span><span class=pln><span class=pln> are </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> a preview version </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>See</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> https</span></span><span class=pun><span class=pun>:</span></span><span class=com><span class=com>//aka.ms/dotnet-core-preview</span></span><span class=pln><span class=pln>
  app6 </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\app6</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>dll
  app6 </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Blazor</span></span><span class=pln><span class=pln> output</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\wwwroot
  </span></span><span class=typ><span class=typ>Optimizing</span></span><span class=pln><span class=pln> assemblies </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> size</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> which may change the behavior </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> the app</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Be</span></span><span class=pln><span class=pln> sure to test after publishing</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>See</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> https</span></span><span class=pun><span class=pun>:</span></span><span class=com><span class=com>//aka.ms/dotnet-illink</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>Compressing</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Blazor</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebAssembly</span></span><span class=pln><span class=pln> publish artifacts</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>This</span></span><span class=pln><span class=pln> may take a </span></span><span class=kwd><span class=kwd>while</span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
  app6 </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\publish
D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6</span></span><span class=pun><span class=pun>&gt;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>as before. Except now when I sum up the relevant <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>br</span></code> files in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>D</span><span class=pun>:</span><span class=pln>\examples\app6\b</span><span class=kwd>in</span><span class=pln>\Release\net6</span><span class=pun>.</span><span class=lit>0</span><span class=pln>\publish\wwwroot_framework</span></code>, the total size is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1.88MB</span></code>. Just by upgrading from .NET 5 to .NET 6, we’ve shaved ~220KB off the total size, even as .NET 6 gains lots of additional code. <em data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>A lot</em> of PRs contributed here, as most changes shave off a few bytes here and a few bytes there. Here are some example changes that were made in the name of size, as they can help to highlight the kinds of changes applications and libraries in general can make to help reduce their footprint:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>像以前除了现在，当我将相关的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>br</span></code> 文件汇总在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>D</span><span class=pun>:</span><span class=pln>\examples\app6\b</span><span class=kwd>in</span><span class=pln>\Release\net6</span><span class=pun>.</span><span class=lit>0</span><span class=pln>\publish\wwwroot_framework</span></code> 中时，总大小是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1.88MB</span></code> 。仅仅通过从.NET 5升级到.NET 6，我们就削减了约220KB的总大小，即使.NET 6获得了大量额外的代码。这里有很多PR贡献，因为大多数更改在这里减少了几个字节，在那里减少了几个字节。以下是一些以size命名的更改示例，因为它们可以帮助突出应用程序和库通常可以进行的更改类型，以帮助减少其占用空间：</font></font></font></p>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/44712 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44712</a> and <a href=https://github.com/dotnet/runtime/pull/44706 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44706</a>. When run over an application, the trimmer identifies unused types and removes them; use a type just once, and it needs to be kept. Over the years, .NET has amassed variations on a theme, with multiple types that can be used for the same purpose, and there’s then value in consolidating all usage to just one of them such that the other is more likely to be trimmed away. A good example of this is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Tuple</span><span class=pun>&lt;&gt;</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code>. Throughout the codebase there are occurrences of both; this PR replaces a bunch of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Tuple</span><span class=pun>&lt;&gt;</span></code> use with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code>, which not only helps to avoid allocations in some cases, it makes it much more likely that more <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Tuple</span><span class=pun>&lt;&gt;</span></code> types can be trimmed away.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#44712和dotnet/runtime#44706。当在应用程序上运行时，修剪器识别未使用的类型并删除它们;只使用一次类型，它需要保留。多年来，.NET已经积累了一个主题的变体，有多种类型可以用于相同的目的，然后将所有使用合并到其中一个，这样另一个更有可能被修剪掉。一个很好的例子是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Tuple</span><span class=pun>&lt;&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code> 。在整个代码库中，两者都有出现;这个PR用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code> 取代了一堆 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Tuple</span><span class=pun>&lt;&gt;</span></code> 使用，这不仅有助于避免某些情况下的分配，而且更有可能削减更多 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Tuple</span><span class=pun>&lt;&gt;</span></code> 类型。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/43634 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43634</a>. The nature of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code> is that there are lots of copies of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code>, one for each arity (e.g. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;</span><span class=pln>T1</span><span class=pun>,</span><span class=pln> T2</span><span class=pun>&gt;</span></code>, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;</span><span class=pln>T1</span><span class=pun>,</span><span class=pln> T2</span><span class=pun>,</span><span class=pln> T3</span><span class=pun>&gt;</span></code>, etc.), and then because it’s a generic often used with value types, every generic instantiation of a given tuple type ends up duplicating all of the assembly for that type. Thus, it’s valuable to keep the types as slim as possible. This PR introduced a throw helper and then replaced ~20 throw sites from across the types, reducing the amount of assembly required for each.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#43634。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code> 的性质是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;&gt;</span></code> 有很多副本，每个数组一个副本（例如： <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;</span><span class=pln>T1</span><span class=pun>,</span><span class=pln> T2</span><span class=pun>&gt;</span></code> 、 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ValueTuple</span><span class=pun>&lt;</span><span class=pln>T1</span><span class=pun>,</span><span class=pln> T2</span><span class=pun>,</span><span class=pln> T3</span><span class=pun>&gt;</span></code> 等），然后因为它是一个常与值类型一起使用的泛型，所以给定元组类型的每个泛型实例化最终都会复制该类型的所有程序集。因此，保持类型尽可能苗条是有价值的。这个PR引入了一个抛出帮助器，然后从不同类型中替换了大约20个抛出站点，减少了每个站点所需的组装量。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/45054 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45054</a>. This PR represents a typical course of action when trying to reduce the size of a trimmed application: cutting unnecessary references from commonly used code to less commonly used code. In this case, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RuntimeType</span></code> (the derivation of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Type</span></code> that’s most commonly used) has a dependency on the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Convert</span></code> type, which makes it so that the trimmer can’t trim away <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Convert</span></code>‘s static constructor. This PR rewrites the relevant, small portions of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RuntimeType</span></code> to not need <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Convert</span></code> at all.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#45054。此PR代表了尝试减小修剪后的应用程序大小时的典型操作过程：将不必要的引用从常用代码删除到不常用代码。在这种情况下， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RuntimeType</span></code> （最常用的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Type</span></code> 的派生）依赖于 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Convert</span></code> 类型，这使得修剪器无法修剪掉 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Convert</span></code> 的静态构造函数。此PR重写了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>RuntimeType</span></code> 的相关小部分，使其完全不需要 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Convert</span></code> 。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/45127 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45127</a>. If a type’s static constructor initializes a field, the trimmer is unable to remove the field or the thing it’s being initialized to, so for rarely used fields, it can be beneficial to initialize them lazily. This PR makes the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Factory</span></code> property lazily-initialized (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>Factory</span></code> remains non-lazily-initialized, as it’s much more commonly used), which then also makes it more likely that <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskFactory</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> can be trimmed away.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#45127。如果一个类型的静态构造函数初始化了一个字段，则微调器无法移除该字段或它被初始化的对象，因此对于很少使用的字段，延迟初始化它们可能是有益的。这个PR使得 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;.</span><span class=typ>Factory</span></code> 属性被惰性初始化（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Task</span><span class=pun>.</span><span class=typ>Factory</span></code> 保持非惰性初始化，因为它更常用），这也使得 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskFactory</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 更有可能被修剪掉。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/45239 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45239</a>. It’s very common when multiple overloads of something exist for the simpler overload to delegate to the more complicated overload. However, typically the more complicated overload has more inherent dependencies than would the simpler one, and so from a trimming perspective, it can actually be beneficial to invert the dependency chain, and have the more complicated overload delegate to the simpler one to handle the subset of functionality required for the simple one. This PR does that for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Utf8Encoding</span></code>‘s constructors and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskFactory</span></code>‘s constructors.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#45239。当存在多个重载时，将较简单的重载委托给较复杂的重载是非常常见的。然而，通常，更复杂的重载比更简单的重载具有更多的固有依赖性，并且因此从修整的角度来看，反转依赖性链，并且使更复杂的重载委托给更简单的重载以处理简单重载所需的功能子集实际上可能是有益的。这个PR为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Utf8Encoding</span></code> 的构造函数和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TaskFactory</span></code> 的构造函数做了这一点。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/52681 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52681</a> and <a href=https://github.com/dotnet/runtime/pull/52794 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52794</a>. Sometimes analyzing the code that remains after trimming makes you rethink whether functionality you have in your library or app is actually necessary. In doing so for System.Net.Http.dll, we realized we were keeping around a ton of mail address-related parsing code in the assembly, purely in the name of validating <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>From</span></code> headers in a way that wasn’t particularly useful, so we removed it. We also avoided including code into the WASM build of the assembly that wouldn’t actually be used in that build. These efforts shrunk the size of the assembly by almost 15%.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#52681和dotnet/runtime#52794。有时，分析修剪后剩余的代码会让你重新思考库或应用程序中的功能是否真的是必要的。在对System.Net.Http.dll执行此操作时，我们意识到我们在程序集中保留了大量与邮件地址相关的解析代码，纯粹是以一种没有特别有用的方式验证 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>From</span></code> 头的名义，所以我们删除了它。我们还避免了在程序集的WASM版本中包含实际上不会使用的代码。这些努力使组装体的规模缩小了近15%。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/45296 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45296</a> and <a href=https://github.com/dotnet/runtime/pull/45643 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45643</a>. To support various concepts from the globalization APIs when using the ICU globalization implementation, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Private</span><span class=pun>.</span><span class=typ>CoreLib</span></code> carries with it several sizeable data tables. These PRs significantly reduce the size of that data, by encoding it in a much more compact form and by accessing the blittable data as a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> around the data directly from the assembly.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#45296和dotnet/runtime#45643。为了在使用ICU全球化实现时支持来自全球化API的各种概念， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Private</span><span class=pun>.</span><span class=typ>CoreLib</span></code> 携带了几个相当大的数据表。这些PR通过以更紧凑的形式对数据进行编码，并通过直接从程序集访问可分块数据作为围绕数据的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> ，显著地减小了该数据的大小。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/46061 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46061</a>. Similarly, to support ordinal case conversion, <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Private</span><span class=pun>.</span><span class=typ>CoreLib</span></code> carries a large casing table. This table is stored in memory in a static <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ushort</span><span class=pun>[]?[]</span></code> array, and previously, it was initialized with collection-initialization syntax. That resulted in the generated static constructor for initializing the array being over 1KB of IL instructions. This PR changed it to actually store the data in the assembly encoded as bytes, and then in the constructor create the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ushort</span><span class=pun>[]?[]</span></code> from a <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> over that data.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#46061。类似地，为了支持序数大小写转换， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Private</span><span class=pun>.</span><span class=typ>CoreLib</span></code> 携带一个大的大小写表。此表以静态 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ushort</span><span class=pun>[]?[]</span></code> 数组的形式存储在内存中，并且之前，它是用集合初始化语法初始化的。这导致生成的用于初始化数组的静态构造函数超过1 KB的IL指令。这个PR改变了它，实际上将数据存储在程序集中编码为字节，然后在构造函数中从该数据上的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>ReadOnlySpan</span><span class=str>&lt;byte&gt;</span></code> 创建 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>ushort</span><span class=pun>[]?[]</span></code> 。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/48906 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48906</a>. This is also in a similar vein to the previous ICU changes. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebUtility</span></code> has a static <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;</span><span class=kwd>ulong</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>&gt;</span></code> lookup table. Previously, that dictionary was being initialized in a manner that led to <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebUtility</span></code>‘s static constructor being over 17KB of IL. This PR reduces it to less than 300B.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#48906。这也与之前的ICU变化相似。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebUtility</span></code> 有一个静态 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Dictionary</span><span class=pun>&lt;</span><span class=kwd>ulong</span><span class=pun>,</span><span class=pln> </span><span class=kwd>char</span><span class=pun>&gt;</span></code> 查找表。以前，字典的初始化方式导致 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>WebUtility</span></code> 的静态构造函数超过17 KB的IL。此PR将其降低到小于300 B。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/46211 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46211</a>. The trimmer looks at IL to determine whether some code uses some other code, but there are dependencies it can’t always see. There are multiple ways a developer can inform the trimmer it should keep some code around even if it doesn’t know why. One is via a special XML file that can be fed to the trimmer to tell it which members should be considered rooted and not trimmed away. That mechanism, however, is a very large hammer. The preferred mechanism is a set of attributes that allow for the information to be much more granular. In particular, the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DynamicDependencyAttribute</span></code> lets the developer declare that some member <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code> should be kept if some other member <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> is kept. This PR switches some rooting with the XML file to instead use the attributes.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#46211。修剪器查看IL以确定某些代码是否使用了其他代码，但它并不总是能看到依赖项。开发人员可以通过多种方式通知修剪器，即使它不知道为什么也应该保留一些代码。一种是通过一个特殊的XML文件，该文件可以提供给修剪器，告诉它哪些成员应该被认为是root成员而不是修剪掉的。然而，这个机制是一个非常大的锤子。首选的机制是一组属性，这些属性允许信息更加精细。特别是， <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>DynamicDependencyAttribute</span></code> 让开发人员声明如果保留某个其他成员 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>B</span></code> ，则应保留某个成员 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>A</span></code> 。此PR将XML文件的某些根转换为使用属性。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/47918 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47918</a>. Since its porting to .NET Core, LINQ has received a lot of attention, as it’s a ripe area for optimization. A set of the optimizations that went into LINQ involved adding a few new internal interfaces that could then be implemented on a bunch of types representing the various LINQ combinators in order to communicate additional data between operators. This resulted in massive speedups for certain operations, however it also added a significant amount of IL to System.Linq.dll, around 20K uncompressed (around 6K compressed). And it has the potential to result in an order of magnitude more assembly code, depending on how these types are instantiated. Because of the latter issue, a special-build flavor was previously added to the assembly, so that it could be built without those optimizations that were contributing significantly to its size. This PR cleaned that up and extended it so that the size-optimized build could be used for Blazor WASM and other mobile targets.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#47918。自从它移植到.NET Core以来，LINQ受到了很多关注，因为它是一个成熟的优化领域。LINQ中的一组优化涉及添加一些新的内部接口，然后可以在表示各种LINQ组合子的一堆类型上实现这些接口，以便在运算符之间传递额外的数据。这导致了某些操作的大幅加速，但它也为System.Linq.dll增加了大量的IL，约20 K未压缩（约6 K压缩）。而且它有可能产生数量级更多的汇编代码，这取决于这些类型是如何实例化的。由于后一个问题，以前向程序集添加了一个特殊的构建风格，这样就可以在没有那些显著增加其大小的优化的情况下构建它。这个PR清理并扩展了它，以便大小优化的构建可以用于Blazor WASM和其他移动的目标。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/53317 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53317</a>. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code>‘s <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> was using <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DynamicDependency</span><span class=pun>]</span></code> to root all of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Collections</span><span class=pun>.</span><span class=typ>Immutable</span></code> collections, just in case they were used. This PR undoes that dependency, saving ~28KB compressed in a default Blazor WASM application.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#53317。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Text</span><span class=pun>.</span><span class=typ>Json</span></code> 的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>JsonSerializer</span></code> 正在使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>DynamicDependency</span><span class=pun>]</span></code> 来root所有的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Collections</span><span class=pun>.</span><span class=typ>Immutable</span></code> 集合，以防它们被使用。此PR取消了该依赖性，在默认的Blazor WASM应用程序中节省了约28 KB的压缩。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/44696 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44696</a> from <a href=https://github.com/benaadams target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@benaadams</a>, <a href=https://github.com/dotnet/runtime/pull/44734 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44734</a>, <a href=https://github.com/dotnet/runtime/pull/44825 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44825</a>, <a href=https://github.com/dotnet/runtime/pull/47496 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47496</a>, <a href=https://github.com/dotnet/runtime/pull/47873 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47873</a>, <a href=https://github.com/dotnet/runtime/pull/53123 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#53123</a>, and <a href=https://github.com/dotnet/runtime/pull/56937 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#56937</a>. We have a love/hate relationship with LINQ. On the one hand, it’s an invaluable tool for quickly expressing complicated operations with very little code, and in the common case, it’s perfectly fine to use and we encourage applications to use it. On the other hand, from a performance perspective, LINQ isn’t stellar, even as we’ve invested significantly in improving it. From a throughput and memory perspective, simple LINQ operations will invariably be more expensive than hand-rolled versions of the same thing, if for no other reason than because the expressability it provides means functionality is passed around as delegates, enumerators are allocated, and so on. And from a size perspective, all that functionality comes with a lot of IL (and most of the time, any attempts we make to increase throughput also increase size). If in the libraries we can replace LINQ usage with only minimally larger open-coded replacements, we’ll typically do so.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 来自@benaadams的dotnet/runtime#44696、dotnet/runtime#44734、dotnet/runtime#44825、dotnet/runtime#47496、dotnet/runtime#47873、dotnet/runtime#53123和dotnet/runtime#56937。我们对LINQ有爱/恨的关系。一方面，它是一个非常宝贵的工具，可以用很少的代码快速表达复杂的操作，在通常情况下，它非常好用，我们鼓励应用程序使用它。另一方面，从性能的角度来看，LINQ并不出色，即使我们已经投入了大量资金来改进它。从吞吐量和内存的角度来看，简单的LINQ操作总是比同样的东西的手工版本更昂贵，如果没有其他原因，只是因为它提供的可表达性意味着功能作为委托传递，分配枚举数，等等。 从大小的角度来看，所有这些功能都伴随着大量的IL（大多数时候，我们为增加吞吐量所做的任何尝试都会增加大小）。如果在库中，我们可以用最小的更大的开放代码替换来替换LINQ的使用，我们通常会这样做。</font></font></font></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet/runtime/pull/39549 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#39549</a>. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> contains the compiled WebAssembly for the mono runtime used in Blazor WASM apps. The more features unnecessary for this scenario (e.g. various debugging features, dead code in this configuration, etc.) that can be removed in the build, the smaller the file will be.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> dotnet/runtime#39549。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> 包含Blazor WASM应用程序中使用的mono运行时的已编译WebAssembly。这种情况下不必要的功能越多（例如各种调试功能、此配置中的死代码等）文件越小。</font></font></font></li>
</ul>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Now, let’s take the size reduction a step further. The runtime itself is contained in the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> file, but when we trim the app as part of publishing, we’re only trimming the managed assemblies, not the runtime, as the SDK itself doesn’t include the tools necessary to do so. We can rectify that by installing the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>wasm</span><span class=pun>-</span><span class=pln>tools</span></code> workload via <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span></code> (<a href=https://github.com/dotnet/runtime/pull/43785 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43785</a>):<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>现在，让我们进一步缩小尺寸。运行时本身包含在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> 文件中，但是当我们在发布过程中修剪应用时，我们只修剪托管程序集，而不是运行时，因为SDK本身不包含这样做所需的工具。我们可以通过 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span></code> （dotnet/runtime#43785）安装 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>wasm</span><span class=pun>-</span><span class=pln>tools</span></code> 工作负载来纠正这个问题：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet workload install wasm</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>tools</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>With that installed, we can publish again, exactly as before:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>安装好后，我们可以像以前一样再次发布： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet publish </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>but now we see some extra output (and it takes longer to publish):<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>但现在我们看到一些额外的输出（并且需要更长的时间来发布）： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> dotnet publish </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span><span class=pln><span class=pln>
</span></span><span class=typ><span class=typ>Microsoft</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>R</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Build</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Engine</span></span><span class=pln><span class=pln> version </span></span><span class=lit><span class=lit>17.0</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>preview</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>21411</span></span><span class=pun><span class=pun>-</span></span><span class=lit><span class=lit>06</span></span><span class=pun><span class=pun>+</span></span><span class=pln><span class=pln>b0bb46ab8 </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET
</span></span><span class=typ><span class=typ>Copyright</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>C</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Microsoft</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Corporation</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>All</span></span><span class=pln><span class=pln> rights reserved</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>

  </span></span><span class=typ><span class=typ>Determining</span></span><span class=pln><span class=pln> projects to restore</span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>Restored</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\app6</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>csproj </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>245</span></span><span class=pln><span class=pln> ms</span></span><span class=pun><span class=pun>).</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>You</span></span><span class=pln><span class=pln> are </span></span><span class=kwd><span class=kwd>using</span></span><span class=pln><span class=pln> a preview version </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>NET</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>See</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> https</span></span><span class=pun><span class=pun>:</span></span><span class=com><span class=com>//aka.ms/dotnet-core-preview</span></span><span class=pln><span class=pln>
  app6 </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\app6</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>dll
  app6 </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Blazor</span></span><span class=pln><span class=pln> output</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\wwwroot
  </span></span><span class=typ><span class=typ>Optimizing</span></span><span class=pln><span class=pln> assemblies </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> size</span></span><span class=pun><span class=pun>,</span></span><span class=pln><span class=pln> which may change the behavior </span></span><span class=kwd><span class=kwd>of</span></span><span class=pln><span class=pln> the app</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Be</span></span><span class=pln><span class=pln> sure to test after publishing</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>See</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> https</span></span><span class=pun><span class=pun>:</span></span><span class=com><span class=com>//aka.ms/dotnet-illink</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>Compiling</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>native</span></span><span class=pln><span class=pln> assets </span></span><span class=kwd><span class=kwd>with</span></span><span class=pln><span class=pln> emcc</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>This</span></span><span class=pln><span class=pln> may take a </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>Linking</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>with</span></span><span class=pln><span class=pln> emcc</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>This</span></span><span class=pln><span class=pln> may take a </span></span><span class=kwd><span class=kwd>while</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
  </span></span><span class=typ><span class=typ>Compressing</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Blazor</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>WebAssembly</span></span><span class=pln><span class=pln> publish artifacts</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>This</span></span><span class=pln><span class=pln> may take a </span></span><span class=kwd><span class=kwd>while</span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln>
  app6 </span></span><span class=pun><span class=pun>-&gt;</span></span><span class=pln><span class=pln> D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\publish
D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6</span></span><span class=pun><span class=pun>&gt;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>See those two extra <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>emcc</span></code>-related lines. <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>emcc</span></code> is the Emscripten front-end compiler (Emscripten is a compiler toolchain for compiling to WebAssembly), and what we’re seeing here is <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> being relinked so as to remove functionality from the binary that’s not used by the trimmed binaries in the application. If I now re-measure the size of the relevant <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>br</span></code> files in <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>D</span><span class=pun>:</span><span class=pln>examplesapp6binReleasenet6</span><span class=pun>.</span><span class=lit>0publishwwwroot</span><span class=pln>_framework</span></code>, it’s now <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1.82MB</span></code>, so we’ve removed an additional <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>60KB</span></code> from the published application size.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>看到这两个额外的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>emcc</span></code> 相关的行。 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>emcc</span></code> 是Emscripten前端编译器（Emscripten是用于编译为WebAssembly的编译器工具链），我们在这里看到的是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> 被重新链接，以便从二进制文件中删除未被应用程序中的修剪二进制文件使用的功能。如果我现在重新测量 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>D</span><span class=pun>:</span><span class=pln>examplesapp6binReleasenet6</span><span class=pun>.</span><span class=lit>0publishwwwroot</span><span class=pln>_framework</span></code> 中相关的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>br</span></code> 文件的大小，现在是 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1.82MB</span></code> ，所以我们已经从发布的应用程序大小中删除了额外的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>60KB</span></code> 。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>We can go further, though. I’ll add two lines to my app6.csproj in the top <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=tag>&lt;PropertyGroup&gt;</span><span class=pln>...</span><span class=tag>&lt;/PropertyGroup&gt;</span></code> section:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我们可以走得更远。我将在app6.csproj的顶部 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=tag>&lt;PropertyGroup&gt;</span><span class=pln>...</span><span class=tag>&lt;/PropertyGroup&gt;</span></code> 部分添加两行：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-xml prettyprinted"><span class=pln><span class=pln>    </span></span><span class=tag><span class=tag>&lt;InvariantGlobalization&gt;</span></span><span class=pln><span class=pln>true</span></span><span class=tag><span class=tag>&lt;/InvariantGlobalization&gt;</span></span><span class=pln><span class=pln>
    </span></span><span class=tag><span class=tag>&lt;BlazorEnableTimeZoneSupport&gt;</span></span><span class=pln><span class=pln>false</span></span><span class=tag><span class=tag>&lt;/BlazorEnableTimeZoneSupport&gt;</span></span><span class=pln><span class=pln>    </span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>These are feature switches, and serve two purposes. First, they can be queried by code in the app (and, in particular, in the core libraries) to determine what functionality to employ. For example, if you search dotnet/runtime for “GlobalizationMode.Invariant”, you’ll find code along the lines of:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这些是功能开关，有两个用途。首先，它们可以通过应用程序中的代码（特别是核心库中的代码）进行查询，以确定要使用什么功能。例如，如果你在dotnet/runtime中搜索“GlobalizationMode.Invariant”，你会发现代码沿着： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=kwd><span class=kwd>if</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>GlobalizationMode</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Invariant</span></span><span class=pun><span class=pun>)</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln> </span></span><span class=com><span class=com>// only use invariant culture / functionality</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=kwd><span class=kwd>else</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>...</span></span><span class=pln><span class=pln> </span></span><span class=com><span class=com>// use ICU or NLS for processing based on the appropriate culture</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Second, the switch informs the trimmer that it can substitute in a fixed value for the property associated with the switch, e.g. setting <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=tag>&lt;InvariantGlobalization&gt;</span><span class=pln>true</span><span class=tag>&lt;/InvariantGlobalization&gt;</span></code> causes the trimmer to rewrite the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GlobalizationMode</span><span class=pun>.</span><span class=typ>Invariant</span></code> property to be hardcoded to return <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code>, at which point it can then use that to prune away any visibly unreachable code paths. That means in an example like the code snippet above, the trimmer can elide the entire <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>else</span></code> block, and if that ends up meaning additional types and members become unused, they can be removed, as well. By setting the two aforementioned switches, we’re eliminating any need the app has for the ICU globalization library, which is a significant portion of the app’s size, both in terms of the logic linked into <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> and the data necessary to drive it (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code>). With those switches set, we can re-publish (after deleting the old <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>publish</span></code> directory). Two things I immediately notice. First, there aren’t any <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icu</span><span class=pun>*.</span><span class=pln>br</span></code> files at all, as there’s no longer a need for anything ICU-related. And second, all of the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>br</span></code> files weigh in at only <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1.07MB</span></code>, removing another 750KB from the app’s size, more than 40% of where we were before.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>第二，开关通知修剪器它可以用固定值替换与开关相关联的属性，例如设置 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=tag>&lt;InvariantGlobalization&gt;</span><span class=pln>true</span><span class=tag>&lt;/InvariantGlobalization&gt;</span></code> 使得修剪器重写要被硬编码的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>GlobalizationMode</span><span class=pun>.</span><span class=typ>Invariant</span></code> 属性以返回 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>true</span></code> ，此时它可以使用该属性来修剪掉任何可见不可到达的代码路径。这意味着在上面的代码片段这样的例子中，修剪器可以省略整个 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>else</span></code> 块，如果这意味着其他类型和成员变得未使用，它们也可以被删除。通过设置上述两个开关，我们消除了应用程序对ICU全球化库的任何需求，这是应用程序大小的重要部分，无论是链接到 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> 的逻辑还是驱动它所需的数据（ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icudt</span><span class=pun>.</span><span class=pln>dat</span><span class=pun>.</span><span class=pln>br</span></code> ）。设置这些开关后，我们可以重新发布（删除旧的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>publish</span></code> 目录后）。我立刻注意到了两件事。首先，根本没有任何 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>icu</span><span class=pun>*.</span><span class=pln>br</span></code> 文件，因为不再需要任何与ICU相关的文件。 第二，所有 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>.</span><span class=pln>br</span></code> 文件的权重仅为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=lit>1.07MB</span></code> ，从应用程序的大小中又删除了750KB，超过了我们之前的40%。</font></font></font></p>
<h3 id=blazor-and-mono data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Blazor and mono<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Blazor和mono </font></font></font><a aria-labelledby=blazor-and-mono class=linkicon href=#blazor-and-mono data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h3>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Ok, so we’ve got our Blazor WASM app, and we’re able to ship a small package down to the browser to execute it. Does it run efficiently?<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>好了，我们已经有了Blazor WASM应用程序，我们可以将一个小包发送到浏览器来执行它。它运行效率高吗？ </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> file mentioned previously contains the .NET runtime used to execute these applications. The runtime is itself compiled to WASM, downloaded to the browser, and used to execute the application and library code on which the app depends. I say “the runtime” here, but in reality there are actually multiple incarnations of a runtime for .NET. In .NET 6, all of the .NET core libraries for all of the .NET app models, whether it be console apps or ASP.NET Core or Blazor WASM or mobile apps, come from the same source in dotnet/runtime, but there are actually two runtime implementations in dotnet/runtime: “coreclr” and “mono”. In this blog post, when I’ve talked about runtime improvements in components like “the” JIT and GC, I’ve actually been referring to coreclr, which is what’s used for console apps, ASP.NET Core, Windows Forms, and WPF. Blazor WebAssembly, however, relies on mono, which has been honed over the years to be small and agile for these kinds of scenarios, and has also received a lot of performance investment in .NET 6.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>前面提到的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet</span><span class=pun>.</span><span class=pln>wasm</span></code> 文件包含用于执行这些应用程序的.NET运行时。运行时本身被编译为WASM，下载到浏览器，并用于执行应用程序所依赖的应用程序和库代码。我在这里说的是“运行时”，但实际上，. NET运行时有多种体现。在.NET 6中，用于所有.NET应用程序模型的所有.NET核心库，无论是控制台应用程序、ASP.NET Core应用程序、Blazor WASM或移动的应用程序，都来自于dotnet/runtime中的同一个来源，但dotnet/runtime中实际上有两个运行时实现：“coreclr”和“mono”。在这篇博文中，当我谈到像JIT和GC这样的组件的运行时改进时，我实际上指的是coreclr，它用于控制台应用程序、ASP.NET Core、Windows Forms和WPF。 然而，Blazor WebAssembly依赖于mono，多年来，mono已经被磨练为针对这类场景的小型和敏捷，并且在.NET 6中也获得了大量的性能投资。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There are three significant areas of investment here. The first is around improvements to the IL interpreter in mono. Mono not only has a JIT capable of on-demand assembly generation ala coreclr, it also supports interpreting IL, which is valuable on platforms that for security reasons prohibit executing machine assembly code generated on the fly. <a href=https://github.com/dotnet/runtime/pull/46037 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#46037</a> overhauled the interpreter to move it from being stack-based (where IL instructions push and pop values from a stack) to being based on the concept of reading/writing local variables, a switch that both simplified the code base and gave it a performance boost. <a href=https://github.com/dotnet/runtime/pull/48513 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48513</a> improved the interpreter’s ability to inline, in particular for methods attributed with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>MethodImpl</span><span class=pun>(</span><span class=typ>MethodImplOptions</span><span class=pun>.</span><span class=typ>AggressiveInlining</span><span class=pun>)]</span></code>, which is important with the libraries in dotnet/runtime as some of the lower-level processing routines make strategic use of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AggressiveInlining</span></code> in places it’s been measured to yield impactful gains. <a href=https://github.com/dotnet/runtime/pull/50361 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50361</a>, <a href=https://github.com/dotnet/runtime/pull/51273 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51273</a>, <a href=https://github.com/dotnet/runtime/pull/52130 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52130</a>, and <a href=https://github.com/dotnet/runtime/pull/52242 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#52242</a> all served to optimize how various kinds of instructions were encoded and invoked, and <a href=https://github.com/dotnet/runtime/pull/51309 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51309</a> improved the efficiency of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>finally</span></code> blocks by removing overhead associated with thread aborts, which no longer exist in .NET (.NET Framework 4.8 and earlier have the concept of a thread abort, where one thread can inject a special exception into another, and that exception could end up being thrown at practically any instruction; by default, however, they don’t interrupt <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>finally</span></code> blocks).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这里有三大投资领域。第一个是关于mono中IL解释器的改进。Mono不仅具有能够按需生成汇编的JIT，而且还支持解释IL，这在出于安全原因禁止执行即时生成的机器汇编代码的平台上是有价值的。dotnet/runtime#46037对解释器进行了彻底的改造，将其从基于堆栈的（IL指令从堆栈中推送和弹出值）转变为基于阅读/写局部变量的概念，这种转换既简化了代码库，又提高了性能。dotnet/runtime#48513提高了解释器的内联能力，特别是对于属性为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pun>[</span><span class=typ>MethodImpl</span><span class=pun>(</span><span class=typ>MethodImplOptions</span><span class=pun>.</span><span class=typ>AggressiveInlining</span><span class=pun>)]</span></code> 的方法，这对于dotnet/runtime中的库来说是很重要的，因为一些较低级别的处理例程在被测量为产生影响性收益的地方战略性地使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>AggressiveInlining</span></code> 。 dotnet/runtime#50361、dotnet/runtime#51273、dotnet/runtime#52130和dotnet/runtime#52242都用于优化各种指令的编码和调用方式，dotnet/runtime#51309通过去除线程中止相关的开销来提高 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>finally</span></code> 块的效率，线程中止不再存在于.NET中（.NET Framework 4.8和更早版本有线程中止的概念，其中一个线程可以将特殊异常注入到另一个线程中，并且该异常可能最终在几乎任何指令中抛出）;但是，默认情况下，它们不中断 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=kwd>finally</span></code> 块）。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The second area of investment was around <a href=https://devblogs.microsoft.com/dotnet/hardware-intrinsics-in-net-core/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>hardware intrinsics</a>. .NET Core 3.0 and .NET 5 added literally thousands of new methods, each of which map effectively 1:1 with some hardware-specific instruction, enabling C# code to directly target functionality from various ISAs (Instruction Set Architectures) like SSSE3 or AVX2. Of course, something needs to be able to translate the C# methods into the underlying instructions they represent, which means a lot of work to fully enable every code generator. Mono supports using LLVM for code generation, and a bunch of PRs improved the LLVM-enabled mono’s support for hardware intrinsics, whether it be <a href=https://github.com/dotnet/runtime/pull/49260 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49260</a>, <a href=https://github.com/dotnet/runtime/pull/49737 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49737</a>, <a href=https://github.com/dotnet/runtime/pull/48361 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48361</a>, and <a href=https://github.com/dotnet/runtime/pull/47482 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47482</a> adding support for ARM64 AdvSimd APIs; <a href=https://github.com/dotnet/runtime/pull/48413 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48413</a>, <a href=https://github.com/dotnet/runtime/pull/47337 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47337</a>, and <a href=https://github.com/dotnet/runtime/pull/48525 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#48525</a> rounding out the support for the Sha1, Sha256, and Aes intrinsics; or <a href=https://github.com/dotnet/runtime/pull/54924 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54924</a> and <a href=https://github.com/dotnet/runtime/pull/47028 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#47028</a> implementing foundational support with <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Vector64</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Vector128</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code>. Many of the library performance improvements highlighted in previous blog posts rely on the throughput improvements from vectorization, which then accrue here as well, which includes when building Blazor WASM apps with AOT.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>第二个投资领域是硬件内部。.NET Core 3.0和.NET 5添加了数千种新方法，每个方法都与某些硬件特定指令有效地1：1映射，使C#代码能够直接针对SSSE3或AVX2等各种ISA（指令集架构）的功能。当然，需要一些东西能够将C#方法转换成它们所表示的底层指令，这意味着要完全启用每个代码生成器，需要做大量的工作。 Mono支持使用LLVM进行代码生成，并且一系列PR改进了支持LLVM的mono对硬件内在特性的支持，无论是dotnet/runtime#49260、dotnet/runtime#49737、dotnet/runtime#48361和dotnet/runtime#47482，都增加了对ARM 64 AdvSimd API的支持; dotnet/runtime#48413、dotnet/runtime#47337和dotnet/runtime#48525四舍五入了对Sha1、Sha 256和Aes内在函数的支持;或者dotnet/runtime#54924和dotnet/runtime#47028实现了与 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Vector64</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Vector128</span><span class=pun>&lt;</span><span class=pln>T</span><span class=pun>&gt;</span></code> 的基础支持。在以前的博客文章中强调的许多库性能改进都依赖于向量化带来的吞吐量改进，这也是在这里产生的，包括使用AOT构建Blazor WASM应用程序时。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>And that brings us to the third, and arguably most impactful, area of investment: AOT for Blazor WASM. I highlighted earlier that Blazor WASM apps targeting .NET 5 were interpreted, meaning while the runtime itself was compiled to WASM, the runtime then turned around and interpreted the IL for the app and the libraries it depends on. Now with .NET 6, a Blazor WASM app can be compiled ahead of time entirely to WebAssembly, avoiding the need for JIT’ing or interpreting at run-time. All of these improvements together lead to huge, cross-cutting performance improvements for Blazor WASM apps when targeting .NET 6 instead of .NET 5.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这就把我们带到了第三个，也是最有影响力的投资领域：Blazor WASM的AOT。我之前强调过，针对.NET 5的Blazor WASM应用程序是经过解释的，这意味着当运行时本身被编译为WASM时，运行时会反过来解释应用程序及其依赖的库的IL。现在有了.NET 6，Blazor WASM应用程序可以提前完全编译为WebAssembly，避免了在运行时进行JIT或解释的需要。所有这些改进共同导致Blazor WASM应用程序在针对.NET 6而不是.NET 5时的巨大，跨领域的性能改进。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Let’s do one last benchmark. Continuing with the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app5</span></code> and <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app6</span></code> examples from the previous section, we’ll do something that involves a bit of computation: SHA-256. The implementation of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>SHA256</span></code> used for Blazor WASM on both .NET 5 and .NET 6 is exactly the same, and is implemented in C#, making it a reasonable test case. I’ve replaced the entire contents of the Counter.razor file in both of those projects with this, which in response to a button click is simply SHA-256 hashing a byte array of some UTF8 Shakespeare several thousand times.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>让我们做最后一个基准测试。继续上一节中的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app5</span></code> 和 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app6</span></code> 示例，我们将做一些涉及到一些计算的事情：SHA-256在.NET 5和.NET 6上用于Blazor WASM的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>SHA256</span></code> 的实现是完全相同的，并且是在C#中实现的，使其成为一个合理的测试用例。我已经用这个替换了这两个项目中Counter.razor文件的全部内容，它对按钮单击的响应只是SHA-256对某个UTF8 Shakespeare的字节数组散列几千次。</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-C# prettyprinted"><span class=lit><span class=lit>@page</span></span><span class=pln><span class=pln> </span></span><span class=str><span class=str>"/counter"</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>@using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Security</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Cryptography</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>@using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Diagnostics</span></span><span class=pln><span class=pln>
</span></span><span class=lit><span class=lit>@using</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>System</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Text</span></span><span class=pln><span class=pln>

</span></span><span class=str><span class=str>&lt;h1&gt;</span></span><span class=typ><span class=typ>Hashing</span></span><span class=pun><span class=pun>&lt;/</span></span><span class=pln><span class=pln>h1</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln>

</span></span><span class=str><span class=str>&lt;p&gt;</span></span><span class=typ><span class=typ>Time</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>@_time</span></span><span class=pun><span class=pun>&lt;/</span></span><span class=pln><span class=pln>p</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln>

</span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln>button </span></span><span class=kwd><span class=kwd>class</span></span><span class=pun><span class=pun>=</span></span><span class=str><span class=str>"btn btn-primary"</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>@onclick</span></span><span class=pun><span class=pun>=</span></span><span class=str><span class=str>"Hash"</span></span><span class=pun><span class=pun>&gt;</span></span><span class=typ><span class=typ>Click</span></span><span class=pln><span class=pln> me</span></span><span class=pun><span class=pun>&lt;/</span></span><span class=pln><span class=pln>button</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln>

</span></span><span class=lit><span class=lit>@code</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>const</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>string</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Sonnet18</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>@</span></span><span class=str><span class=str>"Shall I compare thee to a summer’s day?
Thou art more lovely and more temperate:
Rough winds do shake the darling buds of May,
And summer’s lease hath all too short a date;
Sometime too hot the eye of heaven shines,
And often is his gold complexion dimm'd;
And every fair from fair sometime declines,
By chance or nature’s changing course untrimm'd;
But thy eternal summer shall not fade,
Nor lose possession of that fair thou ow’st;
Nor shall death brag thou wander’st in his shade,
When in eternal lines to time thou grow’st:
So long as men can breathe or eyes can see,
So long lives this, and this gives life to thee."</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>TimeSpan</span></span><span class=pln><span class=pln> _time</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>

    </span></span><span class=kwd><span class=kwd>private</span></span><span class=pln><span class=pln> </span></span><span class=kwd><span class=kwd>void</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Hash</span></span><span class=pun><span class=pun>()</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>byte</span></span><span class=pun><span class=pun>[]</span></span><span class=pln><span class=pln> bytes </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Encoding</span></span><span class=pun><span class=pun>.</span></span><span class=pln><span class=pln>UTF8</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>GetBytes</span></span><span class=pun><span class=pun>(</span></span><span class=typ><span class=typ>Sonnet18</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>var</span></span><span class=pln><span class=pln> sw </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=typ><span class=typ>Stopwatch</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>StartNew</span></span><span class=pun><span class=pun>();</span></span><span class=pln><span class=pln>
        </span></span><span class=kwd><span class=kwd>for</span></span><span class=pln><span class=pln> </span></span><span class=pun><span class=pun>(</span></span><span class=kwd><span class=kwd>int</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>0</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i </span></span><span class=pun><span class=pun>&lt;</span></span><span class=pln><span class=pln> </span></span><span class=lit><span class=lit>2000</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln> i</span></span><span class=pun><span class=pun>++)</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>{</span></span><span class=pln><span class=pln>
            _ </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> SHA256</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>HashData</span></span><span class=pun><span class=pun>(</span></span><span class=pln><span class=pln>bytes</span></span><span class=pun><span class=pun>);</span></span><span class=pln><span class=pln>
        </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
        _time </span></span><span class=pun><span class=pun>=</span></span><span class=pln><span class=pln> sw</span></span><span class=pun><span class=pun>.</span></span><span class=typ><span class=typ>Elapsed</span></span><span class=pun><span class=pun>;</span></span><span class=pln><span class=pln>
    </span></span><span class=pun><span class=pun>}</span></span><span class=pln><span class=pln>
</span></span><span class=pun><span class=pun>}</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I’ll start by publishing the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app5</span></code> app:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我将从发布 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app5</span></code> 应用程序开始：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5</span></span><span class=pun><span class=pun>&gt;</span></span><span class=pln><span class=pln> dotnet publish </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Then to run it, we need a web server to host the server side of the app, and to make that easy, I’ll use the <a href=https://www.nuget.org/packages/dotnet-serve/ target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet serve</span></code></a> global tool. To install it, run:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然后，为了运行它，我们需要一个Web服务器来托管应用程序的服务器端，为了使其简单，我将使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>dotnet serve</span></code> global工具。要安装它，请运行：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>dotnet tool install </span></span><span class=pun><span class=pun>--</span></span><span class=kwd><span class=kwd>global</span></span><span class=pln><span class=pln> dotnet</span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>serve</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>at which point you can start a simple web server for the files in the published directory:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>此时，您可以为发布目录中的文件启动一个简单的Web服务器： </font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>pushd D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app5\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net5</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\publish\wwwroot
dotnet serve </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>o</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>click <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Counter</span></code>, and then click the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Click</span><span class=pln> </span><span class=typ>Me</span></code> button a few times. I get resulting numbers like this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>单击 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Counter</span></code> ，然后多次单击 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Click</span><span class=pln> </span><span class=typ>Me</span></code> 按钮。我得到的结果是这样的：</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=lightbox-link aria-label="Lightbox image, click or press enter to enlarge" href=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/Hashing1.png data-featherlight=image data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img decoding=async data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/Hashing1.png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASEAAADfCAMAAACOLJX0AAADAFBMVEX////u7u5TV1oiJSna29w/QkWrrK4xb78hJSkrYqn///1AQ0aKjI/HyMkmKi4sY6nkrG2w5/4oJSnHjDY8jcxurOj///j+///19fYiJS/v2N7+/f3a2tyWzPtTVVf7/Px1d3rc/v/6zZU4Oz/z/////+yjYzD//9L857HExcaio6Xh4uMjJ2NdJir5//8zb9olJo2DhYfs/v8yNTmicL+GJSpZXF8iJUTm5udjZmjK8/4wZKq1trjq6utPf7k4JSlKTVD+9vGQkpS/wMHQz9HCr8L5+fluq+ed0/3l/v9xc3ZGSUxdYGPT//8oLTH4+f5KebiWmJqMRyxFsOw0b+JOUVXz8/MrR5Pjr3NpbG81b7BlLyrZ8v7zwoj///P//PT505zLzM24urvZ2dp5tO7y/P9Jb78iKkf++ceaVy+/7/5OxfLG9/56Jyr+/OIjJnBRT0bw8PI8fb3S/v///tgyb79CJSn63qk3Rln97r15e36tr7CBb78iJTxQl9XF6f5qJSolMG3zzpVSRz4lOUqattcwbLp0YE7U1dZrbnBuiLdkmNFIYXz39/i2flHR9v6hxekqSoL//+KP1fdQJilbotxEOSplTEQlJoFLVVmr3/2Ks9Xy/v/Rsovu1qv96sywocE6itqHiYs9QER+gIOcnZ9MQDGJwvPEiFAtVKL96ejmxKHVoVxATm11sOef1PU9Lym46v5ATlh6SywuMTXf3+C9vr+ytLWoajXOmE01dbee4PyZosnRonT//Oz5/v/77+3858OPhcN0xvJBouircTKNj5H24eQyb8kwYalbt+07icXs+P/n094sQFGYeGixrs2siG2t2PQiJVK95P5xotb98djJu9C7gDhUb8H++NE+l+Pg+v/g6fKGLyuydDLrs3o4htN9lMOp1vApS3pzSyxsb796RCvEiT9WjsqQx/hggpynqarrtnrOmGXq2OH85b3OyuI2aqHo0tpTYpLKt8I5R2kmMIDmxY4mMI07icSDbk7dtoB80fdnYy5NicUCHNSOAAAOVklEQVR42uybXYwbRx3Ax+c76y/deZVePmxrL/H23BbWTqK6Fq4NNrGck6GxsXClc+JcSWM7VSAqpAkobc9K25RI3LUcNAhaCg2V7iNJBYRCc05b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" alt="SHA256 benchmark on .NET 5" class=lazyloaded data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></a></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>so ~0.45 seconds on .NET 5. Now I can do the exact same thing on .NET 6 with the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app6</span></code> project:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>所以在.NET 5上约0.45秒。现在，我可以在.NET 6上使用 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app6</span></code> 项目做完全相同的事情：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-console prettyprinted"><span class=pln><span class=pln>popd
cd </span></span><span class=pun><span class=pun>..</span></span><span class=pln><span class=pln>app6
dotnet publish </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>c </span></span><span class=typ><span class=typ>Release</span></span><span class=pln><span class=pln>
pushd D</span></span><span class=pun><span class=pun>:</span></span><span class=pln><span class=pln>\examples\app6\b</span></span><span class=kwd><span class=kwd>in</span></span><span class=pln><span class=pln>\Release\net6</span></span><span class=pun><span class=pun>.</span></span><span class=lit><span class=lit>0</span></span><span class=pln><span class=pln>\publish\wwwroot
dotnet serve </span></span><span class=pun><span class=pun>-</span></span><span class=pln><span class=pln>o</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>and I get results like this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我得到了这样的结果： </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=lightbox-link aria-label="Lightbox image, click or press enter to enlarge" href=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/Hashing2.png data-featherlight=image data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img decoding=async data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/Hashing2.png src="data:image/png;base64,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" alt="SHA256 benchmark on .NET 6" class=lazyloaded data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></a></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>so ~0.28 seconds on .NET 6. That ~40% improvement is due to the interpreter optimizations, as we’re otherwise running the exact same code.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>所以在.NET 6上约0.28秒。这40%的改进是由于解释器的优化，因为我们运行的代码完全相同。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Now, let’s try this out with AOT. I modify the <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app6</span><span class=pun>.</span><span class=pln>csproj</span></code> to include this in the top <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=tag>&lt;PropertyGroup&gt;</span><span class=pln>...</span><span class=tag>&lt;/PropertyGroup&gt;</span></code> node:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>现在，让我们用AOT试试这个。我修改了 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>app6</span><span class=pun>.</span><span class=pln>csproj</span></code> ，将其包含在顶部的 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=tag>&lt;PropertyGroup&gt;</span><span class=pln>...</span><span class=tag>&lt;/PropertyGroup&gt;</span></code> 节点中：</font></font></font></p>
<pre class=prettyprinted tabindex=0><code class="language-xml prettyprinted"><span class=tag><span class=tag>&lt;RunAOTCompilation&gt;</span></span><span class=pln><span class=pln>true</span></span><span class=tag><span class=tag>&lt;/RunAOTCompilation&gt;</span></span></code></pre>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Then I republish (and get a cup of coffee… the AOT step adds some time to the build process). With that, I now get results like this:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>然后我重新发布（并喝杯咖啡... AOT步骤为构建过程增加了一些时间）。这样，我就得到了这样的结果： </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=lightbox-link aria-label="Lightbox image, click or press enter to enlarge" href=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/Hashing3.png data-featherlight=image data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img decoding=async data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/Hashing3.png src="data:image/png;base64,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" alt="SHA256 benchmark on .NET 6 with AOT" class=lazyloaded data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></a></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>so ~0.018 seconds, making it ~16x faster than it was before. A nice note to end this post on.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>所以~0.018秒，比之前快了~ 16倍。一个很好的注释来结束这篇文章。 </font></font></font></p>
<h2 id=is-that-all data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Is that all?<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>就这些吗 </font></font></font><a aria-labelledby=is-that-all class=linkicon href=#is-that-all data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Link" aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a></h2>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Of course not! <img draggable=false role=img class=emoji alt=🙂 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PGNpcmNsZSBmaWxsPSIjRkZDQzREIiBjeD0iMTgiIGN5PSIxOCIgcj0iMTgiLz48cGF0aCBmaWxsPSIjNjY0NTAwIiBkPSJNMTAuNTE1IDIzLjYyMUMxMC41NiAyMy44IDExLjY4MyAyOCAxOCAyOGM2LjMxOCAwIDcuNDQtNC4yIDcuNDg1LTQuMzc5LjA1NS0uMjE3LS4wNDMtLjQ0Mi0uMjM3LS41NTQtLjE5NS0uMTExLS40MzktLjA3OC0uNi4wNzdDMjQuNjI5IDIzLjE2MyAyMi42OTQgMjUgMTggMjVzLTYuNjMtMS44MzctNi42NDgtMS44NTVDMTEuMjU2IDIzLjA1IDExLjEyOCAyMyAxMSAyM2MtLjA4NCAwLS4xNjkuMDIxLS4yNDYuMDY0LS4xOTYuMTEyLS4yOTQuMzM5LS4yMzkuNTU3eiIvPjxlbGxpcHNlIGZpbGw9IiM2NjQ1MDAiIGN4PSIxMiIgY3k9IjEzLjUiIHJ4PSIyLjUiIHJ5PSIzLjUiLz48ZWxsaXBzZSBmaWxsPSIjNjY0NTAwIiBjeD0iMjQiIGN5PSIxMy41IiByeD0iMi41IiByeT0iMy41Ii8+PC9zdmc+ width=17 height=17 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467> Whether it be for <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Xml</span></code> (<a href=https://github.com/dotnet/runtime/pull/49988 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#49988</a> from <a href=https://github.com/kronic target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@kronic</a>, <a href=https://github.com/dotnet/runtime/pull/54344 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54344</a>, <a href=https://github.com/dotnet/runtime/pull/54299 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54299</a>, <a href=https://github.com/dotnet/runtime/pull/54346 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54346</a>, <a href=https://github.com/dotnet/runtime/pull/54356 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54356</a>, <a href=https://github.com/dotnet/runtime/pull/54836 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#54836</a>), or caching (<a href=https://github.com/dotnet/runtime/pull/51761 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#51761</a>, <a href=https://github.com/dotnet/runtime/pull/45410 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45410</a>, <a href=https://github.com/dotnet/runtime/pull/45563 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45563</a>, <a href=https://github.com/dotnet/runtime/pull/45280 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#45280</a>), or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Drawing</span></code> (<a href=https://github.com/dotnet/runtime/pull/50489 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50489</a> from <a href=https://github.com/L2 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@L2</a>, <a href=https://github.com/dotnet/runtime/pull/50622 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#50622</a> from <a href=https://github.com/L2 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@L2</a>), or <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Diagnostics</span><span class=pun>.</span><span class=typ>Process</span></code> (<a href=https://github.com/dotnet/runtime/pull/44691 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#44691</a>, <a href=https://github.com/dotnet/runtime/pull/43365 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#43365</a> from <a href=https://github.com/am11 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@am11</a>), or any number of other areas, there have been an untold number of performance improvements in .NET 6 that I haven’t been able to do justice to in this post.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>当然不是！ <img draggable=false role=img class=emoji alt=🙂 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PGNpcmNsZSBmaWxsPSIjRkZDQzREIiBjeD0iMTgiIGN5PSIxOCIgcj0iMTgiLz48cGF0aCBmaWxsPSIjNjY0NTAwIiBkPSJNMTAuNTE1IDIzLjYyMUMxMC41NiAyMy44IDExLjY4MyAyOCAxOCAyOGM2LjMxOCAwIDcuNDQtNC4yIDcuNDg1LTQuMzc5LjA1NS0uMjE3LS4wNDMtLjQ0Mi0uMjM3LS41NTQtLjE5NS0uMTExLS40MzktLjA3OC0uNi4wNzdDMjQuNjI5IDIzLjE2MyAyMi42OTQgMjUgMTggMjVzLTYuNjMtMS44MzctNi42NDgtMS44NTVDMTEuMjU2IDIzLjA1IDExLjEyOCAyMyAxMSAyM2MtLjA4NCAwLS4xNjkuMDIxLS4yNDYuMDY0LS4xOTYuMTEyLS4yOTQuMzM5LS4yMzkuNTU3eiIvPjxlbGxpcHNlIGZpbGw9IiM2NjQ1MDAiIGN4PSIxMiIgY3k9IjEzLjUiIHJ4PSIyLjUiIHJ5PSIzLjUiLz48ZWxsaXBzZSBmaWxsPSIjNjY0NTAwIiBjeD0iMjQiIGN5PSIxMy41IiByeD0iMi41IiByeT0iMy41Ii8+PC9zdmc+ width=17 height=17 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467> 是否为 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Xml</span></code> （dotnet/runtime#49988 from @kronic，dotnet/runtime#54344，dotnet/runtime#54299，dotnet/runtime#54346，dotnet/runtime#54356，dotnet/runtime#54836），或缓存（dotnet/runtime#51761，dotnet/runtime#45410，dotnet/runtime#45563，dotnet/runtime#45280），或 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Drawing</span></code> （来自@L2的dotnet/runtime#50489，来自@L2的dotnet/runtime#50622），或者 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>System</span><span class=pun>.</span><span class=typ>Diagnostics</span><span class=pun>.</span><span class=typ>Process</span></code> （来自@am11的dotnet/runtime#44691，dotnet/runtime#43365），或者任何其他领域，.NET 6中有无数的性能改进，我还没有能够在这篇文章中公正地做。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>There are also many outstanding PRs in dotnet/runtime that haven’t yet been merged but may be for .NET 6. For example, <a href=https://github.com/dotnet/runtime/pull/57079 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#57079</a> enables support for TLS resumption on Linux, which has the potential to improve the time it takes to establish a secure connection by an order of magnitude. Or <a href=https://github.com/dotnet/runtime/pull/55745 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#55745</a>, which enables the JIT to fold <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TimeSpan</span><span class=pun>.</span><span class=typ>FromSeconds</span><span class=pun>(</span><span class=pln>constant</span><span class=pun>)</span></code> (and other such `From` methods) into a single instruction. Or <a href=https://github.com/dotnet/runtime/pull/35565 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime#35565</a> from <a href=https://github.com/sakno target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>@sakno</a>, which uses spans more aggressively throughout the implementation of <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BigInteger</span></code>. So much goodness already merged and so much more on the way.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在dotnet/runtime中还有许多尚未被合并的PR，但可能是.NET 6的。例如，dotnet/runtime#57079支持Linux上的TLS恢复，这有可能将建立安全连接所需的时间缩短一个数量级。或者dotnet/runtime#55745，它使JIT能够将 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>TimeSpan</span><span class=pun>.</span><span class=typ>FromSeconds</span><span class=pun>(</span><span class=pln>constant</span><span class=pun>)</span></code> （以及其他类似的‘From’方法）折叠成一条指令。或者来自@sakno的dotnet/runtime#35565，它在 <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>BigInteger</span></code> 的整个实现中使用了更积极的跨度。那么多的善良已经融合在一起，还有那么多的在路上。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Don’t just take my word for it, though. Please <a href=https://dotnet.microsoft.com/download/dotnet/6.0 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>download .NET 6</a> and give it a spin. I’m quite hopeful you’ll like what you see. If you do, tell us. If you don’t, tell us. We want to hear from you, and even more than that, we’d love your involvement. Of the ~400 merged PRs linked to in this blog post, over 15% of them came from the .NET community outside of Microsoft, and we’d love to see that number grow even higher. If you’ve got ideas for improvements or the inclination to try to make them a reality, please join us for a fun and fulfilling time in <a href=https://github.com/dotnet/runtime target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>dotnet/runtime</a>.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>但别只相信我的话。请下载.NET 6并给予测试。我很希望你会喜欢你所看到的。如果你知道，告诉我们。如果你不知道告诉我们。我们希望听到你的声音，更重要的是，我们希望你的参与。在这篇博客文章中链接的约400个合并PR中，超过15%来自微软以外的.NET社区，我们希望看到这个数字增长得更高。如果你有改进的想法，或者想把它们变成现实，请加入我们，在dotnet/runtime中度过一段有趣而充实的时光。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Happy coding!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>编码愉快！ </font></font></font></p>
 <div class="row justify-content-center" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 
 <div style=clear:both;padding-bottom:0px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></div><div class=postdetail-author-info data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467> <div class=authorinfoarea data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=post-authoravatar data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=60&amp;d=mm&amp;r=g" src=data:image/jpeg;base64,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 data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=120&amp;d=mm&amp;r=g 2x" class="avatar avatar-60 photo lazyloaded" height=60 width=60 decoding=async srcset sizes></div>
 <h3 class=post-authorname data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=no-underline data-bi-id="author follow within post" data-bi-area data-bi-name="Stephen Toub - MSFT" aria-label="Stephen Toub - MSFT" href=https://devblogs.microsoft.com/dotnet/author/toub data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Stephen Toub - MSFT </a>
 <span data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Partner Software Engineer, .NET</span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT合作伙伴软件工程师，.NET </font></font></font>
 </h3>
 <div class=social-links data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <strong data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Follow <font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>遵循 </font></font></font></strong>
 <a class="no-underline stayinformed" title=Github data-bi-id="author follow within post" data-bi-area data-bi-name=git_profile_url aria-label="Stephen Toub - MSFT Github profile" target=_blank href=https://github.com/stephentoub data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <i class="fa fa-github"></i>
 </a>
 <a class="no-underline stayinformed hvr-pop" title="RSS Feed" aria-label="Stephen Toub - MSFT RSS Feed" target=_blank href=https://devblogs.microsoft.com/dotnet/author/toub/feed/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <i class="fa fa-rss"></i>
</a>
 </p>
 <div style=clear:both data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></div>
 </div>
 </div>
 </div>
 </div>
</div>
 <footer class=cattagsarea translate=no>
 <span class=cat-links>Posted in <a href=https://devblogs.microsoft.com/dotnet/category/dotnet/ rel="category tag" aria-label=".NET Category">.NET</a> <a href=https://devblogs.microsoft.com/dotnet/category/internals/ rel="category tag" aria-label=".NET Internals Category">.NET Internals</a> <a href=https://devblogs.microsoft.com/dotnet/category/csharp/ rel="category tag" aria-label="C# Category">C#</a> <a href=https://devblogs.microsoft.com/dotnet/category/performance/ rel="category tag" aria-label="Performance Category">Performance</a></span>
 </footer>
</article> 
 <div class=related-postssection role=region aria-label="Related Post Section" data-bi-id="read next" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <h3 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Read next<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>读取下一 </font></font></font></h3>
 <div class="row related-articles" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article class=col-md-6 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=post-card aria-label="Related Post Title" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=article-title href=https://devblogs.microsoft.com/dotnet/understanding-the-cost-of-csharp-delegates/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Understanding the cost of C# delegates<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 了解C#委托的成本 </font></font></font></a>
 <div class=post-desc data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Delegates are widely used in C# (and .NET, in general), but it's not always obvious to the developer what code they write ends up generating. In this post, I'll show the various forms to make you aware of their costs.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>委托在C#（和.NET）中被广泛使用，但对于开发人员来说，他们编写的代码最终会生成什么并不总是显而易见的。在这篇文章中，我将展示各种表格，让你了解它们的成本。 </font></font></font></div>
 <div class=author-details data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/author/pamorgad data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=avatar-img data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img alt data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/PauloMorgado_340x340-1-150x150.jpg src="data:image/jpeg;base64,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" data-srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/08/PauloMorgado_340x340-1-300x300.jpg 2x" class="avatar avatar-100 photo avatar-default lazyloaded" height=100 width=100 decoding=async srcset sizes></span><span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Paulo Morgado<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>保罗·莫尔加多</font></font></font></span></a> <br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=post-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 18, 2021<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2021年8月18日</font></font></font></span></div>
 <div class=post-comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=comment-icon href=https://devblogs.microsoft.com/dotnet/understanding-the-cost-of-csharp-delegates/#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg width=17 height=17 class=mr-1 viewBox="0 0 18 17" fill=none xmlns=http://www.w3.org/2000/svg>
 <path d="M0 0.125H18V12.5H6.4248L2.25 16.6748V12.5H0V0.125ZM16.875 11.375V1.25H1.125V11.375H3.375V13.9502L5.9502 11.375H16.875Z" fill=#0078D4></path>
 </svg>31 comments<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>31条评论</font></font></font></a></div>
 </div>
 </article><article class=col-md-6 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=post-card aria-label="Related Post Title" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=article-title href=https://devblogs.microsoft.com/dotnet/new-dotnet-6-apis-driven-by-the-developer-community/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>New .NET 6 APIs driven by the developer community<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 由开发人员社区驱动的新.NET 6 API </font></font></font></a>
 <div class=post-desc data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET 6 is on the way, and I wanted to share some of my favorite new APIs that you are going to love.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET 6即将推出，我想分享一些我最喜欢的新API，你一定会喜欢。 </font></font></font></div>
 <div class=author-details data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/author/davifowl data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=avatar-img data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img alt data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/03/IMG_1301-150x150.jpeg src="data:image/jpeg;base64,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" data-srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/2021/03/IMG_1301.jpeg 2x" class="avatar avatar-100 photo avatar-default lazyloaded" height=100 width=100 decoding=async srcset sizes></span><span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>David Fowler<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>大卫·弗勒</font></font></font></span></a> <br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=post-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 23, 2021<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>2021年8月23日</font></font></font></span></div>
 <div class=post-comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class=comment-icon href=https://devblogs.microsoft.com/dotnet/new-dotnet-6-apis-driven-by-the-developer-community/#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg width=17 height=17 class=mr-1 viewBox="0 0 18 17" fill=none xmlns=http://www.w3.org/2000/svg>
 <path d="M0 0.125H18V12.5H6.4248L2.25 16.6748V12.5H0V0.125ZM16.875 11.375V1.25H1.125V11.375H3.375V13.9502L5.9502 11.375H16.875Z" fill=#0078D4></path>
 </svg>59 comments<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>59条评论</font></font></font></a></div>
 </div>
 </article> </div>
 </div> 
 
 
 
 <div id=comments class=comments-area data-bi-id=comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <h2 class=comments-title data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 93 comments <font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>93条评论 </font></font></font></h2>
 
 <p class=nocomments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Comments are closed. <a href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comments" title="Login to edit/delete your existing comments" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Login to edit/delete your existing comments</a><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>评论已关闭.登录以编辑/删除您现有的评论 </font></font></font>
 </p>
 <nav aria-label="Comment navigation" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <ul class=pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="page-item active" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span aria-current=page class="page-link current" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Page</span> 1<span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>of comments</span> </span> </li>
 <li class=page-item data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=page-link href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/comment-page-2#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Page</span> 2<span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>of comments</span> </a> </li>
 <li class=page-item data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=page-link href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/comment-page-3#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Page</span> 3<span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>of comments</span> </a> </li>
 <li class=page-item data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=page-link href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/comment-page-4#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Page</span> 4<span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>of comments</span> </a> </li>
 <li class=page-item data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="next page-link" href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/comment-page-2#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--ChevronRight" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Next comment</span></a> </li>
 </ul>
 </nav>
 
 <ul class=commentlist data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <li class="comment byuser comment-author-eatonzveare even thread-even depth-1 comment-show" id=li-comment-10099 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10099 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/b25c338f2ed8405e80c0e6fe854b5cb5?s=40&amp;d=mm&amp;r=g" src=data:image/png;base64,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 data-srcset="https://secure.gravatar.com/avatar/b25c338f2ed8405e80c0e6fe854b5cb5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Eaton </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T09:34:19-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 9:34 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10099 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10099" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>伊顿八月17，2021 9：34上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10099 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10099 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10099 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10099 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>How long does it take you to write these blog posts? <img draggable=false role=img class=emoji alt=😉 src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGQ0M0RCIgZD0iTTM2IDE4YzAgOS45NDEtOC4wNTkgMTgtMTggMTgtOS45NCAwLTE4LTguMDU5LTE4LTE4QzAgOC4wNiA4LjA2IDAgMTggMGM5Ljk0MSAwIDE4IDguMDYgMTggMTgiLz48ZWxsaXBzZSBmaWxsPSIjNjY0NTAwIiBjeD0iMTEuNSIgY3k9IjE2LjUiIHJ4PSIyLjUiIHJ5PSIzLjUiLz48cGF0aCBmaWxsPSIjNjY0NTAwIiBkPSJNMjguNDU3IDE3Ljc5N2MtLjA2LS4xMzUtMS40OTktMy4yOTctNC40NTctMy4yOTctMi45NTcgMC00LjM5NyAzLjE2Mi00LjQ1NyAzLjI5Ny0uMDkyLjIwNy0uMDMyLjQ0OS4xNDUuNTkxLjE3NS4xNDIuNDI2LjE0Ny42MS4wMTQuMDEyLS4wMDkgMS4yNjItLjkwMiAzLjcwMi0uOTAyIDIuNDI2IDAgMy42NzQuODgxIDMuNzAyLjkwMS4wODguMDY2LjE5NC4wOTkuMjk4LjA5OS4xMSAwIC4yMjEtLjAzNy4zMTItLjEwOS4xNzctLjE0Mi4yMzgtLjM4Ni4xNDUtLjU5NHpNNS45OTkgMTIuNDU4Yy0uMjA4IDAtLjQxOS0uMDY1LS41OTktLjItLjQ0Mi0uMzMxLS41MzEtLjk1OC0uMi0xLjQgMy4yNjItNC4zNSA3LjYxNi00LjQgNy44LTQuNC41NTIgMCAxIC40NDggMSAxIDAgLjU1MS0uNDQ1Ljk5OC0uOTk2IDEtLjE1Ni4wMDItMy41NjkuMDg2LTYuMjA1IDMuNi0uMTk1LjI2Mi0uNDk2LjQtLjguNHptMjMuMDAyIDIuMTI1Yy0uMzA1IDAtLjYwNC0uMTM4LS44MDEtLjQtMi41OTItMy40NTctNi45NjEtMi42MjctNy4wMDQtMi42Mi0uNTQ3LjEwOC0xLjA2OC0uMjQzLTEuMTc3LS43ODQtLjEwOC0uNTQyLjI0My0xLjA2OC43ODQtMS4xNzcuMjMxLS4wNDcgNS42NTctMS4wNzIgOC45OTYgMy4zOC4zMzIuNDQyLjI0MiAxLjA2OS0uMiAxLjQtLjE3OS4xMzctLjM4OS4yMDEtLjU5OC4yMDF6bS01Ljc0NyA4Ljk5NGMtLjE4OC0uMTEtLjQzMi0uMDg3LS41OTcuMDYtLjAxLjAwOC0xLjAxMy44NjMtNC42NTcuODYzLTMuNjQxIDAtNC42NDYtLjg1NC00LjY0Ni0uODU0LS4xNTktLjE2LS40MDQtLjE5LS42LS4wODItLjE5NS4xMTEtLjI5My4zMzktLjIzOC41NTcuMDEuMDQ0IDEuMTQ0IDQuMzc5IDUuNDg0IDQuMzc5czUuNDc0LTQuMzM1IDUuNDg1LTQuMzc5Yy4wNTMtLjIxMy0uMDQ0LS40MzEtLjIzMS0uNTQ0eiIvPjwvc3ZnPg==" width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>你写这些博客文章需要多长时间？ <img draggable=false role=img class=emoji alt=😉 src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGQ0M0RCIgZD0iTTM2IDE4YzAgOS45NDEtOC4wNTkgMTgtMTggMTgtOS45NCAwLTE4LTguMDU5LTE4LTE4QzAgOC4wNiA4LjA2IDAgMTggMGM5Ljk0MSAwIDE4IDguMDYgMTggMTgiLz48ZWxsaXBzZSBmaWxsPSIjNjY0NTAwIiBjeD0iMTEuNSIgY3k9IjE2LjUiIHJ4PSIyLjUiIHJ5PSIzLjUiLz48cGF0aCBmaWxsPSIjNjY0NTAwIiBkPSJNMjguNDU3IDE3Ljc5N2MtLjA2LS4xMzUtMS40OTktMy4yOTctNC40NTctMy4yOTctMi45NTcgMC00LjM5NyAzLjE2Mi00LjQ1NyAzLjI5Ny0uMDkyLjIwNy0uMDMyLjQ0OS4xNDUuNTkxLjE3NS4xNDIuNDI2LjE0Ny42MS4wMTQuMDEyLS4wMDkgMS4yNjItLjkwMiAzLjcwMi0uOTAyIDIuNDI2IDAgMy42NzQuODgxIDMuNzAyLjkwMS4wODguMDY2LjE5NC4wOTkuMjk4LjA5OS4xMSAwIC4yMjEtLjAzNy4zMTItLjEwOS4xNzctLjE0Mi4yMzgtLjM4Ni4xNDUtLjU5NHpNNS45OTkgMTIuNDU4Yy0uMjA4IDAtLjQxOS0uMDY1LS41OTktLjItLjQ0Mi0uMzMxLS41MzEtLjk1OC0uMi0xLjQgMy4yNjItNC4zNSA3LjYxNi00LjQgNy44LTQuNC41NTIgMCAxIC40NDggMSAxIDAgLjU1MS0uNDQ1Ljk5OC0uOTk2IDEtLjE1Ni4wMDItMy41NjkuMDg2LTYuMjA1IDMuNi0uMTk1LjI2Mi0uNDk2LjQtLjguNHptMjMuMDAyIDIuMTI1Yy0uMzA1IDAtLjYwNC0uMTM4LS44MDEtLjQtMi41OTItMy40NTctNi45NjEtMi42MjctNy4wMDQtMi42Mi0uNTQ3LjEwOC0xLjA2OC0uMjQzLTEuMTc3LS43ODQtLjEwOC0uNTQyLjI0My0xLjA2OC43ODQtMS4xNzcuMjMxLS4wNDcgNS42NTctMS4wNzIgOC45OTYgMy4zOC4zMzIuNDQyLjI0MiAxLjA2OS0uMiAxLjQtLjE3OS4xMzctLjM4OS4yMDEtLjU5OC4yMDF6bS01Ljc0NyA4Ljk5NGMtLjE4OC0uMTEtLjQzMi0uMDg3LS41OTcuMDYtLjAxLjAwOC0xLjAxMy44NjMtNC42NTcuODYzLTMuNjQxIDAtNC42NDYtLjg1NC00LjY0Ni0uODU0LS4xNTktLjE2LS40MDQtLjE5LS42LS4wODItLjE5NS4xMTEtLjI5My4zMzktLjIzOC41NTcuMDEuMDQ0IDEuMTQ0IDQuMzc5IDUuNDg0IDQuMzc5czUuNDc0LTQuMzM1IDUuNDg1LTQuMzc5Yy4wNTMtLjIxMy0uMDQ0LS40MzEtLjIzMS0uNTQ0eiIvPjwvc3ZnPg==" width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467> </font></font></font><br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
Good stuff here. Thanks for the great overview!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 好东西在这里。感谢伟大的概述！</font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor odd alt depth-2 comment-show" id=li-comment-10100 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10100 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T09:45:53-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 9:45 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10100 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10100" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 2021年8月17日9：45上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10100 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10100 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10100 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10100 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Thanks! Glad you liked it. It is indeed a labor of love.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>谢谢你，谢谢很高兴你喜欢。这确实是一种爱的劳动。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-calvin_nelmsn-com even depth-3 comment-show" id=li-comment-10156 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10156 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/3ad4650481cc18c778bdd832feec9e44?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+t6KPxr0D4VeF7fVJrjUbtFmjgYJFGwyu/GSSPYY/OgDhvsFz5PnfZ5vJ6+ZsO386gr6awMY7V5N8VvC9vpklvqVoiwpO5jlRRhd+MggdsgHP0oA8+oo/GigA/CvR/hJ4hgtHudLndYmmcSQljgM2MFfrwMfjXnKIZHVEBZmOAo5JNez+DPh7aaHbR3N7EtxqLDcd4ysXsB6+/5UAdnz6V5Z8XPEMF19n0qB1laF/NmKnIVsEBfryc/hXqXHvXG+NPh7aa5bSXNlEtvqKgsNgwsvsR6+/wCdAHi/4UUroY3ZHBVlOCp4IPpRQB1Xwy05dR8WW5cBlt1afHuOB+RIP4V7hz60UUAHPrRz60UUAeH/ABN05dO8WXBQBUuEWfHucg/qCfxooooA/9k=" data-srcset="https://secure.gravatar.com/avatar/3ad4650481cc18c778bdd832feec9e44?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Calvin Nel </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-18T11:05:34-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 18, 2021 11:05 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10156 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10156" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>卡尔文Nel八月18，2021 11：05上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10156 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10156 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10156 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10156 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Yes agreed, just logged in to say thanks for the efforts…. its nice reading these!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>是的同意，刚刚登录说感谢的努力.阅读这些很好！ </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor odd alt depth-4 comment-show" id=li-comment-10159 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10159 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-18T12:16:52-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 18, 2021 12:16 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10159 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10159" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 2021年8月18日12：16下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10159 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10159 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10159 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10159 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Thanks <img draggable=false role=img class=emoji alt=🙂 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PGNpcmNsZSBmaWxsPSIjRkZDQzREIiBjeD0iMTgiIGN5PSIxOCIgcj0iMTgiLz48cGF0aCBmaWxsPSIjNjY0NTAwIiBkPSJNMTAuNTE1IDIzLjYyMUMxMC41NiAyMy44IDExLjY4MyAyOCAxOCAyOGM2LjMxOCAwIDcuNDQtNC4yIDcuNDg1LTQuMzc5LjA1NS0uMjE3LS4wNDMtLjQ0Mi0uMjM3LS41NTQtLjE5NS0uMTExLS40MzktLjA3OC0uNi4wNzdDMjQuNjI5IDIzLjE2MyAyMi42OTQgMjUgMTggMjVzLTYuNjMtMS44MzctNi42NDgtMS44NTVDMTEuMjU2IDIzLjA1IDExLjEyOCAyMyAxMSAyM2MtLjA4NCAwLS4xNjkuMDIxLS4yNDYuMDY0LS4xOTYuMTEyLS4yOTQuMzM5LS4yMzkuNTU3eiIvPjxlbGxpcHNlIGZpbGw9IiM2NjQ1MDAiIGN4PSIxMiIgY3k9IjEzLjUiIHJ4PSIyLjUiIHJ5PSIzLjUiLz48ZWxsaXBzZSBmaWxsPSIjNjY0NTAwIiBjeD0iMjQiIGN5PSIxMy41IiByeD0iMi41IiByeT0iMy41Ii8+PC9zdmc+ width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>感谢 <img draggable=false role=img class=emoji alt=🙂 src=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PGNpcmNsZSBmaWxsPSIjRkZDQzREIiBjeD0iMTgiIGN5PSIxOCIgcj0iMTgiLz48cGF0aCBmaWxsPSIjNjY0NTAwIiBkPSJNMTAuNTE1IDIzLjYyMUMxMC41NiAyMy44IDExLjY4MyAyOCAxOCAyOGM2LjMxOCAwIDcuNDQtNC4yIDcuNDg1LTQuMzc5LjA1NS0uMjE3LS4wNDMtLjQ0Mi0uMjM3LS41NTQtLjE5NS0uMTExLS40MzktLjA3OC0uNi4wNzdDMjQuNjI5IDIzLjE2MyAyMi42OTQgMjUgMTggMjVzLTYuNjMtMS44MzctNi42NDgtMS44NTVDMTEuMjU2IDIzLjA1IDExLjEyOCAyMyAxMSAyM2MtLjA4NCAwLS4xNjkuMDIxLS4yNDYuMDY0LS4xOTYuMTEyLS4yOTQuMzM5LS4yMzkuNTU3eiIvPjxlbGxpcHNlIGZpbGw9IiM2NjQ1MDAiIGN4PSIxMiIgY3k9IjEzLjUiIHJ4PSIyLjUiIHJ5PSIzLjUiLz48ZWxsaXBzZSBmaWxsPSIjNjY0NTAwIiBjeD0iMjQiIGN5PSIxMy41IiByeD0iMi41IiByeT0iMy41Ii8+PC9zdmc+ width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467> </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 <li class="comment byuser comment-author-jadangerbrooks even depth-3 comment-show" id=li-comment-10222 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10222 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/1d0cc0cb221d8b718690d845d945149a?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+t6KPxr0D4VeF7fVJrjUbtFmjgYJFGwyu/GSSPYY/OgDhvsFz5PnfZ5vJ6+ZsO386gr6awMY7V5N8VvC9vpklvqVoiwpO5jlRRhd+MggdsgHP0oA8+oo/GigA/CvR/hJ4hgtHudLndYmmcSQljgM2MFfrwMfjXnKIZHVEBZmOAo5JNez+DPh7aaHbR3N7EtxqLDcd4ysXsB6+/5UAdnz6V5Z8XPEMF19n0qB1laF/NmKnIVsEBfryc/hXqXHvXG+NPh7aa5bSXNlEtvqKgsNgwsvsR6+/wCdAHi/4UUroY3ZHBVlOCp4IPpRQB1Xwy05dR8WW5cBlt1afHuOB+RIP4V7hz60UUAHPrRz60UUAeH/ABN05dO8WXBQBUuEWfHucg/qCfxooooA/9k=" data-srcset="https://secure.gravatar.com/avatar/1d0cc0cb221d8b718690d845d945149a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Mystery Man </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-21T19:35:02-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 21, 2021 7:35 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10222 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10222" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>神秘人八月21，2021 7：35下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10222 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10222 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10222 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10222 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Yes, it is obviously a labor of love, but one that takes up 116 pages. It’s the size of a large research paper or a small book.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>是的，这显然是一个爱的劳动，但一个占了116页。它的大小相当于一篇大型研究论文或一本小书。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As such, it needs an abstract and a summary to be effective.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>因此，它需要一个摘要和总结才能有效。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
</ul>
</li>
 <li class="comment byuser comment-author-tonyvca odd alt thread-odd thread-alt depth-1 comment-show" id=li-comment-10102 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10102 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/ae92c157edcfd3e842e7d7169f507f59?s=40&amp;d=mm&amp;r=g" src=data:image/png;base64,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 data-srcset="https://secure.gravatar.com/avatar/ae92c157edcfd3e842e7d7169f507f59?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Tony Henrique </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T10:26:46-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 10:26 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10102 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10102" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>托尼·恩里克八月17，2021 10：26上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10102 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10102 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10102 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10102 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Wow. Lots of improvements that will reflect on faster, more reliable and more efficient apps!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>哇哦大量的改进将反映在更快，更可靠和更高效的应用程序！ </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor even depth-2 comment-show" id=li-comment-10105 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10105 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T10:41:30-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 10:41 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10105 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10105" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 2021年8月17日10：41上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10105 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10105 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10105 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10105 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img draggable=false role=img class=emoji alt=👍 src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGREI1RSIgZD0iTTM0Ljk1NiAxNy45MTZjMC0uNTAzLS4xMi0uOTc1LS4zMjEtMS40MDQtMS4zNDEtNC4zMjYtNy42MTktNC4wMS0xNi41NDktNC4yMjEtMS40OTMtLjAzNS0uNjM5LTEuNzk4LS4xMTUtNS42NjguMzQxLTIuNTE3LTEuMjgyLTYuMzgyLTQuMDEtNi4zODItNC40OTggMC0uMTcxIDMuNTQ4LTQuMTQ4IDEyLjMyMi0yLjEyNSA0LjY4OC02Ljg3NSAyLjA2Mi02Ljg3NSA2Ljc3MXYxMC43MTljMCAxLjgzMy4xOCAzLjU5NSAyLjc1OCAzLjg4NUM4LjE5NSAzNC4yMTkgNy42MzMgMzYgMTEuMjM4IDM2aDE4LjA0NGMxLjgzOCAwIDMuMzMzLTEuNDk2IDMuMzMzLTMuMzM0IDAtLjc2Mi0uMjY3LTEuNDU2LS42OTgtMi4wMTggMS4wMi0uNTcxIDEuNzItMS42NDkgMS43Mi0yLjg5OSAwLS43Ni0uMjY2LTEuNDU0LS42OTYtMi4wMTUgMS4wMjMtLjU3IDEuNzI1LTEuNjQ5IDEuNzI1LTIuOTAxIDAtLjkwOS0uMzY4LTEuNzMzLS45NjEtMi4zMzYuNzU3LS42MTEgMS4yNTEtMS41MzUgMS4yNTEtMi41ODF6Ii8+PHBhdGggZmlsbD0iI0VFOTU0NyIgZD0iTTIzLjAyIDIxLjI0OWg4LjYwNGMxLjE3IDAgMi4yNjgtLjYyNiAyLjg2Ni0xLjYzMy4yNDYtLjQxNS4xMDktLjk1Mi0uMzA3LTEuMTk5LS40MTUtLjI0Ny0uOTUyLS4xMDgtMS4xOTkuMzA3LS4yODMuNDc5LS44MDYuNzc1LTEuMzYxLjc3NWgtOC44MWMtLjg3MyAwLTEuNTgzLS43MS0xLjU4My0xLjU4M3MuNzEtMS41ODMgMS41ODMtMS41ODNIMjguN2MuNDgzIDAgLjg3NS0uMzkyLjg3NS0uODc1cy0uMzkyLS44NzUtLjg3NS0uODc1aC01Ljg4OGMtMS44MzggMC0zLjMzMyAxLjQ5NS0zLjMzMyAzLjMzMyAwIDEuMDI1LjQ3NSAxLjkzMiAxLjIwNSAyLjU0NC0uNjE1LjYwNS0uOTk4IDEuNDQ1LS45OTggMi4zNzMgMCAxLjAyOC40NzggMS45MzggMS4yMTIgMi41NDktLjYxMS42MDQtLjk5IDEuNDQxLS45OSAyLjM2NyAwIDEuMTIuNTU5IDIuMTA4IDEuNDA5IDIuNzEzLS41MjQuNTg5LS44NTIgMS4zNTYtLjg1MiAyLjIwNCAwIDEuODM4IDEuNDk1IDMuMzMzIDMuMzMzIDMuMzMzaDUuNDg0YzEuMTcgMCAyLjI2OS0uNjI1IDIuODY3LTEuNjMyLjI0Ny0uNDE1LjExLS45NTItLjMwNS0xLjE5OS0uNDE2LS4yNDUtLjk1My0uMTEtMS4xOTkuMzA1LS4yODUuNDc5LS44MDguNzc2LTEuMzYzLjc3NmgtNS40ODRjLS44NzMgMC0xLjU4My0uNzEtMS41ODMtMS41ODNzLjcxLTEuNTgzIDEuNTgzLTEuNTgzaDYuNTA2YzEuMTcgMCAyLjI3LS42MjYgMi44NjctMS42MzMuMjQ3LS40MTYuMTEtLjk1My0uMzA1LTEuMTk5LS40MTktLjI1MS0uOTU0LS4xMS0xLjE5OS4zMDUtLjI4OS40ODctLjc5OS43NzctMS4zNjMuNzc3aC03LjA2M2MtLjg3MyAwLTEuNTgzLS43MTEtMS41ODMtMS41ODRzLjcxLTEuNTgzIDEuNTgzLTEuNTgzaDguMDkxYzEuMTcgMCAyLjI2OS0uNjI1IDIuODY3LTEuNjMyLjI0Ny0uNDE1LjExLS45NTItLjMwNS0xLjE5OS0uNDE3LS4yNDYtLjk1My0uMTEtMS4xOTkuMzA1LS4yODkuNDg2LS43OTkuNzc2LTEuMzYzLjc3NkgyMy4wMmMtLjg3MyAwLTEuNTgzLS43MS0xLjU4My0xLjU4M3MuNzA5LTEuNTg0IDEuNTgzLTEuNTg0eiIvPjwvc3ZnPg==" width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 <li class="comment byuser comment-author-teo-tsirpanis-718 odd alt thread-even depth-1 comment-show" id=li-comment-10103 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10103 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/ea1621c3e8d065544b63c47005a550f2-1.jpg src="data:image/jpeg;base64,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" data-srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/ea1621c3e8d065544b63c47005a550f2-1.jpg 2x" class="avatar avatar-40 photo avatar-default lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Theodore Tsirpanis </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T10:31:14-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 10:31 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10103 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10103" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>西奥多Tsirpanis八月17，2021 10：31上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10103 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10103 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10103 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10103 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Great work! I always enjoy reading these “Performance Improvements” posts.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>干得好！我总是喜欢阅读这些“性能改进”的帖子。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I found two typos:<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我发现了两个错别字： </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>in the JIT section: “the affect of which” -&gt; “the <strong data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>e</strong>ffect of which”<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在JIT部分：“The effect of which”-&gt;“the effect of which”</font></font></font><br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
in the WebSockets section: “ammortized” -&gt; “amortized”<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 在WebSockets部分：“ammortized”-&gt;“amortized”</font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor even depth-2 comment-show" id=li-comment-10104 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10104 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T10:40:55-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 10:40 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10104 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10104" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 2021年8月17日10：40上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10104 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10104 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10104 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10104 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Thanks, and thanks for your contributions. Typos fixed.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>谢谢，谢谢你的贡献。错别字修复。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-mejnm2-com odd alt depth-3 comment-show" id=li-comment-10226 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10226 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/b19bc5229ba5087eff77abce3de8e969?s=40&amp;d=mm&amp;r=g" src=data:image/png;base64,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 data-srcset="https://secure.gravatar.com/avatar/b19bc5229ba5087eff77abce3de8e969?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Joseph Musser </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-22T13:17:30-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 22, 2021 1:17 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10226 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10226" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>约瑟夫·穆瑟八月22，2021 1：17下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10226 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10226 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10226 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10226 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>One more: <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Sometimes</span><span class=pln> analyzing the code the remains after trimming</span></code> (<code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>the remains</span></code> → <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>that remains</span></code>)<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>还有一个： <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=typ>Sometimes</span><span class=pln> analyzing the code the remains after trimming</span></code> （ <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>the remains</span></code> → <code class=prettyprinted data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=pln>that remains</span></code> ）</font></font></font><br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
And yes, again a favorite read!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 是的，又是一本最喜欢的书！</font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor even depth-4 comment-show" id=li-comment-10296 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10296 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-25T07:47:41-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 25, 2021 7:47 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10296 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10296" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 2021年8月25日7：47上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10296 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10296 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10296 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10296 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <blockquote data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>And yes, again a favorite read!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>是的，又是一本最喜欢的书！ </font></font></font></p>
</blockquote>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><img draggable=false role=img class=emoji alt=😊 src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGQ0M0RCIgZD0iTTM2IDE4YzAgOS45NDEtOC4wNTkgMTgtMTggMThTMCAyNy45NDEgMCAxOCA4LjA1OSAwIDE4IDBzMTggOC4wNTkgMTggMTgiLz48Y2lyY2xlIGZpbGw9IiNGRjc4OTIiIGN4PSI3IiBjeT0iMTgiIHI9IjUiLz48Y2lyY2xlIGZpbGw9IiNGRjc4OTIiIGN4PSIyOSIgY3k9IjE4IiByPSI1Ii8+PHBhdGggZmlsbD0iIzY2NDUwMCIgZD0iTTI3LjMzNSAyMS42MjljLS4xNzgtLjE2MS0uNDQ0LS4xNzEtLjYzNS0uMDI5LS4wMzkuMDI5LTMuOTIyIDIuOS04LjcgMi45LTQuNzY2IDAtOC42NjItMi44NzEtOC43LTIuOS0uMTkxLS4xNDItLjQ1Ny0uMTMtLjYzNS4wMjktLjE3Ny4xNi0uMjE3LjQyNC0uMDk0LjYyOEM4LjcgMjIuNDcyIDExLjc4OCAyNy41IDE4IDI3LjVzOS4zMDEtNS4wMjggOS40MjktNS4yNDNjLjEyMy0uMjA1LjA4NC0uNDY4LS4wOTQtLjYyOHpNNy45OTkgMTVjLS4xNSAwLS4zMDMtLjAzNC0uNDQ2LS4xMDYtLjQ5NC0uMjQ3LS42OTQtLjg0OC0uNDQ3LTEuMzQyQzcuMTU4IDEzLjQ0OCA4LjQyNCAxMSAxMiAxMWMzLjU3NyAwIDQuODQyIDIuNDQ5IDQuODk0IDIuNTUzLjI0Ny40OTQuMDQ3IDEuMDk1LS40NDcgMS4zNDItLjQ5Mi4yNDUtMS4wODUuMDQ5LTEuMzM2LS40MzZDMTUuMDY4IDE0LjM3OSAxNC4yODEgMTMgMTIgMTNjLTIuMzE3IDAtMy4wOTkgMS40MzMtMy4xMDYgMS40NDctLjE3NS4zNTEtLjUyOC41NTMtLjg5NS41NTN6bTIwLjAwMiAwYy0uMzY3IDAtLjcyLS4yMDItLjg5Ni0uNTUzQzI3LjA4IDE0LjQwMSAyNi4yOTkgMTMgMjQgMTNzLTMuMDggMS40MDEtMy4xMTIgMS40NmMtLjI2LjQ4MS0uODU5LjY3LTEuMzQ1LjQyLS40ODUtLjI1Mi0uNjgyLS44MzktLjQzOC0xLjMyOEMxOS4xNTcgMTMuNDQ5IDIwLjQyMyAxMSAyNCAxMXM0Ljg0MyAyLjQ0OSA0Ljg5NSAyLjU1M2MuMjQ3LjQ5NC4wNDcgMS4wOTUtLjQ0NyAxLjM0Mi0uMTQ0LjA3MS0uMjk3LjEwNS0uNDQ3LjEwNXoiLz48L3N2Zz4=" width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></p>
<blockquote data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>the remains → that remains<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>the remains的意思 </font></font></font></p>
</blockquote>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Thanks, fixed.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>谢谢，修好了。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
 <li class="comment byuser comment-author-jameswil odd alt thread-odd thread-alt depth-1 comment-show" id=li-comment-10107 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10107 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/fee625eae4aba50140ecb29810176119-1-48x48.jpg src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><rect fill-opacity="0"/></svg>' data-srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/fee625eae4aba50140ecb29810176119-1-96x96.jpg 2x" class="avatar avatar-40 photo avatar-default lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-49)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 James Wil </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T11:48:31-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 11:48 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10107 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10107" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>詹姆斯·威尔八月17，2021 11：48上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10107 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10107 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10107 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10107 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Years and years and years of waiting for AOT compiler for dotnet..<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>年复一年，年复一年，等待AOT编译器为dotnet.. </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>And still nothing..<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>还是什么都没有。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Years and years and years wasted on trying to “optimize” mono..<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>年复一年地浪费在试图“优化”单声道上。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This is laughable at this point, glad i didn’t wait for dotnet people to do something and went with golang instead<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这是可笑的在这一点上，很高兴我没有等待dotnet的人做一些事情，而是去与golang代替 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Also no words on NativeAOT, i guess you guys don’t know about it? really? yeah that’s sad<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>也没有关于NativeAOT的话，我想你们不知道吧？真的吗？是的，那很悲哀 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-reilly-woodcanalyst-com even depth-2 comment-show" id=li-comment-10109 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10109 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/d56fe2b70d9037e4073ec9e99a585db7?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/d56fe2b70d9037e4073ec9e99a585db7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-50)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Reilly Wood </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T12:26:22-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 12:26 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10109 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10109" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Reilly Wood八月17，2021 12：26下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10109 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10109 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10109 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10109 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>This is not a great comment.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这不是一个伟大的评论。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>As Stephen notes, “A large percentage of the work in .NET 6 actually went into trimming safety” which is an essential part of AOT.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>正如Stephen所指出的，“.NET 6中很大一部分工作实际上都是为了调整安全性”，这是AOT的重要组成部分。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Lots of work is going into NativeAOT, follow the dotnet/runtimelab repo if you’d like to keep up to date on it.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>NativeAOT有很多工作要做，如果你想跟上它的最新情况，请关注dotnet/runtimelab repo。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-jameswil odd alt depth-3 comment-show" id=li-comment-10188 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10188 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/fee625eae4aba50140ecb29810176119-1-48x48.jpg src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><rect fill-opacity="0"/></svg>' data-srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/fee625eae4aba50140ecb29810176119-1-96x96.jpg 2x" class="avatar avatar-40 photo avatar-default lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-49)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 James Wil </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-19T06:34:55-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 19, 2021 6:34 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10188 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10188" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>詹姆斯·威尔八月19，2021 6：34上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10188 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10188 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10188 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10188 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>They never refer to nativeAOT, they always refer to MONO WASM AOT, wich is bad<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>他们从来不提nativeAOT，他们总是提MONOWASMAOT，这很糟糕 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Even in this blogpost, they refer to mono AOT<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>即使在这篇博文中，他们也提到了单声道AOT </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 <li class="comment byuser comment-author-john-tur even depth-2 comment-show" id=li-comment-10131 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10131 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/57c4dfd355e85a8a972bacfc72b4b0d3?s=40&amp;d=mm&amp;r=g" src=data:image/png;base64,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 data-srcset="https://secure.gravatar.com/avatar/57c4dfd355e85a8a972bacfc72b4b0d3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 John Tur </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T17:11:27-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 5:11 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10131 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10131" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>约翰·图尔八月17，2021 5：11下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10131 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10131 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10131 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10131 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>You know that all of these optimizations will benefit NativeAOT, right?<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>您知道所有这些优化都将使NativeAOT受益，对吗？ </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-jameswil odd alt depth-3 comment-show" id=li-comment-10189 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10189 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/fee625eae4aba50140ecb29810176119-1-48x48.jpg src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48"><rect fill-opacity="0"/></svg>' data-srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/fee625eae4aba50140ecb29810176119-1-96x96.jpg 2x" class="avatar avatar-40 photo avatar-default lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-49)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 James Wil </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-19T06:39:58-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 19, 2021 6:39 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10189 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10189" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>詹姆斯·威尔八月19，2021 6：39上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10189 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10189 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10189 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10189 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>That would be nice but if they don’t talk about it, i can’t know<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>那很好但如果他们不谈我就不知道了 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 <li class="comment byuser comment-author-zezba9000 even depth-2 comment-show" id=li-comment-10193 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10193 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/4349ed6429ba8afc87933a4afacfe7e0?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+t6KPxr0D4VeF7fVJrjUbtFmjgYJFGwyu/GSSPYY/OgDhvsFz5PnfZ5vJ6+ZsO386gr6awMY7V5N8VvC9vpklvqVoiwpO5jlRRhd+MggdsgHP0oA8+oo/GigA/CvR/hJ4hgtHudLndYmmcSQljgM2MFfrwMfjXnKIZHVEBZmOAo5JNez+DPh7aaHbR3N7EtxqLDcd4ysXsB6+/5UAdnz6V5Z8XPEMF19n0qB1laF/NmKnIVsEBfryc/hXqXHvXG+NPh7aa5bSXNlEtvqKgsNgwsvsR6+/wCdAHi/4UUroY3ZHBVlOCp4IPpRQB1Xwy05dR8WW5cBlt1afHuOB+RIP4V7hz60UUAHPrRz60UUAeH/ABN05dO8WXBQBUuEWfHucg/qCfxooooA/9k=" data-srcset="https://secure.gravatar.com/avatar/4349ed6429ba8afc87933a4afacfe7e0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Andrew Witte </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-19T11:44:40-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 19, 2021 11:44 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10193 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10193" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>安德鲁·维特八月19，2021 11：44上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10193 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10193 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10193 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10193 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET and its runtime are fundamentally flawed for AOT. (It tries to solve to much and ends up failing where mostly needed)<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET及其运行时对于AOT来说是有根本性缺陷的。(It试图解决很多问题，但最终在最需要的地方失败了）</font></font></font><br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
C# is mostly good as a lang however and needs to just be compiling directly to native code with a runtime built around the lang (not a lang trying to hack around a flawed runtime &amp; JIT).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> C#作为一个lang是很好的，但是，它只需要直接编译成本地代码，并使用一个围绕lang构建的运行时（而不是一个lang试图绕过有缺陷的运行时&amp; JIT）。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>If it was done this way, WASM, ASM.JS, PNACL, embedded would no longer or would never have been such a big issue. Game, web, desktop-app, mobile-app code would be much faster, use less power and start faster. Yet the obsession with a JIT continues to plague C# moving past its legacy inclinations for use.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>如果这样做，WASM，ASM.JS，PNACL，嵌入式将不再或永远不会成为如此大的问题。游戏、网页、桌面应用、移动应用的代码会更快，耗电更少，启动速度更快。然而，对JIT的痴迷继续困扰着C#，使之超越了它的传统倾向。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>A JIT should have been a special use case not the default crutch things are designed around.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>JIT应该是一个特殊的用例，而不是默认的拐杖。</font></font></font><br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
I’ve never heard a use case where a JIT’s solutions weren’t better solved with native complication solutions (and just as easy to understand with proper syntax).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 我从来没有听说过JIT的解决方案不能用原生复杂度解决方案更好地解决（并且使用正确的语法也很容易理解）的用例。</font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
 <li class="comment byuser comment-author-olegm-developmentyandex-ru odd alt depth-2 comment-show" id=li-comment-10284 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10284 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/4d5d6ebf0cf3a1be19d44f363573d5df?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+t6KPxr0D4VeF7fVJrjUbtFmjgYJFGwyu/GSSPYY/OgDhvsFz5PnfZ5vJ6+ZsO386gr6awMY7V5N8VvC9vpklvqVoiwpO5jlRRhd+MggdsgHP0oA8+oo/GigA/CvR/hJ4hgtHudLndYmmcSQljgM2MFfrwMfjXnKIZHVEBZmOAo5JNez+DPh7aaHbR3N7EtxqLDcd4ysXsB6+/5UAdnz6V5Z8XPEMF19n0qB1laF/NmKnIVsEBfryc/hXqXHvXG+NPh7aa5bSXNlEtvqKgsNgwsvsR6+/wCdAHi/4UUroY3ZHBVlOCp4IPpRQB1Xwy05dR8WW5cBlt1afHuOB+RIP4V7hz60UUAHPrRz60UUAeH/ABN05dO8WXBQBUuEWfHucg/qCfxooooA/9k=" data-srcset="https://secure.gravatar.com/avatar/4d5d6ebf0cf3a1be19d44f363573d5df?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Oleg Mikhailov </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-24T14:50:07-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 24, 2021 2:50 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10284 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10284" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>奥列格·米哈伊洛夫八月24，2021 2：50下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10284 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10284 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10284 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10284 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>+1 Microsoft’s investment in the infrastructure is terribly ineffective. It was foolish to spend years and a lot of man-hours on all these optimizations in .Net Core 1 / 2 / 3, .Net 5 and .Net 6, while AOT would solve most of the performance problems.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>+ 1微软在基础设施上的投资非常低效。在.Net Core 1 / 2 / 3、.Net 5和.Net 6中花费数年时间和大量人力进行所有这些优化是愚蠢的，而AOT可以解决大多数性能问题。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-pjmlp_ptyahoo-com even depth-3 comment-show" id=li-comment-10368 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10368 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/c8c44c1ae21f50fc60ec65cf2d0b2c66?s=40&amp;d=mm&amp;r=g" src=data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+uKKK9A+FXhe31SafUbuNZo4GCRRsMqXxkkj2GPzoA4b7Bc+R532eXyevmbDt/OoK+msDGMceleT/Fbwvb6ZJBqVpGsKTuY5Y1GF34yCB7gHP0oA89ooooAK9H+EfiGC0e40udxG0ziSEscBmxgr9eBj8a86RGkdURSzMcBQOSa9n8GfD210O2jub2JLjUWG47xlYvYD19/yoA7KvLPi54hgujb6VA4kaJ/NmKnIVsEBfryc/hXqdcb4z+HtrrltJc2USW+oqCw2DCy+zD19/wA6APFqKc6NG7I6lWU4Kkcg0UAdR8MtOXUfFluXG5bdWnwfUcD9SD+Fe40UUAFFFFAHh3xN05dO8WXBQbVuFWfA9Twf1BP40UUUAf/Z data-srcset="https://secure.gravatar.com/avatar/c8c44c1ae21f50fc60ec65cf2d0b2c66?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Paulo Pinto </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-09-05T05:41:59-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 September 5, 2021 5:41 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10368 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10368" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Paulo Pinto September 5，2021 5：41 am 0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10368 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10368 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10368 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10368 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Apparently .NET Native effort was from WinDev only, and now is left to die.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>显然，.NET Native的工作只来自WinDev，现在已经死了。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
</ul>
</li>
 <li class="comment byuser comment-author-reilly-woodcanalyst-com odd alt thread-even depth-1 comment-show" id=li-comment-10108 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10108 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/d56fe2b70d9037e4073ec9e99a585db7?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/d56fe2b70d9037e4073ec9e99a585db7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-50)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Reilly Wood </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T12:20:36-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 12:20 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10108 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10108" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Reilly Wood八月17，2021 12：20下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10108 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10108 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10108 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10108 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>These posts are a major highlight of every .NET release for me. Thanks again! I’m really excited to try out PGO in particular.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这些帖子对我来说是每个.NET版本的主要亮点。再次感谢！我真的很兴奋，特别是尝试PGO。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Also, small typo: @Segioo0694 should be @Sergio0694<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>还有一个小错字：@Segioo0694应该是@Sergio0694 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor even depth-2 comment-show" id=li-comment-10111 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10111 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T12:46:18-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 12:46 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10111 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10111" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 八月17，2021 12：46下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10111 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10111 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10111 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10111 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Thanks! Very glad you liked it and look forward to it. And thanks for pointing out my typo: fixed.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>谢谢你，谢谢很高兴你喜欢它并期待它。谢谢你指出我的错字：固定. </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 <li class="comment byuser comment-author-hiteshdavey odd alt thread-odd thread-alt depth-1 comment-show" id=li-comment-10110 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10110 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/53fe9524eb6724b54a1f4e7a2032af81?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+t6KPxr0D4VeF7fVJrjUbtFmjgYJFGwyu/GSSPYY/OgDhvsFz5PnfZ5vJ6+ZsO386gr6awMY7V5N8VvC9vpklvqVoiwpO5jlRRhd+MggdsgHP0oA8+oo/GigA/CvR/hJ4hgtHudLndYmmcSQljgM2MFfrwMfjXnKIZHVEBZmOAo5JNez+DPh7aaHbR3N7EtxqLDcd4ysXsB6+/5UAdnz6V5Z8XPEMF19n0qB1laF/NmKnIVsEBfryc/hXqXHvXG+NPh7aa5bSXNlEtvqKgsNgwsvsR6+/wCdAHi/4UUroY3ZHBVlOCp4IPpRQB1Xwy05dR8WW5cBlt1afHuOB+RIP4V7hz60UUAHPrRz60UUAeH/ABN05dO8WXBQBUuEWfHucg/qCfxooooA/9k=" data-srcset="https://secure.gravatar.com/avatar/53fe9524eb6724b54a1f4e7a2032af81?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 hitesh davey </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T12:41:29-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 12:41 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10110 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10110" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>hitesh davey八月17，2021 12：41下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10110 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10110 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10110 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10110 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Honestly, this is a lot of work indeed! EXCELLENT would be an understatement! I am running out of words to appreciate your team’s effort in optimizing .NET 6 to this level.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>老实说，这确实是一个很大的工作！优秀将是一个轻描淡写！我已经没有言语来感谢您的团队在将.NET 6优化到这个级别上所做的努力了。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Blogs about performance optimizations are always interesting to read. You learn a lot along the way. So far I have read 30% of this blog. It will take 5 days for me to read the entire blog and understand it (I will make sure I will read it to keep myself motivated to adopt .NET 6). Next time pl make sure you present the blog in 3 parts to keep the reader engaged with the content.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>关于性能优化的博客总是有趣的阅读。一路沿着你学到了很多。到目前为止，我已经阅读了这个博客的30%。我需要5天的时间来阅读整个博客并理解它（我会确保我会阅读它，以保持自己采用.NET 6的动力）。下次请确保你的博客分为三个部分，以保持读者对内容的参与。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Btw, the Loop optimization part was an intresting read.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>顺便说一句，循环优化部分是一个有趣的阅读。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor even depth-2 comment-show" id=li-comment-10114 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10114 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T13:03:27-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 1:03 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10114 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10114" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 八月17，2021 1 1：03下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10114 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10114 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10114 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10114 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I’m very glad you like it and see value in it. Thanks for the feedback.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我很高兴你喜欢它，看到它的价值。感谢您的反馈。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 <li class="comment byuser comment-author-dominik-jeske odd alt thread-even depth-1 comment-show" id=li-comment-10115 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10115 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2927a2e304e3714b26552d37f960323c?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,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" data-srcset="https://secure.gravatar.com/avatar/2927a2e304e3714b26552d37f960323c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Dominik Jeske </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T13:12:16-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 1:12 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10115 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10115" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Dominik Jeske八月17，2021 1 1：12下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10115 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10115 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10115 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10115 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Great summary Stapen!! I wonder when You will reach the point “When Alexander saw the breadth of his domain, he wept, for there were no more worlds to conquer.” I also have one suggestion – There is lot of stuff that will be given to us just by update to .NET 6 and I really appreciate this but I also would like to read some distillated stuff that will guide us how to improve our code or stop doing some things basing on changes in .NET – for example you mentioned about rule to use sealed in non public classes.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>伟大的总结Stapen！！我想知道你什么时候会达到这一点“当亚历山大看到他的领土的广度，他哭了，因为没有更多的世界征服。”我也有一个建议-有很多的东西，将给我们只是通过更新到.NET 6，我真的很感激这一点，但我也想读一些提炼的东西，将指导我们如何改善我们的代码或停止做一些事情的基础上的变化.NET -例如，你提到的规则使用密封在非公共类。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor even depth-2 comment-show" id=li-comment-10121 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10121 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T14:47:03-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 2:47 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10121 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10121" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 2021年8月17日2：47下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10121 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10121 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10121 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10121 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Thanks, and thanks for the feedback. I remember when I finished both the .NET Core 2.1 and .NET Core 3.0 blog posts thinking “What will I have to talk about next time?” I’ve stopped asking myself that <img draggable=false role=img class=emoji alt=😉 src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNiAzNiI+PHBhdGggZmlsbD0iI0ZGQ0M0RCIgZD0iTTM2IDE4YzAgOS45NDEtOC4wNTkgMTgtMTggMTgtOS45NCAwLTE4LTguMDU5LTE4LTE4QzAgOC4wNiA4LjA2IDAgMTggMGM5Ljk0MSAwIDE4IDguMDYgMTggMTgiLz48ZWxsaXBzZSBmaWxsPSIjNjY0NTAwIiBjeD0iMTEuNSIgY3k9IjE2LjUiIHJ4PSIyLjUiIHJ5PSIzLjUiLz48cGF0aCBmaWxsPSIjNjY0NTAwIiBkPSJNMjguNDU3IDE3Ljc5N2MtLjA2LS4xMzUtMS40OTktMy4yOTctNC40NTctMy4yOTctMi45NTcgMC00LjM5NyAzLjE2Mi00LjQ1NyAzLjI5Ny0uMDkyLjIwNy0uMDMyLjQ0OS4xNDUuNTkxLjE3NS4xNDIuNDI2LjE0Ny42MS4wMTQuMDEyLS4wMDkgMS4yNjItLjkwMiAzLjcwMi0uOTAyIDIuNDI2IDAgMy42NzQuODgxIDMuNzAyLjkwMS4wODguMDY2LjE5NC4wOTkuMjk4LjA5OS4xMSAwIC4yMjEtLjAzNy4zMTItLjEwOS4xNzctLjE0Mi4yMzgtLjM4Ni4xNDUtLjU5NHpNNS45OTkgMTIuNDU4Yy0uMjA4IDAtLjQxOS0uMDY1LS41OTktLjItLjQ0Mi0uMzMxLS41MzEtLjk1OC0uMi0xLjQgMy4yNjItNC4zNSA3LjYxNi00LjQgNy44LTQuNC41NTIgMCAxIC40NDggMSAxIDAgLjU1MS0uNDQ1Ljk5OC0uOTk2IDEtLjE1Ni4wMDItMy41NjkuMDg2LTYuMjA1IDMuNi0uMTk1LjI2Mi0uNDk2LjQtLjguNHptMjMuMDAyIDIuMTI1Yy0uMzA1IDAtLjYwNC0uMTM4LS44MDEtLjQtMi41OTItMy40NTctNi45NjEtMi42MjctNy4wMDQtMi42Mi0uNTQ3LjEwOC0xLjA2OC0uMjQzLTEuMTc3LS43ODQtLjEwOC0uNTQyLjI0My0xLjA2OC43ODQtMS4xNzcuMjMxLS4wNDcgNS42NTctMS4wNzIgOC45OTYgMy4zOC4zMzIuNDQyLjI0MiAxLjA2OS0uMiAxLjQtLjE3OS4xMzctLjM4OS4yMDEtLjU5OC4yMDF6bS01Ljc0NyA4Ljk5NGMtLjE4OC0uMTEtLjQzMi0uMDg3LS41OTcuMDYtLjAxLjAwOC0xLjAxMy44NjMtNC42NTcuODYzLTMuNjQxIDAtNC42NDYtLjg1NC00LjY0Ni0uODU0LS4xNTktLjE2LS40MDQtLjE5LS42LS4wODItLjE5NS4xMTEtLjI5My4zMzktLjIzOC41NTcuMDEuMDQ0IDEuMTQ0IDQuMzc5IDUuNDg0IDQuMzc5czUuNDc0LTQuMzM1IDUuNDg1LTQuMzc5Yy4wNTMtLjIxMy0uMDQ0LS40MzEtLjIzMS0uNTQ0eiIvPjwvc3ZnPg==" width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>谢谢，谢谢你的反馈。我记得当我完成.NET Core 2.1和.NET Core 3.0博客文章时，我想“下次我会谈论什么？”“我已经停止问自己这个#0 #</font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 <li class="comment byuser comment-author-daniel-steinerphonak-ch odd alt thread-odd thread-alt depth-1 comment-show" id=li-comment-10116 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10116 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/7b0564a81b8409fa26887f489aba31d1?s=40&amp;d=mm&amp;r=g" src=data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+uKKK9A+FXhe31SafUbuNZo4GCRRsMqXxkkj2GPzoA4b7Bc+R532eXyevmbDt/OoK+msDGMceleT/Fbwvb6ZJBqVpGsKTuY5Y1GF34yCB7gHP0oA89ooooAK9H+EfiGC0e40udxG0ziSEscBmxgr9eBj8a86RGkdURSzMcBQOSa9n8GfD210O2jub2JLjUWG47xlYvYD19/yoA7KvLPi54hgujb6VA4kaJ/NmKnIVsEBfryc/hXqdcb4z+HtrrltJc2USW+oqCw2DCy+zD19/wA6APFqKc6NG7I6lWU4Kkcg0UAdR8MtOXUfFluXG5bdWnwfUcD9SD+Fe40UUAFFFFAHh3xN05dO8WXBQbVuFWfA9Twf1BP40UUUAf/Z data-srcset="https://secure.gravatar.com/avatar/7b0564a81b8409fa26887f489aba31d1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Daniel Steiner </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T13:24:32-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 1:24 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10116 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10116" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>丹尼尔·施泰纳八月17，2021 1：24下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10116 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10116 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10116 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10116 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>why are 40 bytes reserved<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>为什么保留40字节</font></font></font><br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 sub rsp,28<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> subrsp，28</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>on the stack in the first code example ( public static int Compute() =&gt; ComputeValue(123) * 11;)<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>在第一个代码示例中的堆栈上（public static int Compute（）=&gt; ComputeValue（123）* 11;） </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>they’re no values stored on the stack and the the method ComputeValue takes only one parameter and therefore I would expect only 4 bytes space reserved on the stack to have temporary storage location for storing the value of the register used for passing the value if the register needs to be overriden by another value within the called method.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>它们不是存储在堆栈上的值，计算值方法只需要一个参数，因此我希望在堆栈上只保留4个字节的空间，以便在寄存器需要被调用方法中的另一个值覆盖的情况下存储寄存器的值。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-andya even depth-2 comment-show" id=li-comment-10119 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10119 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/0df0dd42da08ba3574f565287e531039?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A/VOvHPi7+1f8Pvgv4kj8Oa5f3Fx4jktPtiaXYW5lk8vJC7jwq7iDjcR69K9hkbbGxJKgAnI7V+KuieJJfiH8SPEfjfXb2XUrm8vJGlvrp0iIRWOxMsQqqq7VAzxwBXNiKrpQ5o7noYHDwxNZQqOy6n3rZft8NJeCW6+H91DpBP8ArotRWScL6+WY1XPtv/GvW/gz+1F4E+OF/eaXoeoNba/ZjfPo98hjuETs4/hYH/ZJx3r4aOpaT/YhZI53kxxBuUk8E5yCeOD+VeEavrMvgv4o+GPG+iNLZ3FpexKJIWYE7ZFfYwwDjCsCCOQfevDw2PrSnapqj7HNMlwVKgp4Z2l89V8z9uKKQEEAjkGivpT8+Fr84fiR8P7H4Y/H/wAaabawQQade3a6xGsaDEazLvcAdBh9+B0xiv0er4n/AG7ZNH8NeMPDviCz1CzOt3cEmm3mnrMnnMigvFIY85wN7qWI/iQVw42DqUWo7ntZRXjh8ZGU9j581TVgdZu7+OKMW/nxPE00oX5FBBGOpzuOOnevTvgh4Q0L4lfHDwiuo2S3em2/m6iltcIGVpI42ChgeoDHPPXaK8iGp6D9mEoaCIgDMTj529ePWvob9gnVfD/irx34hvDqlsut6baeRaaOWxMIJHy84B6rlAmRnBLZxkZ+dw9FyxELLY/Qs2xtOngJrmTclpbzPuOilor7A/Iz8W9c/ad+K/jcSR6p491owy/6yG1uTbRkem2LaMe2MVy+j6SbrUPNZ2mklbLSOctk9eT6n+VFFbYxKOGnbsdeXWli6d+56LY+FRLCwuZHlRRxECcH6+teMxRXyfFLU/EtrPPp9rZp9hs2gcxtKFPzPkfw7s49evTqUV8xlf72tKUui/M+wz6EaFGEKasm/wAj2zwT+218XPh6Eit/FEus2ScfZtaQXYx2G9v3gHsGFFFFfU8kT4W5/9k=" data-srcset="https://secure.gravatar.com/avatar/0df0dd42da08ba3574f565287e531039?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Andy Ayers<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T14:30:28-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 2:30 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10119 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10119" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Andy Ayers <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 八月17，2021 2：30下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10119 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10119 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10119 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10119 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The <a href="https://docs.microsoft.com/en-us/cpp/build/x64-calling-convention?view=msvc-160" target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>windows x64 ABI</a> requires that non-leaf methods allocate 32 bytes on the stack frame for use by callees, and the stack pointer has to remain 16 byte aligned outside the prolog. We have 8 bytes on the stack from the call pushing the return address, so we need to allocate 40 bytes more to keep everything in sync with the ABI requirements.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Windows x64 ABI要求非叶方法在堆栈帧上分配32个字节供被调用方使用，堆栈指针必须在序言外保持16字节对齐。栈上有8个字节来自推送返回地址的调用，所以我们需要再分配40个字节来保持所有内容与ABI要求同步。</font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 <li class="comment byuser comment-author-danieldsmith odd alt thread-even depth-1 comment-show" id=li-comment-10117 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10117 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/645dd0e1815ec192e9dd7727b5dfb0b1?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/645dd0e1815ec192e9dd7727b5dfb0b1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-59)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Daniel Smith </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T13:27:44-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 1:27 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10117 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10117" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Daniel Smith八月17，2021 1 1：27下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10117 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10117 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10117 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10117 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Amazing – what an incredible amount of effort has gone into this release. Thank you so much to everyone involved!<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>令人惊讶的是，在这个版本中付出了多么令人难以置信的努力。非常感谢所有参与的人! </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Has the team been following Dave Plummer’s language drag race? The latest benchmarks have C# and Java neck and neck with one C# version using unsafe code edging ahead! Any final optimisations planned that might make a difference to the race?<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>团队有没有关注戴夫·普卢默的语言竞赛？最新的基准测试让C#和Java并驾齐驱，其中一个C#版本使用了不安全的代码!有没有最后的优化计划，可能会对比赛产生影响？ </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor even depth-2 comment-show" id=li-comment-10122 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10122 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T14:47:34-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 2:47 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10122 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10122" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub-MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 2021年8月17日2：47下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10122 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10122 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10122 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10122 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Thanks. Can you point me to the C# benchmark code in question?<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>谢谢.你能告诉我有问题的C#基准测试代码吗？ </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-tjgutjahr odd alt depth-3 comment-show" id=li-comment-10134 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10134 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/69ba2b6c01dce235e473dd6ffda9eecf?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAKAAoAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+t6KPxr0D4VeF7fVJrjUbtFmjgYJFGwyu/GSSPYY/OgDhvsFz5PnfZ5vJ6+ZsO386gr6awMY7V5N8VvC9vpklvqVoiwpO5jlRRhd+MggdsgHP0oA8+oo/GigA/CvR/hJ4hgtHudLndYmmcSQljgM2MFfrwMfjXnKIZHVEBZmOAo5JNez+DPh7aaHbR3N7EtxqLDcd4ysXsB6+/5UAdnz6V5Z8XPEMF19n0qB1laF/NmKnIVsEBfryc/hXqXHvXG+NPh7aa5bSXNlEtvqKgsNgwsvsR6+/wCdAHi/4UUroY3ZHBVlOCp4IPpRQB1Xwy05dR8WW5cBlt1afHuOB+RIP4V7hz60UUAHPrRz60UUAeH/ABN05dO8WXBQBUuEWfHucg/qCfxooooA/9k=" data-srcset="https://secure.gravatar.com/avatar/69ba2b6c01dce235e473dd6ffda9eecf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Travis J. Gutjahr </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T21:45:05-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 9:45 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10134 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10134" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Travis J.美好的一年八月17，2021 9：45 pm 0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10134 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10134 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10134 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10134 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href="https://www.youtube.com/watch?v=sJC3JsvhM9o" target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>https://www.youtube.com/watch?v=sJC3JsvhM9o</a> for the video.<br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<a href=https://github.com/PlummersSoftwareLLC/Primes target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>https://github.com/PlummersSoftwareLLC/Primes</a> for the source code.</p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>The idea is to implement a prime sieve in many different languages to showcase performance differences but also highlight languages features and styling differences.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我们的想法是在许多不同的语言中实现一个主筛，以展示性能差异，但也突出语言功能和样式差异。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
 <li class="comment byuser comment-author-danieldsmith even depth-3 comment-show" id=li-comment-10141 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10141 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/645dd0e1815ec192e9dd7727b5dfb0b1?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/645dd0e1815ec192e9dd7727b5dfb0b1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-59)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Daniel Smith </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-18T01:40:30-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 18, 2021 1:40 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10141 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10141" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>丹尼尔Smith八月18，2021 1 1：40上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10141 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10141 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10141 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10141 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Here’s the GitHub repo for the drag race (the C# entries are under the PrimeCSharp folder):<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>下面是GitHub的repo for drag race（C#条目位于PrimeCSharp文件夹下）： </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/PlummersSoftwareLLC/Primes target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>https://github.com/PlummersSoftwareLLC/Primes</a></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-ryan-q-heath odd alt depth-4 comment-show" id=li-comment-10151 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10151 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/8196ac7ecc62ed5aaa2879fe15733dce?s=40&amp;d=mm&amp;r=g" src="data:image/jpeg;base64,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" data-srcset="https://secure.gravatar.com/avatar/8196ac7ecc62ed5aaa2879fe15733dce?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Ryan Heath </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-18T09:21:47-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 18, 2021 9:21 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10151 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10151" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Ryan Heath八月18，2021 9：21上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10151 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10151 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10151 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10151 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Would be nice to see if just using net6 the program is running faster.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>如果只是使用net 6程序运行得更快，那就太好了。 </font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>// Ryan</p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-lovettchris even depth-5 comment-show" id=li-comment-10208 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10208 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/aa2b9adbfaf11a4a8c1c03fffd83588b?s=40&amp;d=mm&amp;r=g" src="data:image/png;base64,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" data-srcset="https://secure.gravatar.com/avatar/aa2b9adbfaf11a4a8c1c03fffd83588b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Chris Lovett </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-20T02:52:27-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 20, 2021 2:52 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10208 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10208" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>克里斯·洛维特八月20，2021 2：52上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10208 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10208 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10208 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10208 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>I’m not seeing an obvious improvement with <a href=https://github.com/PlummersSoftwareLLC/Primes/tree/drag-race/PrimeCSharp/solution_1 target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>https://github.com/PlummersSoftwareLLC/Primes/tree/drag-race/PrimeCSharp/solution_1</a><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>我https://github.com/PlummersSoftwareLLC/Primes/tree/drag-race/PrimeCSharp/solution_1</font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
 <li class="comment byuser comment-author-ianmarteens-com odd alt depth-5 comment-show" id=li-comment-10310 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10310 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/3853a8f9d0bb5b0f1aad05b73ee525db?s=40&amp;d=mm&amp;r=g" src=data:image/jpeg;base64,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 data-srcset="https://secure.gravatar.com/avatar/3853a8f9d0bb5b0f1aad05b73ee525db?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Ian Marteens </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-27T04:40:13-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 27, 2021 4:40 am </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10310 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10310" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Ian Martentens八月27，2021 4：40上午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10310 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10310 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10310 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10310 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Chris, have you tried using the three “experimental” environment variables? For all code that I’ve tested, there are no improvements… unless those three variables are set (Tiered PGO, No R2R, QuickJitForLoops).<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Chris，你试过使用三个“实验”环境变量吗？对于我测试过的所有代码，没有任何改进...除非设置了这三个变量（Tiered PGO、No R2 R、QuickJitForLoops）。 </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
 <li class="comment byuser comment-author-yhntgbujm even thread-odd thread-alt depth-1 comment-show" id=li-comment-10120 style=display:block data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10120 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src=https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/d0af06fffaf5443b9ee6b42008478d3f-48x48.png src=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAE5klEQVR42u1YaWicZRBOrVZrPaq1Ra1aFRURFQURRfACFREP9IfXD0E8qlJFUaoo6A+R4v3Ppokm5jDH5tzcSZtjN0lzZ5Oaq+bebM7tXkl2s+fjzISP5mM3f5qlux/swLDwvfO97zwzz8y8+yUl/ZEDTWtcOJEAoGWNCycSALSsceFEAoCWNS6cSADQssaFExv0gqO52JmSj4uS87QFYFeKDk+VNeCb9n6kDI7ix94hPKmvZ0DnDmA7vXzd38W4OUuPa+l3+yabXZ6qw4FMPW7MLOXoRbS5MDkX+zNKZK9r0opUjl1G73/V1gfzihuBUAgsfvrlZ9u2koHdfxUifXgc464V6CdnsC+9OMxm29EcHGzqxGmHC6fOOPBClSHiXvfmV6F1fgljzmV2TEWRZ8obMUPOs+uTdFbywCiO9AziacrIVigkhxzpHUQwFJIDHiysDbO58s8CFI6ZQSLR+757ICJ/36pvw4rfD08ggPebOlRn/EDv8LtOrw9vN7Rj57F8zhivbQWA+mC3P4B3GzvC1m//pxxDdicUOTEzzxQJow8Bk0BYKBAPF9VCHYBpsAzbXbg1uyy6Xeg+XRWnVQ7/tW8YO46po/JaXQtcPh+vCwWmllfxQEGNymZPWiGqpmfB0r5gpboqgbJ2NdG0YkrWhII3ZJRGFYDw3jC7CJYGywL2pp+N7g5K8U+mIXF+wb0Gl9cnFDlo6FQV3y3ZegzanAIwdWgMl6boSPPxItXLx83dMFntYDET+C9ae/EOZfq5yiZcQlTaMoCLKeK/94+AfJQCvDuvMiK4ess8epds4mQaFf6uVJ1iJ4VtW/NiLRDEIWM3g5OuZpxbZGoqnYcDwQGQZ7XmOQ5WVOYAc182dfn8eON4K5TnDxGXubi9wSC+bDMxxdgJiehNmXq2EWc/p6j6yGbB7eHeLs+vIur8QtmrJPpYVt1gcVAGa6bnUDoxw4XN9REVANJ9zCurEqlvO0/xPBDHDlH6Oaqz5MCjJcfxel0r1wNHW6KuzIis05Ng6VmyMceViUtrBUwviTbLgM2Bu3IrGRzPBm7RUQEg6T45bwVL2aSFD5DDs8kxTn7z3JLY3JEjHQn+DUCvp+HVtXgGJGzPgHhPVRFzFlj6o1/EojxdZbiEJEpOnqasfKBQ5mfTEHcnSXmBtEQIFfZQO32kuI4zJBT6rKWHM3feAYh+ZOxiugg9nq804OVqI+xerwyfV+talKnMTkpNTFDrvV9XjfeaOqQwrR4vnq1oRFKsADxWegLzqx6J5OGTJhpM/3JNSEZu2zB8Hie7ObLjov/Q0CWFTWbi3IEsfewA7Bcu28BSQl3COLsolModncIVZ7sFDym584QgnFfaLFOLKRYzANIVMkYmwPKfY5kHl1Dqk2bu6+q58dt6O2U74b8/GMLhNhNRLDdmAMTJT9f5LZwOrF/weBaE2b5Js2LZ52c7oZyd6ualaiOvxQ6Acu1d8qxBkUbLAvZFmJZ35lRgxO6CInSNoH5fFnMANF1L0We1K1dnvrNHvPLuJq4XjZuhSPn67Ig5AClCHRWjMvZfqWne7H+tcn1QTe9YA5A+/4S+nh2S4t2btvll6568Kvnn9XV7v/p6HT4kpWa+oz0/MHRyR9P2VwnNf1ZJANCcxoUTCQBa1rhwIgFAyxoXTiQAaFj/Byy+yLHxsLswAAAAAElFTkSuQmCC data-srcset="https://devblogs.microsoft.com/dotnet/wp-content/uploads/sites/10/nsl_avatars/d0af06fffaf5443b9ee6b42008478d3f-96x96.png 2x" class="avatar avatar-40 photo avatar-default lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Wf F </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T14:41:49-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 2:41 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10120 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10120" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>Wf F 2021年8月17日2：41下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10120 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10120 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10120 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10120 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>These perf write-ups are a treat.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>这些表现是一种享受。</font></font></font><br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
You do (always have!) such a great job across the board, from PR curation to the examples given to “topic mini-introductions” to the balance of depth with conciseness.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 你总是这样！）从公关策划到“主题迷你介绍”的例子，再到深度与简洁的平衡，这是一项全面的伟大工作。</font></font></font><br data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
Thank you so much for the time and effort you put into these.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 非常感谢您为这些投入的时间和精力。</font></font></font></p>
<p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Small typo contribution: “nameof(intput)” -&gt; “nameof(input)”<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>小错字贡献：“nameof（intput）”-&gt;“nameof（input）” </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 <ul class=children data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="comment byuser comment-author-toub bypostauthor odd alt depth-2 comment-show" id=li-comment-10123 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <article id=comment-10123 class=comment data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="comment-author vcard" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <img alt data-src="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=40&amp;d=mm&amp;r=g" src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill-opacity="0"/></svg>' data-srcset="https://secure.gravatar.com/avatar/2f85938ff9d752d14977fa35c0af37e5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo lazyloaded" height=40 width=40 decoding=async data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 srcset style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-40)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important" sizes> </div>
 <header data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <span class=author-name data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="url x-hidden-focus" href=https://devblogs.microsoft.com/dotnet/author/toub/ alt="Stephen Toub - MSFT" title="Stephen Toub - MSFT" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stephen Toub - MSFT<img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"></a>
 </span>
 <span class=comment-date data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <time pubdate datetime=2021-08-17T14:48:59-07:00 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 August 17, 2021 2:48 pm </time>
 </span>
 <span class=voting data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span id=loggedoutvotes10123 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="comment-reply-login x-hidden-focus" title data-toggle=tooltip href="https://devblogs.microsoft.com/dotnet/wp-login.php?redirect_to=https%3A%2F%2Fdevblogs.microsoft.com%2Fdotnet%2Fperformance-improvements-in-net-6%2F%23comment-10123" data-bi-id=comments data-bi-name="Login to vote" aria-label="Login to vote" data-original-title="Login to vote" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=icon-like-dislike data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 2048 2048" class="svg_dd790ee3 x-hidden-focus" focusable=false><path d="M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"></path></svg></span></a> 0</span> </span><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Stephen Toub - MSFT <img src='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="54" height="53"><rect fill-opacity="0"/></svg>' alt="Microsoft employee" title="Microsoft employee" width=18 height=17.65625 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467 style="background-blend-mode:normal!important;background-clip:content-box!important;background-position:50% 50%!important;background-color:rgba(0,0,0,0)!important;background-image:var(--sf-img-41)!important;background-size:100% 100%!important;background-origin:content-box!important;background-repeat:no-repeat!important"> 八月17，2021 2：48下午0 </font></font></font>
 <div class="comment-meta commentmetadata" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span class=collapse-comment id=collapse-comment-10123 data-toggle=collapse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <button class=btn title data-toggle=tooltip data-original-title="collapse this comment">
 <span class=sr-only>collapse this comment</span><i class="fabric-icon fabric-icon--ChevronDown" aria-hidden=true></i>
 </button>
 
 </span>
 
 <span class=copy-link data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <button class="copy-link-anchor btn" title data-toggle=tooltip data-clipboard-text=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10123 targeturi=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/#comment-10123 data-original-title="copy link to this comment">
 <span class=sr-only>copy link to this comment</span>
 <i class="fabric-icon fabric-icon--Link" aria-hidden=true></i><div class=copy-link-live role=region aria-live=assertive></div>
 </button>
 </span>
 </div>
 </header>
 <div class=comment-content id=comment-text-10123 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Thanks for the nice words! And for pointing out the typo: fixed.<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>谢谢你的好话！并指出错别字：固定. </font></font></font></p>
 </div>
 <footer data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=reply data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 </div>
 </footer>
 </article>
 </li>
</ul>
</li>
 </ul>
 <nav aria-label="Comment navigation" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <ul class=pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li class="page-item active" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <span aria-current=page class="page-link current" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Page</span> 1<span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>of comments</span> </span> </li>
 <li class=page-item data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=page-link href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/comment-page-2#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Page</span> 2<span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>of comments</span> </a> </li>
 <li class=page-item data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=page-link href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/comment-page-3#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Page</span> 3<span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>of comments</span> </a> </li>
 <li class=page-item data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=page-link href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/comment-page-4#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Page</span> 4<span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>of comments</span> </a> </li>
 <li class=page-item data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class="next page-link" href=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/comment-page-2#comments data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--ChevronRight" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i><span class=screen-reader-text-pagination data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Next comment</span></a> </li>
 </ul>
 </nav>
 </div>
 
 
 </div>
 </div>
</div>
</div>
</main>
<div class=wrapper id=wrapper-footer-1 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <section data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <nav aria-label="Primary Footer Navigation" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=container aria-label="Recommended and Related" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=row data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=col-lg-4 style=padding-bottom:10px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="card bottomleft" aria-label=".NET Feature Blogs" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=card-body style=height:393px;padding-left:26px;padding-top:24px;padding-right:17px;margin-bottom:24px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <h5 class=card-title data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Feature Blogs<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>.NET功能博客 </font></font></font></h5>
 <div class="card-text listdisplay" style=height:100%;width:100%;overflow-y:auto;overflow-x:hidden data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/maui/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET MAUI</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/aspnetcore/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ASP.NET Core<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> ASP.NET核心</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/aspnet/category/blazor/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Blazor</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/entity-framework/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Entity Framework<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 实体框架</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/ml-dotnet/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>ML.NET</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/nuget/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>NuGet</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/xamarin/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Xamarin</a></li>
</ul>
<h5 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Languages<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>语言 </font></font></font></h5>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/csharp/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>C#</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/fsharp/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>F#</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/vbteam/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Visual Basic</a></li>
</ul>
<h5 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Popular Topics</h5>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/internals/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Internals</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/maintenance-and-updates/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Servicing</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/containers/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Containers</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/developer-stories/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Developer Stories</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/category/performance/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Performance</a></li>
</ul>
</div>
 </div>
 </div>
 </div><div class=col-lg-4 style=padding-bottom:10px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="card bottomcenter" aria-label=Archive data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=card-body style=height:393px;padding-left:26px;padding-top:24px;padding-right:17px;margin-bottom:24px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <h5 class=card-title data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Archive<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>存档 </font></font></font></h5>
 <div class="card-text listdisplay" style=height:100%;width:100%;overflow-y:auto;overflow-x:hidden data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><div class=ftr-archives role=list data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>	<li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二三年九月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二三年八月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二三年七月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二三年六月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二三年五月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二三年四月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 2023年3月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 2023年2月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2023/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2023<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二三年一月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2022<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二二年十二月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2022<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 二〇二二年十一月</font></font></font></a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2022/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2022</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2021/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2021</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2020/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2020</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2019/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2019</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2018/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2018</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2017/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2017</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2016/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2016</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2015/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2015</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2014/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2014</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2013/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2013</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2012/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2012</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2011/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2011</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2011/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2011</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2011/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2011</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2011/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2011</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2011/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2011</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2011/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2011</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2011/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2011</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2011/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2011</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2010/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2010</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2009/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2009</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2008/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2008</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2007/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2007</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/08/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>August 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/04/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>April 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/03/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>March 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/02/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>February 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2006/01/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>January 2006</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2005/10/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>October 2005</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2005/07/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>July 2005</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2005/05/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>May 2005</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2004/12/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>December 2004</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2004/11/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>November 2004</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2004/09/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>September 2004</a></li>
 <li tabindex=0 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://devblogs.microsoft.com/dotnet/2004/06/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>June 2004</a></li>
</div></div>
 </div>
 </div>
 </div><div class=col-lg-4 style=padding-bottom:10px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="card bottomright" aria-label="More .NET" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=card-body style=height:393px;padding-left:26px;padding-top:24px;padding-right:17px;margin-bottom:24px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <h5 class=card-title data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>More .NET<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>更多.NET </font></font></font></h5>
 <div class="card-text listdisplay" style=height:100%;width:100%;overflow-y:auto;overflow-x:hidden data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://aka.ms/DotNET_Download target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Download .NET<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 下载.NET</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://aka.ms/DotNET_CommunityPage target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Community<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> .NET社区</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://aka.ms/DotNET_Docs target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Documentation<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> .NET文档</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://aka.ms/DotNET_APIs target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET API Browser<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> .NET API浏览器</font></font></font></a></li>
</ul>
<h5 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Learn<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>学习 </font></font></font></h5>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://dotnet.microsoft.com/learn target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>.NET Learning Hub<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> .NET学习中心</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://dotnet.microsoft.com/learn/dotnet/architecture-guides target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Architecture Guidance<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 架构指南</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://dotnet.microsoft.com/learn/videos target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Beginner Videos<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 初学者视频</font></font></font></a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://dotnet.microsoft.com/customers target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Customer Showcase<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 客户展示</font></font></font></a></li>
</ul>
<h5 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Follow<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>遵循 </font></font></font></h5>
<ul data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://twitter.com/dotnet target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Twitter</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://dotnet.social/@dotnet target=_blank rel=me data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Mastodon</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://youtube.com/@dotnet target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>YouTube</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://facebook.com/dotnet target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Facebook</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://www.linkedin.com/groups/40949/ target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>LinkedIn</a></li>
<li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a href=https://github.com/dotnet target=_blank rel=noopener data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>GitHub</a></li>
</ul>
</div>
 </div>
 </div>
 </div></div>
 </div> </nav>
 </section>
 <section class=container data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=row data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=col-12 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <nav class=site-footer id=colophon aria-label="Secondary Footer Navigation" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class="row justify-content-center featuresectiontwo" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=col-4 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></div>
 <div class=col-4 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></div>
 </div>
 <div class="row justify-content-center featuresectiontwo" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=col-10 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <h3 class=stayinformedtitle data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Stay informed<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>随时了解 </font></font></font></h3><div id=subscribe_form class="col-12 stayinformedform tnp tnp-subscription" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <form method=post action="https://devblogs.microsoft.com/dotnet?na=s" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <div class="col-8 tnp-field tnp-field-email pull-left" style=margin-right:13px;width:300px;margin-left:30px data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><input style="border:1px solid #CED4DA;background-color:#FFF;height:34px;font-size:14px" class="tnp-email x-hidden-focus" type=email name=ne placeholder="Enter your email" required value></div><div style="padding:0 10px" class="tnp-field tnp-field-button" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><input style="background-color:#0072cc;padding:6px 20px;height:32px;font-size:14px" class="tnp-submit x-hidden-focus" type=submit value=Subscribe>
 <div style=clear:both data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></div>
 <div class="tnp-field tnp-privacy-field" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><label style=font-size:14px;font-weight:normal data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>By subscribing you agree to our <a href=https://docs.microsoft.com/en-us/collaborate/terms-of-use target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Terms of Use</a> and <a href=https://privacy.microsoft.com/en-us/privacystatement target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Privacy Policy</a><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>通过订阅您同意我们的使用条款和隐私政策</font></font></font></label></div>
 </div>
 </form>
 </div><div class=col-12 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><a class="no-underline stayinformedsite" title=facebook data-bi-id="follow blog within post" data-bi-name="blog follow post-.NET Blog-facebook" aria-label="Follow Us on Facebook" target=_blank href=https://aka.ms/dotnet/facebook data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-facebook hvr-pop"></i></a><a class="no-underline stayinformedsite" title=twitter data-bi-id="follow blog within post" data-bi-name="blog follow post-.NET Blog-twitter" aria-label="Follow Us on Twitter" target=_blank href=https://aka.ms/dotnet/twitter data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-twitter hvr-pop"></i></a><a class="no-underline stayinformedsite" title=linkedin data-bi-id="follow blog within post" data-bi-name="blog follow post-.NET Blog-linkedin" aria-label="Follow Us on LinkedIn" target=_blank href=https://aka.ms/dotnet/linkedin data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-linkedin hvr-pop"></i></a><a class="no-underline stayinformedsite" title=youtube data-bi-id="follow blog within post" data-bi-name="blog follow post-.NET Blog-youtube" aria-label="Follow Us on YouTube" target=_blank href=https://aka.ms/dotnet/youtube data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-youtube-play hvr-pop"></i></a><a class="no-underline stayinformedsite" title=twitch data-bi-id="follow blog within post" data-bi-name="blog follow post-.NET Blog-twitch" aria-label="Follow Us on Twitch" target=_blank href=https://aka.ms/VisualStudio_Twitch data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-twitch hvr-pop"></i></a><a class="no-underline stayinformedsite" title=GitHub data-bi-id="follow blog within post" data-bi-name="blog follow post-.NET Blog-github" aria-label="Follow Us on GitHub" target=_blank href=https://aka.ms/dotnet/github data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-github hvr-pop"></i></a><a class="no-underline stayinformedsite" title=Stackoverflow data-bi-id="follow blog within post" data-bi-name="blog follow post-.NET Blog-stackoverflow" aria-label="Follow Us on Stackoverflow" target=_blank href="https://stackoverflow.com/questions/tagged/.net?sort=frequent" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-stack-overflow hvr-pop"></i></a><a class="no-underline stayinformedsite" title="RSS Feed" data-bi-id="follow blog within post" data-bi-name="blog follow post-.NET Blog-rss-feed" aria-label="Subscribe to Our RSS Feed" target=_blank href=https://devblogs.microsoft.com/dotnet/feed/ data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-rss hvr-pop"></i></a></div>
 </div>
 </div>
 </nav>
 </div>
 </div>
 </section>
</div>
<div class="social-icon-bar banner-active" data-bi-id="left gutter" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=social-icon-general data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a href="https://www.facebook.com/sharer/sharer.php?u=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/" title="Share on Facebook" aria-label="Share on Facebook" target=_blank rel="noopener noreferrer nofollow" class=facebook data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-facebook"></i></a>
 <a href="https://twitter.com/intent/tweet?url=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/&amp;text=Performance%20Improvements%20in%20.NET%206" title="Share on Twitter" aria-label="Share on Twitter" target=_blank rel="noopener noreferrer nofollow" class=twitter data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-twitter"></i></a>
 <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://devblogs.microsoft.com/dotnet/performance-improvements-in-net-6/" title="Share on LinkedIn" aria-label="Share on LinkedIn" target=_blank rel="noopener noreferrer nofollow" class=linkedin data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fa fa-linkedin"></i></a>
 </div>
 <div class="devblogs-dropdown-button devblogs-dropdown-button--social-mobile sf-hidden">
 
 </div>
</div>
<div class=back-comment-buttons data-bi-id="right gutter" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a data-bi-id="right gutter" data-bi-name=comments_click_to_top href=#page title="Back to top" aria-label="click back to top of page" class="back-to-top sf-hidden" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></a>
<a data-bi-id="right gutter" data-bi-name=jump-to-comments href=#comments aria-label="click to comments" class=jump-to-comments title="Jump to comments" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><i class="fabric-icon fabric-icon--Message" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467></i></a>
 </div>
<div style=display:none data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
</div> 
 
 
 <div class="modal fade sf-hidden" id=codeModal tabindex=-1 role=dialog aria-labelledby=codeModalLabel aria-hidden=true data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 </div>
<div id=usabilla-button class=vscom-usabilla-button data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a tabindex=0 id=usbl-integrated-button data-bi-id="right gutter" data-bi-name="Usabilla feedback button" href=javascript:void(0) class=vscom-usabilla-link role=button data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <p class=vscom-usabilla-text data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 Feedback <img class=vscom-usabilla-icon src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwMSIgaGVpZ2h0PSIxMDAxIiB2aWV3Qm94PSIwIDAgMTAwMSAxMDAxIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8dGl0bGU+ZWRpdC1vdXRsaW5lPC90aXRsZT4KPGRlc2M+Q3JlYXRlZCB1c2luZyBGaWdtYTwvZGVzYz4KPGcgaWQ9IkNhbnZhcyIgdHJhbnNmb3JtPSJtYXRyaXgoNzEuNSAwIDAgNzEuNSAtMzUyNDkuNSAtNTg2MykiPgo8ZyBpZD0iZWRpdC1vdXRsaW5lIj4KPG1hc2sgaWQ9Im1hc2swX291dGxpbmUiIG1hc2stdHlwZT0iYWxwaGEiPgo8ZyBpZD0iTWFzayI+Cjx1c2UgeGxpbms6aHJlZj0iI3BhdGgwX2ZpbGwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ5MyA4MikiIGZpbGw9IiNGRkZGRkYiLz4KPC9nPgo8L21hc2s+CjxnIGlkPSJNYXNrIiBtYXNrPSJ1cmwoI21hc2swX291dGxpbmUpIj4KPHVzZSB4bGluazpocmVmPSIjcGF0aDBfZmlsbCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDkzIDgyKSIgZmlsbD0iI0ZGRkZGRiIvPgo8L2c+CjxnIGlkPSImIzIyNjsmIzEzNDsmIzE3MDsmIzI0MDsmIzE1OTsmIzE0MjsmIzE2ODtDb2xvciIgbWFzaz0idXJsKCNtYXNrMF9vdXRsaW5lKSI+CjxnIGlkPSJSZWN0YW5nbGUgMyI+Cjx1c2UgeGxpbms6aHJlZj0iI3BhdGgxX2ZpbGwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ5MyA4MikiIGZpbGw9IiNGRkZGRkYiLz4KPC9nPgo8L2c+CjwvZz4KPC9nPgo8ZGVmcz4KPHBhdGggaWQ9InBhdGgwX2ZpbGwiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTSA5Ljk5NjA5IDAuNjgyNjE3QyAxMC45MTAyIC0wLjIyNzUzOSAxMi4zOTg0IC0wLjIyNzUzOSAxMy4zMTI1IDAuNjgyNjE3QyAxMy43NTc4IDEuMTI0MDIgMTQgMS43MTM4NyAxNCAyLjMzODg3QyAxNCAyLjkxMzA5IDEzLjk0OTIgMy4yNjQ2NSAxMy4zMzIgMy44Nzc5M0wgNC40MTQwNiAxMi45MjQ4TCAwIDEzLjk5OUwgMS4xMjUgOS41ODEwNUwgOS45OTYwOSAwLjY4MjYxN1pNIDEuOTU3MDMgMTAuMzIzMkwgMS4zODY3MiAxMi41OTI4TCAzLjY2MDE2IDEyLjAyNjRDIDMuNDYwOTQgMTEuMTg2NSAyLjgwMDc4IDEwLjUyMjUgMS45NTcwMyAxMC4zMjMyWk0gMi42NDg0NCA5LjQ2Nzc3TCA5LjU5NzY2IDIuNTI2MzdMIDExLjQ2ODggNC4zOTM1NUwgNC41MTE3MiAxMS4zMzg5QyA0LjE3NTc4IDEwLjQ4NzMgMy41IDkuODA3NjIgMi42NDg0NCA5LjQ2Nzc3Wk0gMTIuMTkxNCAzLjY3MDlMIDEyLjU4OTggMy4yNzI0NkMgMTIuODM5OCAzLjAyMjQ2IDEyLjk3NjYgMi42OTA0MyAxMi45NzY2IDIuMzM4ODdDIDEyLjk3NjYgMS45ODczIDEyLjgzOTggMS42NTUyNyAxMi41ODk4IDEuNDA1MjdDIDEyLjA3NDIgMC44OTM1NTUgMTEuMjM4MyAwLjg5MzU1NSAxMC43MTg4IDEuNDA1MjdMIDEwLjMyMDMgMS44MDM3MUwgMTIuMTkxNCAzLjY3MDlaIi8+CjxwYXRoIGlkPSJwYXRoMV9maWxsIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0gMCAwTCAxNCAwTCAxNCAxNEwgMCAxNEwgMCAwWiIvPgo8L2RlZnM+Cjwvc3ZnPgo=" alt="usabilla icon" width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 反馈 <img class=vscom-usabilla-icon src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwMSIgaGVpZ2h0PSIxMDAxIiB2aWV3Qm94PSIwIDAgMTAwMSAxMDAxIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8dGl0bGU+ZWRpdC1vdXRsaW5lPC90aXRsZT4KPGRlc2M+Q3JlYXRlZCB1c2luZyBGaWdtYTwvZGVzYz4KPGcgaWQ9IkNhbnZhcyIgdHJhbnNmb3JtPSJtYXRyaXgoNzEuNSAwIDAgNzEuNSAtMzUyNDkuNSAtNTg2MykiPgo8ZyBpZD0iZWRpdC1vdXRsaW5lIj4KPG1hc2sgaWQ9Im1hc2swX291dGxpbmUiIG1hc2stdHlwZT0iYWxwaGEiPgo8ZyBpZD0iTWFzayI+Cjx1c2UgeGxpbms6aHJlZj0iI3BhdGgwX2ZpbGwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ5MyA4MikiIGZpbGw9IiNGRkZGRkYiLz4KPC9nPgo8L21hc2s+CjxnIGlkPSJNYXNrIiBtYXNrPSJ1cmwoI21hc2swX291dGxpbmUpIj4KPHVzZSB4bGluazpocmVmPSIjcGF0aDBfZmlsbCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDkzIDgyKSIgZmlsbD0iI0ZGRkZGRiIvPgo8L2c+CjxnIGlkPSImIzIyNjsmIzEzNDsmIzE3MDsmIzI0MDsmIzE1OTsmIzE0MjsmIzE2ODtDb2xvciIgbWFzaz0idXJsKCNtYXNrMF9vdXRsaW5lKSI+CjxnIGlkPSJSZWN0YW5nbGUgMyI+Cjx1c2UgeGxpbms6aHJlZj0iI3BhdGgxX2ZpbGwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ5MyA4MikiIGZpbGw9IiNGRkZGRkYiLz4KPC9nPgo8L2c+CjwvZz4KPC9nPgo8ZGVmcz4KPHBhdGggaWQ9InBhdGgwX2ZpbGwiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTSA5Ljk5NjA5IDAuNjgyNjE3QyAxMC45MTAyIC0wLjIyNzUzOSAxMi4zOTg0IC0wLjIyNzUzOSAxMy4zMTI1IDAuNjgyNjE3QyAxMy43NTc4IDEuMTI0MDIgMTQgMS43MTM4NyAxNCAyLjMzODg3QyAxNCAyLjkxMzA5IDEzLjk0OTIgMy4yNjQ2NSAxMy4zMzIgMy44Nzc5M0wgNC40MTQwNiAxMi45MjQ4TCAwIDEzLjk5OUwgMS4xMjUgOS41ODEwNUwgOS45OTYwOSAwLjY4MjYxN1pNIDEuOTU3MDMgMTAuMzIzMkwgMS4zODY3MiAxMi41OTI4TCAzLjY2MDE2IDEyLjAyNjRDIDMuNDYwOTQgMTEuMTg2NSAyLjgwMDc4IDEwLjUyMjUgMS45NTcwMyAxMC4zMjMyWk0gMi42NDg0NCA5LjQ2Nzc3TCA5LjU5NzY2IDIuNTI2MzdMIDExLjQ2ODggNC4zOTM1NUwgNC41MTE3MiAxMS4zMzg5QyA0LjE3NTc4IDEwLjQ4NzMgMy41IDkuODA3NjIgMi42NDg0NCA5LjQ2Nzc3Wk0gMTIuMTkxNCAzLjY3MDlMIDEyLjU4OTggMy4yNzI0NkMgMTIuODM5OCAzLjAyMjQ2IDEyLjk3NjYgMi42OTA0MyAxMi45NzY2IDIuMzM4ODdDIDEyLjk3NjYgMS45ODczIDEyLjgzOTggMS42NTUyNyAxMi41ODk4IDEuNDA1MjdDIDEyLjA3NDIgMC44OTM1NTUgMTEuMjM4MyAwLjg5MzU1NSAxMC43MTg4IDEuNDA1MjdMIDEwLjMyMDMgMS44MDM3MUwgMTIuMTkxNCAzLjY3MDlaIi8+CjxwYXRoIGlkPSJwYXRoMV9maWxsIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0gMCAwTCAxNCAwTCAxNCAxNEwgMCAxNEwgMCAwWiIvPgo8L2RlZnM+Cjwvc3ZnPgo=" alt="usabilla icon" width=16 height=16 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467> </font></font></font>
 </p>
 </a>
</div>
<div id=footerArea class=uhf data-m='{"cN":"footerArea","cT":"Area_coreuiArea","id":"a2Body","sN":2,"aN":"Body"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div id=footerRegion data-region-key=footerregion data-m='{"cN":"footerRegion","cT":"Region_coreui-region","id":"r1a2","sN":1,"aN":"a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div id=footerUniversalFooter data-m='{"cN":"footerUniversalFooter","cT":"Module_coreui-universalfooter","id":"m1r1a2","sN":1,"aN":"r1a2"}' data-module-id=Category|footerRegion|coreui-region|footerUniversalFooter|coreui-universalfooter data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
<footer id=uhf-footer class="c-uhff context-uhf" data-uhf-mscc-rq=false data-footer-footprint="/DEV_Blogs/DEV_BlogsFooter, fromService: True" data-m='{"cN":"Uhf footer_cont","cT":"Container","id":"c1m1r1a2","sN":1,"aN":"m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <nav class=c-uhff-nav aria-label="Footer Resource links" data-m='{"cN":"Footer nav_cont","cT":"Container","id":"c1c1m1r1a2","sN":1,"aN":"c1m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <div class=c-uhff-nav-row data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=c-uhff-nav-group data-m='{"cN":"footerNavColumn1_cont","cT":"Container","id":"c1c1c1m1r1a2","sN":1,"aN":"c1c1m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=c-heading-4 role=heading aria-level=2 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>What's new<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>有什么新 </font></font></font></div>
 <ul class="c-list f-bare" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Surface Pro 9 What's new" class=c-uhff-link href=https://www.microsoft.com/en-us/d/surface-pro-9/93VKD8NP4FVK data-m='{"cN":"Footer_WhatsNew_NewSurfacePro8_nav","id":"n1c1c1c1m1r1a2","sN":1,"aN":"c1c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Surface Pro 9</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Surface Laptop 5 What's new" class=c-uhff-link href=https://www.microsoft.com/en-us/d/surface-laptop-5/8XN49V61S1BN data-m='{"cN":"Footer_WhatsNew_SurfaceLaptop2_nav","id":"n2c1c1c1m1r1a2","sN":2,"aN":"c1c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Surface Laptop 5</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Surface Studio 2+ What's new" class=c-uhff-link href=https://www.microsoft.com/en-us/d/surface-studio-2plus/8VLFQC3597K4 data-m='{"cN":"Footer_WhatsNew_SurfaceStudio_nav","id":"n3c1c1c1m1r1a2","sN":3,"aN":"c1c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Surface Studio 2+</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Surface Laptop Go 2 What's new" class=c-uhff-link href=https://www.microsoft.com/en-us/d/surface-laptop-go-2/8PGLPV76MJHN data-m='{"cN":"Footer_WhatsNew_SurfaceLaptopGo_nav","id":"n4c1c1c1m1r1a2","sN":4,"aN":"c1c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Surface Laptop Go 2</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Surface Laptop Studio What's new" class=c-uhff-link href=https://www.microsoft.com/en-us/d/surface-laptop-studio/8SRDF62SWKPF data-m='{"cN":"Footer_WhatsNew_SurfaceLaptopStudio_nav","id":"n5c1c1c1m1r1a2","sN":5,"aN":"c1c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Surface Laptop Studio</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Surface Go 3 What's new" class=c-uhff-link href=https://www.microsoft.com/en-us/d/surface-go-3/904H27D0CBWN data-m='{"cN":"Footer_WhatsNew_SurfaceGo3_nav","id":"n6c1c1c1m1r1a2","sN":6,"aN":"c1c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Surface Go 3<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 表面Go 3 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft 365 What's new" class=c-uhff-link href=https://www.microsoft.com/microsoft-365 data-m='{"cN":"Footer_WhatsNew_Microsoft365_nav","id":"n7c1c1c1m1r1a2","sN":7,"aN":"c1c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft 365</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Windows 11 apps What's new" class=c-uhff-link href=https://www.microsoft.com/windows/windows-11-apps data-m='{"cN":"Footer_WhatsNew_Windows_11_apps_nav","id":"n8c1c1c1m1r1a2","sN":8,"aN":"c1c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Windows 11 apps<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Windows 11应用程序 </font></font></font></a>
 </li>
 </ul>
 
 </div>
 <div class=c-uhff-nav-group data-m='{"cN":"footerNavColumn2_cont","cT":"Container","id":"c2c1c1m1r1a2","sN":2,"aN":"c1c1m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=c-heading-4 role=heading aria-level=2 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Store</div>
 <ul class="c-list f-bare" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Account profile Microsoft Store" class=c-uhff-link href=https://account.microsoft.com/ data-m='{"cN":"Footer_StoreandSupport_AccountProfile_nav","id":"n1c2c1c1m1r1a2","sN":1,"aN":"c2c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Account profile<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 账户简档 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Download Center Microsoft Store" class=c-uhff-link href=https://www.microsoft.com/en-us/download data-m='{"cN":"Footer_StoreandSupport_DownloadCenter_nav","id":"n2c2c1c1m1r1a2","sN":2,"aN":"c2c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Download Center<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 下载中心 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Store support Microsoft Store" class=c-uhff-link href="https://go.microsoft.com/fwlink/?linkid=2139749" data-m='{"cN":"Footer_StoreandSupport_SalesAndSupport_nav","id":"n3c2c1c1m1r1a2","sN":3,"aN":"c2c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Store support<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Microsoft Store支持 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Returns Microsoft Store" class=c-uhff-link href="https://go.microsoft.com/fwlink/p/?LinkID=824764&amp;clcid=0x409" data-m='{"cN":"Footer_StoreandSupport_Returns_nav","id":"n4c2c1c1m1r1a2","sN":4,"aN":"c2c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Returns<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 返回 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Order tracking Microsoft Store" class=c-uhff-link href=https://account.microsoft.com/orders data-m='{"cN":"Footer_StoreandSupport_OrderTracking_nav","id":"n5c2c1c1m1r1a2","sN":5,"aN":"c2c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Order tracking<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 订单跟踪 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Certified Refurbished Microsoft Store" class=c-uhff-link href=https://www.microsoft.com/en-us/store/b/certified-refurbished-products data-m='{"cN":"Footer_StoreandSupport_StoreLocations_nav","id":"n6c2c1c1m1r1a2","sN":6,"aN":"c2c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Certified Refurbished<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 认证翻新 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Store Promise Microsoft Store" class=c-uhff-link href="https://www.microsoft.com/en-us/store/b/why-microsoft-store?icid=footer_why-msft-store_7102020" data-m='{"cN":"Footer_StoreandSupport_MicrosoftPromise_nav","id":"n7c2c1c1m1r1a2","sN":7,"aN":"c2c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Store Promise<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Microsoft Store承诺 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Flexible Payments Microsoft Store" class=c-uhff-link href="https://www.microsoft.com/en-us/store/b/payment-financing-options?icid=footer_financing_vcc" data-m='{"cN":"Footer_StoreandSupport_Financing_nav","id":"n8c2c1c1m1r1a2","sN":8,"aN":"c2c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Flexible Payments<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 灵活的付款方式 </font></font></font></a>
 </li>
 </ul>
 
 </div>
 <div class=c-uhff-nav-group data-m='{"cN":"footerNavColumn3_cont","cT":"Container","id":"c3c1c1m1r1a2","sN":3,"aN":"c1c1m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=c-heading-4 role=heading aria-level=2 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Education<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>教育 </font></font></font></div>
 <ul class="c-list f-bare" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft in education Education" class=c-uhff-link href=https://www.microsoft.com/en-us/education data-m='{"cN":"Footer_Education_MicrosoftInEducation_nav","id":"n1c3c1c1m1r1a2","sN":1,"aN":"c3c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft in education<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 微软教育 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Devices for education Education" class=c-uhff-link href=https://www.microsoft.com/en-us/education/devices/overview data-m='{"cN":"Footer_Education_DevicesforEducation_nav","id":"n2c3c1c1m1r1a2","sN":2,"aN":"c3c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Devices for education<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 教育设备 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Teams for Education Education" class=c-uhff-link href=https://www.microsoft.com/en-us/education/products/teams data-m='{"cN":"Footer_Education_MicrosoftTeamsforEducation_nav","id":"n3c3c1c1m1r1a2","sN":3,"aN":"c3c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Teams for Education</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft 365 Education Education" class=c-uhff-link href=https://www.microsoft.com/en-us/education/buy-license/microsoft365 data-m='{"cN":"Footer_Education_Microsoft365Education_nav","id":"n4c3c1c1m1r1a2","sN":4,"aN":"c3c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft 365 Education<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Microsoft 365教育 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="How to buy for your school Education" class=c-uhff-link href=https://www.microsoft.com/education/how-to-buy data-m='{"cN":"Footer_Howtobuyforyourschool_nav","id":"n5c3c1c1m1r1a2","sN":5,"aN":"c3c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>How to buy for your school<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 如何为你的学校购买 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Educator training and development Education" class=c-uhff-link href=https://education.microsoft.com/ data-m='{"cN":"Footer_Education_EducatorTrainingDevelopment_nav","id":"n6c3c1c1m1r1a2","sN":6,"aN":"c3c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Educator training and development<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 教育工作者培训和发展 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Deals for students and parents Education" class=c-uhff-link href=https://www.microsoft.com/en-us/store/b/education data-m='{"cN":"Footer_Education_DealsForStudentsandParents_nav","id":"n7c3c1c1m1r1a2","sN":7,"aN":"c3c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Deals for students and parents<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 学生和家长优惠 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Azure for students Education" class=c-uhff-link href=https://azure.microsoft.com/en-us/free/students/ data-m='{"cN":"Footer_Education_Azureforstudents_nav","id":"n8c3c1c1m1r1a2","sN":8,"aN":"c3c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Azure for students<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Azure学生 </font></font></font></a>
 </li>
 </ul>
 
 </div>
 </div>
 <div class=c-uhff-nav-row data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=c-uhff-nav-group data-m='{"cN":"footerNavColumn4_cont","cT":"Container","id":"c4c1c1m1r1a2","sN":4,"aN":"c1c1m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=c-heading-4 role=heading aria-level=2 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Business<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>业务 </font></font></font></div>
 <ul class="c-list f-bare" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Cloud Business" class=c-uhff-link href=https://www.microsoft.com/en-us/microsoft-cloud data-m='{"cN":"Footer_Business_Microsoft_Cloud_nav","id":"n1c4c1c1m1r1a2","sN":1,"aN":"c4c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Cloud<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 微软云 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Security Business" class=c-uhff-link href=https://www.microsoft.com/en-us/security data-m='{"cN":"Footer_Business_Microsoft Security_nav","id":"n2c4c1c1m1r1a2","sN":2,"aN":"c4c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Security</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Dynamics 365 Business" class=c-uhff-link href=https://dynamics.microsoft.com/en-us/ data-m='{"cN":"Footer_Business_MicrosoftDynamics365_nav","id":"n3c4c1c1m1r1a2","sN":3,"aN":"c4c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Dynamics 365</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft 365 Business" class=c-uhff-link href=https://www.microsoft.com/en-us/microsoft-365/business/ data-m='{"cN":"Footer_Business_M365_nav","id":"n4c4c1c1m1r1a2","sN":4,"aN":"c4c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft 365</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Power Platform Business" class=c-uhff-link href=https://powerplatform.microsoft.com/en-us/ data-m='{"cN":"Footer_DeveloperAndIT_Power Platform_nav","id":"n5c4c1c1m1r1a2","sN":5,"aN":"c4c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Power Platform</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Teams Business" class=c-uhff-link href=https://www.microsoft.com/en-us/microsoft-teams/group-chat-software data-m='{"cN":"Footer_Business_Microsoft365_nav","id":"n6c4c1c1m1r1a2","sN":6,"aN":"c4c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Teams</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Industry Business" class=c-uhff-link href=https://www.microsoft.com/en-us/industry data-m='{"cN":"Footer_Business_MicrosoftIndustry_nav","id":"n7c4c1c1m1r1a2","sN":7,"aN":"c4c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Industry<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 微软工业 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Small Business Business" class=c-uhff-link href="https://www.microsoft.com/en-us/store/b/business?icid=CNavBusinessStore" data-m='{"cN":"Footer_Business-SmallBusiness_nav","id":"n8c4c1c1m1r1a2","sN":8,"aN":"c4c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Small Business<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 小企业 </font></font></font></a>
 </li>
 </ul>
 
 </div>
 <div class=c-uhff-nav-group data-m='{"cN":"footerNavColumn5_cont","cT":"Container","id":"c5c1c1m1r1a2","sN":5,"aN":"c1c1m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=c-heading-4 role=heading aria-level=2 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Developer &amp; IT<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>开发人员和IT </font></font></font></div>
 <ul class="c-list f-bare" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Azure Developer &amp; IT" class=c-uhff-link href=https://azure.microsoft.com/en-us/ data-m='{"cN":"Footer_DeveloperAndIT_MicrosoftAzure_nav","id":"n1c5c1c1m1r1a2","sN":1,"aN":"c5c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Azure</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Developer Center Developer &amp; IT" class=c-uhff-link href=https://developer.microsoft.com/en-us/ data-m='{"cN":"Footer_DeveloperAndIT_DeveloperCenter_nav","id":"n2c5c1c1m1r1a2","sN":2,"aN":"c5c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Developer Center<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 开发者中心 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Documentation Developer &amp; IT" class=c-uhff-link href=https://learn.microsoft.com/docs/ data-m='{"cN":"Footer_DeveloperAndIT_Documentation_nav","id":"n3c5c1c1m1r1a2","sN":3,"aN":"c5c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Documentation<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 文件 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Learn Developer &amp; IT" class=c-uhff-link href=https://learn.microsoft.com/ data-m='{"cN":"Footer_DeveloperAndIT_MicrosoftLearn_nav","id":"n4c5c1c1m1r1a2","sN":4,"aN":"c5c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Learn<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 微软学习 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Microsoft Tech Community Developer &amp; IT" class=c-uhff-link href=https://techcommunity.microsoft.com/ data-m='{"cN":"Footer_DeveloperAndIT_MicrosoftTechCommunity_nav","id":"n5c5c1c1m1r1a2","sN":5,"aN":"c5c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Microsoft Tech Community<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Microsoft技术社区 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Azure Marketplace Developer &amp; IT" class=c-uhff-link href=https://azuremarketplace.microsoft.com/en-us/ data-m='{"cN":"Footer_DeveloperAndIT_AzureMarketplace_nav","id":"n6c5c1c1m1r1a2","sN":6,"aN":"c5c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Azure Marketplace</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="AppSource Developer &amp; IT" class=c-uhff-link href=https://appsource.microsoft.com/en-us/ data-m='{"cN":"Footer_DeveloperAndIT_AppSource_nav","id":"n7c5c1c1m1r1a2","sN":7,"aN":"c5c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>AppSource</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Visual Studio Developer &amp; IT" class=c-uhff-link href=https://visualstudio.microsoft.com/ data-m='{"cN":"Footer_DeveloperAndIT_MicrosoftVisualStudio_nav","id":"n8c5c1c1m1r1a2","sN":8,"aN":"c5c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Visual Studio</a>
 </li>
 </ul>
 
 </div>
 <div class=c-uhff-nav-group data-m='{"cN":"footerNavColumn6_cont","cT":"Container","id":"c6c1c1m1r1a2","sN":6,"aN":"c1c1m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <div class=c-heading-4 role=heading aria-level=2 data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Company<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>公司 </font></font></font></div>
 <ul class="c-list f-bare" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Careers Company" class=c-uhff-link href=https://careers.microsoft.com/ data-m='{"cN":"Footer_Company_Careers_nav","id":"n1c6c1c1m1r1a2","sN":1,"aN":"c6c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Careers<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 职业 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="About Microsoft Company" class=c-uhff-link href=https://www.microsoft.com/about data-m='{"cN":"Footer_Company_AboutMicrosoft_nav","id":"n2c6c1c1m1r1a2","sN":2,"aN":"c6c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>About Microsoft<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 关于Microsoft </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Company news Company" class=c-uhff-link href=https://news.microsoft.com/ data-m='{"cN":"Footer_Company_CompanyNews_nav","id":"n3c6c1c1m1r1a2","sN":3,"aN":"c6c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Company news<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 公司新闻 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Privacy at Microsoft Company" class=c-uhff-link href=https://privacy.microsoft.com/en-us data-m='{"cN":"Footer_Company_PrivacyAtMicrosoft_nav","id":"n4c6c1c1m1r1a2","sN":4,"aN":"c6c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Privacy at Microsoft<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> Microsoft的隐私 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Investors Company" class=c-uhff-link href=https://www.microsoft.com/investor/default.aspx data-m='{"cN":"Footer_Company_Investors_nav","id":"n5c6c1c1m1r1a2","sN":5,"aN":"c6c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Investors<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 投资者 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Diversity and inclusion Company" class=c-uhff-link href=https://www.microsoft.com/en-us/diversity/ data-m='{"cN":"Footer_Company_DiversityAndInclusion_nav","id":"n6c6c1c1m1r1a2","sN":6,"aN":"c6c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Diversity and inclusion<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 多样性和包容性 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Accessibility Company" class=c-uhff-link href=https://www.microsoft.com/en-us/accessibility data-m='{"cN":"Footer_Company_Accessibility_nav","id":"n7c6c1c1m1r1a2","sN":7,"aN":"c6c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Accessibility<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 无障碍 </font></font></font></a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a aria-label="Sustainability Company" class=c-uhff-link href=https://www.microsoft.com/en-us/sustainability/ data-m='{"cN":"Footer_Company_Sustainability_nav","id":"n8c6c1c1m1r1a2","sN":8,"aN":"c6c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sustainability<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 持续性 </font></font></font></a>
 </li>
 </ul>
 
 </div>
 </div>
 </nav>
 <div class=c-uhff-base data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 
 <a data-m='{"id":"n7c1c1m1r1a2","sN":7,"aN":"c1c1m1r1a2"}' href=https://aka.ms/yourcaliforniaprivacychoices class="c-uhff-link c-uhff-ccpa" target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <svg role=img xmlns=http://www.w3.org/2000/svg viewBox="0 0 30 14" xml:space=preserve height=16 width=43>
 <title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
 <path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style=fill-rule:evenodd;clip-rule:evenodd;fill:#fff></path>
 <path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style=fill-rule:evenodd;clip-rule:evenodd;fill:#06f></path>
 <path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style=fill:#fff></path>
 <path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style=fill:#06f></path>
 </svg>
 <span data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Your Privacy Choices<font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><font class=notranslate data-immersive-translate-translation-element-mark=1>&nbsp;</font><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-inline-wrapper-theme-paper immersive-translate-target-translation-inline-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1>您的隐私选择 </font></font></font></span>
 </a>
 <noscript>
                <a data-m="{&quot;id&quot;:&quot;n8c1c1m1r1a2&quot;,&quot;sN&quot;:8,&quot;aN&quot;:&quot;c1c1m1r1a2&quot;}" href="https://aka.ms/yourcaliforniaprivacychoices" class="c-uhff-link c-uhff-ccpa">
        <svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 14" xml:space="preserve" height="16" width="43">
            <title>California Consumer Privacy Act (CCPA) Opt-Out Icon</title>
            <path d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"></path>
            <path d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z" style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"></path>
            <path d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z" style="fill:#fff"></path>
            <path d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z" style="fill:#06f"></path>
        </svg>
        <span>Your Privacy Choices</span>
    </a>

        </noscript>
 <nav aria-label="Microsoft corporate links" data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <ul class="c-list f-bare" data-m='{"cN":"Corp links_cont","cT":"Container","id":"c9c1c1m1r1a2","sN":9,"aN":"c1c1m1r1a2"}' data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <li id=c-uhff-footer_sitemap data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=c-uhff-link href=https://www.microsoft.com/en-us/sitemap1.aspx data-mscc-ic=false data-m='{"cN":"Footer_Sitemap_nav","id":"n1c9c1c1m1r1a2","sN":1,"aN":"c9c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Sitemap</a>
 </li>
 <li id=c-uhff-footer_contactus data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=c-uhff-link href=https://support.microsoft.com/contactus data-mscc-ic=false data-m='{"cN":"Footer_ContactUs_nav","id":"n2c9c1c1m1r1a2","sN":2,"aN":"c9c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Contact Microsoft</a>
 </li>
 <li id=c-uhff-footer_privacyandcookies data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=c-uhff-link href="https://go.microsoft.com/fwlink/?LinkId=521839" data-mscc-ic=false data-m='{"cN":"Footer_PrivacyandCookies_nav","id":"n3c9c1c1m1r1a2","sN":3,"aN":"c9c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Privacy </a>
 </li>
 <li class="x-hidden sf-hidden" id=c-uhff-footer_managecookies>
 
 </li>
 <li id=c-uhff-footer_termsofuse data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=c-uhff-link href="https://go.microsoft.com/fwlink/?LinkID=206977" data-mscc-ic=false data-m='{"cN":"Footer_TermsOfUse_nav","id":"n5c9c1c1m1r1a2","sN":5,"aN":"c9c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Terms of use</a>
 </li>
 <li id=c-uhff-footer_trademarks data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=c-uhff-link href="https://go.microsoft.com/fwlink/?linkid=2196228" data-mscc-ic=false data-m='{"cN":"Footer_Trademarks_nav","id":"n6c9c1c1m1r1a2","sN":6,"aN":"c9c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Trademarks</a>
 </li>
 <li id=c-uhff-footer_safetyandeco data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=c-uhff-link href="https://go.microsoft.com/fwlink/?linkid=2196227" data-mscc-ic=false data-m='{"cN":"Footer_SafetyAndEco_nav","id":"n7c9c1c1m1r1a2","sN":7,"aN":"c9c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Safety &amp; eco</a>
 </li>
 <li id=c-uhff-recycling data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=c-uhff-link href=https://www.microsoft.com/en-us/legal/compliance/recycling data-mscc-ic=false data-m='{"cN":"Recycling_nav","id":"n8c9c1c1m1r1a2","sN":8,"aN":"c9c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>Recycling</a>
 </li>
 <li id=c-uhff-footer_aboutourads data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>
 <a class=c-uhff-link href=https://choice.microsoft.com/ data-mscc-ic=false data-m='{"cN":"Footer_AboutourAds_nav","id":"n9c9c1c1m1r1a2","sN":9,"aN":"c9c1c1m1r1a2"}' target=_blank data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>About our ads</a>
 </li>
 <li data-immersive-translate-effect=1 data-immersive_translate_walked=60b33cd8-168a-4dc7-9e25-28f9fa83f467>© Microsoft 2023</li><font class="notranslate immersive-translate-target-wrapper" lang=zh-CN data-immersive-translate-translation-element-mark=1><br><font class="notranslate immersive-translate-target-translation-theme-paper immersive-translate-target-translation-block-wrapper-theme-paper immersive-translate-target-translation-block-wrapper" data-immersive-translate-translation-element-mark=1><font class="notranslate immersive-translate-target-inner immersive-translate-target-translation-theme-paper-inner" data-immersive-translate-translation-element-mark=1> 网站地图联系Microsoft隐私使用条款商标安全环保回收关于我们的广告© Microsoft 2023 </font></font></font>
 
 </ul>
 </nav>
 </div>
 
</footer>
 </div>
 </div>
 </div>
</div>